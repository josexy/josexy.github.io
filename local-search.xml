<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>v2ray ws tls</title>
    <link href="/v2ray-ws-tls/"/>
    <url>/v2ray-ws-tls/</url>
    
    <content type="html"><![CDATA[<p>æ— </p><span id="more"></span><h3 id="centosubuntu"><a class="markdownIt-Anchor" href="#centosubuntu"></a> CentOS/Ubuntu</h3><p>è‹¥æ˜¯CentOSï¼Œåˆ™å¯ä»EPELä»“åº“ä¸­å®‰è£… Nginx</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">yum install epel-release<br>yum install nginx<br></code></pre></div></td></tr></table></figure><h3 id="cloudflarenamecheapfreenom"><a class="markdownIt-Anchor" href="#cloudflarenamecheapfreenom"></a> Cloudflare+namecheap/Freenom</h3><p>åœ¨namecheapæˆ–Freenomä¸Šæ³¨å†Œä¸€ä¸ªåŸŸåï¼Œç„¶åä¿®æ”¹åŸŸåçš„DNSä¸ºcloudflareåˆ†é…çš„æ–°çš„DNS</p><img src="/uploads/images/v2ray_ws_tls/01.png" style="zoom:67%;" /><p>åˆ° <a href="https://dash.cloudflare.com/profile/api-tokens">https://dash.cloudflare.com/profile/api-tokens</a> åˆ›å»ºä¸€ä¸ªTokenã€‚å¦‚ä¸‹</p><img src="/uploads/images/v2ray_ws_tls/02.png" style="zoom:67%;" /><p>æ³¨æ„ï¼ŒSSL/TLS è¿˜éœ€è¦è®¾ç½®ä¸º <code>Full</code>æˆ–<code>Full (strict)</code></p><h3 id="nginx"><a class="markdownIt-Anchor" href="#nginx"></a> Nginx</h3><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">cat &lt;&lt;<span class="hljs-string">EOF&gt;/etc/nginx/conf.d/default.conf</span><br><span class="hljs-string">server &#123;</span><br><span class="hljs-string">    listen       443 ssl;</span><br><span class="hljs-string">    server_name  $&#123;DOMAIN&#125;;</span><br><span class="hljs-string">    ssl_certificate ssl/$&#123;DOMAIN&#125;.crt;       </span><br><span class="hljs-string">    ssl_certificate_key ssl/$&#123;DOMAIN&#125;.key;   </span><br><span class="hljs-string"> </span><br><span class="hljs-string">    location /ws &#123;                         </span><br><span class="hljs-string">        proxy_redirect off;</span><br><span class="hljs-string">        proxy_pass http://127.0.0.1:10086;       </span><br><span class="hljs-string">        proxy_http_version 1.1;</span><br><span class="hljs-string">        proxy_set_header Upgrade \$http_upgrade;</span><br><span class="hljs-string">        proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class="hljs-string">        proxy_set_header Host \$http_host;</span><br><span class="hljs-string">        proxy_set_header X-Real-IP \$remote_addr;</span><br><span class="hljs-string">        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;</span><br><span class="hljs-string">        proxy_connect_timeout 60s;</span><br><span class="hljs-string">        proxy_read_timeout 86400s;</span><br><span class="hljs-string">        proxy_send_timeout 60s;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br></code></pre></div></td></tr></table></figure><h3 id="v2ray"><a class="markdownIt-Anchor" href="#v2ray"></a> v2ray</h3><h4 id="server"><a class="markdownIt-Anchor" href="#server"></a> Server</h4><p>ç¼–è¾‘ <code>/etc/v2ray/config.json</code> æ·»åŠ ä»¥ä¸‹å†…å®¹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">&#123;<br>  <span class="hljs-string">&quot;inbounds&quot;</span>: [&#123;<br>    <span class="hljs-string">&quot;port&quot;</span>: 10086,           <br>    <span class="hljs-string">&quot;listen&quot;</span>:<span class="hljs-string">&quot;127.0.0.1&quot;</span>,<br>    <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;vmess&quot;</span>,<br>    <span class="hljs-string">&quot;settings&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;clients&quot;</span>: [<br>        &#123;<br>          <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;UUID&#125;</span>&quot;</span>, <br>          <span class="hljs-string">&quot;level&quot;</span>: 1,<br>          <span class="hljs-string">&quot;alterId&quot;</span>: 64      <br>        &#125;<br>      ]<br>    &#125;,<br>    <span class="hljs-string">&quot;streamSettings&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;network&quot;</span>: <span class="hljs-string">&quot;ws&quot;</span>,<br>      <span class="hljs-string">&quot;wsSettings&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;path&quot;</span>: <span class="hljs-string">&quot;/ws&quot;</span>   <br>      &#125;<br>    &#125;<br>  &#125;],<br>  <span class="hljs-string">&quot;outbounds&quot;</span>: [&#123;<br>    <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;freedom&quot;</span>,<br>    <span class="hljs-string">&quot;settings&quot;</span>: &#123;&#125;<br>  &#125;,&#123;<br>    <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;blackhole&quot;</span>,<br>    <span class="hljs-string">&quot;settings&quot;</span>: &#123;&#125;,<br>    <span class="hljs-string">&quot;tag&quot;</span>: <span class="hljs-string">&quot;blocked&quot;</span><br>  &#125;],<br>  <span class="hljs-string">&quot;routing&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;rules&quot;</span>: [<br>      &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;field&quot;</span>,<br>        <span class="hljs-string">&quot;ip&quot;</span>: [<span class="hljs-string">&quot;geoip:private&quot;</span>],<br>        <span class="hljs-string">&quot;outboundTag&quot;</span>: <span class="hljs-string">&quot;blocked&quot;</span><br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­ <code>id</code>é€šè¿‡ <code>cat /proc/sys/kernel/random/uuid</code>åˆ†é…</p><h4 id="client"><a class="markdownIt-Anchor" href="#client"></a> Client</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">&#123;<br>    <span class="hljs-string">&quot;dns&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;servers&quot;</span>: [<br>            <span class="hljs-string">&quot;8.8.4.4&quot;</span>,<br>            <span class="hljs-string">&quot;1.1.1.1&quot;</span>,<br>            <span class="hljs-string">&quot;8.8.8.8&quot;</span>,<br>            <span class="hljs-string">&quot;114.114.114.114&quot;</span><br>        ]<br>    &#125;,<br>    <span class="hljs-string">&quot;inbounds&quot;</span>: [<br>        &#123;<br>            <span class="hljs-string">&quot;listen&quot;</span>: <span class="hljs-string">&quot;127.0.0.1&quot;</span>,<br>            <span class="hljs-string">&quot;port&quot;</span>: 15490,<br>            <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;dokodemo-door&quot;</span>,<br>            <span class="hljs-string">&quot;settings&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;address&quot;</span>: <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;sniffing&quot;</span>: &#123;<br>            &#125;<br>        &#125;,<br>        &#123;<br>            <span class="hljs-string">&quot;listen&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>            <span class="hljs-string">&quot;port&quot;</span>: 8888,<br>            <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;http&quot;</span>,<br>            <span class="hljs-string">&quot;settings&quot;</span>: &#123;<br>            &#125;,<br>            <span class="hljs-string">&quot;sniffing&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;enabled&quot;</span>: <span class="hljs-literal">false</span><br>            &#125;<br>        &#125;,<br>        &#123;<br>            <span class="hljs-string">&quot;listen&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>            <span class="hljs-string">&quot;port&quot;</span>: 1088,<br>            <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;socks&quot;</span>,<br>            <span class="hljs-string">&quot;settings&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;auth&quot;</span>: <span class="hljs-string">&quot;noauth&quot;</span>,<br>                <span class="hljs-string">&quot;userLevel&quot;</span>: 0<br>            &#125;,<br>            <span class="hljs-string">&quot;sniffing&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;enabled&quot;</span>: <span class="hljs-literal">false</span><br>            &#125;<br>        &#125;<br>    ],<br>    <span class="hljs-string">&quot;log&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;loglevel&quot;</span>: <span class="hljs-string">&quot;warning&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;outbounds&quot;</span>: [<br>        &#123;<br><br>            <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;vmess&quot;</span>,<br>            <span class="hljs-string">&quot;sendThrough&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>            <span class="hljs-string">&quot;settings&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;vnext&quot;</span>: [<br>                    &#123;<br>                        <span class="hljs-string">&quot;address&quot;</span>: <span class="hljs-string">&quot;åŸŸå&quot;</span>,<br>                        <span class="hljs-string">&quot;port&quot;</span>: 443,<br>                        <span class="hljs-string">&quot;users&quot;</span>: [<br>                            &#123;<br>                                <span class="hljs-string">&quot;alterId&quot;</span>: 64,<br>                                <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;æœåŠ¡å™¨UUID&quot;</span>,<br>                                <span class="hljs-string">&quot;level&quot;</span>: 0,<br>                                <span class="hljs-string">&quot;security&quot;</span>: <span class="hljs-string">&quot;none&quot;</span><br>                            &#125;<br>                        ]<br>                    &#125;<br>                ]<br>            &#125;,<br>            <span class="hljs-string">&quot;streamSettings&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;dsSettings&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;path&quot;</span>: <span class="hljs-string">&quot;/&quot;</span><br>                &#125;,<br>                <span class="hljs-string">&quot;httpSettings&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;host&quot;</span>: [<br>                    ],<br>                    <span class="hljs-string">&quot;path&quot;</span>: <span class="hljs-string">&quot;/&quot;</span><br>                &#125;,<br>                <span class="hljs-string">&quot;kcpSettings&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;congestion&quot;</span>: <span class="hljs-literal">false</span>,<br>                    <span class="hljs-string">&quot;downlinkCapacity&quot;</span>: 100,<br>                    <span class="hljs-string">&quot;header&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;none&quot;</span><br>                    &#125;,<br>                    <span class="hljs-string">&quot;mtu&quot;</span>: 1350,<br>                    <span class="hljs-string">&quot;readBufferSize&quot;</span>: 1,<br>                    <span class="hljs-string">&quot;tti&quot;</span>: 24,<br>                    <span class="hljs-string">&quot;uplinkCapacity&quot;</span>: 5,<br>                    <span class="hljs-string">&quot;writeBufferSize&quot;</span>: 1<br>                &#125;,<br>                <span class="hljs-string">&quot;network&quot;</span>: <span class="hljs-string">&quot;ws&quot;</span>,<br>                <span class="hljs-string">&quot;quicSettings&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;header&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;none&quot;</span><br>                    &#125;,<br>                    <span class="hljs-string">&quot;key&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                    <span class="hljs-string">&quot;security&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>                &#125;,<br>                <span class="hljs-string">&quot;security&quot;</span>: <span class="hljs-string">&quot;tls&quot;</span>,<br>                <span class="hljs-string">&quot;sockopt&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;mark&quot;</span>: 0,<br>                    <span class="hljs-string">&quot;tcpFastOpen&quot;</span>: <span class="hljs-literal">false</span>,<br>                    <span class="hljs-string">&quot;tproxy&quot;</span>: <span class="hljs-string">&quot;off&quot;</span><br>                &#125;,<br>                <span class="hljs-string">&quot;tcpSettings&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;header&quot;</span>: &#123;<br>                        <span class="hljs-string">&quot;request&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;headers&quot;</span>: &#123;<br>                            &#125;,<br>                            <span class="hljs-string">&quot;method&quot;</span>: <span class="hljs-string">&quot;GET&quot;</span>,<br>                            <span class="hljs-string">&quot;path&quot;</span>: [<br>                            ],<br>                            <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.1&quot;</span><br>                        &#125;,<br>                        <span class="hljs-string">&quot;response&quot;</span>: &#123;<br>                            <span class="hljs-string">&quot;headers&quot;</span>: &#123;<br>                            &#125;,<br>                            <span class="hljs-string">&quot;reason&quot;</span>: <span class="hljs-string">&quot;OK&quot;</span>,<br>                            <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;200&quot;</span>,<br>                            <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.1&quot;</span><br>                        &#125;,<br>                        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;none&quot;</span><br>                    &#125;<br>                &#125;,<br>                <span class="hljs-string">&quot;tlsSettings&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;allowInsecure&quot;</span>: <span class="hljs-literal">true</span>,<br>                    <span class="hljs-string">&quot;allowInsecureCiphers&quot;</span>: <span class="hljs-literal">false</span>,<br>                    <span class="hljs-string">&quot;alpn&quot;</span>: [<br>                    ],<br>                    <span class="hljs-string">&quot;certificates&quot;</span>: [<br>                    ],<br>                    <span class="hljs-string">&quot;disableSystemRoot&quot;</span>: <span class="hljs-literal">false</span>,<br>                    <span class="hljs-string">&quot;serverName&quot;</span>: <span class="hljs-string">&quot;&quot;</span><br>                &#125;,<br>                <span class="hljs-string">&quot;wsSettings&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;headers&quot;</span>: &#123;<br>                    &#125;,<br>                    <span class="hljs-string">&quot;path&quot;</span>: <span class="hljs-string">&quot;/ws&quot;</span><br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;tag&quot;</span>: <span class="hljs-string">&quot;server&quot;</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;freedom&quot;</span>,<br>            <span class="hljs-string">&quot;sendThrough&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>            <span class="hljs-string">&quot;settings&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;domainStrategy&quot;</span>: <span class="hljs-string">&quot;AsIs&quot;</span>,<br>                <span class="hljs-string">&quot;redirect&quot;</span>: <span class="hljs-string">&quot;:0&quot;</span>,<br>                <span class="hljs-string">&quot;userLevel&quot;</span>: 0<br>            &#125;,<br>            <span class="hljs-string">&quot;streamSettings&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;kcpSettings&quot;</span>: &#123;<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;tag&quot;</span>: <span class="hljs-string">&quot;outBound_DIRECT&quot;</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-string">&quot;protocol&quot;</span>: <span class="hljs-string">&quot;blackhole&quot;</span>,<br>            <span class="hljs-string">&quot;sendThrough&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>            <span class="hljs-string">&quot;settings&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;response&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;none&quot;</span><br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;streamSettings&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;kcpSettings&quot;</span>: &#123;<br>                &#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;tag&quot;</span>: <span class="hljs-string">&quot;outBound_BLACKHOLE&quot;</span><br>        &#125;<br>    ],<br>    <span class="hljs-string">&quot;policy&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;system&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;statsInboundDownlink&quot;</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-string">&quot;statsInboundUplink&quot;</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-string">&quot;statsOutboundDownlink&quot;</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-string">&quot;statsOutboundUplink&quot;</span>: <span class="hljs-literal">true</span><br>        &#125;<br>    &#125;,<br>    <span class="hljs-string">&quot;routing&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;domainStrategy&quot;</span>: <span class="hljs-string">&quot;AsIs&quot;</span>,<br>        <span class="hljs-string">&quot;rules&quot;</span>: [<br>            &#123;<br>                <span class="hljs-string">&quot;ip&quot;</span>: [<br>                    <span class="hljs-string">&quot;geoip:private&quot;</span><br>                ],<br>                <span class="hljs-string">&quot;outboundTag&quot;</span>: <span class="hljs-string">&quot;outBound_DIRECT&quot;</span>,<br>                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;field&quot;</span><br>            &#125;,<br>            &#123;<br>                <span class="hljs-string">&quot;ip&quot;</span>: [<br>                    <span class="hljs-string">&quot;geoip:cn&quot;</span><br>                ],<br>                <span class="hljs-string">&quot;outboundTag&quot;</span>: <span class="hljs-string">&quot;outBound_DIRECT&quot;</span>,<br>                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;field&quot;</span><br>            &#125;,<br>            &#123;<br>                <span class="hljs-string">&quot;domain&quot;</span>: [<br>                    <span class="hljs-string">&quot;geosite:cn&quot;</span><br>                ],<br>                <span class="hljs-string">&quot;outboundTag&quot;</span>: <span class="hljs-string">&quot;outBound_DIRECT&quot;</span>,<br>                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;field&quot;</span><br>            &#125;<br>        ]<br>    &#125;,<br>    <span class="hljs-string">&quot;stats&quot;</span>: &#123;<br>    &#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h3 id="ä¸€é”®é…ç½®è„šæœ¬"><a class="markdownIt-Anchor" href="#ä¸€é”®é…ç½®è„šæœ¬"></a> ä¸€é”®é…ç½®è„šæœ¬</h3><p>æ•´ä¸ªè¿‡ç¨‹ç”¨bashè„šæœ¬å¤„ç†</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment"># åŸŸåï¼Œè‡ªè¡Œä¿®æ”¹</span><br><span class="hljs-built_in">export</span> DOMAIN=<br><span class="hljs-built_in">export</span> UUID=$(cat /proc/sys/kernel/random/uuid)<br><span class="hljs-comment"># cloudflareä¸­åˆ›å»ºçš„tokenï¼Œè‡ªè¡Œä¿®æ”¹</span><br><span class="hljs-built_in">export</span> CF_Token=<span class="hljs-string">&quot;&quot;</span><br><br>curl -X GET <span class="hljs-string">&quot;https://api.cloudflare.com/client/v4/user/tokens/verify&quot;</span> \<br>     -H <span class="hljs-string">&quot;Authorization: Bearer <span class="hljs-variable">$&#123;CF_Token&#125;</span>&quot;</span> \<br>     -H <span class="hljs-string">&quot;Content-Type:application/json&quot;</span><br><br>apt install curl wget -y <br>apt install socat -y<br>apt install nginx -y<br><br>bash &lt;(curl -L -s https://install.direct/go.sh)<br>cat &lt;&lt;<span class="hljs-string">EOF&gt;/etc/v2ray/config.json</span><br><span class="hljs-string">&#123;</span><br><span class="hljs-string">  &quot;inbounds&quot;: [&#123;</span><br><span class="hljs-string">    &quot;port&quot;: 10086,           </span><br><span class="hljs-string">    &quot;listen&quot;:&quot;127.0.0.1&quot;,</span><br><span class="hljs-string">    &quot;protocol&quot;: &quot;vmess&quot;,</span><br><span class="hljs-string">    &quot;settings&quot;: &#123;</span><br><span class="hljs-string">      &quot;clients&quot;: [</span><br><span class="hljs-string">        &#123;</span><br><span class="hljs-string">          &quot;id&quot;: &quot;$&#123;UUID&#125;&quot;, </span><br><span class="hljs-string">          &quot;level&quot;: 1,</span><br><span class="hljs-string">          &quot;alterId&quot;: 64      </span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">      ]</span><br><span class="hljs-string">    &#125;,</span><br><span class="hljs-string">    &quot;streamSettings&quot;: &#123;</span><br><span class="hljs-string">      &quot;network&quot;: &quot;ws&quot;,</span><br><span class="hljs-string">      &quot;wsSettings&quot;: &#123;</span><br><span class="hljs-string">        &quot;path&quot;: &quot;/ws&quot;   </span><br><span class="hljs-string">      &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">  &#125;],</span><br><span class="hljs-string">  &quot;outbounds&quot;: [&#123;</span><br><span class="hljs-string">    &quot;protocol&quot;: &quot;freedom&quot;,</span><br><span class="hljs-string">    &quot;settings&quot;: &#123;&#125;</span><br><span class="hljs-string">  &#125;,&#123;</span><br><span class="hljs-string">    &quot;protocol&quot;: &quot;blackhole&quot;,</span><br><span class="hljs-string">    &quot;settings&quot;: &#123;&#125;,</span><br><span class="hljs-string">    &quot;tag&quot;: &quot;blocked&quot;</span><br><span class="hljs-string">  &#125;],</span><br><span class="hljs-string">  &quot;routing&quot;: &#123;</span><br><span class="hljs-string">    &quot;rules&quot;: [</span><br><span class="hljs-string">      &#123;</span><br><span class="hljs-string">        &quot;type&quot;: &quot;field&quot;,</span><br><span class="hljs-string">        &quot;ip&quot;: [&quot;geoip:private&quot;],</span><br><span class="hljs-string">        &quot;outboundTag&quot;: &quot;blocked&quot;</span><br><span class="hljs-string">      &#125;</span><br><span class="hljs-string">    ]</span><br><span class="hljs-string">  &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br><br><span class="hljs-comment"># yum -y update</span><br><span class="hljs-comment"># yum -y install epel-release</span><br><span class="hljs-comment"># yum -y install nginx</span><br><br>systemctl <span class="hljs-built_in">enable</span> v2ray<br>systemctl restart v2ray<br><br>mkdir /etc/nginx/ssl <br>mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.back  <br>cat &lt;&lt;<span class="hljs-string">EOF&gt;/etc/nginx/conf.d/default.conf</span><br><span class="hljs-string">server &#123;</span><br><span class="hljs-string">    listen       443 ssl;</span><br><span class="hljs-string">    server_name  $&#123;DOMAIN&#125;;</span><br><span class="hljs-string">    ssl_certificate ssl/$&#123;DOMAIN&#125;.crt;       </span><br><span class="hljs-string">    ssl_certificate_key ssl/$&#123;DOMAIN&#125;.key;   </span><br><span class="hljs-string"> </span><br><span class="hljs-string">    location /ws &#123;                         </span><br><span class="hljs-string">        proxy_redirect off;</span><br><span class="hljs-string">        proxy_pass http://127.0.0.1:10086;       </span><br><span class="hljs-string">        proxy_http_version 1.1;</span><br><span class="hljs-string">        proxy_set_header Upgrade \$http_upgrade;</span><br><span class="hljs-string">        proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class="hljs-string">        proxy_set_header Host \$http_host;</span><br><span class="hljs-string">        proxy_set_header X-Real-IP \$remote_addr;</span><br><span class="hljs-string">        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;</span><br><span class="hljs-string">        proxy_connect_timeout 60s;</span><br><span class="hljs-string">        proxy_read_timeout 86400s;</span><br><span class="hljs-string">        proxy_send_timeout 60s;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string">EOF</span><br>systemctl stop nginx<br>systemctl <span class="hljs-built_in">enable</span> nginx<br><br>mv ~/.acme.sh ~/.acme.sh.back <br>curl  https://get.acme.sh | sh<br><span class="hljs-built_in">source</span> ~/.bashrc<br><span class="hljs-built_in">cd</span> ~/.acme.sh<br>./acme.sh --issue --dns dns_cf -d <span class="hljs-variable">$&#123;DOMAIN&#125;</span> --standalone -k ec-256<br>cat <span class="hljs-variable">$&#123;DOMAIN&#125;</span>_ecc/fullchain.cer &gt;/etc/nginx/ssl/<span class="hljs-variable">$&#123;DOMAIN&#125;</span>.crt<br>cat <span class="hljs-variable">$&#123;DOMAIN&#125;</span>_ecc/<span class="hljs-variable">$&#123;DOMAIN&#125;</span>.key&gt;/etc/nginx/ssl/<span class="hljs-variable">$&#123;DOMAIN&#125;</span>.key<br>systemctl restart nginx<br>./acme.sh --installcert -d <span class="hljs-variable">$&#123;DOMAIN&#125;</span> -d *.<span class="hljs-variable">$&#123;DOMAIN&#125;</span> \<br>          --fullchainpath /etc/nginx/ssl/<span class="hljs-variable">$&#123;DOMAIN&#125;</span>.crt \<br>          --keypath /etc/nginx/ssl/<span class="hljs-variable">$&#123;DOMAIN&#125;</span>.key \<br>          --reloadcmd <span class="hljs-string">&quot;systemctl force-reload nginx&quot;</span> \<br>          --ecc<br><br><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;DOMAIN: &quot;</span> =&gt; <span class="hljs-variable">$&#123;DOMAIN&#125;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;UUID: &quot;</span> =&gt; <span class="hljs-variable">$&#123;UUID&#125;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;CF_Token: &quot;</span> =&gt; <span class="hljs-variable">$&#123;CF_Token&#125;</span><br><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>v2ray</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Unix/Linux Shell</title>
    <link href="/unix-linux-shell/"/>
    <url>/unix-linux-shell/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦æ˜¯å‚è€ƒä¹¦ä¸Šå†…å®¹å¹¶æ€»ç»“å‡ºæ¥çš„ï¼Œå› æ­¤æ— æ³•å…¨é¢æ¦‚è¿°æ¯ä¸€ä¸ªshellçš„ä½¿ç”¨ï¼Œå…·ä½“å¯ä»¥<code>man</code>æŸ¥çœ‹å¸®åŠ©ã€‚ğŸ‘€</p><span id="more"></span><h3 id="rm"><a class="markdownIt-Anchor" href="#rm"></a> rm</h3><p>ç©è¿‡linuxéƒ½çŸ¥é“ <code>rm</code> è¿™ä¸ªå‘½ä»¤ï¼Œå®ƒæ˜¯ç”¨æ¥åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶/ç›®å½•ï¼Œä¸€èˆ¬å¸¸ç”¨çš„æ“ä½œæ˜¯ <code>rm files</code>ã€‚ä¸è¿‡æœ‰æ—¶ä¸ºäº†çœäº‹ï¼Œç›´æ¥ <code>rm -rf files/dirs</code>è¡¨ç¤ºå¼ºåˆ¶åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•(åŒ…æ‹¬å­ç›®å½•æ‰€æœ‰æ–‡ä»¶)ã€‚<br />ä¸è¿‡æœ‰æ—¶å€™çªç„¶sbäº†ï¼Œç›´æ¥æ‰§è¡Œ <code>rm -rf /*</code> ï¼Œé™¤éååº”åœ¨0.000000009mså†…å¦åˆ™åŸºæœ¬å°±GGäº†ï¼Œè¿˜è¦ä¸€ç§å†™æ³•ä¹Ÿå¯èƒ½GGï¼Œæ¯”å¦‚: <code>rm -rf $TMP/*</code>ï¼Œå¦‚æœå˜é‡<code>$TMP</code> <strong>ä¸å­˜åœ¨æˆ–ä¸ºç©º</strong>ï¼Œé‚£ä¹ˆè¿™æ¡å‘½ä»¤ç­‰ä»·äº<code>rm -rf /*</code>ã€‚ã€‚ã€‚<br />æ€»ä¹‹ï¼Œrmå°±æ˜¯ä¸‡æ¶ä¹‹æºï¼Œè¿œç¦»rmï¼Œä»æˆ‘åšèµ· ğŸ¤£</p><h3 id="å˜é‡åˆå§‹åŒ–ç©ºå€¼"><a class="markdownIt-Anchor" href="#å˜é‡åˆå§‹åŒ–ç©ºå€¼"></a> å˜é‡åˆå§‹åŒ–ç©ºå€¼</h3><p>Linuxå˜é‡åˆå§‹åŒ–ä¸ºç©ºå€¼æœ‰3ç§å½¢å¼ï¼Œæ•ˆæœä¸€æ ·ã€‚</p><ul><li><code>var=</code></li><li><code>var=&quot;&quot;</code> (æ— ç©ºæ ¼)</li><li><code>var=''</code> (æ— ç©ºæ ¼)</li></ul><h3 id="æ•´æ•°ç®—æ•°æ“ä½œ"><a class="markdownIt-Anchor" href="#æ•´æ•°ç®—æ•°æ“ä½œ"></a> æ•´æ•°ç®—æ•°æ“ä½œ $(())ã€$[]</h3><p>åŸºæœ¬ä¸Šlinux shellæä¾›äº†ä¸€ç§å«åš<strong>ç®—æœ¯æ‰©å±•</strong>çš„æœºåˆ¶èƒ½å¤Ÿæ‰§è¡Œshellå˜é‡çš„<strong>æ•´æ•°</strong>è¿ç®—ã€‚ï¼ˆPS: bashä»…æ”¯æŒæ•´æ•°ï¼Œè€Œzshå…¶å®æ”¯æŒæµ®ç‚¹æ•°çš„ã€‚ä»¥ä¸‹æ‰€æœ‰å‘½ä»¤åŠç»“æœå‡åœ¨bashä¸Šæµ‹è¯•ï¼‰<br />æ ¼å¼: <code>$((expression))</code> æˆ– <code>$[expression]</code> expressionè¡¨è¾¾å¼é¦–å°¾å¯æ— ç©ºæ ¼<br /><code>$(())</code> æ”¯æŒ +ã€-ã€<em>ã€/ã€%ã€**(å¹‚)ã€+=ã€-=ã€</em>=ã€/=ã€var++ã€varâ€“ã€++varã€â€“var<br />é™¤æ­¤ä¹‹å¤–ï¼Œ<code>$(())</code>ä¹Ÿæ”¯æŒè¿›åˆ¶ä¹‹é—´çš„è½¬æ¢ï¼ˆè½¬æ¢ä¸º10è¿›åˆ¶ï¼‰ã€‚å³ <code>$((åŸºæ•°#è½¬æ¢çš„å€¼))</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> $((<span class="hljs-number">1</span>+<span class="hljs-number">20</span>*<span class="hljs-number">2</span>))     <span class="hljs-comment"># 41</span><br><br>var=100<br><span class="hljs-built_in">echo</span> $((var+=<span class="hljs-number">100</span>))   <span class="hljs-comment"># 200</span><br><br><span class="hljs-built_in">echo</span> $((var+<span class="hljs-number">100</span>))<br><span class="hljs-built_in">echo</span> $((<span class="hljs-variable">$var</span>+<span class="hljs-number">100</span>))   <span class="hljs-comment"># $éå¿…éœ€</span><br><br><span class="hljs-built_in">echo</span> $((<span class="hljs-number">2#11111111</span>)) <span class="hljs-comment"># è¾“å‡º 255 </span><br><span class="hljs-built_in">echo</span> $((<span class="hljs-number">8#377</span>))      <span class="hljs-comment"># è¾“å‡º 255</span><br><span class="hljs-built_in">echo</span> $((<span class="hljs-number">16#ff</span>))      <span class="hljs-comment"># è¾“å‡º 255</span><br><span class="hljs-built_in">echo</span> $((<span class="hljs-number">10#255</span>))     <span class="hljs-comment"># è¾“å‡º 255</span><br><span class="hljs-built_in">echo</span> $((<span class="hljs-number">3#22</span>))       <span class="hljs-comment"># è¾“å‡º 8 </span><br>var=ff<br><span class="hljs-built_in">echo</span> $((<span class="hljs-number">16</span>#<span class="hljs-variable">$var</span>))    <span class="hljs-comment"># è¾“å‡º 255</span><br><br><span class="hljs-built_in">echo</span> $((<span class="hljs-number">10</span>!=<span class="hljs-number">10</span>&amp;&amp;var&gt;<span class="hljs-number">100</span>))  <span class="hljs-comment"># ç”šè‡³è¿˜å¯ä»¥é€»è¾‘åˆ¤æ–­</span><br></code></pre></div></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥åœ¨if/forå†…è¿›è¡Œæ±‚å’Œï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªç®€çŸ­çš„ä¾‹å­ï¼Œå…¶ä¸­ <code>:</code> ä¸èƒ½å»æ‰ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰<code>:</code>é‚£ä¹ˆ<code>$((sum+=i))</code>è¢«å½“ä½œä¸€æ¡å‘½ä»¤å»æ‰§è¡Œï¼Œè€Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦æ±‚å’Œï¼Œæ²¡æœ‰æ‰§è¡Œä»€ä¹ˆshellå‘½ä»¤ï¼Œäºæ˜¯bashåªèƒ½æŠ¥é”™<code>æœªæ‰¾åˆ°å‘½ä»¤</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>sum=<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;1..100&#125;;<span class="hljs-keyword">do</span><br>        : $((sum+=i))<br><span class="hljs-keyword">done</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$sum</span><br></code></pre></div></td></tr></table></figure><h3 id="å‘½ä»¤æ›¿æ¢"><a class="markdownIt-Anchor" href="#å‘½ä»¤æ›¿æ¢"></a> å‘½ä»¤æ›¿æ¢ $()</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œlinuxé€šè¿‡ <code>$()</code> å’Œ <code>` `</code>æ¥æ‰§è¡Œä¸€äº›å‘½ä»¤ï¼Œæ¯”å¦‚<code>echo $(date)</code> <code>echo `date`</code>ï¼Œè¿™åœ¨shellè„šæœ¬ä¸­å¾ˆå¸¸è§ï¼Œå¯ä»¥ä¿å­˜è¾“å‡ºç»“æœåˆ°å˜é‡ä¸­ã€‚</p><h3 id="å˜é‡æ›¿æ¢"><a class="markdownIt-Anchor" href="#å˜é‡æ›¿æ¢"></a> å˜é‡æ›¿æ¢ ${}</h3><p>æ‰€è°“çš„å˜é‡æ›¿æ¢ä¹Ÿå°±æ˜¯æŠŠå˜é‡æ”¾åœ¨ç”¨åŒå¼•å·<code>&quot;&quot;</code>å­—ç¬¦ä¸²è€Œä¸æ˜¯å•å¼•å·<code>''</code>å­—ç¬¦ä¸²ä¸­ã€‚è¿™æ˜¯å› ä¸ºå•å¼•å·è¡¨ç¤ºå‘Šè¯‰shellå¿½ç•¥å­—ç¬¦ä¸²ä¸­çš„<strong>ç‰¹æ®Šå­—ç¬¦</strong>ï¼Œæ¯”å¦‚<code>$</code><br />æ¯”å¦‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">num=666<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;number: <span class="hljs-variable">$&#123;num&#125;</span>000&quot;</span>        <span class="hljs-comment"># number: 666000</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;number: $&#123;num&#125;000&#x27;</span>        <span class="hljs-comment"># number: $&#123;num&#125;000</span><br></code></pre></div></td></tr></table></figure><h3 id="å‚æ•°æ›¿æ¢"><a class="markdownIt-Anchor" href="#å‚æ•°æ›¿æ¢"></a> å‚æ•°æ›¿æ¢</h3><p>shellä¸­å‚æ•°åŒ…æ‹¬ï¼šä¼ é€’ç»™ç¨‹åºçš„å‚æ•°ï¼ˆä½ç½®å‚æ•°ï¼Œæ¯”å¦‚$0ã€$1â€¦ï¼‰ã€ç‰¹æ®Šçš„shellå˜é‡ï¼ˆå¦‚ $#ï¼‰å’Œæ™®é€šå˜é‡ï¼ˆå…³é”®å­—å‚æ•°ï¼‰</p><table><thead><tr><th>å‚æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>${parameter}</td><td>æ›¿æ¢ä¸ºparameterçš„å€¼</td></tr><tr><td>${parameter:-value}</td><td>å¦‚æœparameterå·²è®¾ç½®ä¸”ä¸ä¸ºç©ºï¼Œæ›¿æ¢ä¸ºå®ƒçš„å€¼ï¼›å¦åˆ™ï¼Œæ›¿æ¢ä¸º value</td></tr><tr><td>${parameter-value}</td><td>å¦‚æœparameterå·²è®¾ç½®ï¼Œæ›¿æ¢ä¸ºå®ƒçš„å€¼ï¼›å¦åˆ™ï¼Œæ›¿æ¢ä¸º value</td></tr><tr><td>${parameter:=value}</td><td>å¦‚æœparameterå·²è®¾ç½®ä¸”ä¸ä¸ºç©ºï¼Œæ›¿æ¢ä¸ºå®ƒçš„å€¼ï¼›å¦åˆ™ï¼Œæ›¿æ¢ä¸º valueå¹¶å°†å…¶èµ‹ç»™parameter</td></tr><tr><td>${parameter=value}</td><td>å¦‚æœparameterå·²è®¾ç½®ï¼Œæ›¿æ¢ä¸ºå®ƒçš„å€¼ï¼›å¦åˆ™ï¼Œæ›¿æ¢ä¸º valueå¹¶å°†å…¶èµ‹ç»™parameter</td></tr><tr><td>${parameter:?value}</td><td>å¦‚æœparameterå·²è®¾ç½®ä¸”ä¸ä¸ºç©ºï¼Œæ›¿æ¢ä¸ºå®ƒçš„å€¼ï¼›å¦åˆ™ï¼Œå°†valueå†™å…¥æ ‡å‡†é”™è¯¯å¹¶é€€å‡ºã€‚è‹¥å¿½ç•¥valueï¼Œåˆ™å‘æ ‡å‡†é”™è¯¯å†™å…¥parameter: parameter null or not set</td></tr><tr><td>${parameter?value}</td><td>å¦‚æœparameterå·²è®¾ç½®ï¼Œæ›¿æ¢ä¸ºå®ƒçš„å€¼ï¼›å¦åˆ™ï¼Œå°†valueå†™å…¥æ ‡å‡†é”™è¯¯å¹¶é€€å‡ºã€‚è‹¥å¿½ç•¥valueï¼Œåˆ™å‘æ ‡å‡†é”™è¯¯å†™å…¥parameter: parameter null or not set</td></tr><tr><td>${parameter:+value}</td><td>å¦‚æœparameterå·²è®¾ç½®ä¸”ä¸ä¸ºç©ºï¼Œæ›¿æ¢ä¸ºvalueï¼›å¦åˆ™ï¼Œæ›¿æ¢ä¸ºç©º</td></tr><tr><td>${parameter+value}</td><td>å¦‚æœparameterå·²è®¾ç½®ï¼Œæ›¿æ¢ä¸ºvalueï¼›å¦åˆ™ï¼Œæ›¿æ¢ä¸ºç©º</td></tr><tr><td>${ #parameter}</td><td>æ±‚parameterçš„<strong>é•¿åº¦</strong></td></tr><tr><td>${parameter#pattern}</td><td>ä»parameter<strong>å·¦è¾¹</strong>å¼€å§‹<strong>åˆ é™¤</strong>patternçš„<strong>æœ€çŸ­</strong>åŒ¹é…ï¼Œä½™ä¸‹å†…å®¹ä½œä¸ºå‚æ•°æ›¿æ¢çš„ç»“æœ</td></tr><tr><td>${parameter##pattern}</td><td>ä»parameter<strong>å·¦è¾¹</strong>å¼€å§‹<strong>åˆ é™¤</strong>patternçš„<strong>æœ€é•¿</strong>åŒ¹é…ï¼Œä½™ä¸‹å†…å®¹ä½œä¸ºå‚æ•°æ›¿æ¢çš„ç»“æœ</td></tr><tr><td>${parameter%pattern}</td><td>ä»parameter<strong>å³è¾¹</strong>å¼€å§‹<strong>åˆ é™¤</strong>patternçš„<strong>æœ€çŸ­</strong>åŒ¹é…ï¼Œä½™ä¸‹å†…å®¹ä½œä¸ºå‚æ•°æ›¿æ¢çš„ç»“æœ</td></tr><tr><td>${parameter%%pattern}</td><td>ä»parameter<strong>å³è¾¹</strong>å¼€å§‹<strong>åˆ é™¤</strong>patternçš„<strong>æœ€é•¿</strong>åŒ¹é…ï¼Œä½™ä¸‹å†…å®¹ä½œä¸ºå‚æ•°æ›¿æ¢çš„ç»“æœ</td></tr></tbody></table><p>é€šè¿‡ <code>set</code> å‘½ä»¤å¯ä»¥ä¸ºä½ç½®å‚æ•°é‡æ–°èµ‹å€¼ã€‚<br />å¦‚ <code>set a b 123</code>ï¼Œè¿™å°†<code>a</code>èµ‹å€¼ç»™<code>$1</code>ã€<code>b</code>èµ‹å€¼ç»™<code>$2</code>ã€<code>123</code>èµ‹å€¼ç»™<code>$3</code>ã€‚<br />è¿˜å¯ä»¥å°†è¾“å…¥çš„æ¯ä¸ªæ•°æ®ä¾æ¬¡åˆ†é…åˆ°ä½ç½®å‚æ•°<code>$1</code>ã€<code>$2</code>â€¦</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">read</span> line<br><span class="hljs-built_in">set</span> <span class="hljs-variable">$line</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$#</span><br><span class="hljs-keyword">for</span> args; <span class="hljs-keyword">do</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-variable">$args</span><br><span class="hljs-keyword">done</span><br></code></pre></div></td></tr></table></figure><h3 id="æ•°å­¦ç­‰å¼è§£ç®—å™¨expr"><a class="markdownIt-Anchor" href="#æ•°å­¦ç­‰å¼è§£ç®—å™¨expr"></a> æ•°å­¦ç­‰å¼è§£ç®—å™¨expr</h3><p>exprå‘½ä»¤æ²¡æœ‰$(())é«˜çº§ï¼ŒåŠŸèƒ½æ¯”è¾ƒå±€é™è€Œä¸”ä¹Ÿåªæ”¯æŒæ•´æ•°ã€‚expré™¤äº†æ”¯æŒåŸºæœ¬çš„ Â±*/å¤–ï¼Œè¿˜æ”¯æŒ|ã€&amp;ã€!=ã€=ã€&lt;=ã€&lt;ã€&gt;=ã€&gt;é€»è¾‘åˆ¤æ–­ã€‚éœ€è¦ç”¨ç©ºæ ¼åˆ†éš”å‚æ•°ï¼Œè€Œä¸”ä¹˜çš„è¯éœ€è¦ç”¨<code>\</code>è½¬ä¹‰ï¼æ³¨æ„ä¸è¦ç†æ‰€å½“ç„¶åœ°ç”¨ <code>&quot;&quot;</code> æ¥åŒ…å›´è¡¨è¾¾å¼ï¼Œè¿™æ²¡ç”¨</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">expr 10 + 10 \* 10 / 20   <span class="hljs-comment"># è¾“å‡º 15</span><br>expr <span class="hljs-string">&quot;10 + 10 * 10 / 20&quot;</span>  <span class="hljs-comment"># è¾“å‡º 10 + 10 * 10 / 20</span><br><br>var=100<br>expr <span class="hljs-variable">$var</span> + 100           <span class="hljs-comment"># è¾“å‡º 200</span><br>i=`expr <span class="hljs-variable">$var</span> + 100`       <span class="hljs-comment"># i=200</span><br><br></code></pre></div></td></tr></table></figure><p>å½“ç„¶exprè¿˜æœ‰å…¶ä»–åŠŸèƒ½ï¼Œæ¯”å¦‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># é»˜è®¤è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦æ•°ç›®</span><br>expr <span class="hljs-string">&quot;i love linux&quot;</span> : <span class="hljs-string">&quot;.*&quot;</span>          <span class="hljs-comment"># 12</span><br><span class="hljs-comment"># ç­‰åŒäº</span><br>expr length <span class="hljs-string">&quot;i love linux&quot;</span>          <span class="hljs-comment"># 12</span><br><br><span class="hljs-comment"># è¿”å›æŸä¸ªå­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­çš„ç´¢å¼•(ä»1å¼€å§‹)</span><br>expr index <span class="hljs-string">&quot;i love linux&quot;</span>  o        <span class="hljs-comment"># 4</span><br><br><span class="hljs-comment"># æå–ç´¢å¼•ä¸º8çš„5ä¸ªå­—ç¬¦çš„å­å­—ç¬¦ä¸²</span><br>expr substr <span class="hljs-string">&quot;i love linux&quot;</span>  8 5     <span class="hljs-comment"># linux</span><br></code></pre></div></td></tr></table></figure><h3 id="ä¼ é€’å‚æ•°"><a class="markdownIt-Anchor" href="#ä¼ é€’å‚æ•°"></a> ä¼ é€’å‚æ•°</h3><p>å¯ä»¥ç»™ä¸€ä¸ªshellè„šæœ¬æˆ–<strong>å‡½æ•°</strong>ä¼ é€’å‚æ•°ï¼Œä¸è·å–å‚æ•°æœ‰å…³çš„ä¸€äº›å˜é‡å¤§è‡´å¦‚ä¸‹</p><table><thead><tr><th>å˜é‡</th><th></th><th>å˜é‡</th><th></th></tr></thead><tbody><tr><td>$#</td><td>å‚æ•°ä¸ªæ•°</td><td>${1}~${n}</td><td>å‚æ•°1~n</td></tr><tr><td>$*</td><td>æ‰€æœ‰åŸå§‹å‚æ•°</td><td>$@</td><td>æ‰€æœ‰å‚æ•°ä¸”æ¯ä¸ªå‚æ•°ç”¨<code>&quot;&quot;</code>åŒ…å›´,å¦‚æœ<code>&quot;$1&quot;</code></td></tr></tbody></table><p>å½“ç„¶è¿˜æœ‰å…¶ä»–çš„å˜é‡æ²¡æœ‰åˆ—å‡ºã€‚</p><h4 id="shift"><a class="markdownIt-Anchor" href="#shift"></a> shift</h4><p>shiftå‘½ä»¤å¯ä»¥å·¦ç§»ä½ç½®å‚æ•°ï¼Œå³è§£å¼€å‚æ•°åŒ…ï¼Œæ¯æ¬¡æ‰§è¡Œ<code>shift</code> <code>$#</code>è‡ªåŠ¨å‡1,<code>$2</code>èµ‹äºˆç»™<code>$1</code>ï¼Œ<code>$3</code>èµ‹äºˆç»™<code>$2</code>â€¦ å½“<code>$#=0</code>ï¼Œæ²¡æœ‰å‚æ•°å¯è§£æ—¶æŠ¥é”™ï¼Œå…·ä½“æƒ…å†µæ ¹æ®shellçš„ä¸åŒè€Œä¸åŒã€‚æ¯”å¦‚æˆ‘è¿™é‡Œbashæ²¡æœ‰æ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯ï¼Œä½†<code>$?</code>ä¸º1ï¼Œè€Œzshæ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯ä¸”<code>$?</code>ä¸º1ã€‚è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨shiftä¸€æ¬¡è§£å¼€å‚æ•°åŒ…ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨<code>$&#123;1&#125;ï½$&#123;n&#125;</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">$@</span>;<span class="hljs-keyword">do</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;=&gt; &#123;<span class="hljs-variable">$1</span>&#125;&quot;</span><br>        <span class="hljs-built_in">shift</span><br><span class="hljs-keyword">done</span> <br><span class="hljs-built_in">shift</span>                   <span class="hljs-comment"># error</span><br><span class="hljs-built_in">echo</span> $?<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;quit&quot;</span><br><br>$ test.sh this is a <span class="hljs-built_in">test</span> <br>Output<br>=&gt; &#123;this&#125;<br>=&gt; &#123;is&#125;<br>=&gt; &#123;a&#125;<br>=&gt; &#123;<span class="hljs-built_in">test</span>&#125;<br>1<br>quit<br></code></pre></div></td></tr></table></figure><h3 id="æ¡ä»¶æµ‹è¯•test"><a class="markdownIt-Anchor" href="#æ¡ä»¶æµ‹è¯•test"></a> æ¡ä»¶æµ‹è¯•test</h3><p>testå‘½ä»¤å¯ä»¥ç”¨æ¥æµ‹è¯•ä¸¤ä¸ª<strong>å­—ç¬¦ä¸²</strong>æ˜¯å¦ç›¸ç­‰ï¼Œè€Œä¸”testä¼šæŠŠæµ‹è¯•å˜é‡å½“ä½œå­—ç¬¦ä¸²æ¥çœ‹å¾…ï¼Œä¹Ÿå°±æ˜¯è¯´ <code>test 100 = 100</code>å®é™…ä¸Šæ˜¯<code>test &quot;100&quot; = &quot;100&quot;</code>æˆ–è€… <code>test &quot;100&quot; = 100</code>ã€‚<br />ç”±äºæµ‹è¯•çš„ç»“æœæ˜¯ä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œçš„é€€å‡ºçŠ¶æ€ç ï¼Œå› æ­¤ç»“æœæ™®éæ˜¯0çœŸï¼Œé0å‡ã€‚</p><p>test å­—ç¬¦ä¸²çš„å…¶ä»–ä¸€äº›æ“ä½œç¬¦</p><table><thead><tr><th>æ“ä½œç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>str1 = str2</td><td>str1 ç­‰äº str2 ?</td></tr><tr><td>str1 != str2</td><td>str1 ä¸ç­‰äº str2 ?</td></tr><tr><td>str</td><td>str ä¸ä¸ºç©º?</td></tr><tr><td>-n str</td><td>strä¸ä¸ºç©º ?</td></tr><tr><td>-z str</td><td>strä¸ºç©º ?</td></tr></tbody></table><p>å…³äº<code>str</code>å’Œ<code>-n str</code>åŒºåˆ«ï¼Œä¸¾ä¸€ä¸ªä¾‹å­å°±çŸ¥é“äº†</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">str=<span class="hljs-string">&quot;    &quot;</span><br><span class="hljs-built_in">test</span> <span class="hljs-variable">$str</span><br><span class="hljs-built_in">echo</span> $?         <span class="hljs-comment"># 1</span><br><br><span class="hljs-built_in">test</span> -n <span class="hljs-variable">$str</span><br><span class="hljs-built_in">echo</span> $?         <span class="hljs-comment"># 0</span><br></code></pre></div></td></tr></table></figure><p>å³å¯ä»¥æŠŠ<code>-n str</code>çœ‹ä½œæ˜¯æµ‹è¯•å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦å¤§äº0ã€‚</p><h3 id="æ¡ä»¶æµ‹è¯•"><a class="markdownIt-Anchor" href="#æ¡ä»¶æµ‹è¯•"></a> æ¡ä»¶æµ‹è¯• []ã€[[]]ã€(())</h3><p>é™¤äº†åœ¨ifä¸­ç”¨teståˆ¤æ–­æ¡ä»¶ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç”¨<code>[ ]</code>å’Œ<code>[[ ]]</code>æµ‹è¯•æ¡ä»¶ã€‚<br />æ³¨æ„ï¼Œ<code>[</code>æ˜¯ä¸€ä¸ªå‘½ä»¤ä½äº <code>/usr/bin/[</code> ï¼Œè€Œ<code>[[ ]]</code> æ˜¯bashçš„ä¸€ä¸ªå…³é”®å­—ã€‚æ³¨æ„<code>[</code>å’Œ<code>]</code>å†…é¦–å°¾ç©ºæ ¼ã€‚<br />å¸¸è§„å†™æ³•</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">var=<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">test</span> <span class="hljs-string">&quot;linux&quot;</span> = <span class="hljs-string">&quot;linux&quot;</span> &amp;&amp; <span class="hljs-built_in">test</span> -z <span class="hljs-variable">$var</span> ;<span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;yes&quot;</span><br><span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;no&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></div></td></tr></table></figure><p>ä½¿ç”¨<code>[ ]</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">var=<br>n=100<br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;linux&quot;</span> = <span class="hljs-string">&quot;linux&quot;</span> ] &amp;&amp; [ -z <span class="hljs-variable">$var</span> ] || [ <span class="hljs-variable">$n</span> -ge 50 ];<span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;yes&quot;</span><br><span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;no&quot;</span><br><span class="hljs-keyword">fi</span><br><br><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;linux&quot;</span> = <span class="hljs-string">&quot;linux&quot;</span> -a -z <span class="hljs-variable">$var</span> -o <span class="hljs-variable">$n</span> -ge 50 ];<span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;yes&quot;</span><br><span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;no&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></div></td></tr></table></figure><p>ä¸Šé¢ä¸¤ç§å†™æ³•ä¸å¤Ÿç®€æ´ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨<code>[[ ]]</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">var=<br>n=100<br><span class="hljs-keyword">if</span> [[ <span class="hljs-string">&quot;linux&quot;</span> = <span class="hljs-string">&quot;linux&quot;</span> &amp;&amp; -z <span class="hljs-variable">$var</span> || <span class="hljs-variable">$n</span>&gt;=50 ]];<span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;yes&quot;</span><br><span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;no&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></div></td></tr></table></figure><p>ç”šè‡³è¿˜å¯ä»¥ä½¿ç”¨Cé£æ ¼çš„æ¡ä»¶åˆ¤æ–­</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sum=<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;1..100&#125;;<span class="hljs-keyword">do</span><br>        <span class="hljs-keyword">if</span> ((i%2==0));<span class="hljs-keyword">then</span><br>                : $((sum+=i))<br>        <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br></code></pre></div></td></tr></table></figure><h3 id="æ•´æ•°æ¯”è¾ƒ"><a class="markdownIt-Anchor" href="#æ•´æ•°æ¯”è¾ƒ"></a> æ•´æ•°æ¯”è¾ƒ</h3><table><thead><tr><th>æ“ä½œç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>n1 -eq n2</td><td>n1 ç­‰äº n2 ?</td></tr><tr><td>n1 -ne n2</td><td>n1 ä¸ç­‰äº n2 ?</td></tr><tr><td>n1 -ge n2</td><td>n1 å¤§äºç­‰äº n2 ?</td></tr><tr><td>n1 -gt n2</td><td>n1 å¤§äº n2 ?</td></tr><tr><td>n1 -le n2</td><td>n1 å°äºç­‰äº n2 ?</td></tr><tr><td>n1 -lt n2</td><td>n1 å°äº n2 ?</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">x1=<span class="hljs-string">&quot;005&quot;</span><br>x2=<span class="hljs-string">&quot;  10&quot;</span><br>[ <span class="hljs-string">&quot;<span class="hljs-variable">$x1</span>&quot;</span> = 5 ]<br><span class="hljs-built_in">echo</span> $?                <span class="hljs-comment"># 1</span><br><br>[ <span class="hljs-string">&quot;<span class="hljs-variable">$x1</span>&quot;</span> -eq 5]<br><span class="hljs-built_in">echo</span> $?                <span class="hljs-comment"># 0</span><br><br>[ <span class="hljs-string">&quot;<span class="hljs-variable">$x2</span>&quot;</span> = 10 ]<br><span class="hljs-built_in">echo</span> $?                <span class="hljs-comment"># 1</span><br><br>[ <span class="hljs-string">&quot;<span class="hljs-variable">$x2</span>&quot;</span> -eq 10]<br><span class="hljs-built_in">echo</span> $?                <span class="hljs-comment"># 0</span><br></code></pre></div></td></tr></table></figure><p>æ€»ä¹‹ï¼Œåœ¨æ¯”è¾ƒå­—ç¬¦ä¸²å’Œæ•´æ•°æ—¶è¦æ³¨æ„æ“ä½œç¬¦</p><h3 id="æ–‡ä»¶æ“ä½œç¬¦"><a class="markdownIt-Anchor" href="#æ–‡ä»¶æ“ä½œç¬¦"></a> æ–‡ä»¶æ“ä½œç¬¦</h3><table><thead><tr><th>æ“ä½œç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>-d file</td><td>fileæ˜¯ä¸€ä¸ªç›®å½•</td></tr><tr><td>-e file</td><td>fileå­˜åœ¨</td></tr><tr><td>-f file</td><td>fileæ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶</td></tr><tr><td>-s file</td><td>fileä¸æ˜¯ç©ºæ–‡ä»¶</td></tr><tr><td>-r file</td><td>fileå¯è¯»</td></tr><tr><td>-w file</td><td>fileå¯å†™</td></tr><tr><td>-x file</td><td>fileå¯æ‰§è¡Œ</td></tr><tr><td>-L file</td><td>fileæ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥</td></tr><tr><td>-g file</td><td>fileè®¾ç½®äº†SGIDä½</td></tr><tr><td>-u file</td><td>fileè®¾ç½®äº†SUIDä½</td></tr><tr><td>-p file</td><td>fileæ˜¯ä¸€ä¸ªå‘½åç®¡é“</td></tr><tr><td>-S file</td><td>fileæ˜¯ä¸€ä¸ªå¥—æ¥å­—</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">[ ! -w /usr/bin/[ ]<br><span class="hljs-built_in">echo</span> $?                 <span class="hljs-comment"># 0</span><br><br><span class="hljs-keyword">if</span> [ -d . -a -x test.sh -o -w test.sh ] ; <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> ok ;<span class="hljs-keyword">fi</span><br><span class="hljs-comment"># ç”¨æ‹¬å·æ”¹å˜æ±‚å€¼é¡ºåº</span><br><span class="hljs-keyword">if</span> [ -d . -a \( -x test.sh -o -w test.sh \) ] ; <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> ok ;<span class="hljs-keyword">fi</span><br></code></pre></div></td></tr></table></figure><h3 id="è°ƒè¯•é€‰é¡¹-x"><a class="markdownIt-Anchor" href="#è°ƒè¯•é€‰é¡¹-x"></a> è°ƒè¯•é€‰é¡¹ -x</h3><p>bashå¯ä»¥åˆ¶å®š-xé€‰é¡¹æ¥è·Ÿè¸ªæ‰§è¡Œè¿‡ç¨‹ï¼Œæ¯”å¦‚æœ‰ä¸‹é¢è¿™ä¸ªshellè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br>sum=<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;1..5&#125;;<span class="hljs-keyword">do</span><br>        <span class="hljs-keyword">if</span> ((i%2==0));<span class="hljs-keyword">then</span><br>                : $((sum+=i))<br>        <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$sum</span><br></code></pre></div></td></tr></table></figure><p>é€šè¿‡ bash -x <a href="http://test.sh">test.sh</a> è·Ÿè¸ªæ‰§è¡Œè¿‡ç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ bash -x test.sh <br>+ sum=<br>+ <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;1..5&#125;<br>+ (( i%2==0 ))<br>+ <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;1..5&#125;<br>+ (( i%2==0 ))<br>+ : 2<br>+ <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;1..5&#125;<br>+ (( i%2==0 ))<br>+ <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;1..5&#125;<br>+ (( i%2==0 ))<br>+ : 6<br>+ <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;1..5&#125;<br>+ (( i%2==0 ))<br>+ <span class="hljs-built_in">echo</span> 6<br>6<br></code></pre></div></td></tr></table></figure><p>æˆ–è€…<code>set -x</code>æ‰“å¼€è·Ÿè¸ªæ¨¡å¼ã€<code>set +x</code>å…³é—­è·Ÿè¸ªæ¨¡å¼</p><h3 id="ç©ºå‘½ä»¤"><a class="markdownIt-Anchor" href="#ç©ºå‘½ä»¤"></a> ç©ºå‘½ä»¤ :</h3><p>å‰é¢æœ‰è°ˆåˆ°è¿‡<code>:</code>è¿™ä¸ªå‘½ä»¤ï¼Œå®ƒå°±åƒPythonçš„<code>pass</code>ï¼Œç±»ä¼¼å ä½ç¬¦ï¼Œä»€ä¹ˆéƒ½ä¸åšã€‚æœ‰æ—¶å¯ä»¥ç”¨<code>:</code>åœ¨if/for/while/until/caseå†…æ‰§è¡Œä¸€äº›èµ‹å€¼æ“ä½œ</p><h3 id="å‘½ä»¤"><a class="markdownIt-Anchor" href="#å‘½ä»¤"></a> .å‘½ä»¤</h3><p><code>. file</code>ä¼šä½¿Shell<strong>è¯»å–å¹¶æ‰§è¡Œ</strong>æŒ‡å®šçš„æ–‡ä»¶ï¼Œfileä¸ä¸€å®šæ˜¯å¯æ‰§è¡Œçš„ï¼Œåªæœ‰å¯è¯»å°±è¡Œã€‚</p><h4 id="å‚æ•°æ‰©å±•"><a class="markdownIt-Anchor" href="#å‚æ•°æ‰©å±•"></a> å‚æ•°æ‰©å±•</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">var=100<br>var=$((var*<span class="hljs-number">100</span>))        <span class="hljs-comment"># 10000</span><br>: $((var*=<span class="hljs-number">100</span>))         <span class="hljs-comment"># 1000000</span><br></code></pre></div></td></tr></table></figure><h4 id="å ä½ç¬¦-æ³¨é‡Š"><a class="markdownIt-Anchor" href="#å ä½ç¬¦-æ³¨é‡Š"></a> å ä½ç¬¦ã€æ³¨é‡Š</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">: hello linux<br><span class="hljs-keyword">if</span> [ 10 -ge 5 ];<span class="hljs-keyword">then</span> : ;<span class="hljs-keyword">else</span> :; <span class="hljs-keyword">fi</span><br></code></pre></div></td></tr></table></figure><h4 id="å‡½æ•°å"><a class="markdownIt-Anchor" href="#å‡½æ•°å"></a> å‡½æ•°å</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">:() <br>&#123; <br>        <span class="hljs-built_in">echo</span> xx; <br>&#125;<br>:<br></code></pre></div></td></tr></table></figure><p>æ¯”å¦‚ä¼—æ‰€å‘¨çŸ¥çš„fork bomb <code>:()&#123; :|:&amp; &#125;;:</code> å°±æ˜¯å¦‚æ­¤ç®€å•ç²—æš´</p><h3 id="å¾ªç¯"><a class="markdownIt-Anchor" href="#å¾ªç¯"></a> å¾ªç¯</h3><h4 id="è·³è¿‡è·³å‡ºå¾ªç¯"><a class="markdownIt-Anchor" href="#è·³è¿‡è·³å‡ºå¾ªç¯"></a> è·³è¿‡/è·³å‡ºå¾ªç¯</h4><p><code>continue n</code>æˆ–<code>break n</code>æ¥è·³è¿‡æˆ–è·³å‡ºç¬¬nå±‚å¾ªç¯</p><h4 id="åå°æ‰§è¡Œå¾ªç¯"><a class="markdownIt-Anchor" href="#åå°æ‰§è¡Œå¾ªç¯"></a> åå°æ‰§è¡Œå¾ªç¯</h4><p>åœ¨å¾ªç¯å…³é—­è¯­å¥doneåé¢åŠ ä¸Š<code>&amp;</code>èƒ½å¤Ÿä½¿å¾ªç¯for/whileåå°æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> 1 2 3;<span class="hljs-keyword">do</span><br>        sleep 2<br><span class="hljs-keyword">done</span> &amp;<br></code></pre></div></td></tr></table></figure><h4 id="å¾ªç¯ä¸Šçš„ioé‡å®šå‘"><a class="markdownIt-Anchor" href="#å¾ªç¯ä¸Šçš„ioé‡å®šå‘"></a> å¾ªç¯ä¸Šçš„IOé‡å®šå‘</h4><p>è¾“å‡ºé‡å®šå‘</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(ls <span class="hljs-variable">$HOME</span>);<span class="hljs-keyword">do</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;=&gt; _<span class="hljs-variable">$&#123;i&#125;</span>_&quot;</span><br><span class="hljs-keyword">done</span> &gt; output 2&gt;&amp;1<br></code></pre></div></td></tr></table></figure><p>è¾“å…¥é‡å®šå‘</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> line;<span class="hljs-keyword">do</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;=&gt; <span class="hljs-variable">$line</span>&quot;</span><br><span class="hljs-keyword">done</span> &lt; file.txt<br></code></pre></div></td></tr></table></figure><h3 id="printf"><a class="markdownIt-Anchor" href="#printf"></a> printf</h3><p>å¯¹äºç®€å•çš„ä¿¡æ¯echoè¶³çŸ£ï¼Œä½†æ˜¯æœ‰æ—¶å€™éœ€è¦æ ¼å¼åŒ–è¾“å‡ºä¿¡æ¯ï¼Œé‚£ä¹ˆlinuxæä¾›äº†ä¸€ä¸ªç±»ä¼¼Cçš„printfå‘½ä»¤æ¥å¸®åŠ©å®Œæˆæ ¼å¼åŒ–ï¼Œæ›´å¤šå†…å®¹å¯ä»¥å»æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ğŸ˜¹</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">printf</span> <span class="hljs-string">&quot;%.4f %s %d\n&quot;</span> 10.22 $(uname -r) 100     <span class="hljs-comment"># 10.2200 5.4.34-1-MANJARO 100</span><br></code></pre></div></td></tr></table></figure><h3 id="exec"><a class="markdownIt-Anchor" href="#exec"></a> exec</h3><p>execé™¤äº†ä¼šç”¨æ–°ç¨‹åº<strong>æ›¿æ¢</strong>ç°æœ‰çš„ç¨‹åºï¼Œè¿˜æœ‰ä¸€ä¸‹åŠŸèƒ½</p><h4 id="é‡å®šå‘æ ‡å‡†è¾“å…¥"><a class="markdownIt-Anchor" href="#é‡å®šå‘æ ‡å‡†è¾“å…¥"></a> é‡å®šå‘æ ‡å‡†è¾“å…¥</h4><p><code>exec &lt; infile</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-built_in">exec</span> &lt; infile<br><span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> l;<span class="hljs-keyword">do</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;=&gt; <span class="hljs-variable">$l</span>&quot;</span><br><span class="hljs-keyword">done</span><br></code></pre></div></td></tr></table></figure><h4 id="é‡å®šå‘æ ‡å‡†è¾“å‡º"><a class="markdownIt-Anchor" href="#é‡å®šå‘æ ‡å‡†è¾“å‡º"></a> é‡å®šå‘æ ‡å‡†è¾“å‡º</h4><p><code>exec &gt; outfile</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><span class="hljs-built_in">exec</span> &gt; outfile<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(ls);<span class="hljs-keyword">do</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;=&gt; <span class="hljs-variable">$i</span>&quot;</span><br><span class="hljs-keyword">done</span><br></code></pre></div></td></tr></table></figure><h4 id="é‡ç½®æ ‡å‡†è¾“å…¥è¾“å‡º"><a class="markdownIt-Anchor" href="#é‡ç½®æ ‡å‡†è¾“å…¥è¾“å‡º"></a> é‡ç½®æ ‡å‡†è¾“å…¥/è¾“å‡º</h4><ul><li><code>exec &gt; /dev/tty</code></li><li><code>exec &lt; /dev/tty</code></li></ul><h3 id="å‘½ä»¤ç»„"><a class="markdownIt-Anchor" href="#å‘½ä»¤ç»„"></a> å‘½ä»¤ç»„( â€¦ )ã€{ â€¦; }</h3><p><code>( ... )</code>å†…çš„å‘½ä»¤ä¼šåœ¨<strong>å­shell</strong>æ‰§è¡Œï¼Œè€Œ<code>&#123; ...; &#125;</code>å†…çš„å‘½ä»¤åˆ™æ˜¯åœ¨<strong>å½“å‰shell</strong>æ‰§è¡Œã€‚<br />è¦æ³¨æ„ï¼Œ<code>&#123; ...; &#125;</code>çš„å·¦<code>&#123;</code>åéœ€è¦ç©ºæ ¼ï¼</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">var=100<br>(var=200)<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$var</span>       <span class="hljs-comment"># 100</span><br><br>var=100<br>&#123; var=200;&#125;<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$var</span>       <span class="hljs-comment"># 200</span><br>&#123; var+=300;&#125;<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$var</span>       <span class="hljs-comment"># 200300</span><br></code></pre></div></td></tr></table></figure><p>å…¶å®<code>&#123; ...;&#125;</code>å°±åƒä¸€ä¸ªæ— åå‡½æ•°çš„è°ƒç”¨â€¦</p><h3 id="åªè¯»å˜é‡"><a class="markdownIt-Anchor" href="#åªè¯»å˜é‡"></a> åªè¯»å˜é‡</h3><p>readonlyå’Œ<code>declare</code>å‘½ä»¤å¯ä»¥æŒ‡å®šæŸä¸ªå˜é‡åªè¯»ã€‚<br /><code>readonly var</code>æˆ–<code>declare -r var</code></p><h3 id="eval"><a class="markdownIt-Anchor" href="#eval"></a> eval</h3><p>æŠŠevalæ”¾åœ¨å‘½ä»¤è¡Œä¹‹å‰ï¼ŒShellä¼šå¯¹è¯¥å‘½ä»¤è¡Œè¿›è¡ŒäºŒæ¬¡æ‰«æï¼Œç„¶åæ‰§è¡Œã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">pipe=<span class="hljs-string">&quot;|&quot;</span><br><span class="hljs-built_in">eval</span> <span class="hljs-variable">$pipe</span> wc -l        <br></code></pre></div></td></tr></table></figure><p>Shellç¬¬ä¸€æ¬¡æ‰«ææ—¶æŠŠ<code>pipe</code>å˜é‡æ›¿æ¢ä¸º<code>|</code>ï¼Œç„¶åevalä½¿å¾—Shellé‡æ–°æ‰«æå‘½ä»¤è¡Œï¼Œæ­¤æ—¶Shellèƒ½å¤Ÿè¯†åˆ«å‡º<code>|</code>æ˜¯ä¸€ä¸ªç®¡é“ç¬¦å·ï¼Œå› æ­¤ä¾¿èƒ½æˆåŠŸæ‰§è¡Œè¯¥å‘½ä»¤è¡Œ<br />ä¸evalæ­é…çš„å­—ç¬¦æœ‰<code>;</code>ã€<code>|</code>ã€<code>&amp;</code>ã€<code>&lt;</code>ã€<code>&gt;</code>ã€<code>å¼•å·' &quot;</code></p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¾‹å­ï¼Œå±•ç¤ºäº†shellä¸­æ‰€è°“çš„â€œæŒ‡é’ˆâ€</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">x=100<br>ptrx=x<br><span class="hljs-built_in">eval</span> <span class="hljs-built_in">echo</span> \$<span class="hljs-variable">$ptrx</span>       <span class="hljs-comment"># 100</span><br><span class="hljs-built_in">eval</span> <span class="hljs-variable">$ptrx</span>=50<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$x</span>                 <span class="hljs-comment"># 50</span><br></code></pre></div></td></tr></table></figure><h3 id="trap"><a class="markdownIt-Anchor" href="#trap"></a> trap</h3><p>trapç”¨äºä¿¡å·å¤„ç†ï¼Œä¸€èˆ¬æ ¼å¼ <code>trap commands signals</code><br />ä¸€äº›ä¿¡å·åˆ—è¡¨å¦‚ä¸‹</p><table><thead><tr><th>ä¿¡å·</th><th>ä¿¡å·åç§°</th><th>äº§ç”ŸåŸå› </th></tr></thead><tbody><tr><td>0</td><td>EXIT</td><td>é€€å‡ºSHELL</td></tr><tr><td>1</td><td>HUP</td><td>æŒ‚èµ·</td></tr><tr><td>2</td><td>INT</td><td>ä¸­æ–­</td></tr><tr><td>3</td><td>QUIT</td><td>é€€å‡º</td></tr><tr><td>6</td><td>ABRT</td><td>ä¸­æ­¢</td></tr><tr><td>9</td><td>KILL</td><td>&quot;é”€æ¯&quot;è¿›ç¨‹</td></tr><tr><td>14</td><td>ALAM</td><td>è¶…æ—¶</td></tr><tr><td>15</td><td>TERM</td><td>è½¯ä»¶ç»ˆæ­¢ä¿¡å·</td></tr></tbody></table><p>æ²¡æœ‰å‚æ•°çš„<code>trap</code>ä¼šæ˜¾ç¤ºå®šä¹‰è¿‡æˆ–ä¿®æ”¹è¿‡çš„æ‰€æœ‰trapå¤„ç†ç¨‹åº</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">trap</span> <span class="hljs-string">&quot;echo bye&quot;</span> INT<br><span class="hljs-built_in">trap</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> 1 2 3  ;<span class="hljs-keyword">do</span><br>        sleep 1<br>        <span class="hljs-built_in">echo</span> ...<br><span class="hljs-keyword">done</span><br></code></pre></div></td></tr></table></figure><p><code>trap &quot;&quot; SIGINT</code> å¿½ç•¥SIGINTä¿¡å·ï¼Œè¿™ä¹Ÿä¼šå¯¼è‡´æ‰€æœ‰çš„å­shellä¹Ÿå¿½ç•¥è¿™ä¸ªä¿¡å·(æ— è®ºå­shellæ˜¯å¦æœ‰è‡ªå·±çš„trapä¿¡å·å¤„ç†ç¨‹åº)<br /><code>trap : SIGINT</code> å½“å‰shellä»€ä¹ˆä¹Ÿä¸åšï¼Œå­shellæ‰§è¡Œé»˜è®¤çš„ä¿¡å·å¤„ç†ç¨‹åº(å¦‚æœæœ‰çš„è¯)<br /><code>trap SIGINT</code> é‡ç½®ä¸­æ–­ä¿¡å·å¤„ç†<br />ä¸€ã€</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ <span class="hljs-built_in">trap</span> <span class="hljs-string">&quot;&quot;</span> SIGINT<br>$ bash test.sh <br><span class="hljs-built_in">trap</span> -- <span class="hljs-string">&#x27;&#x27;</span> SIGINT<br>...<br>^C...<br>...<br></code></pre></div></td></tr></table></figure><p>äºŒã€</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ <span class="hljs-built_in">trap</span> : SIGINT<br>$ bash test.sh <br><span class="hljs-built_in">trap</span> -- <span class="hljs-string">&#x27;echo bye&#x27;</span> SIGINT<br>...<br>^Cbye<br>...<br></code></pre></div></td></tr></table></figure><h3 id="ioé‡å®šå‘"><a class="markdownIt-Anchor" href="#ioé‡å®šå‘"></a> IOé‡å®šå‘</h3><p>ä¸‹è¡¨å±•ç¤ºäº†é‡å®šå‘çš„ä¸€äº›æ“ä½œ(ä»å·¦åˆ°å³å¤„ç†é‡å®šå‘)</p><table><thead><tr><th>ç¬¦å·</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>&lt;</td><td>stdiné‡å®šå‘</td></tr><tr><td>&gt;</td><td>stdouté‡å®šå‘</td></tr><tr><td>2&gt;</td><td>stderré‡å®šå‘</td></tr><tr><td>&gt;&amp;2</td><td>stdouté‡å®šå‘åˆ°stderr</td></tr><tr><td>&gt; file 2&gt;&amp;1</td><td>stdoutå’Œstderré‡å®šå‘åˆ°fileï¼Œç­‰ä»·äº &gt;file 2&gt;&gt;file</td></tr><tr><td>&gt;&amp;-</td><td>å…³é—­stdout,stderrï¼Œå¦‚ exec 1&gt;&amp;-ã€exec 2&gt;&amp;-</td></tr><tr><td>&lt;&amp;-</td><td>å…³é—­stdinï¼Œå¦‚ exec 0&lt;&amp;-</td></tr></tbody></table><p>æ¯”å¦‚å¸¸è§çš„ <code>commands &gt;/dev/null 2&gt;&amp;1</code></p><h3 id="è¡Œå†…è¾“å…¥é‡å®šå‘-here-documents"><a class="markdownIt-Anchor" href="#è¡Œå†…è¾“å…¥é‡å®šå‘-here-documents"></a> è¡Œå†…è¾“å…¥é‡å®šå‘ here documents</h3><p>ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§å½¢å¼</p><ul><li><code>&lt;&lt;EOF</code>  å¿½ç•¥ç‰¹æ®Šå­—ç¬¦</li><li><code>&lt;&lt;\EOF</code> ä¸å¿½ç•¥ç‰¹æ®Šå­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯åŸå°ä¸åŠ¨çš„è¾“å‡ºè¾“å…¥çš„å†…å®¹</li><li><code>&lt;&lt;-EOF</code> åˆ é™¤è¾“å…¥å†…å®¹ä¸­çš„å‰å¯¼åˆ¶è¡¨ç¬¦</li><li><code>&lt;&lt;EOF&gt;&gt;</code> å¦‚ <code>cat &lt;&lt;EOF&gt;&gt;outfile</code></li><li><code>&lt;&lt;EOF|tee</code> å¦‚ <code>cat &lt;&lt;EOF|tee outfile</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ cat &lt;&lt;<span class="hljs-string">EOF</span><br><span class="hljs-string">&gt; Hello</span><br><span class="hljs-string">&gt; $SHELL</span><br><span class="hljs-string">&gt; `uname -r`</span><br><span class="hljs-string">&gt; EOF</span><br>Hello<br>/usr/bin/zsh<br>5.4.34-1-MANJARO<br></code></pre></div></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ cat &lt;&lt;\EOF<br>&gt; Hello<br>&gt; <span class="hljs-variable">$SHELL</span><br>&gt; `uname -r`<br>&gt; EOF<br>Hello<br><span class="hljs-variable">$SHELL</span><br>`uname -r`<br></code></pre></div></td></tr></table></figure><h3 id="åˆ é™¤å˜é‡å’Œå‡½æ•°"><a class="markdownIt-Anchor" href="#åˆ é™¤å˜é‡å’Œå‡½æ•°"></a> åˆ é™¤å˜é‡å’Œå‡½æ•°</h3><p><code>unset var</code><br /><code>unset -f func</code></p><h3 id="é€€å‡ºå‡½æ•°"><a class="markdownIt-Anchor" href="#é€€å‡ºå‡½æ•°"></a> é€€å‡ºå‡½æ•°</h3><p><code>return n</code> nä¸ºå‡½æ•°è¿”å›çŠ¶æ€ï¼Œå¯ä»¥ç”¨<code>$?</code>æ•è·</p><h3 id="å±€éƒ¨å˜é‡"><a class="markdownIt-Anchor" href="#å±€éƒ¨å˜é‡"></a> å±€éƒ¨å˜é‡</h3><p>ä½¿ç”¨<code>typeset</code>æˆ–<code>local</code>å®šä¹‰å±€éƒ¨å˜é‡ï¼Œå…¶ä¸­<code>local</code>åªèƒ½ç”¨åœ¨<strong>å‡½æ•°</strong>ä¸­ã€‚<br />åŒæ—¶<code>typeset</code>è¿˜å¯ä»¥å®šä¹‰æ•´æ•°ç±»å‹çš„å˜é‡<code>-i</code>ï¼Œè‹¥èµ‹å€¼çš„ä¸æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šæç¤ºé”™è¯¯</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">typeset</span> -i i=100 j=200<br><span class="hljs-function"><span class="hljs-title">func</span></span>()&#123;<br>        <span class="hljs-built_in">local</span> k=300<br>        <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span> <span class="hljs-variable">$j</span> <span class="hljs-variable">$k</span>   <span class="hljs-comment"># 100 200 300</span><br>&#125;<br>func<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span> <span class="hljs-variable">$j</span> <span class="hljs-variable">$k</span>           <span class="hljs-comment"># 100 200</span><br><br><span class="hljs-built_in">typeset</span> -i n=100<br>n=100*200<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$n</span>                 <span class="hljs-comment"># 20000</span><br><span class="hljs-built_in">typeset</span> var=100<br>var=100*200<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$var</span>               <span class="hljs-comment"># 100*200</span><br></code></pre></div></td></tr></table></figure><h3 id="æ•°ç»„"><a class="markdownIt-Anchor" href="#æ•°ç»„"></a> æ•°ç»„</h3><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">arr[0]=<span class="hljs-string">&quot;wtf&quot;</span><br>arr[1]=100<br><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$arr</span>[1]            <span class="hljs-comment"># wtf[1]  </span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;arr[1]&#125;</span>          <span class="hljs-comment"># 100  </span><br><span class="hljs-comment"># æ•°ç»„æ‰€æœ‰å…ƒç´ </span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;arr[*]&#125;</span>          <span class="hljs-comment"># wtf 100</span><br><span class="hljs-comment"># æ•°ç»„å…ƒç´ æ•°é‡</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;#arr[*]&#125;</span>         <span class="hljs-comment"># 2</span><br><br><span class="hljs-comment"># æ•´æ•°æ•°ç»„</span><br><span class="hljs-built_in">typeset</span> -i array<br>array[0]=100<br>array[1]=200<br>((array[2]=array[0]+array[1]))<br>array[3]=array[0]+array[1] <span class="hljs-comment"># åªæœ‰æ•´æ•°æ•°ç»„æ‰è¡Œ</span><br>: $((array[<span class="hljs-number">4</span>]=array[<span class="hljs-number">0</span>]+array[<span class="hljs-number">1</span>]))<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;array[*]&#125;</span>        <span class="hljs-comment"># 100 200 300 300 300</span><br></code></pre></div></td></tr></table></figure><h3 id="ç”Ÿæˆä¼ªéšæœºæ•°"><a class="markdownIt-Anchor" href="#ç”Ÿæˆä¼ªéšæœºæ•°"></a> ç”Ÿæˆä¼ªéšæœºæ•°</h3><blockquote><p>/dev/randomåœ¨ç±»UNIXç³»ç»Ÿä¸­æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è®¾å¤‡æ–‡ä»¶ï¼Œå¯ä»¥ç”¨ä½œéšæœºæ•°å‘ç”Ÿå™¨æˆ–ä¼ªéšæœºæ•°å‘ç”Ÿå™¨ã€‚</p><p>/dev/randomçš„ä¸€ä¸ªå‰¯æœ¬æ˜¯ /dev/urandomï¼ˆâ€œunblockedâ€ï¼Œéé˜»å¡çš„éšæœºæ•°å‘ç”Ÿå™¨ï¼‰ï¼Œå®ƒä¼šé‡å¤ä½¿ç”¨ç†µæ± ä¸­çš„æ•°æ®ä»¥äº§ç”Ÿä¼ªéšæœºæ•°æ®ã€‚è¿™è¡¨ç¤ºå¯¹/dev/urandomçš„è¯»å–æ“ä½œä¸ä¼šäº§ç”Ÿé˜»å¡ï¼Œä½†å…¶è¾“å‡ºçš„ç†µå¯èƒ½å°äº/dev/randomçš„ã€‚å®ƒå¯ä»¥ä½œä¸ºç”Ÿæˆè¾ƒä½å¼ºåº¦å¯†ç çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œä¸å»ºè®®ç”¨äºç”Ÿæˆé«˜å¼ºåº¦é•¿æœŸå¯†ç ã€‚</p></blockquote><p>è¯¦ç»†ä¿¡æ¯ç»´åŸºç™¾ç§‘<a href="https://zh.wikipedia.org/wiki//dev/random">/dev/random</a></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># ç”Ÿæˆ16ä½åŒ…å«A-Zã€a-zçš„éšæœºæ•°</span><br>head /dev/urandom |tr -dc <span class="hljs-string">&#x27;A-Za-z&#x27;</span>|head -c 16<br><span class="hljs-comment"># ç”Ÿæˆ32ä½åŒ…å«a-zã€0-9çš„éšæœºæ•°</span><br>head /dev/urandom |tr -dc <span class="hljs-string">&#x27;0-9a-z&#x27;</span>|head -c 32<br></code></pre></div></td></tr></table></figure><h3 id="é™åˆ¶æ–‡ä»¶åˆ—å®½-fold"><a class="markdownIt-Anchor" href="#é™åˆ¶æ–‡ä»¶åˆ—å®½-fold"></a> é™åˆ¶æ–‡ä»¶åˆ—å®½ fold</h3><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># æ¯è¡Œ20åˆ— </span><br>fold -w 20 test.file<br></code></pre></div></td></tr></table></figure><h3 id="åˆ¤æ–­å‘½ä»¤æ˜¯å¦å­˜åœ¨"><a class="markdownIt-Anchor" href="#åˆ¤æ–­å‘½ä»¤æ˜¯å¦å­˜åœ¨"></a> åˆ¤æ–­å‘½ä»¤æ˜¯å¦å­˜åœ¨</h3><p>å¯ä»¥ç”¨äºåˆ¤æ–­linuxå‘½ä»¤æ˜¯å¦å­˜åœ¨çš„æ–¹æ³•å¾ˆå¤šï¼Œæ¯”å¦‚ whichã€typeã€hashã€command</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">command</span> -V ps &gt; /dev/null 2&gt;&amp;1<br><span class="hljs-keyword">if</span> [ $? -eq 0 ];<span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> OK;<span class="hljs-keyword">else</span> <span class="hljs-built_in">echo</span> NO;<span class="hljs-keyword">fi</span><br></code></pre></div></td></tr></table></figure><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>å¤§æ¦‚å°±è¿™æ ·å§â€¦ğŸ‘´ğŸ’”<br />ä»¥ååœ¨è¡¥å……è¡¥å……ğŸ‘</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>KDE Panelé€æ˜</title>
    <link href="/kde-panel-transparency/"/>
    <url>/kde-panel-transparency/</url>
    
    <content type="html"><![CDATA[<p>KDEçš„é¢æ¿é»˜è®¤æ˜¯ä¸é€æ˜çš„ï¼Œå¯ä»¥é€šè¿‡å…¶ä»–çš„ä¸»é¢˜è¾¾åˆ°åŠé€æ˜æ•ˆæœï¼Œç„¶è€Œè¿™æ ·è¿˜æ˜¯ä¸ç¾è§‚ï¼Œå› æ­¤â€¦</p><span id="more"></span><p>æœ¬æ–‡ä¸»è¦å‚è€ƒäº†Manjaroè®ºå› <a href="https://forum.manjaro.org/t/where-can-the-transparency-of-the-kde-panel-be-set/50219">Where can the transparency of the KDE Panel be set?</a></p><p>æœªä¿®æ”¹ï¼ŒçœŸâ€¦ä¸‘â€¦<br /><img src="/uploads/images/kde_panel/1.png" alt="" /></p><p>KDE Plasmaä¸»é¢˜ä¸€èˆ¬ä½äº <code>/usr/share/plasma/desktoptheme</code> å’Œ <code>$HOME/.local/share/plasma/desktoptheme</code>ã€‚</p><p>å‡å¦‚æˆ‘çš„ä¸»é¢˜æ˜¯<code>McMojave</code>ï¼Œé‚£ä¹ˆæˆ‘é€šè¿‡ <code>inkscape</code> ä¿®æ”¹svgçŸ¢é‡å›¾å½¢æ–‡ä»¶ <code>$HOME/.local/share/plasma/desktoptheme/McMojave/widgets/panel-background.svgz</code> å°±å¯ä»¥è¾¾åˆ°å…¨é€æ˜æ•ˆæœã€‚</p><p>åŸå›¾<br /><img src="/uploads/images/kde_panel/2.png" alt="" /><br />ä¿®æ”¹(åˆ é™¤)ä¹‹å<br /><img src="/uploads/images/kde_panel/3.png" alt="" /><br />æˆ–è€…<br /><img src="/uploads/images/kde_panel/4.png" alt="" /><br />åè€…ä¼šåˆ é™¤é¢æ¿è¾¹æ¡†é˜´å½±éƒ¨åˆ†ã€‚</p><p>æ•ˆæœ<br /><img src="/uploads/images/kde_panel/5.png" alt="" /><br /><img src="/uploads/images/kde_panel/6.png" alt="" /><br />æ¥ä¸€å¼ æ¡Œé¢å›¾ áƒš(â•¹â—¡â•¹áƒš)<br /><img src="/uploads/images/kde_panel/7.png" alt="" /></p><p>Bye~</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Manjaro</tag>
      
      <tag>KDE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxä¿®æ”¹ç³»ç»Ÿä»£ç†</title>
    <link href="/linux-system-proxy/"/>
    <url>/linux-system-proxy/</url>
    
    <content type="html"><![CDATA[<p>linuxç³»ç»Ÿä»£ç†å¯ä»¥é€šè¿‡shellä¿®æ”¹ï¼Œå…¶æ•ˆæœä½œç”¨äºå½“å‰shellæˆ–è€…æ‰€æœ‰shellï¼Œå¯¹äºåƒchrome,firefoxç­‰æ¡Œé¢æµè§ˆå™¨ï¼Œæ˜¯ä¸èƒ½ç›´æ¥èµ°ä»£ç†çš„ï¼Œé™¤éå®‰è£…ä¸€äº›proxyæ’ä»¶ã€‚ä¸è¿‡æœ‰æ—¶æˆ‘ä»¬æƒ³åœ¨è‡ªå·±å†™çš„ç¨‹åºå†…è®¾ç½®ç³»ç»Ÿä»£ç†ï¼Œé‚£ä¹ˆè¿™æ—¶ä»…ä¿®æ”¹shell(http_proxy)ä¹‹ç±»çš„æ˜¯æ¯«æ— ä½œç”¨çš„ï¼Œå¿…é¡»ä¾èµ–äºå½“å‰çš„æ¡Œé¢ç¯å¢ƒ(gnome,kde?)æä¾›çš„æ¥å£ï¼Œå°±åƒwindowsä¿®æ”¹æ³¨å†Œè¡¨æ¥ä¿®æ”¹ç³»ç»Ÿä»£ç†ã€‚</p><span id="more"></span><h3 id="å½“å‰shell"><a class="markdownIt-Anchor" href="#å½“å‰shell"></a> å½“å‰shell</h3><p>è¿™ç§æ–¹å¼ä»…ä»…å¯¹å½“å‰shellä»¥åŠäº§ç”Ÿçš„å­shellæœ‰ç”¨ï¼Œæ™®éçš„æ–¹æ³•æ˜¯exportå¯¼å‡º*_proxyå˜é‡ï¼š<br /><code>export http_proxy=http://USERNAME:PASSWORD@SERVER:PORT/</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> http_proxy=http://127.0.0.1:8888<br><span class="hljs-built_in">export</span> https_proxy=http://127.0.0.1:8888<br></code></pre></div></td></tr></table></figure><p>è‹¥å¸Œæœ›ä»…ä»…å¯¹å½“å‰shellå…¶ä½œç”¨ï¼Œé‚£ä¹ˆå¯ä»¥è¿™æ ·åšï¼š</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">http_proxy=http://127.0.0.1:8888 curl www.google.com --head<br></code></pre></div></td></tr></table></figure><p>ä¸è¿‡è¿™ç§é€šè¿‡ä¿®æ”¹http_proxyç­‰ç¯å¢ƒå˜é‡æ¥è®¾ç½®ä»£ç†çš„æ–¹æ³•ä¼¼ä¹ä¸æ”¯æŒsocksã€‚</p><h3 id="æ‰€æœ‰shell"><a class="markdownIt-Anchor" href="#æ‰€æœ‰shell"></a> æ‰€æœ‰shell</h3><p>è¿™ç§æƒ…å†µå¯ä»¥ä¿®æ”¹<code>/etc/profile</code>ã€<code>/etc/environment</code>ã€<code>$HOME/.bashrc</code>ã€<code>$HOME/.zshrc</code>é…ç½®æ–‡ä»¶ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œåªéœ€è¦ä¿®æ”¹<code>.bashrc</code>æˆ–<code>.zshrc</code>å°±å¯ä»¥ä½¿æ‰€æœ‰çš„shellèµ°ä»£ç†ï¼ˆé™¤éç‰¹æ®Šæƒ…å†µï¼‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># set</span><br><span class="hljs-built_in">export</span> &#123;http,https&#125;_proxy=<span class="hljs-string">&quot;http://127.0.0.1:8888&quot;</span><br><span class="hljs-comment"># unset</span><br><span class="hljs-built_in">unset</span> &#123;http,https&#125;_proxy<br><span class="hljs-comment"># test</span><br>curl -v checkip.dyndns.org<br>curl --head -v www.google.com<br></code></pre></div></td></tr></table></figure><p>è‹¥å¸Œæœ›ç«‹å³è§æ•ˆï¼Œåˆ™ <code>source $HOME/.zshrc</code> æˆ– <code>source $HOME/.bashrc</code>ã€‚</p><h3 id="gnome"><a class="markdownIt-Anchor" href="#gnome"></a> GNOME</h3><p>ä»¥ä¸Šæ–¹æ³•å¯¹äºå¤§éƒ¨åˆ†å‘½ä»¤ï¼ˆcurl,wget,gitç­‰ï¼‰æ¥è¯´åœ¨shellåŸºæœ¬ä¸Šå¯ä»¥èµ°ä»£ç†ã€‚ä¸è¿‡æˆ‘å¼€å¤´è¯´äº†ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨è‡ªå·±å†™çš„ç¨‹åºå†…è®¾ç½®ç³»ç»Ÿä»£ç†ï¼Œå°±åƒv2rayNGä¿®æ”¹Windowsæ³¨å†Œè¡¨ã€‚</p><p>è€Œä¸”è¿™æ ·åšçš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯æ”¯æŒsocksä»£ç†ã€‚</p><p>ç¡®å®šlinuxçš„æ¡Œé¢ç¯å¢ƒå¯ä»¥é€šè¿‡ <code>env |grep DESKTOP</code> æŸ¥çœ‹å…¨å±€ç¯å¢ƒå˜é‡ï¼Œæˆ–è€…ç›´æ¥ <code>echo $XDG_SESSION_DESKTOP</code>ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œçš„è™šæ‹Ÿæœºlinux gnome3è¾“å‡º<code>gnome-classic</code>ã€‚</p><p>gnomeé€šè¿‡<code>gsettings</code>æ¥ç®¡ç†GNOME3çš„é…ç½®ï¼Œè¿™æ ·å°±å¯ä»¥ä¿®æ”¹ç³»ç»Ÿä»£ç†ã€‚<br />ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è·å–å½“å‰gnomeçš„ç³»ç»Ÿä»£ç†ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">gsettings get org.gnome.system.proxy mode<br>gsettings get org.gnome.system.proxy.http host<br>gsettings get org.gnome.system.proxy.http port<br>gsettings get org.gnome.system.proxy.socks host<br>gsettings get org.gnome.system.proxy.socks port<br></code></pre></div></td></tr></table></figure><p><code>mode</code>æœ‰ä¸‰ç§æƒ…å†µï¼š</p><ul><li>none æ— ä»£ç†</li><li>manual æ‰‹åŠ¨ä»£ç†: ä¿®æ”¹http,https,socksç­‰</li><li>auto ä»£ç†è‡ªåŠ¨é…ç½®: PAC</li></ul><h4 id="ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a class="markdownIt-Anchor" href="#ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a> ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">gsettings <span class="hljs-built_in">set</span> org.gnome.system.proxy mode <span class="hljs-string">&quot;manual&quot;</span><br>gsettings <span class="hljs-built_in">set</span> org.gnome.system.proxy.http host <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>gsettings <span class="hljs-built_in">set</span> org.gnome.system.proxy.http port 8888<br>gsettings <span class="hljs-built_in">set</span> org.gnome.system.proxy.socks host <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>gsettings <span class="hljs-built_in">set</span> org.gnome.system.proxy.socks port 1088<br></code></pre></div></td></tr></table></figure><p>å–æ¶ˆç³»ç»Ÿä»£ç†:</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">gsettings <span class="hljs-built_in">set</span> org.gnome.system.proxy mode <span class="hljs-string">&quot;none&quot;</span><br></code></pre></div></td></tr></table></figure><h4 id="èº«ä»½éªŒè¯æ–¹å¼"><a class="markdownIt-Anchor" href="#èº«ä»½éªŒè¯æ–¹å¼"></a> èº«ä»½éªŒè¯æ–¹å¼ï¼š</h4><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">gsettings <span class="hljs-built_in">set</span> org.gnome.system.proxy.http use-authentication <span class="hljs-literal">true</span><br>gsettings <span class="hljs-built_in">set</span> org.gnome.system.proxy.http authentication-user <span class="hljs-string">&quot;xxx&quot;</span><br>gsettings <span class="hljs-built_in">set</span> org.gnome.system.proxy.http authentication-password <span class="hljs-string">&quot;xxx&quot;</span><br></code></pre></div></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è®¾ç½®ä¸ç»è¿‡ä»£ç†çš„ä¸»æœºã€‚<br />ä¸è¿‡æˆ‘è¿™é‡Œv2rayé…ç½®äº†è·¯ç”±åŠŸèƒ½ï¼Œè¿™æ ·çš„è¯å³ä½¿æ˜¯manualåœ¨è®¿é—®å›½å†…ç½‘ç«™æ—¶ä¾ç„¶ä¸èµ°ä»£ç†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">gsettings get org.gnome.system.proxy ignore-hosts <br></code></pre></div></td></tr></table></figure><p>é»˜è®¤è¾“å‡º <code>['localhost', '127.0.0.0/8', '::1']</code></p><h4 id="pac"><a class="markdownIt-Anchor" href="#pac"></a> PAC</h4><blockquote><p>ä»£ç†è‡ªåŠ¨é…ç½®ï¼ˆProxy auto-configï¼Œç®€ç§°PACï¼‰æ˜¯ä¸€ç§ç½‘é¡µæµè§ˆå™¨æŠ€æœ¯ï¼Œç”¨äºå®šä¹‰æµè§ˆå™¨è¯¥å¦‚ä½•è‡ªåŠ¨é€‰æ‹©é€‚å½“çš„ä»£ç†æœåŠ¡å™¨æ¥è®¿é—®ä¸€ä¸ªç½‘å€ã€‚</p></blockquote><p>ä¹Ÿå°±æ˜¯å›½å†…ä¸èµ°ä»£ç†ï¼Œå›½å¤–èµ°ä»£ç†ï¼Œä¸€èˆ¬æ¥è¯´å¯ä»¥åŠ å¿«ç½‘ç«™è®¿é—®é€Ÿåº¦ã€‚<br />å…³äºPACç½‘ä¸Šæœ‰å¾ˆå¤šæ–‡ç« ä»‹ç»ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p><p>gsettingsè®¾ç½®å¦‚ä¸‹:</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">gsettings get org.gnome.system.proxy autoconfig-url <br><span class="hljs-string">&#x27;http://127.0.0.1:xxxx/pac&#x27;</span><br></code></pre></div></td></tr></table></figure><h3 id="kde"><a class="markdownIt-Anchor" href="#kde"></a> KDE</h3><p>å¯¹äºKDEæ¥è¯´ï¼Œé€šè¿‡ <code>kwriteconfig5</code> æ¥ä¿®æ”¹ç³»ç»Ÿä»£ç†ï¼ŒæŒ‡å®šçš„é…ç½®æ–‡ä»¶ä¸€èˆ¬ä½äº <code>$HOME/.config/kioslaverc</code>ï¼Œå†…å®¹å¤§è‡´å¦‚ä¸‹ï¼Œæœ‰ç‚¹ç±»ä¼¼äºwindowsçš„inié…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">AutoResume=<span class="hljs-literal">true</span><br>ProxyUrlDisplayFlags=0<br><br>[Proxy Settings]<br>Proxy Config Script=<br>ProxyType=0<br>ReversedException=<span class="hljs-literal">false</span><br>ftpProxy=http://localhost 8888<br>httpProxy=http://localhost 8888<br>httpsProxy=http://localhost 8888<br>socksProxy=socks://localhost 1088<br></code></pre></div></td></tr></table></figure><p>kwriteconfig5çš„helpä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">kwriteconfig5<br>Usage: kwriteconfig5 [options] value<br><br>Options:<br>  -h, --<span class="hljs-built_in">help</span>       Displays <span class="hljs-built_in">help</span> on commandline options.<br>  --help-all       Displays <span class="hljs-built_in">help</span> including Qt specific options.<br>  --file &lt;file&gt;    Use &lt;file&gt; instead of global config<br>  --group &lt;group&gt;  Group to look <span class="hljs-keyword">in</span>. Use repeatedly <span class="hljs-keyword">for</span> nested groups.<br>  --key &lt;key&gt;      Key to look <span class="hljs-keyword">for</span><br>  --<span class="hljs-built_in">type</span> &lt;<span class="hljs-built_in">type</span>&gt;    Type of variable. Use <span class="hljs-string">&quot;bool&quot;</span> <span class="hljs-keyword">for</span> a boolean, otherwise it is<br>                   treated as a string<br>  --delete         Delete the designated key <span class="hljs-keyword">if</span> enabled<br><br>Arguments:<br>  value            The value to write. Mandatory, on a shell use <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">for</span> empty<br></code></pre></div></td></tr></table></figure><p>äºæ˜¯KDEä¸‹ä¿®æ”¹ç³»ç»Ÿä»£ç†å˜å¾—ååˆ†ç®€å•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">kwriteconfig5 --file kioslaverc --group <span class="hljs-string">&quot;Proxy Settings&quot;</span> --key <span class="hljs-string">&quot;ProxyType&quot;</span> 1<br>kwriteconfig5 --file kioslaverc --group <span class="hljs-string">&quot;Proxy Settings&quot;</span> --key <span class="hljs-string">&quot;httpProxy&quot;</span> <span class="hljs-string">&quot;http://127.0.0.1 8888&quot;</span><br>kwriteconfig5 --file kioslaverc --group <span class="hljs-string">&quot;Proxy Settings&quot;</span> --key <span class="hljs-string">&quot;httpsProxy&quot;</span> <span class="hljs-string">&quot;http://127.0.0.1 8888&quot;</span><br>kwriteconfig5 --file kioslaverc --group <span class="hljs-string">&quot;Proxy Settings&quot;</span> --key <span class="hljs-string">&quot;socksProxy&quot;</span> <span class="hljs-string">&quot;socks://127.0.0.1 1088&quot;</span><br></code></pre></div></td></tr></table></figure><p><code>ProxyType</code> å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li>0 æ— ä»£ç†</li><li>1 æ‰‹åŠ¨é…ç½®</li><li>2 ä»£ç†è‡ªåŠ¨é…ç½®: PAC</li></ul><p>PACæ¨¡å¼:</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">kwriteconfig5 --file kioslaverc --group <span class="hljs-string">&quot;Proxy Settings&quot;</span> --key <span class="hljs-string">&quot;ProxyType&quot;</span> 2<br>kwriteconfig5 --file kioslaverc --group <span class="hljs-string">&quot;Proxy Settings&quot;</span> --key <span class="hljs-string">&quot;Proxy Config Script&quot;</span> <span class="hljs-string">&quot;&quot;</span><br></code></pre></div></td></tr></table></figure><p>å–æ¶ˆç³»ç»Ÿä»£ç†:</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">kwriteconfig5 --file kioslaverc --group <span class="hljs-string">&quot;Proxy Settings&quot;</span> --key <span class="hljs-string">&quot;ProxyType&quot;</span> 0<br></code></pre></div></td></tr></table></figure><p>è‡³æ­¤ï¼Œé€šè¿‡gsettingsæˆ–kwriteconfig5æ¥ä¿®æ”¹ç³»ç»Ÿä»£ç†ä¹Ÿå°±å°èœä¸€ç¢Ÿäº†ï¼Œå…¶ä½™xfceç­‰å…¶ä»–æ¡Œé¢ç¯å¢ƒæˆ‘è¿˜æ²¡æœ‰æµ‹è¯•ï¼Œæ‰€ä»¥å°±ä¸çŸ¥é“å•¦ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Windows</tag>
      
      <tag>KDE</tag>
      
      <tag>GNOME</tag>
      
      <tag>Proxy</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux RDPè¿œç¨‹æ¡Œé¢è¿æ¥Windows</title>
    <link href="/linux-rdp-windows/"/>
    <url>/linux-rdp-windows/</url>
    
    <content type="html"><![CDATA[<p>è¿œç¨‹æ¡Œé¢åè®®RDPï¼ˆRemote Desktop Protocolï¼‰æ˜¯Microsoftå¼€å‘çš„ä¸“æœ‰åè®®ï¼Œå®ƒä¸ºç”¨æˆ·æä¾›å›¾å½¢ç•Œé¢ä»¥é€šè¿‡ç½‘ç»œè¿æ¥åˆ°å¦ä¸€å°è®¡ç®—æœºã€‚</p><span id="more"></span><p>Windowså¯ä»¥é€šè¿‡VNCè¿œç¨‹æ¡Œé¢è¿æ¥Linuxï¼Œåè¿‡æ¥å´ä¸è¡Œã€‚ä½†æ˜¯ç¡®å®éœ€è¦è¿œç¨‹æ¡Œé¢æ§åˆ¶Windowsï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨ <strong>rdesktop</strong> æˆ– <strong>xfreerdp</strong>ï¼Œä¸¤è€…å‡æ˜¯Linuxä¸‹æ”¯æŒWindowsè¿œç¨‹æ¡Œé¢è¿æ¥çš„å®¢æˆ·ç«¯ç¨‹åºã€‚</p><h3 id="å®‰è£…"><a class="markdownIt-Anchor" href="#å®‰è£…"></a> å®‰è£…</h3><p><strong>rdesktop</strong><br />ubuntu:<br /><code>sudo apt install rdesktop</code><br />arch/manjaro:<br /><code>sudo pacman -S rdesktop</code></p><p><strong>xfreerdp</strong><br />ubuntu:<br /><code>sudo apt get install freerdp</code><br />arch/manjaro:<br /><code>sudo pacman -S freerdp</code></p><h3 id="rdesktop"><a class="markdownIt-Anchor" href="#rdesktop"></a> rdesktop</h3><p>åœ¨æ­¤ä¹‹å‰éœ€è¦è®©Windowsæ”¯æŒè¿œç¨‹ååŠ©ï¼Œå¯ä»¥åœ¨ç³»ç»Ÿå±æ€§-è¿œç¨‹ä¸­å¼€å¯ï¼šã€å…è®¸è¿œç¨‹ååŠ©è¿æ¥è¿™å°è®¡ç®—æœºã€‘+ã€å…è®¸è¿œç¨‹è¿æ¥åˆ°æ­¤è®¡ç®—æœºã€‘ï¼Œå¦‚æœå‹¾é€‰äº†ã€ä»…è¿è¡Œè¿è¡Œä½¿ç”¨ç½‘ç»œçº§åˆ«èº«ä»½éªŒè¯çš„è¿œç¨‹æ¡Œé¢å•ä½è®¡ç®—æœºè¿æ¥ã€‘ï¼Œé‚£ä¹ˆ <strong>rdesktop</strong> æ— æ³•è¿æ¥ï¼ŒæŠ¥é”™ä¿¡æ¯ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">Core(<span class="hljs-built_in">warning</span>): Certificate received <span class="hljs-keyword">from</span> <span class="hljs-keyword">server</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">trusted</span> <span class="hljs-keyword">by</span> this <span class="hljs-keyword">system</span>, an <span class="hljs-keyword">exception</span> has been added <span class="hljs-keyword">by</span> the <span class="hljs-keyword">user</span> <span class="hljs-keyword">to</span> trust this specific certificate.<br>Failed <span class="hljs-keyword">to</span> initialize NLA, <span class="hljs-keyword">do</span> you have correct Kerberos TGT initialized ?<br>Failed <span class="hljs-keyword">to</span> <span class="hljs-keyword">connect</span>, CredSSP required <span class="hljs-keyword">by</span> <span class="hljs-keyword">server</span> (<span class="hljs-keyword">check</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">server</span> has disabled <span class="hljs-built_in">old</span> TLS versions, <span class="hljs-keyword">if</span> yes use -V <span class="hljs-keyword">option</span>).<br></code></pre></div></td></tr></table></figure><p>è§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š1ï¼‰ä¸å‹¾é€‰è¯¥é€‰é¡¹ï¼›2ï¼‰ä½¿ç”¨ <strong>xfreerdp</strong></p><p><code>rdesktop 192.168.xxx.xxx</code> é»˜è®¤é€‰é¡¹å°±å¯ä»¥è¿œç¨‹æ¡Œé¢è¿æ¥Windowsï¼ˆéœ€è¦è¾“å…¥ç”¨æˆ·å£ä»¤ï¼‰ã€‚<br />rdesktopä¸€äº›å¸¸ç”¨é€‰é¡¹ï¼š<br />-u : Windowsç”¨æˆ·<br />-p : Windowså£ä»¤ï¼ˆéPINï¼‰<br />-g : çª—å£å¤§å°ï¼Œå¦‚ 1366x768<br />-f  :å…¨å±<br />-a : è‰²å½©æ·±åº¦ ï¼š8, 15, 16, 24, 32<br />-r sound ï¼šæ”¯æŒå£°éŸ³<br />-r clipboardï¼šæ”¯æŒå‰ªåˆ‡æ¿<br />-r diskï¼š è¿œç¨‹è¿æ¥æ—¶æŒ‚è½½æœ¬åœ°æ–‡ä»¶ç›®å½•</p><p>è¯¦ç»†ä¿¡æ¯ <code>man rdesktop</code></p><p><strong>examples</strong></p> <figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">% rdesktop 192.168.1.6<br>% rdesktop -u user -p - -f<br>% rdesktop -u user -p passwd -g 1366x768 -r sound  -a 32 -r clipboard:PRIMARYCLIPBOARD -r disk:MyDir=/mnt/shared 192.168.1.6 <br></code></pre></div></td></tr></table></figure><h3 id="xfreerdp"><a class="markdownIt-Anchor" href="#xfreerdp"></a> xfreerdp</h3><p>xfreerdpé€‰é¡¹æ¯”è¾ƒå¤šï¼Œä¸è¿‡æŒæ¡åŸºæœ¬çš„ä¹Ÿå°±å¤Ÿäº†</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">/v:&lt;server&gt;[:port] é»˜è®¤ç«¯å£ 3389<br>/wã€/h çª—å£å¤§å°<br>/size:&lt;width&gt;x&lt;height&gt; çª—å£å¤§å°ï¼Œå¦‚ 1024x768<br>/f å…¨å±<br>/workarea Use available work area<br>/bpp:&lt;depth&gt; è‰²å½©æ·±åº¦ <br>/u:&lt;user&gt;[@&lt;domain&gt;] <br>/p:&lt;password&gt;<br>/d:&lt;domain&gt; åŸŸï¼Œå¯é€‰<br>+fonts å¹³æ»‘å­—ä½“<br></code></pre></div></td></tr></table></figure><p><strong>examples</strong></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">% xfreerdp /v:192.168.1.6<br>% xfreerdp /u:user /p:passwd /v:192.168.1.6 /f<br>% xfreerdp /bpp:32 +fonts /u:user /p:passwd /v:192.168.1.6 /workarea <br>% xfreerdp /bpp:32 +clipboard +fonts /u:user /p:passwd /workarea /sound /drive:shared,/mnt/shared /v:192.168.1.6 <br>% xfreerdp /bpp:32 +clipboard +fonts /u:user /p:passwd /size:1366x768 /sound -v:192.168.1.6:3389 <br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Windows</tag>
      
      <tag>RDP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å“ˆå¤«æ›¼ç¼–ç å®ç°è§£å‹ç¼©æ–‡æœ¬æ–‡ä»¶</title>
    <link href="/huffman-encode-decode/"/>
    <url>/huffman-encode-decode/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰å·²ç»ç®€å•åœ°ä»‹ç»äº†LZW ç¼–ç å®ç°çš„åŸç†ï¼Œå®ƒç”±ä¸€ä¸ªåˆå§‹å­—å…¸åœ¨ç¼–ç /è§£ç çš„è¿‡ç¨‹ä¸­ä¸æ–­çš„æ‰©å¢å­—å…¸å†…å®¹ï¼Œä»è€Œåœ¨ä¸‹ä¸€æ¬¡ç¼–ç /è§£ç é‡åˆ°é‡å¤çš„æ–‡æœ¬ä¸²æ—¶ä»å­—å…¸ä¸­æ‰¾å‡ºä¹‹å‰çš„ä»£ç å¹¶å†™å…¥æ–‡æœ¬æ–‡ä»¶ï¼Œè¿™æ ·å°±é¿å…äº†é‡å¤çš„æ–‡æœ¬è€Œè¾¾åˆ°æ–‡æœ¬æ–‡ä»¶ç©ºé—´ç¼©å°çš„ç›®çš„ã€‚æœ¬æ–‡ä¸»è¦ä»<s>ç®€å•ä»‹ç»</s>å“ˆå¤«æ›¼æ ‘è¿‡æ¸¡åˆ°ç¼–ç è§£ç å†…å®¹ã€‚</p><span id="more"></span><h3 id="å“ˆå¤«æ›¼æ ‘"><a class="markdownIt-Anchor" href="#å“ˆå¤«æ›¼æ ‘"></a> å“ˆå¤«æ›¼æ ‘</h3><p>å“ˆå¤«æ›¼æ ‘ä¹Ÿå¯ä»¥ç§°ä½œéœå¤«æ›¼æ ‘ï¼ˆHuffman Treeï¼‰ï¼Œå®é™…ä¸Šå®ƒæ˜¯ä¸€é¢—æœ€ä¼˜äºŒå‰æ ‘ã€‚å®ƒçš„æœ€ä¼˜ä¸»è¦ä½“ç°åœ¨å®ƒçš„<code>åŠ æƒè·¯å¾„é•¿åº¦WPL(weighted path length)</code> æœ€å°ï¼ä¸ºä»€ä¹ˆæœ€å°ï¼Œä¸‹æ–‡æœ‰è§£é‡Šâ€¦<br />æ³¨æ„ï¼ŒèŠ‚ç‚¹çš„<code>åŠ æƒè·¯å¾„é•¿åº¦</code>æ˜¯æŒ‡ä»æ ¹èŠ‚ç‚¹åˆ°è¯¥èŠ‚ç‚¹ä¹‹é—´çš„è·¯å¾„é•¿åº¦ä¸è¯¥èŠ‚ç‚¹æƒå€¼çš„ä¹˜ç§¯ã€‚è€ŒWPLæŒ‡çš„æ˜¯æ‰€æœ‰<code>å¶å­èŠ‚ç‚¹</code>çš„åŠ æƒè·¯å¾„é•¿åº¦<code>æ€»å’Œ</code>ã€‚</p><p>å“ˆå¤«æ›¼æ ‘è¯¦ç»†ä¿¡æ¯å¯ä»¥å‚è€ƒè¿™ä½å¤§ä½¬çš„æ–‡ç«  <a href="https://blog.csdn.net/google19890102/article/details/54848262">æ•°æ®ç»“æ„å’Œç®—æ³•â€”â€”Huffmanæ ‘å’ŒHuffmanç¼–ç </a> ã€‚æ¯•ç«Ÿæœ¬æ–‡ä¸»è¦æ˜¯ä»‹ç»å“ˆå¤«æ›¼çš„ç¼–ç è§£ç è¿‡ç¨‹ï¼Œè€Œä¸”ç†è§£å“ˆå¤«æ›¼æ ‘ä¹ŸèŠ±ä¸äº†å¤šé•¿æ—¶é—´â€¦</p><h3 id="ç¼–ç "><a class="markdownIt-Anchor" href="#ç¼–ç "></a> ç¼–ç </h3><p>å“ˆå¤«æ›¼ç¼–ç ä¸LZWç¼–ç å‡ä¸ºæ— æŸæ•°æ®å‹ç¼©ç®—æ³•çš„å®ç°ï¼Œå“ˆå¤«æ›¼ç¼–ç æœ€æ˜æ˜¾çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯æ— éœ€å­˜å‚¨8ä½çš„å­—ç¬¦ï¼Œåªéœ€è¦å­˜å‚¨01æ¯”ç‰¹æµå³å¯ï¼Œå®ƒæ˜¯ç”¨è¾ƒå°‘çš„æ¯”ç‰¹æ¥è¡¨ç¤ºå‡ºç°é¢‘ç‡é«˜çš„å­—ç¬¦ï¼Œç”¨è¾ƒå¤šçš„æ¯”ç‰¹è¡¨ç¤ºå‡ºç°é¢‘ç‡ä½çš„å­—ç¬¦ï¼Œå³<code>å¯å˜é•¿ç¼–ç </code>ï¼ˆä»å“ˆå¤«æ›¼æ ‘çš„è§’åº¦ç†è§£å°±æ˜¯å­—ç¬¦å‡ºç°é¢‘ç‡/æƒå€¼é«˜çš„ä½äºæ ‘çš„é¡¶å±‚ï¼Œåä¹‹ä½äºæ ‘çš„åº•å±‚ï¼‰ã€‚è¿™æ ·çš„è¯èƒ½å¤Ÿæ¯”è¾ƒå®¹æ˜“èŠ‚çœç©ºé—´ï¼ˆæ¯•ç«Ÿå†™å…¥ä»¥ä½ä¸ºå•ä½çš„æ•°æ®æ€»æ¯”å†™å…¥ä»¥å­—èŠ‚ä¸ºå•ä½çš„è¦èŠ‚çœç©ºé—´ï¼‰ã€‚</p><p>æ— è®ºæ˜¯ç¼–ç è¿˜æ˜¯è§£ç ï¼Œéƒ½éœ€è¦æ„é€ <code>å“ˆå¤«æ›¼æ ‘</code>ï¼Œå¹¶ä¸”å¾—åˆ°ä¸€ä¸ª<code>å“ˆå¤«æ›¼ç¼–ç è¡¨</code>ï¼Œä¹‹åæˆ‘ä»¬å°±æ˜¯åˆ©ç”¨è¿™ä¸ªè¡¨å°†ASCIIæ–‡ä»¶ä¸­å‡ºç°çš„å­—ç¬¦æ‰€å¯¹åº”çš„äºŒè¿›åˆ¶bitæµå†™å…¥åˆ°å‹ç¼©æ–‡ä»¶ä¸­ã€‚</p><p>å‡è®¾å‹ç¼©æ–‡ä»¶ä¸ºASCIIæ–‡ä»¶ï¼Œé‚£ä¹ˆåœ¨æ„é€ å“ˆå¤«æ›¼æ ‘ä¹‹å‰è¿˜éœ€è¦ç»Ÿè®¡ASCIIæ–‡ä»¶ä¸­æ¯ä¸ªASCIIå­—ç¬¦å‡ºç°çš„<code>é¢‘ç‡</code>ï¼Œä¹Ÿå°±æ˜¯å“ˆå¤«æ›¼æ ‘æ¯ä¸ªèŠ‚ç‚¹çš„æƒå€¼ã€‚ç»Ÿè®¡æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥æ‰«æä¸€éæ–‡ä»¶å³å¯ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•æ„é€ å“ˆå¤«æ›¼æ ‘å‘¢ï¼Ÿä»<code>å­—ç¬¦å‡ºç°é¢‘ç‡/æƒå€¼é«˜çš„ä½äºæ ‘çš„é¡¶å±‚ï¼Œåä¹‹ä½äºæ ‘çš„åº•å±‚</code>å¯çŸ¥ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ä¹‹å‰å·²ç»ç»Ÿè®¡å¥½çš„<code>å­—ç¬¦é¢‘ç‡è¡¨F(c)</code>æ¥æ„é€ å“ˆå¤«æ›¼æ ‘ï¼Œå¸¸è§çš„æ–¹æ³•æ˜¯é€šè¿‡<code>ä¼˜å…ˆçº§é˜Ÿåˆ—</code>æ¥å®Œæˆæ„é€ ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥é€šè¿‡æ’åºçš„æ–¹æ³•å®Œæˆã€‚æ€»ä¹‹ï¼Œæ„é€ çš„è´ªå©ªå‡†åˆ™æ˜¯æ¯æ¬¡é€‰å–ä¸¤ä¸ªå‡ºç°é¢‘ç‡æœ€å°(a,b)çš„èŠ‚ç‚¹ä½œä¸ºå­èŠ‚ç‚¹ï¼Œå…¶çˆ¶èŠ‚ç‚¹è¡¨ç¤ºå­èŠ‚ç‚¹å‡ºç°çš„æ€»é¢‘ç‡(a+b)ï¼Œç›´åˆ°å‰©ä½™æ ¹èŠ‚ç‚¹ä¸ºæ­¢ï¼Œè¿™é‡Œçš„<code>èŠ‚ç‚¹</code>æŒ‡çš„æ˜¯FÂ©ä¸­æ¯ä¸ªå‡ºç°é¢‘ç‡å¤§äº0çš„å­—ç¬¦ã€‚å®è§‚ä¸Šæ¥çœ‹ï¼Œæ„é€ å“ˆå¤«æ›¼æ ‘æ˜¯è‡ªåº•å‘ä¸Šè¿›è¡Œçš„ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰ä¸€æ®µæ–‡æœ¬<code>S=hhelloooo</code>ï¼Œé¦–å…ˆç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°é¢‘ç‡ï¼š</p><table><thead><tr><th>character</th><th>h</th><th>e</th><th>l</th><th>o</th></tr></thead><tbody><tr><td>frequency</td><td>2</td><td>1</td><td>2</td><td>4</td></tr></tbody></table><p>æ¥ç€åˆ©ç”¨è¿™ä¸ªè¡¨æ„é€ å“ˆå¤«æ›¼æ ‘å¦‚ä¸‹å›¾æ‰€ç¤º<br /><img src="/uploads/images/data_structure/huffman_cpp/1.PNG" alt="image" /></p><p>å‡è®¾å°†çˆ¶èŠ‚ç‚¹ä¸å·¦èŠ‚ç‚¹ç›¸è¿æ¥åˆ†æ”¯æ ‡è®°ä¸º0ã€å³èŠ‚ç‚¹çš„æ ‡è®°ä¸º1ï¼ˆä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼š0è¡¨ç¤ºå‘å·¦å­æ ‘ç§»åŠ¨ä¸€æ­¥ã€1è¡¨ç¤ºå‘å³å­æ ‘ç§»åŠ¨ä¸€æ­¥ï¼‰<br /><img src="/uploads/images/data_structure/huffman_cpp/2.PNG" alt="image" /></p><p>é‚£ä¹ˆå­—ç¬¦håœ¨å“ˆå¤«æ›¼æ ‘ä¸­è¡¨ç¤ºäºŒè¿›åˆ¶ä¸²ä¸º 10ï¼ŒåŒæ ·eã€lã€oå¯¹åº”çš„äºŒè¿›åˆ¶ä¸²åˆ†åˆ«ä¸º110ã€111ã€0ã€‚<br />äºæ˜¯è¿›ä¸€æ­¥å¾—åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„è¡¨æ ¼ï¼Œä»è¿™ä¸ªè¡¨æ ¼å¯ä»¥å¾—åˆ°çš„ä¿¡æ¯æœ‰ï¼š</p><ul><li>å­—ç¬¦åˆ°äºŒè¿›åˆ¶ä»£ç çš„æ˜ å°„è¡¨</li><li>å­—ç¬¦çš„é¢‘ç‡è¡¨</li></ul><table><thead><tr><th>character</th><th>h</th><th>e</th><th>l</th><th>o</th></tr></thead><tbody><tr><td>frequency</td><td>2</td><td>1</td><td>2</td><td>4</td></tr><tr><td>bit stream</td><td>10</td><td>110</td><td>111</td><td>0</td></tr></tbody></table><p>å°†å­—ç¬¦ä¸² hhelloooo æ¯ä¸ªå‡ºç°çš„å­—ç¬¦ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºå°±æ˜¯ï¼š 10.10.110.111.111.0.0.0.0ã€‚</p><p>æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜å‘ç°å­—ç¬¦hã€eã€lã€oå§‹ç»ˆä½äº<code>å¶å­èŠ‚ç‚¹</code>ï¼Œè¿™æ ·æœ‰ä»€ä¹ˆæ„ä¹‰å—ï¼Ÿå›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰å…ˆå¼•å…¥ä¸€ä¸ªæ¦‚å¿µï¼š<code>å˜é•¿å‰ç¼€ç </code>ï¼Œå¤§æ„æ˜¯ï¼š<strong>æ²¡æœ‰ä¸€ä¸ªä»£ç æ˜¯å¦ä¸€ä¸ªä»£ç çš„å‰ç¼€</strong> ã€‚ è¿™å¥è¯æˆ‘æ˜¯æ‘˜è‡ªã€Šæ•°æ®ç»“æ„ç®—æ³•ä¸åº”ç”¨ã€‹ï¼Œè€Œã€Šç®—æ³•ã€‹ç¬¬å››ç‰ˆä¸­æ˜¯è¿™æ ·æè¿°çš„ï¼š<strong>å¦‚æœæ‰€æœ‰å­—ç¬¦ç¼–ç éƒ½ä¸ä¼šæˆä¸ºå…¶ä»–å­—ç¬¦ç¼–ç çš„å‰ç¼€ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦åˆ†éš”ç¬¦äº†</strong> ã€‚å…¶å®è¿™å¾ˆå®¹æ˜“ç†è§£ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªäºŒè¿›åˆ¶ä»£ç æ˜¯å¦å¤–æŸä¸€ä¸ªäºŒè¿›åˆ¶ä»£ç çš„å‰ç¼€ï¼Œé‚£ä¹ˆåœ¨è§£ç çš„è¿‡ç¨‹ä¸­å°±ä¼šæ— æ³•åˆ¤æ–­å‡ºè¯¥äºŒè¿›åˆ¶ä»£ç å±äºå“ªä¸ªåŸå§‹å­—ç¬¦ã€‚å› æ­¤ï¼Œè¦é¿å…è¿™ç§æƒ…å†µï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯å°†å­—ç¬¦èŠ‚ç‚¹ç½®äº<code>å¶å­èŠ‚ç‚¹</code>ï¼Œè¿™æ ·åœ¨è§£ç çš„è¿‡ç¨‹ä¸­è‡ªé¡¶å‘ä¸‹çš„å¯»æ‰¾åŸå§‹å­—ç¬¦å°±å¯ä»¥å®Œæˆäº†ã€‚</p><p>ç°åœ¨å†æ¥è®¨è®ºå¦ä¸€ä¸ªé—®é¢˜ï¼Œæ¯•ç«Ÿå“ˆå¤«æ›¼ç¼–ç æ˜¯è§£å‹ç¼©ç®—æ³•å˜›ï¼Œé‚£ä¹ˆå…¶å‹ç¼©æ•ˆç‡å¦‚ä½•å‘¢ï¼Ÿ</p><p>æ¯”å¦‚ä¸Šé¢çš„å­—ç¬¦ä¸²hhellooooï¼Œç”±äºæ¯ä¸ªASCIIç å ä¸€ä¸ªå­—èŠ‚ï¼Œæ€»å…±9bytes=72bitsï¼Œç¼–ç åçš„äºŒè¿›åˆ¶ä¸² 10101101,11111000,0 æ€»å…±<strong>17bits</strong>ï¼Œæ•…å‹ç¼©ç‡å¤§çº¦æ˜¯ 23.6%ï¼Œè¿˜è¡Œã€‚<br />å†æ¥çœ‹ä¸€ä¸ªå…¨æ˜¯å­—æ¯aä¸”é•¿åº¦ä¸ºçº¦62kå­—èŠ‚çš„å­—ç¬¦ä¸²ï¼Œå‹ç¼©åçš„æ–‡ä»¶å¤§å°ä»…ä¸º5å­—èŠ‚ï¼ç°åœ¨ä»…ä»…æ”¹å˜ä¸€ä¸ªå­—æ¯aä¸ºbï¼ŒåŸæ–‡ä»¶å¤§å°ä¸å˜ï¼Œæ­¤æ—¶å‹ç¼©åçš„æ–‡ä»¶å¤§å°çº¦ä¸º7.7Kå­—èŠ‚ï¼</p><p>å’³å’³ï¼Œç°åœ¨å›ç­”ä¹‹å‰çš„é‚£ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆ<code>åŠ æƒè·¯å¾„é•¿åº¦WPL</code>æ˜¯æœ€å°çš„ã€‚æˆ‘ä»¬ä¸å¦¨æ¥ç®—ä¸€ä¸‹ç°åœ¨è¿™é¢—å“ˆå¤«æ›¼æ ‘çš„WPLæ˜¯å¤šå°‘å‘¢ï¼Œ<br />å…¶WPLä¸ºï¼š1x4+2x2+3x1+3x2=4+4+3+6=<strong>17</strong>ã€‚è¿™ä¸å‹ç¼©åçš„æ–‡ä»¶å¤§å°ç›¸ç­‰ï¼Œè¿™ä¹Ÿè¯´æ˜äº†WPLè¶Šå°ï¼Œå‹ç¼©æ–‡ä»¶ä½“ç§¯è¶Šå°ï¼Œä½†ä¹Ÿä¸å¯èƒ½ä¸º0ã€‚<br />è¿™æ—¶å€™å¾—åˆ°ä¸€ä¸ªç»“è®ºï¼šå¯¹äºä»»æ„å˜é•¿å‰ç¼€ç ï¼Œç¼–ç åçš„äºŒè¿›åˆ¶bitæµçš„é•¿åº¦ç­‰äºç›¸åº”çš„å“ˆå¤«æ›¼æ ‘çš„WPLã€‚</p><p>æ³¨æ„ï¼šåœ¨æŸäº›æƒ…å†µä¸‹å‹ç¼©ç‡ç”šè‡³ä¼šè¶…è¿‡100%ï¼</p><p>å¯è§å“ˆå¤«æ›¼ç¼–ç å¯¹äºæ–‡ä»¶å‹ç¼©ä¹Ÿæ˜¯æœ‰è¦æ±‚çš„ã€‚</p><blockquote><p>1.å¿…é¡»<code>å°½é‡</code>åˆ©ç”¨è¢«å‹ç¼©çš„æ•°æ®æµä¸­çš„<code>å·²çŸ¥</code>ç»“æ„ï¼›<br />2.å°è§„æ¨¡çš„å­—æ¯è¡¨ï¼›<br />3.è¾ƒé•¿çš„è¿ç»­ç›¸åŒçš„ä½æˆ–å­—ç¬¦ï¼›<br />4.é¢‘ç¹ä½¿ç”¨çš„å­—ç¬¦ï¼›<br />5.è¾ƒé•¿çš„è¿ç»­é‡å¤çš„ä½æˆ–å­—ç¬¦ã€‚</p></blockquote><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ—¢ç„¶èƒ½å¤Ÿå‹ç¼©æ–‡ä»¶ï¼Œé‚£ä¹ˆä¹Ÿå¾—å¿…é¡»å®Œå…¨æˆåŠŸè§£å‹æ–‡ä»¶æ‰è¡Œå•Šï¼Œä¸ç„¶æ–‡ä»¶æ˜¯çœŸçš„æŸåäº†å“­éƒ½æ¥ä¸åŠ:)ã€‚<s>æ€»æ‰€å‘¨çŸ¥</s>LZW ç¼–ç åœ¨å®ç°ç¼–ç çš„æ•´ä¸ªè¿‡ç¨‹ä¸­æ²¡æœ‰å°†æ•´ä¸ªå­—å…¸å†™å…¥å‹ç¼©æ–‡ä»¶ï¼Œç”šè‡³åœ¨è§£ç æ—¶ä¹Ÿæ˜¯æ²¡æœ‰ä¸€ä¸ªå®Œæ•´çš„å­—å…¸ï¼Œè¿™æ˜¯LZWçš„ç‹¬ç‰¹ä¹‹å¤„ã€‚è€Œå“ˆå¤«æ›¼ç¼–ç åˆ™ä¸åŒï¼Œå®ƒæ˜¯éœ€è¦å†™å…¥ç›¸å…³ä¿¡æ¯çš„ï¼è¿™æ ·åœ¨è§£ç æ—¶æ‰èƒ½å¤Ÿé‡æ„å“ˆå¤«æ›¼æ ‘ã€‚è¿™ä¸ªç›¸å…³ä¿¡æ¯å¯ä»¥æ˜¯å­—ç¬¦åˆ°äºŒè¿›åˆ¶ä»£ç çš„æ˜ å°„è¡¨bitstreamÂ©æˆ–è€…æ¯ä¸ªå­—ç¬¦çš„é¢‘ç‡è¡¨fÂ©ã€‚ä¸è¿‡ã€Šç®—æ³•ã€‹ç¬¬å››ç‰ˆé‡Œé¢å¹¶æ²¡æœ‰ç”¨çš„ä»¥ä¸Šä¸¤ç§æ–¹æ³•ï¼Œè€Œæ˜¯å†™å…¥ä¸€ä¸ªå“ˆå¤«æ›¼æ ‘ç»“æ„ï¼ˆå°†å“ˆå¤«æ›¼æ ‘ç¼–ç ä¸ºbitæµï¼‰ï¼Œè¿™æ ·åšçš„ç›´æ¥ç›®çš„æ˜¯é˜²æ­¢ä¸å¿…è¦çš„ç©ºé—´æµªè´¹ã€‚<br />è‡³äºæ€ä¹ˆç¼–ç ï¼Œå…¶å®å°±æ˜¯é€šè¿‡ä¸€æ¬¡å‰åºéå†å°†<code>å†…éƒ¨èŠ‚ç‚¹</code>å’Œ<code>å¶å­èŠ‚ç‚¹</code>çš„å¼€å…³bitå†™å…¥å‹ç¼©æ–‡ä»¶ä¸­ã€‚æ¯”å¦‚ä¸‹é¢è¿™å¼ å›¾<br /><img src="/uploads/images/data_structure/huffman_cpp/3.PNG" alt="image" /></p><p>åœ¨ä¸€æ¬¡å‰åºéå†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°å†…éƒ¨èŠ‚ç‚¹å°±å†™å…¥0bitï¼Œå¦‚æœæ˜¯å¶å­èŠ‚ç‚¹é™¤äº†å†™å…¥1bitå¤–è¿˜éœ€è¦å°†å­—ç¬¦çš„ASCIIç ï¼ˆ8bitsï¼‰ä¹Ÿå†™å…¥æ–‡ä»¶ï¼Œæœ€åå†å†™å…¥å˜é•¿å‰ç¼€ç ã€‚è¿™æ ·åšçš„ç†ç”±æ–¹ä¾¿è§£ç æ—¶é‡æ„å“ˆå¤«æ›¼æ ‘ã€‚<br />æ€»ä¹‹éœ€è¦å†™å…¥æ–‡ä»¶çš„å†…å®¹æœ‰ï¼šç¼–ç å“ˆå¤«æ›¼æ ‘çš„bitsæµ+<strong>å­—ç¬¦ä¸ªæ•°(32bits)</strong>+å¯¹åº”å­—ç¬¦çš„äºŒè¿›åˆ¶ä»£ç ï¼ˆæˆ–è€…ç§°ä¸ºå˜é•¿å‰ç¼€ç ï¼‰ã€‚ä¸Šé¢çš„å›¾æ²¡æœ‰æ ‡å­—ç¬¦ä¸ªæ•°çš„äºŒè¿›åˆ¶ï¼ˆæ¯•ç«Ÿè¿™ä¸ªä¾‹å­æ‰åªæœ‰9ä¸ªå­—ç¬¦ï¼Œä¸å¯èƒ½ç”»é‚£ä¹ˆå¤š0å§ï¼‰ã€‚</p><p>å½“ç„¶äº†ï¼Œä¸æ˜¯æ¯æ¬¡éƒ½æ°å¥½å°†æ¯8bitsä¸€ä¸ªå­—èŠ‚å†™å…¥æ–‡ä»¶ï¼Œå¯èƒ½æœ€åå°±ä¼šå¤šå‡ºNä½<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>â‰¤</mo><mi>N</mi><mo>â‰¤</mo><mn>7</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">( 1 \le N \le 7)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">7</span><span class="mclose">)</span></span></span></span>ã€‚è¦çŸ¥é“ç›®å‰æ ‡å‡†C++åªèƒ½æ“ä½œå­—èŠ‚æµï¼Œè¿˜ä¸èƒ½æ“ä½œä½æµï¼ˆJavaæœ‰BinaryStdIn/Outï¼‰ã€‚è§£å†³æ–¹æ³•å¾ˆç®€å•ç²—æš´ï¼Œä¸è¶³8ä½çš„å°±åœ¨åé¢è¡¥0ã€‚</p><p>ç°åœ¨å°ç»“ä¸€ä¸‹ï¼Œè¦å®ç°å“ˆå¤«æ›¼å‹ç¼©ç®—æ³•ï¼Œéœ€è¦ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ul><li>ä»æ–‡ä»¶è¾“å…¥æµç»Ÿè®¡åœ¨ASCIIç èŒƒå›´å†…å­—ç¬¦å‡ºç°é¢‘ç‡ï¼›</li><li>åˆ©ç”¨é¢‘ç‡è¡¨æ„é€ å“ˆå¤«æ›¼æ ‘ï¼›</li><li>åˆ©ç”¨å“ˆå¤«æ›¼æ ‘æ„é€ å“ˆå¤«æ›¼ç¼–ç è¡¨ï¼ˆå¦‚a:10010ï¼‰ï¼›</li><li>å†™å…¥å“ˆå¤«æ›¼æ ‘/bitstreamÂ©/fÂ©ï¼›</li><li>å†™å…¥å­—ç¬¦ä¸ªæ•°ï¼Œæ¯•ç«Ÿè§£ç å¯ä¸çŸ¥é“æœ‰å¤šå°‘ä¸ªå­—ç¬¦ï¼›</li><li>ä»å“ˆå¤«æ›¼ç¼–ç è¡¨å†™å…¥æ‰€æœ‰å­—ç¬¦å¯¹åº”çš„äºŒè¿›åˆ¶ç¼–ç ï¼›</li><li>å‹ç¼©ç»“æŸã€‚</li></ul><h3 id="è§£ç "><a class="markdownIt-Anchor" href="#è§£ç "></a> è§£ç </h3><p>è§£ç å°±æ˜¯ç¼–ç çš„é€†æ“ä½œï¼Œä¸è¿‡ä¸€äº›ç»†èŠ‚è¿˜æ˜¯éœ€è¦æ³¨æ„çš„ã€‚<br />è¿˜æ˜¯ä»¥ä¸Šé¢é‚£ä¸ªä¾‹å­æ¥è¯´å§(âŠ™ï¹âŠ™)<br />01(01101111)01(01101000)01(01100101)1(01101100)+10101101111110000</p><p>è§£ç çš„ç¬¬ä¸€æ­¥è‚¯å®šæ˜¯è¯»å–å‰é¢é‚£ä¸€å¨å·²ç»å°†å“ˆå¤«æ›¼æ ‘ç¼–ç æˆbitæµçš„äºŒè¿›åˆ¶ä¸²ï¼Œå…³é”®æ˜¯è¯»å–äº†è¯¥æ€ä¹ˆæ„é€ å‡ºå“ˆå¤«æ›¼æ ‘ã€‚è®°å¾—ä¹‹å‰ç¼–ç æ—¶æˆ‘ä»¬æ˜¯èµ°ä¸€æ¬¡å‰åºéå†æ‰å°†å“ˆå¤«æ›¼æ ‘ç¼–ç æˆbitæµï¼Œé‚£ä¹ˆè§£ç åˆæœ‰ä½•ä¸å¯å‘¢ï¼Ÿå¦‚æœè¯»å–çš„ä¸€ä¸ªbitæ˜¯1ï¼Œè¿™è¯´æ˜è¯¥å¤„æ˜¯å¶å­èŠ‚ç‚¹(new)ï¼Œé‚£ä¹ˆæ¥ç€å†è¯»å–1byteå°±èƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ªASCIIç ï¼Œç„¶åç»“æŸï¼›å¦‚æœè¯»å–åˆ°0bitï¼Œè¯´æ˜æ˜¯è¿™æ˜¯ä¸€ä¸ªå†…éƒ¨èŠ‚ç‚¹(new)ï¼Œå°†è¯¥å†…éƒ¨èŠ‚ç‚¹ä½œä¸ºçˆ¶èŠ‚ç‚¹åé‚£ä¹ˆç»§ç»­é€’å½’ï¼Œç›´åˆ°éå†å®Œæ‰€æœ‰å¶å­èŠ‚ç‚¹ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»é€šè¿‡bitæµæ„é€ å‡ºäº†å“ˆå¤«æ›¼æ ‘ï¼Œæ¥ç€å†è¯»å–32bitsæˆ–è€…64bitsï¼Œæ€»ä¹‹æ˜¯ä¸€ä¸ªè®°å½•ç€å­—ç¬¦ä¸ªæ•°çš„æ•´æ•°ã€‚</p><p>æœ€åä¸€æ­¥å°±æ˜¯è§£æå˜é•¿å‰ç¼€ç  10.10.110.111.111.0.0.0.0 ã€‚è§‚å¯Ÿè¿™ä¸€ä¸²äºŒè¿›åˆ¶æ–‡æœ¬ï¼Œå®ƒè¢«åˆ†å‰²çš„ä»½æ•°ä¹Ÿå°±æ˜¯ä»–å¯¹åº”çš„å­—ç¬¦æ€»æ•°ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆéœ€è¦å†™å…¥å­—ç¬¦ä¸ªæ•°çš„åŸå› ï¼Œæ­¤æ—¶æˆ‘ä»¬å¹¶ä¸çŸ¥é“å‹ç¼©æ–‡ä»¶æ€»å…±æœ‰å¤šå°‘bitsï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“å®ƒæœ‰Nä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡å“ˆå¤«æ›¼æ ‘åè§£å‡ºæ‰€æœ‰çš„åŸå§‹å­—ç¬¦å¹¶å†™å…¥è§£å‹æ–‡ä»¶ã€‚å½“ç„¶äº†ï¼Œå¦‚æœå·²ç»çŸ¥é“å‹ç¼©æ–‡ä»¶æœ‰å¤šå°‘ä¸ªbitsï¼Œé‚£ä¹ˆå°±æ²¡å¿…è¦è¿™ä¸ªNäº†ï¼Œç›´æ¥çš„æ–¹æ³•å°±æ˜¯ä¸€ä½ä¸€ä½çš„è¯»å–å¹¶æ ¹æ®å“ˆå¤«æ›¼æ ‘è§£æå‡ºåŸå§‹å­—ç¬¦ï¼Œä¸è¿‡å°±æ˜¯å¦å¤–ä¸€ç§æ–¹æ³•ï¼Œè¿™é‡Œå°±ä¸è®¨è®ºäº†ã€‚</p><p>å°ç»“ä¸€ä¸‹ï¼Œè§£ç è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ul><li>è¯»å–å‹ç¼©æ–‡ä»¶bitæµé‡æ„å“ˆå¤«æ›¼æ ‘ï¼›</li><li>è¯»å–å­—ç¬¦ä¸ªæ•°Nï¼›</li><li>æ ¹æ®å“ˆå¤«æ›¼æ ‘ã€Nè§£æå‡ºåŸå§‹å­—ç¬¦ï¼Œæ–¹æ³•æ˜¯è‡ªé¡¶å‘ä¸‹è½®å¾ªè§£æï¼›</li><li>è§£å‹ç»“æŸã€‚</li></ul><h3 id="è§£æä½æµ"><a class="markdownIt-Anchor" href="#è§£æä½æµ"></a> è§£æä½æµ</h3><p>ä»£ç å‚è€ƒäº†ã€Šç®—æ³•ã€‹ç¬¬å››ç‰ˆçš„ï¼Œä¸è¿‡ä¹¦ä¸Šæ˜¯Javaç‰ˆæœ¬çš„ï¼Œè€Œä¸”æœ€dan tengçš„å°±æ˜¯è§£æä½æµï¼Œæ— è®ºæ˜¯Cçš„freadã€fwriteã€è¿˜æ˜¯C++çš„basic_ifstream<bool>ã€basic_ofstream<bool>ï¼Œéƒ½è‡³å°‘ä¸€ä¸ªå­—èŠ‚ï¼Œæ ¹æœ¬ä¸èƒ½ç›´æ¥æ“ä½œä½æµï¼Œè€ŒJavaçš„BinaryStdIn/Outå¯ä»¥æ“ä½œä½æµã€‚æ— å¥ˆä¹‹ä¸‹ï¼Œåªèƒ½è‡ªå·±å†™ä¸€ä¸ªç®€å•åœ°å¯ä»¥æ§åˆ¶ä½æµçš„ç±»ï¼ŒåŸç†ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯ä¸€äº›&amp;|&lt;&lt;&gt;&gt;â€¦ï¼ˆåæ¥å‘ç°ç½‘ä¸Šå·²ç»æœ‰å¤§ä½¬å®Œæˆäº†â€¦ï¼‰ç„¶åå†æ”¹å†™Javaç‰ˆæœ¬çš„å“ˆå¤«æ›¼ç¼–ç å®ç°ï¼Œ<br />æœ¬æ¥æƒ³ç€èƒ½ç®€å°±ç®€çš„â€¦<br />æƒ³ç€èƒ½ç®€å°±ç®€çš„â€¦<br />èƒ½ç®€å°±ç®€çš„â€¦<br />ç®€ç®€çš„â€¦<br />ç®€çš„â€¦<br />ç®€.<br />.</p><p>ä»£ç å°±ä¸æ”¾äº†â€¦<br />ç ä¸æ”¾äº†â€¦<br />ç äº†â€¦<br />äº†â€¦<br />â€¦<br />.</p><h3 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h3><p>ã€Šç®—æ³•ã€‹ç¬¬å››ç‰ˆ<br />ã€Šæ•°æ®ç»“æ„ç®—æ³•ä¸åº”ç”¨ã€‹<br /><a href="https://en.wikipedia.org/wiki/Huffman_coding">Huffman coding</a><br /><a href="https://www.cnblogs.com/skywang12345/p/3706370.html">å“ˆå¤«æ›¼æ ‘</a></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>DataStructures</tag>
      
      <tag>C</tag>
      
      <tag>Huffman</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LZWæ–‡æœ¬å‹ç¼©</title>
    <link href="/lzw-cpp/"/>
    <url>/lzw-cpp/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ç¿»çœ‹ã€Šæ•°æ®ç»“æ„ã€ç®—æ³•ä¸åº”ç”¨ã€‹é‡Œé¢å…³äºå“ˆå¸Œè¡¨ç« èŠ‚æ—¶çœ‹åˆ°ä¸€ä¸ªLZWæ–‡æœ¬å‹ç¼©ç®—æ³•çš„å®ä¾‹ï¼Œå•ƒäº†å¾ˆä¹…æ‰åŸºæœ¬äº†è§£LZWç®—æ³•ï¼Œäºæ˜¯èµ¶ç´§æŠŠå®ƒè®°å½•ä¸‹æ¥æ–¹ä¾¿æ—¥åç¿»çœ‹ã€‚</p><span id="more"></span><h3 id="lzw"><a class="markdownIt-Anchor" href="#lzw"></a> LZW</h3><p>Lempel-Ziv-Welchï¼ˆLZWï¼‰æ˜¯ç”±Abraham Lempelï¼ŒJacob Zivå’ŒTerry Welchåˆ›å»ºçš„<strong>æ— æŸ</strong>æ•°æ®å‹ç¼©ç®—æ³•ã€‚<br />ä¸ºäº†å‡å°‘ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶å ç”¨çš„ç£ç›˜ç©ºé—´ï¼Œé€šå¸¸éœ€è¦å°†æ–‡æœ¬æ–‡ä»¶å‹ç¼©ç¼–ç åå­˜å‚¨ï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦å¯¹æ–‡ä»¶ç¼–ç çš„<strong>å‹ç¼©å™¨compressor</strong>ï¼Œä»¥åŠè§£ç çš„<strong>è§£å‹å™¨decompressor</strong>ã€‚</p><h3 id="å‹ç¼©compress"><a class="markdownIt-Anchor" href="#å‹ç¼©compress"></a> å‹ç¼©compress</h3><p>LZWå‹ç¼©æ–¹æ³•æ˜¯å°†æ–‡æœ¬å­—ç¬¦ä¸²Textæ˜ å°„ä¸ºæ•°å­—ç¼–ç Codeï¼ˆæ¯”å¦‚ASCII 0-255ï¼‰ï¼Œè€Œå°†æ–‡æœ¬å­—ç¬¦ä¸²Textå’Œæ•°å­—ç¼–ç Codeè¿™ä¸€å¯¹æ˜ å°„å…³ç³»å­˜å‚¨åœ¨å­—å…¸/å“ˆå¸Œè¡¨ä¸­ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è§„å®šï¼š<code>p</code>è¡¨ç¤ºå­˜åœ¨äºå­—å…¸ä¸­<code>æœ€é•¿</code>çš„å­—ç¬¦ä¸²ï¼Œç§°ä¸º<strong>å‰ç¼€å­—ç¬¦ä¸²</strong>ï¼›<code>c</code>è¡¨ç¤ºåœ¨å¾…ç¼–ç å­—ç¬¦ä¸²<code>S</code>ä¸­åŒ¹é…åˆ°çš„<code>p</code>å‰ç¼€å­—ç¬¦ä¸²çš„<code>ä¸‹ä¸€ä¸ªå­—ç¬¦</code>ï¼Œç§°ä¸º<strong>åç¼€å­—ç¬¦</strong>ï¼›<code>p</code>åœ¨å­—å…¸è¡¨<code>table</code>ä¸­çš„<code>ä»£ç </code>ä¸º<code>table[p]</code>ã€‚</p><p>ä¸ºäº†ç®€åŒ–äº‹ä¾‹ï¼Œå‡è®¾ä¸€ä¸²æ–‡æœ¬<code>S=aaabbbbbbaabaaba</code>åªç”±aã€bç»„æˆï¼Œåˆå§‹æƒ…å†µä¸‹å­—å…¸ä¸­åªæœ‰<code>a</code>å’Œ<code>b</code>è¿™ä¸¤ä¸ªå­—ç¬¦ï¼Œä¸”å­˜å‚¨åœ¨å­—å…¸<code>table</code>ä¸­ï¼Œå·²å‹ç¼©ä¸²ä¸ºç©ºã€‚</p><p>è¿™å¼ å›¾å‚è€ƒäº†ä¹¦ä¸Šçš„ä¾‹å­ï¼ŒåŠ ä¸Šè‡ªå·±ä¿®æ”¹è§‰å¾—æŒºä¸é”™çš„ã€‚å›¾ä¸­è¡¨æ ¼é˜´å½±éƒ¨åˆ†è¡¨ç¤ºè¾“å‡ºçš„å‹ç¼©ä¸²ä»£ç åœ¨å­—å…¸ä¸­çš„ä½ç½®ã€‚<br /><img src="/uploads/images/data_structure/lzw_cpp/01.png" alt="" /></p><p>ç”¨LZWå‹ç¼©ç®—æ³•æ¥æ¨¡æ‹Ÿä¸Šå›¾çš„è¿‡ç¨‹ï¼š<br />1.é¦–å…ˆåˆå§‹åŒ–å­—å…¸<code>table&lt;String,Integer&gt;</code>ï¼›<br />2.ç„¶åæ‰¾åˆ°å¾…ç¼–ç å­—ç¬¦ä¸²<code>S</code>çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä½œä¸º<code>å‰ç¼€å­—ç¬¦ä¸²p</code>ï¼Œä¸”è¿™ä¸ªå­—ç¬¦ä¸€å®šèƒ½åœ¨å­—å…¸ä¸­æ‰¾åˆ°å¯¹åº”ä»£ç <code>table[p]</code>ï¼›<br />3.æ¥ç€è¯»å–<code>S</code>çš„ä¸‹ä¸€ä¸ª<strong>å­—ç¬¦</strong>ä½œä¸º<code>åç¼€å­—ç¬¦c=a</code>ï¼›<br />4.å¦‚æœ<code>p+c</code>åœ¨å­—å…¸ä¸­ï¼Œåˆ™pæŒ‡å‘ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š<code>p=p+c</code>ï¼›<br />5.å¦‚æœ<code>p+c</code>ä¸åœ¨å­—å…¸ä¸­ï¼Œé‚£ä¹ˆè¾“å‡º<code>p</code>åœ¨å­—å…¸ä¸­çš„ä»£ç <code>table[p]</code>ï¼ŒåŒæ—¶ä¸º<code>p+c</code>åœ¨å­—å…¸ä¸­åˆ†é…ä¸€ä¸ªæ–°çš„ä»£ç <code>table[p+c]</code>ï¼Œ<code>p</code>æŒ‡å‘ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼š<code>p=c</code>ï¼›<br />6.é‡å¤æ­¥éª¤3ã€4ã€5ç›´åˆ°<code>EOF</code>ï¼›<br />7.æœ€åè¾“å‡ºä»£ç <code>table[p]</code>ï¼›<br />8.ç»“æŸã€‚</p><p>ä¼ªä»£ç å¦‚ä¸‹</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">Initialize <span class="hljs-keyword">table</span><br>P = first <span class="hljs-keyword">input</span> <span class="hljs-type">character</span><br><span class="hljs-keyword">WHILE</span> <span class="hljs-keyword">not</span> EOF<br>    C = next <span class="hljs-keyword">input</span> <span class="hljs-type">character</span><br>    <span class="hljs-keyword">IF</span> P + C <span class="hljs-keyword">in</span> <span class="hljs-keyword">table</span><br>        P = P + C<br>    <span class="hljs-keyword">ELSE</span><br>        output the code <span class="hljs-keyword">for</span> P<br>        <span class="hljs-keyword">insert</span> P + C <span class="hljs-keyword">into</span> <span class="hljs-keyword">table</span><br>        P = C<br>output code <span class="hljs-keyword">for</span> P<br></code></pre></div></td></tr></table></figure><p>åˆå§‹å­—å…¸ä»…ä»…åŒ…å«ä¸€äº›åŸºæœ¬å­—ç¬¦ä¸²å’Œä»£ç ï¼Œä½†æ˜¯éšç€ç¼–ç çš„è¿›è¡Œï¼Œå­—å…¸ä¸æ–­æ‰©å¢ï¼Œå¦‚æœé‡åˆ°ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²<code>p+c</code>ä¸åœ¨å­—å…¸ä¸­ï¼Œé‚£ä¹ˆå°±å°†å…¶æ·»åŠ åˆ°å­—å…¸ï¼Œä»¥ä¾¿ä¸‹ä¸€æ¬¡ç¼–ç æ—¶<code>p+c</code>èƒ½å¤Ÿä»å­—å…¸ä¸­æ‰¾åˆ°ï¼›å¦‚æœèƒ½å¤Ÿåœ¨å­—å…¸ä¸­æ‰¾åˆ°<code>p+c</code>ï¼Œæ„å‘³ç€éœ€è¦ä¸€ä¸ªæ›´é•¿çš„å­—ç¬¦ä¸²<code>p</code>æ¥æ˜ å°„ä¸€äº›æ–°çš„ä»£ç ä»¥è¾¾åˆ°æ–‡æœ¬å‹ç¼©ç›®çš„ã€‚å°±åƒä¸Šå›¾ä¾‹2,3ï¼Œæ­¤æ—¶<code>p=a,c=a</code>,<code>&lt;aa,2&gt;</code>å·²ç»å­˜åœ¨å­—å…¸ï¼Œä¸‹ä¸€æ¬¡åˆ¤æ–­<code>p+c=aa</code>å°±èƒ½å¤Ÿåœ¨å­—å…¸ä¸­æ‰¾åˆ°<code>aa</code>ï¼Œäºæ˜¯<code>p=p+c=aa</code>ï¼Œå°½å¯èƒ½é€‰æ‹©ä¸€ä¸ªæœ€é•¿çš„å‰ç¼€å­—ç¬¦ä¸²ï¼Œæ¥ç€ä¸‹ä¸€æ¬¡åˆ¤æ–­æ—¶<code>aa+b=aab</code>åœ¨å­—å…¸ä¸­æ‰¾ä¸åˆ°ï¼Œäºæ˜¯å°†<code>&lt;aab,3&gt;</code>æ’å…¥åˆ°å­—å…¸ä¸­ã€‚</p><p>è¿˜æœ‰å½“è¯»å–æ–‡ä»¶å°¾/å­—ç¬¦ä¸²åˆ°è¾¾ç»“å°¾æ—¶ï¼Œæ­¤æ—¶<code>p</code>è¿˜ä¿ç•™ä¹‹å‰çš„å­—ç¬¦ä¸²<code>p=c</code>æˆ–<code>p=p+c</code>ï¼Œè€Œä¸”ä¸€å®šèƒ½åœ¨å­—å…¸ä¸­æ‰¾åˆ°ã€‚è¿™æ˜¯å› ä¸ºå•ä¸ªå­—ç¬¦<code>p=c</code>åœ¨åˆå§‹å­—å…¸tableæ—¶å°±å·²ç»æœ‰å¯¹åº”çš„ä»£ç äº†ï¼Œè€Œ<code>p=p+c</code>è¦æˆç«‹ï¼Œé‚£ä¹ˆå®ƒå¿…é¡»æ˜¯æ’å…¥<code>p+c</code>ä¹‹åæ‰èƒ½å¾—åˆ°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œâ€œè¾“å‡ºâ€æ…¢äºâ€œæ’å…¥â€ã€‚äºæ˜¯ç¼–ç ç»“æŸæ—¶ï¼Œè¿˜è¦å°†å¯¹<code>table[p]</code>å¤„ç†(è¾“å‡º)æ‰ç®—æ˜¯å®Œæ•´çš„LZWç¼–ç ã€‚</p><p>äºæ˜¯ï¼Œå‹ç¼©æ–‡æœ¬ä¸­å¹¶æ²¡æœ‰åŒ…å«åœ¨ç¼–ç è¿‡ç¨‹ä¸­çš„ç”Ÿæˆçš„å­—å…¸ï¼Œè€Œæ˜¯é€šè¿‡ç¼–ç çš„è¿›è¡Œä¸æ–­ç”Ÿæˆæ–°çš„<code>&lt;æ–°å­—ç¬¦ä¸²å‰ç¼€,æ–°çš„ä»£ç &gt;</code>ï¼Œè€Œä¸”æ³¨æ„åˆ°ï¼Œå°†æ–‡æœ¬ç¼–ç åçš„ä»£ç è¾“å‡ºä¹Ÿåªæ˜¯<code>å‰ç¼€å­—ç¬¦ä¸²p</code>ã€‚</p><h3 id="è§£å‹ç¼©decompress"><a class="markdownIt-Anchor" href="#è§£å‹ç¼©decompress"></a> è§£å‹ç¼©decompress</h3><p>ä¸å‹ç¼©å¯¹åº”çš„ä¾¿æ˜¯è§£å‹ç¼©ï¼Œå…¶å®lzwè§£å‹ç¼©ä¸lzwå‹ç¼©æ˜¯äº’é€†çš„ï¼Œä½†è¦ç†è§£å®ƒæ˜¯æ€ä¹ˆå¤„ç†çš„éœ€è¦äº›åŠŸå¤«ã€‚<br />åœ¨å‰é¢çš„å‹ç¼©compressæ—¶ï¼Œå®šä¹‰ä¸€ä¸ªåˆå§‹å­—å…¸ï¼Œä¸”æ˜ å°„å…³ç³»ä¸º&lt;æ–‡æœ¬ä¸²,ä»£ç &gt; =&gt; <code>table&lt;String,Integer&gt;</code>ã€‚åŒæ ·ï¼Œè§£å‹ç¼©ä¹Ÿéœ€è¦ä¸€ä¸ªå­—å…¸ï¼š<code>table&lt;Integer,String&gt;</code>ã€‚<br />ç”±äºè§£ç çš„è¿‡ç¨‹ä¸­ï¼Œè§£ç å™¨å¾—åˆ°çš„æ˜¯ä¸€ä¸ªä»£ç æ•°å­—intï¼Œé‚£å¾—è€ƒè™‘ä»£ç åœ¨ä¸åœ¨å­—å…¸å†…ï¼Œä»¥åŠå¯¹åº”çš„è§£ç æ–‡æœ¬æ˜¯ä»€ä¹ˆã€‚</p><p>é¦–å…ˆéœ€è¦è§„å®šï¼š<code>p</code>è¡¨ç¤ºå½“å‰è¯»å–åˆ°çš„å¾…è§£ç ä¸²<code>S</code>ä¸­æŸä¸€ä¸ªä»£ç ï¼Œå…¶å¯¹åº”çš„æ–‡æœ¬ä¸º<code>text(p)</code>ï¼ˆæˆ–è€…<code>table[p]</code>å¦‚æœå­˜åœ¨çš„è¯ï¼‰ï¼›<code>q</code>è¡¨ç¤ºå‡ºç°äº<code>p</code>ä¹‹å‰çš„ä»£ç ï¼Œå¯ç§°ä¸º<code>å‰ç¼€ä»£ç </code>ï¼Œè€Œä¸”è¯¥ä»£ç <code>q</code>ä¸€å®šå­˜åœ¨å­—å…¸é‡Œï¼Œå…¶å¯¹åº”çš„æ–‡æœ¬ä¸º<code>text(q)</code>ï¼›<code>fc(p)</code>è¡¨ç¤º<code>text(p)</code>çš„ç¬¬ä¸€ä¸ªå­—ç¬¦(first character)ï¼Œå¯ç§°ä¸º<code>åç¼€å­—ç¬¦</code>ã€‚</p><p>è¿˜æ˜¯ä»¥ä¸Šé¢çš„ä¾‹å­æ¥è¯´æ˜ï¼Œå­˜åœ¨å·²ç»ç¼–ç çš„ä»£ç ä¸²<code>0214537</code>ã€‚å›¾ä¸­è¡¨æ ¼é˜´å½±éƒ¨åˆ†è¡¨ç¤ºå°†æ–°çš„&lt;ä»£ç ,æ–‡æœ¬&gt;æ·»åŠ åˆ°å­—å…¸ä¸­ã€‚<br /><img src="/uploads/images/data_structure/lzw_cpp/02.png" alt="" /></p><p>LZWè§£ç è¿‡ç¨‹å¦‚ä¸‹ï¼š<br />1.é¦–å…ˆåˆå§‹åŒ–å­—å…¸ï¼›<br />2.ç„¶åæ‰¾åˆ°<code>S</code>çš„ç¬¬ä¸€ä¸ªä»£ç <code>q</code>ï¼Œè€Œä¸”è¯¥ä»£ç ä¸€å®šå­˜åœ¨å­—å…¸å†…ï¼ˆè¿™æ˜¯ç”±ç¼–ç æ—¶å†³å®šçš„ï¼‰ï¼Œè¾“å‡ºæ–‡æœ¬<code>text(q)</code>ï¼›<br />3.æ¥ç€è¯»å–<code>S</code>çš„ä¸‹ä¸€ä¸ªä»£ç <code>p</code>ï¼›<br />4.å¦‚æœ<code>p</code>åœ¨å­—å…¸é‡Œï¼Œåˆ™è¾“å‡ºå¯¹åº”çš„æ–‡æœ¬<code>text(p)</code>ï¼ŒåŒæ—¶å‘å­—å…¸æ·»åŠ æ–°çš„ä»£ç <code>text(q)fc(p)</code>ï¼›<br />5.å¦‚æœ<code>p</code>ä¸åœ¨å­—å…¸é‡Œï¼Œåˆ™å‘å­—å…¸æ·»åŠ æ–°çš„ä»£ç <code>text(p)=text(q)fc(q)</code>ï¼Œè¾“å‡ºå¯¹åº”çš„æ–‡æœ¬<code>text(p)</code>ï¼›<br />6.é‡å¤æ­¥éª¤3ã€4ã€5ï¼Œç›´åˆ°<code>EOF</code>ï¼›<br />7.ç»“æŸã€‚</p><p>ä¼ªä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">Initialize <span class="hljs-keyword">table</span><br>Q = first <span class="hljs-keyword">input</span> code<br>output <span class="hljs-keyword">table</span>[Q]<br><span class="hljs-keyword">WHILE</span> <span class="hljs-keyword">not</span> EOF<br>    P = next <span class="hljs-keyword">input</span> code<br>    <span class="hljs-keyword">IF</span> P <span class="hljs-type">int</span> <span class="hljs-keyword">table</span><br>        <span class="hljs-keyword">insert</span> TEXT(Q)+FirstCharacter(P) <span class="hljs-keyword">into</span> <span class="hljs-keyword">table</span><br>    <span class="hljs-keyword">ELSE</span><br>        <span class="hljs-keyword">insert</span> TEXT(Q)+FirstCharacter(Q) <span class="hljs-keyword">into</span> <span class="hljs-keyword">table</span><br>    output <span class="hljs-keyword">table</span>[P]<br>    Q=P<br></code></pre></div></td></tr></table></figure><p>1.<code>p</code>åœ¨å­—å…¸é‡Œ<br />ä»¥ä»£ç <code>p=1</code>å’Œä»£ç <code>q=2</code>ä¸ºä¾‹ã€‚<br />ç°åœ¨æ ¹æ®<code>è§£å‹ç¼©</code>çš„æƒ…å†µæ¥åˆ†æï¼šå·²çŸ¥ä»£ç <code>p</code>åœ¨å­—å…¸é‡Œï¼Œè¯´æ˜åœ¨<code>ç¼–ç </code>è¿‡ç¨‹ï¼ˆæ­¤æ—¶pè¡¨ç¤ºä»£ç å¯¹åº”çš„æ–‡æœ¬ï¼‰ä¸­è¾“å‡ºä»£ç <code>table[p]=1</code>ä¹‹å‰çš„æŸä¸€æ­¥éª¤è¾“å‡ºäº†ä»£ç <code>table[q]=2</code>ï¼ŒåŒæ—¶æ·»åŠ æ–°çš„æ–‡æœ¬<code>q+c=aa+b=aab</code>åˆ°å­—å…¸é‡Œä¸”<code>table[q+c]=3</code>ï¼ˆ<font color="red">è¿™ä¹Ÿå°±æ˜¯è§£ç æ—¶çš„text(q)+fcÂ§ï¼Œc=fcÂ§</font>ï¼‰ï¼Œç„¶å<code>q=c=b</code>ï¼›ä¹‹åç»§ç»­åˆ¤æ–­<code>q+c=b+b=bb</code>ä¸åœ¨å­—å…¸å†…ï¼Œåˆ™è¾“å‡º<code>table[q=b]=1</code>ã€‚äºæ˜¯å°±å½¢æˆäº†ä»£ç <code>2 1</code>çš„æƒ…å†µã€‚<br /><img src="/uploads/images/data_structure/lzw_cpp/04.png" alt="" /></p><p>è¿˜æœ‰<code>5 3</code>è¿™ç§æƒ…å†µ<br /><img src="/uploads/images/data_structure/lzw_cpp/03.png" alt="" /></p><p>2.<code>p</code>ä¸åœ¨å­—å…¸é‡Œ<br />è¿™ç§æƒ…å†µåªæœ‰åœ¨æ–‡æœ¬æ®µä¸­å½¢å¼ä¸º<code>text(q)text(q)fc(q)</code>å’Œ<code>text(q)fc(q)</code>ï¼Œä¸”ç›¸åº”çš„å‹ç¼©ä»£ç ä¸²ä¸º<code>qp</code>çš„æ—¶å€™ï¼ˆqpç›¸é‚»ï¼Œè§‚å¯Ÿä¸Šå›¾å¯çŸ¥ï¼‰ï¼Œåªæœ‰åœ¨<code>q</code>è¢«<code>text(q)</code>ä»£æ›¿çš„æƒ…å†µä¸‹ï¼Œä»£ç <code>q</code>åœ¨å­—å…¸ä¸­æ‰ä¸ä¼šæœ‰å¯¹åº”çš„æ–‡æœ¬ï¼Œè€Œè¿™ä¸ªæ–‡æœ¬åº”è¯¥æ˜¯<code>text(q)fc(q)</code>ã€‚æ¯”å¦‚ä¸Šé¢çš„<code>q=3 p=7</code>ä¸”åŸå§‹æ–‡æœ¬æ®µ<code>aab aaba</code>ï¼Œå³<code>text(7)=text(3)fc(3)</code>ï¼›åˆå¦‚<code>q=4 p=5</code>ä¸”åŸå§‹æ–‡æœ¬æ®µ<code>bb bbb</code>ï¼Œå³<code>text(5)=text(4)fc(4)</code>ï¼›è€Œ<code>q=5 p=3</code>çš„åŸå§‹æ–‡æœ¬æ®µä¸º<code>bbb aab</code>ï¼Œä½†æ˜¯æ²¡æœ‰<code>text(3)=text(5)fc(5)=bbbb</code>è¿™ç§æƒ…å†µã€‚è¿™æ˜¯åœ¨ç¼–ç è¿‡ç¨‹ä¸­å†³å®šçš„ã€‚</p><p>è§£ç æ˜¯æ ¹æ®è¯»å–çš„ä»£ç æ¥æ„å»ºä¸€ä¸ªä¸ç¼–ç ä¹‹å‰å®Œå…¨ç›¸åŒçš„å­—å…¸å¹¶è¾“å‡ºå¯¹åº”çš„æ–‡æœ¬ï¼Œè€Œä¸”ä¹Ÿä¸€å®šä¼šå°†æ‰€æœ‰çš„ä»£ç è¯»å–å®Œã€‚</p><p>ä»¥ä¸Šä¾‹å­åªå±•ç¤ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²åªæœ‰aã€bä¸¤ä¸ªå­—ç¬¦ï¼Œä»¥åŠåˆå§‹å­—å…¸ä¸º&lt;a,0&gt;ã€&lt;b,1&gt;ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¸¸è§æ–‡æœ¬æ–‡ä»¶æ˜¯ASCIIæ–‡ä»¶ï¼Œæ‰€ä»¥è¿™æ—¶çš„åˆå§‹å­—å…¸å¤§å°å¯ä»¥æ˜¯256ï¼ŒåŒ…å«äº†æ‰©å±•ASCIIç ã€‚</p><h3 id="code"><a class="markdownIt-Anchor" href="#code"></a> Code</h3><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;unordered_map&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;vector&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">constexpr</span> <span class="hljs-keyword">int</span> ALPHA_MAX=<span class="hljs-number">256</span>;<br>unordered_map&lt;string,<span class="hljs-keyword">int</span>&gt;table;<br>unordered_map&lt;<span class="hljs-keyword">int</span>,string&gt;table2;<br><br><span class="hljs-comment">// ä¿å­˜ç¼–ç ä¹‹åçš„ä»£ç </span><br>vector&lt;<span class="hljs-keyword">int</span>&gt;codes;<br><span class="hljs-comment">// ä¿å­˜è§£ç ä¹‹åçš„æ–‡æœ¬</span><br>string text;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">output</span><span class="hljs-params">(string str)</span></span>&#123;<br>    codes.<span class="hljs-built_in">push_back</span>(table[str]);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">output</span><span class="hljs-params">(<span class="hljs-keyword">int</span> code)</span></span>&#123;<br>    text+=table2[code];<br>&#125;<br><span class="hljs-comment">// ç¼–ç </span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">compress</span><span class="hljs-params">(string source)</span></span>&#123;<br>    <span class="hljs-comment">// åˆå§‹åŒ–å­—å…¸</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; ALPHA_MAX; i++)&#123;<br>        <span class="hljs-function">string <span class="hljs-title">key</span><span class="hljs-params">(<span class="hljs-number">1</span>,<span class="hljs-keyword">char</span>(i))</span></span>;<br>        table.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">make_pair</span>(key,i));<br>    &#125;<br>    <span class="hljs-comment">// å·²ä½¿ç”¨ä»£ç æ•°é‡</span><br>    <span class="hljs-keyword">int</span> usedCode=ALPHA_MAX;<br>    string p=<span class="hljs-string">&quot;&quot;</span>;<br>    string c;<br>    p+=source[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">int</span> len=source.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++) &#123;<br>        c.<span class="hljs-built_in">clear</span>();<br>        c+=source[i];<br>        <span class="hljs-comment">// p+cåœ¨å­—å…¸</span><br>        <span class="hljs-keyword">if</span>(table.<span class="hljs-built_in">find</span>(p+c)!=table.<span class="hljs-built_in">end</span>())&#123;<br>            p=p+c;<br>        <span class="hljs-comment">// p+cä¸åœ¨å­—å…¸</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-built_in">output</span>(p);<br>            table.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">make_pair</span>(p+c,usedCode++));<br>            p=c;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">output</span>(p);<br>&#125;<br><span class="hljs-comment">// è§£ç </span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">uncompress</span><span class="hljs-params">(vector&lt;<span class="hljs-keyword">int</span>&gt;codes)</span></span>&#123;<br>    <span class="hljs-comment">// åˆå§‹åŒ–å­—å…¸</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; ALPHA_MAX; i++)&#123;<br>        <span class="hljs-function">string <span class="hljs-title">text</span><span class="hljs-params">(<span class="hljs-number">1</span>,<span class="hljs-keyword">char</span>(i))</span></span>;<br>        table2.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">make_pair</span>(i,text));<br>    &#125;<br>    <span class="hljs-comment">// å·²ä½¿ç”¨ä»£ç æ•°é‡</span><br>    <span class="hljs-keyword">int</span> usedCode=ALPHA_MAX;<br><br>    <span class="hljs-keyword">int</span> q=codes[<span class="hljs-number">0</span>];<br>    <span class="hljs-built_in">output</span>(q);<br>    <span class="hljs-keyword">int</span> len=codes.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; len; i++)&#123;<br>        <span class="hljs-comment">// è¯»å–ä¸‹ä¸€ä¸ªä»£ç code</span><br>        <span class="hljs-keyword">int</span> p=codes[i];<br>        <span class="hljs-comment">// å½“å‰è¯»å–çš„ä»£ç påœ¨å­—å…¸</span><br>        <span class="hljs-keyword">if</span>(table2.<span class="hljs-built_in">find</span>(p)!=table2.<span class="hljs-built_in">end</span>())&#123;<br>            <span class="hljs-comment">// text(code)=text(q)fc(p)</span><br>            string code=table2[q]+table2[p][<span class="hljs-number">0</span>];<br>            table2.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">make_pair</span>(usedCode++,code));<br>        <span class="hljs-comment">// å½“å‰è¯»å–çš„ä»£ç pä¸åœ¨å­—å…¸</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-comment">// text(p)=text(q)fc(q)</span><br>            string pT=table2[q]+table2[q][<span class="hljs-number">0</span>];<br>            table2.<span class="hljs-built_in">insert</span>(<span class="hljs-built_in">make_pair</span>(usedCode++,pT));<br>        &#125;<br>        q=p;<br>        <span class="hljs-built_in">output</span>(p);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    ifstream in;<br>    in.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;test.txt&quot;</span>,ios_base::binary);<br>    string text=<span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">char</span> c;<br>    <span class="hljs-keyword">while</span>((c=in.<span class="hljs-built_in">get</span>())!=EOF)&#123;<br>        text+=c;<br>    &#125;<br>    <span class="hljs-built_in">compress</span>(text);<br>    in.<span class="hljs-built_in">close</span>();<br><br>    ofstream out;<br>    out.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;test.txt.lzw&quot;</span>,ios_base::binary);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> x:codes)&#123;<br>        out.<span class="hljs-built_in">put</span>(x);<br>    &#125;<br>    out.<span class="hljs-built_in">close</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æµ‹è¯•ä¸€ä¸ªASCIIæ–‡ä»¶<br /><img src="/uploads/images/data_structure/lzw_cpp/05.png" alt="" /></p><p>åˆæµ‹è¯•ä¸€ä¸ªæ–‡ä»¶å…¶æœ€åå‹ç¼©æ—¶ç”Ÿæˆçš„å­—å…¸<br /><img src="/uploads/images/data_structure/lzw_cpp/06.png" alt="" /></p><p>C++ä¸­charæ•°ç»„å­˜å‚¨ä¸­æ–‡æ—¶ï¼Œå¦‚æœå–å…¶ä¸­ä¸€ä¸ªcharçš„è¯ï¼Œç”±äºcharå ç”¨1ä¸ªå­—èŠ‚ï¼Œä½¿å¾—ä¸­æ–‡å‘ç”Ÿæˆªæ–­ï¼ˆè¢«åˆ†è§£ï¼‰ï¼Œæ¯”å¦‚<code>string s=&quot;ä½ å¥½&quot;;</code> ä¸è¿‡ä¸Šé¢çš„æµ‹è¯•ä¾ç„¶å¯ä»¥é€šè¿‡ï¼Œåªè¦åœ¨ç¼–ç è¿‡ç¨‹ä¸­å°†è¢«æˆªæ–­çš„æ‰€æœ‰charä¾æ¬¡å†™å…¥ç¼–ç æ–‡ä»¶ä¸­ï¼Œåœ¨è§£ç æ—¶æŒ‰ç…§åŒæ ·çš„è§„åˆ™å»è¯»å–charï¼Œæœ€åè¿˜æ˜¯å¯ä»¥è§£ç æˆåŠŸçš„ã€‚<br /><img src="/uploads/images/data_structure/lzw_cpp/07.png" alt="" /></p><p>å°±è¿™æ ·å§ï¼Œç­‰æœ‰ç©ºå†æ¥æ›´æ–°æ›´æ–°â€¦</p><h3 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h3><p>ã€Šæ•°æ®ç»“æ„ã€ç®—æ³•ä¸åº”ç”¨ã€‹<br /><a href="https://en.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Welch">Lempelâ€“Zivâ€“Welch</a><br /><a href="https://segmentfault.com/a/1190000011425787?utm_medium=referral&amp;utm_source=tuicool">LZWå‹ç¼©ç®—æ³•åŸç†è§£æ</a></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>DataStructures</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CentOS+TinyProxy+Stunnelé…ç½®HTTPä»£ç†æœåŠ¡å™¨</title>
    <link href="/linux-tinyproxy/"/>
    <url>/linux-tinyproxy/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡å°†åˆ©ç”¨CentOSã€TinyProxyã€Stunnelæ­å»ºä¸€ä¸ªæ­£å‘ä»£ç†æœåŠ¡å™¨â€¦</p><span id="more"></span><p>ä¹‹å‰çš„ <a href="https://www.joxrays.com/centos-shadowsocks/">CentOSæœåŠ¡å™¨Shadowsocks</a> æ˜¯åœ¨CentOS7ä¸Šé…ç½®Shadowsockså°†å…¶ä½œä¸ºä»£ç†æœåŠ¡å™¨ï¼Œè€Œè¿™æ¬¡çš„tinyproxyé…ç½®åŒæ ·ä¹Ÿæ˜¯æŠŠCentOS7ä½œä¸ºä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œè€Œä¸”SSæ˜¯åŸºäºSocks5åè®®ï¼Œtinyproxyæ˜¯HTTP/HTTPSåè®®ã€‚</p><h3 id="tinyproxy"><a class="markdownIt-Anchor" href="#tinyproxy"></a> TinyProxy</h3><p>TinyProxyæ˜¯ä¸€ä¸ªç”±Cè¯­è¨€å¼€å‘ã€å¼€æºã€è½»é‡çº§çš„HTTP/HTTPSä»£ç†æœåŠ¡å™¨ <a href="https://github.com/tinyproxy/tinyproxy">Github</a></p><blockquote><p>Tinyproxy is a light-weight HTTP/HTTPS proxy daemon for POSIX operating systems. Designed from the ground up to be fast and yet small, it is an ideal solution for use cases such as embedded deployments where a full featured HTTP proxy is required, but the system resources for a larger proxy are unavailable.</p></blockquote><p>tinyproxyæ¯”squidé…ç½®è¦ç®€å•ï¼Œä½†squidåŠŸèƒ½å´æ¯”tinyproxyè¦å¤šä¸”çµæ´»æ€§é«˜ã€‚ä¸è¿‡æˆ‘å¯¹squidä¸æ˜¯å¾ˆæ·±å…¥äº†è§£ï¼Œæš‚æ—¶å°±æ‹¿tinyproxyæ¥è¯´å§ã€‚<br />ç”±äºæˆ‘çš„æœåŠ¡å™¨æ˜¯CentOS7ï¼Œæ•…å¯ç›´æ¥ä»åŒ…ç®¡ç†å™¨å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">[root@VM_0_17_centos ~]<span class="hljs-comment"># yum install -y tinyproxy</span><br></code></pre></div></td></tr></table></figure><p>è‹¥åŒ…ç®¡ç†å™¨ä¸­æ²¡æœ‰tinyproxyï¼Œé‚£ä¹ˆ</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">yum install -y epel-release<br>yum update -y<br>yum -y install tinyproxy<br></code></pre></div></td></tr></table></figure><p>ä¹‹åå°±æ˜¯é…ç½®tinyproxyäº†</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">[root@VM_0_17_centos ~]<span class="hljs-comment"># vim /etc/tinyproxy/tinyproxy.conf</span><br></code></pre></div></td></tr></table></figure><p>ä¿®æ”¹tinyproxyç›‘å¬ç«¯å£<code>Port</code>ï¼Œé»˜è®¤ <code>8888</code><br />æ³¨é‡Š<code>Allow</code>å‚æ•°ï¼Œè¡¨ç¤ºå…è®¸æ‰€æœ‰äººéƒ½å¯ä»¥è®¿é—®ä»£ç†æœåŠ¡å™¨ã€‚å¦‚æœåªå¸Œæœ›æŒ‡å®šçš„IPèƒ½å¤Ÿè®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå¯ä»¥æ·»åŠ å¤šä¸ª<code>Allow</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">Port 8888<br><span class="hljs-comment">#Allow 127.0.0.1</span><br>Allow 10.10.6.0/24<br>Allow 123.200.123.66<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ <code>#DisableViaHeader Yes</code> è¿™ä¸ªå‚æ•°ï¼Œç”¨äºæŒ‡å®šæ˜¯å¦åœ¨è¯·æ±‚Headerä¸­æ˜¾ç¤ºtinyproxyç›¸å…³ä¿¡æ¯ï¼ˆæ¯”å¦‚ï¼š<code>Proxy-agent: tinyproxy/1.8.3</code>ï¼‰ï¼Œé»˜è®¤æ˜¯å…³é—­çš„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment">#</span><br><span class="hljs-comment"># ViaProxyName: The &quot;Via&quot; header is required by the HTTP RFC, but using</span><br><span class="hljs-comment"># the real host name is a security concern.  If the following directive</span><br><span class="hljs-comment"># is enabled, the string supplied will be used as the host name in the</span><br><span class="hljs-comment"># Via header; otherwise, the server&#x27;s host name will be used.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#ViaProxyName &quot;tinyproxy&quot;</span><br><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># DisableViaHeader: When this is set to yes, Tinyproxy does NOT add</span><br><span class="hljs-comment"># the Via header to the requests. This virtually puts Tinyproxy into</span><br><span class="hljs-comment"># stealth mode. Note that RFC 2616 requires proxies to set the Via</span><br><span class="hljs-comment"># header, so by enabling this option, you break compliance.</span><br><span class="hljs-comment"># Don&#x27;t disable the Via header unless you know what you are doing...</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#DisableViaHeader Yes</span><br></code></pre></div></td></tr></table></figure><p>å…¶ä»–å‚æ•°é»˜è®¤å³å¯ï¼Œä¹‹åå°±æ˜¯å¯åŠ¨tinyproxy</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">[root@VM_0_17_centos ~]<span class="hljs-comment"># systemctl start tinyproxy.service</span><br>[root@VM_0_17_centos ~]<span class="hljs-comment"># systemctl enable tinyproxy.service</span><br></code></pre></div></td></tr></table></figure><p>é…ç½®iptables</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># å…è®¸è®¿é—®</span><br>iptables -I INPUT -p tcp --dport 8888 -j ACCEPT<br><span class="hljs-comment"># æ‹’ç»è®¿é—®</span><br>iptables -I INPUT -p tcp --dport 8888 -j REJECT<br></code></pre></div></td></tr></table></figure><p>å¯èƒ½è¿˜éœ€è¦é…ç½®äº‘æœåŠ¡å™¨å®‰å…¨ç»„å¤–ç•Œæ‰èƒ½è®¿é—®tinyproxyç«¯å£</p><p>ä¹‹åå°±èƒ½å¤Ÿç›´æ¥é€šè¿‡è¯¥ä»£ç†æœåŠ¡å™¨è¿›è¡Œä»£ç†è®¿é—®äº†</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">% curl -x 129.204.152.8:8888 https://ip.cn --head<br>HTTP/1.0 200 Connection established<br>Proxy-agent: tinyproxy/1.8.3<br><br>HTTP/2 200 <br>date: Mon, 17 Feb 2020 02:08:20 GMT<br>content-type: application/json; charset=UTF-8<br>set-cookie: __cfduid=d404e02d9f8749f3815ce40da97e29bbf1581905300; expires=Wed, 18-Mar-20 02:08:20 GMT; path=/; domain=.ip.cn; HttpOnly; SameSite=Lax<br>cf-cache-status: DYNAMIC<br>expect-ct: max-age=604800, report-uri=<span class="hljs-string">&quot;https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct&quot;</span><br>server: cloudflare<br>cf-ray: 5664367e282eeba9-LAX<br></code></pre></div></td></tr></table></figure><p>å½“ç„¶ä¹Ÿå¯ä»¥ <code>curl -x 129.204.152.8:8888 https://ip.cn --head -k</code>ï¼Œå³å…è®¸curlä½¿ç”¨éå®‰å…¨çš„sslè¿æ¥å¹¶ä¸”ä¼ è¾“æ•°æ®ï¼ˆè¯ä¹¦ä¸å—ä¿¡ï¼‰ã€‚<br />æ³¨æ„ <code>Proxy-agent: tinyproxy/1.8.3</code> ï¼Œä¹‹å‰æˆ‘ä»¬å¹¶æ²¡æœ‰æ³¨é‡Š <code>#DisableViaHeader Yes</code>ï¼Œå®ƒä¼šåœ¨Viaè¯·æ±‚ä¸­æ˜¾ç¤ºä»£ç†ä¿¡æ¯ã€‚<br />æŸ¥çœ‹æ—¥å¿—log <code>tail /var/log/tinyproxy/tinyproxy.log</code>ã€‚</p><p>ç„¶è€Œäº‹æƒ…å¹¶æ²¡æœ‰ç»“æŸâ€¦</p><h3 id="stunneléš§é“"><a class="markdownIt-Anchor" href="#stunneléš§é“"></a> Stunnel(éš§é“)</h3><blockquote><p>Stunnelæ˜¯ä¸€ä¸ªè‡ªç”±çš„è·¨å¹³å°è½¯ä»¶ï¼Œç”¨äºæä¾›å…¨å±€çš„TLS/SSLæœåŠ¡ã€‚é’ˆå¯¹æœ¬èº«æ— æ³•è¿›è¡ŒTLSæˆ–SSLé€šä¿¡çš„å®¢æˆ·ç«¯åŠæœåŠ¡å™¨ï¼ŒStunnelå¯æä¾›å®‰å…¨çš„åŠ å¯†è¿æ¥ã€‚</p></blockquote><p>å¦‚æœç”¨ä»£ç†æœåŠ¡å™¨è®¿é—®ä¸€ä¸ªHTTPåè®®çš„ç½‘ç«™ï¼Œé‚£ä¹ˆä¼ è¾“çš„æ•°æ®æ˜¯ä¸ä¼šåŠ å¯†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è¢«æŠ“åŒ…è½¯ä»¶è·å–æ•°æ®åŒ…ï¼Œæ¯”å¦‚Wiresharkã€‚æˆ‘åœ¨æœåŠ¡å™¨é…ç½®äº†Apacheï¼Œå¼€å¯80ç«¯å£ï¼Œæ¯”å¦‚è¿™æ ·ä¸€ä¸ªHTTP ULRï¼š <a href="http://129.204.152.8:80">http://129.204.152.8:80</a>ã€‚<br /><code>curl -x 129.204.152.8:8888 http://129.204.152.8 -v</code><br /><img src="/uploads/images/tinyproxy_stunnel/01.png" alt="" /></p><p>å¯è§æ•°æ®æ²¡æœ‰åŠ å¯†ï¼Œè€Œæ˜¯ç›´æ¥åœ¨ä¸¤å°ä¸»æœºé—´ä¼ è¾“ï¼Œæˆ‘ä»¬å¸Œæœ›HTTPä¼ è¾“ä¹Ÿæ˜¯å®‰å…¨çš„ï¼Œä¹Ÿå°±æ˜¯ç»è¿‡åŠ å¯†çš„ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨Stunnelå’ŒTinyProxyæ¥æ··æ·†HTTPæµé‡ã€‚</p><p>CentOSå®‰è£…Stunnel <code>yum install -y stunnel</code></p><h4 id="é…ç½®æœåŠ¡ç«¯server"><a class="markdownIt-Anchor" href="#é…ç½®æœåŠ¡ç«¯server"></a> é…ç½®æœåŠ¡ç«¯Server</h4><p><code>vim /etc/stunnel/stunnel.conf</code>ï¼Œå¦‚æœstunnel.confä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæ–°å»ºä¸€ä¸ªå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">[tinyproxy]<br>accept = 0.0.0.0:3128<br>connect = 0.0.0.0:8888<br>cert = /etc/ssl/cert.pem<br>key = /etc/ssl/key.pem<br></code></pre></div></td></tr></table></figure><ul><li>accept æœåŠ¡å™¨stunnelç›‘å¬ç«¯å£ï¼Œç”¨äºä¸å®¢æˆ·ç«¯è¿›è¡Œè¿æ¥</li><li>connect ç”¨äºå‘Šè¯‰stunnelè¦è¿æ¥çš„IPå’Œç«¯å£ã€‚è¿™éœ€è¦æ˜¯TinyProxyç›‘å¬çš„IPå’Œç«¯å£ï¼Œ<code>netstat -anpl|grep tinyproxy</code>å¯çœ‹åˆ°</li><li>cert æœ¬åœ°è¯ä¹¦æ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥ç”¨<code>openssl</code>ç”Ÿæˆ</li><li>key æœ¬åœ°å¯†åŒ™æ–‡ä»¶è·¯å¾„</li></ul><h5 id="åˆ›å»ºè‡ªç­¾åè¯ä¹¦"><a class="markdownIt-Anchor" href="#åˆ›å»ºè‡ªç­¾åè¯ä¹¦"></a> åˆ›å»ºè‡ªç­¾åè¯ä¹¦</h5><p>è¦å¯åŠ¨stunnelï¼Œé‚£è¿˜éœ€è¦åˆ›å»ºè‡ªç­¾åè¯ä¹¦ã€‚</p><p>ç”Ÿæˆkey.pem</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">[root@VM_0_17_centos ~]<span class="hljs-comment"># openssl genrsa -out /etc/ssl/key.pem 4096</span><br>Generating RSA private key, 4096 bit long modulus<br>......................................................................++<br>..............................................................++<br>e is 65537 (0x10001)<br></code></pre></div></td></tr></table></figure><p>è¿™å°†åˆ›å»ºä¸€ä¸ª<code>4096</code>ä½RSAå¯†é’¥<code>key.pem</code>ã€‚æœ‰å…´è¶£çš„å¯ä»¥äº†è§£ä¸‹<a href="https://danielpocock.com/rsa-key-sizes-2048-or-4096-bits/">&quot;RSA Key Sizes: 2048 or 4096 bits?&quot;</a></p><p>ç”Ÿæˆcert.pem</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">[root@VM_0_17_centos ~]<span class="hljs-comment"># openssl req -new -x509 -key /etc/ssl/key.pem -out /etc/ssl/cert.pem -days 1826</span><br>You are about to be asked to enter information that will be incorporated<br>into your certificate request.<br>What you are about to enter is what is called a Distinguished Name or a DN.<br>There are quite a few fields but you can leave some blank<br>For some fields there will be a default value,<br>If you enter <span class="hljs-string">&#x27;.&#x27;</span>, the field will be left blank.<br>-----<br>Country Name (2 letter code) [XX]:US<br>State or Province Name (full name) []:Arizona<br>Locality Name (eg, city) [Default City]:Phoenix<br>Organization Name (eg, company) [Default Company Ltd]:<br>Organizational Unit Name (eg, section) []:<br>Common Name (eg, your name or your server<span class="hljs-string">&#x27;s hostname) []:VM_0_17_centos</span><br><span class="hljs-string">Email Address []:helloworld@example.com          </span><br><span class="hljs-string">[root@VM_0_17_centos ~]# ls -lh /etc/ssl/</span><br><span class="hljs-string">total 8.0K</span><br><span class="hljs-string">-rw-r--r-- 1 root root 2.1K Feb 17 11:03 cert.pem</span><br><span class="hljs-string">lrwxrwxrwx 1 root root   16 Feb  6 11:56 certs -&gt; ../pki/tls/certs</span><br><span class="hljs-string">-rw-r--r-- 1 root root 3.2K Feb 17 10:55 key.pem</span><br></code></pre></div></td></tr></table></figure><ul><li>new x509 åˆ›å»ºä¸€ä¸ªæ–°çš„X509è¯ä¹¦</li><li>days è¯ä¹¦çš„æœ‰æ•ˆæœŸ</li><li>key å¯†åŒ™æ–‡ä»¶</li><li>out è¾“å‡ºåˆ°cert.pem</li></ul><p>ç”Ÿæˆçš„åŒæ—¶è¿˜è¦å›ç­”ä¸€äº›é—®é¢˜</p><ul><li>Country Name å›½å®¶ (PL,UK,US,CA)</li><li>State or Province Name å·æˆ–çœ (Illinois,Ontario,â€¦)</li><li>Locality Name åœ°åŒº (Chicago,Toronto,â€¦)</li><li>Organization Name ç»„ç»‡</li><li>Organizational Unit Name ç»„ç»‡å•ä½</li><li>Common Name (your name or your serverâ€™s hostname) ä¸€èˆ¬æœåŠ¡å™¨hostname</li><li>Email Address ç”µå­é‚®ä»¶</li></ul><p>å¯åŠ¨stunnel <code>stunnel /etc/stunnel/stunnel.conf</code></p><figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir">[root<span class="hljs-variable">@VM_0_17_centos</span> ~]<span class="hljs-comment"># netstat -antpl|grep stunnel</span><br>tcp        0      0 0.0.0.0<span class="hljs-symbol">:</span><span class="hljs-number">3128</span>            0.0.0.0<span class="hljs-symbol">:*</span>               LISTEN      <span class="hljs-number">24263</span>/stunnel<br></code></pre></div></td></tr></table></figure><h4 id="é…ç½®å®¢æˆ·ç«¯client"><a class="markdownIt-Anchor" href="#é…ç½®å®¢æˆ·ç«¯client"></a> é…ç½®å®¢æˆ·ç«¯Client</h4><p>é…ç½®å®ŒæœåŠ¡å™¨è¿˜éœ€è¦é…ç½®æœ¬åœ°å®¢æˆ·ç«¯ï¼Œå°±æ‹¿Arch/Manjaroä¸¾ä¾‹ã€‚<br />å®‰è£…stunnel <code>pacman -S stunnel</code></p><p><code>cp /etc/stunnel/stunnel.conf-sample /etc/stunnel/stunnel.conf</code><br /><code>vim /etc/stunnel/stunnel.conf</code><br />ç¼–è¾‘é…ç½®æ–‡ä»¶stunnel.confå¯ä»¥å…¨éƒ¨åˆ é™¤åªæ·»åŠ ä»¥ä¸‹å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">[tinyproxy]<br>client = yes<br>accept = 0.0.0.0:3129<br>connect = 129.204.152.8:3128<br>verify = 3<br>CAfile = /etc/stunnel/cert.pem<br></code></pre></div></td></tr></table></figure><ul><li>client è¡¨æ˜è¿™æ˜¯å®¢æˆ·ç«¯</li><li>accept æœ¬åœ°stunnelç›‘å¬ipåœ°å€+ç«¯å£ 0.0.0.0:xxxx</li><li>connect è¦è¿æ¥åˆ°è¿œç¨‹stunnelæœåŠ¡å™¨</li><li>verify  è¯ä¹¦éªŒè¯çº§åˆ«ï¼Œverify=3æ ¹æ®æœ¬åœ°å®‰è£…çš„è¯ä¹¦å¹¶éªŒè¯è¯ä¹¦</li><li>CAfile æœåŠ¡å™¨ä¸Šç”Ÿæˆçš„<code>cert.pem</code>ï¼Œå°†å…¶å¤åˆ¶åˆ°æœ¬åœ°/etc/stunnel/cert.pem</li></ul><p>ä¹‹åå°±å¯ä»¥å¯åŠ¨stunneläº†ï¼Œ<code>stunnel /etc/stunnel/stunnel.conf</code>ï¼Œä¹Ÿå¯ä»¥ <code>systemctl start stunnel.service</code>ã€<code>systemctl enable stunnel.service</code></p><h5 id="æµ‹è¯•"><a class="markdownIt-Anchor" href="#æµ‹è¯•"></a> æµ‹è¯•</h5><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">% curl -x 127.0.0.1:3129 https://ip.cn --head<br>HTTP/1.0 200 Connection established<br>Proxy-agent: tinyproxy/1.8.3<br><br>HTTP/2 200 <br>date: Mon, 17 Feb 2020 03:58:29 GMT<br>content-type: application/json; charset=UTF-8<br>set-cookie: __cfduid=d340c54d6fa045689f6f49e91ac7f918f1581911909; expires=Wed, 18-Mar-20 03:58:29 GMT; path=/; domain=.ip.cn; HttpOnly; SameSite=Lax<br>cf-cache-status: DYNAMIC<br>expect-ct: max-age=604800, report-uri=<span class="hljs-string">&quot;https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct&quot;</span><br>server: cloudflare<br>cf-ray: 5664d7d91e5d77b8-LAX<br></code></pre></div></td></tr></table></figure><p><code>curl -x 127.0.0.1:3129 http://129.204.152.8 -v</code><br /><img src="/uploads/images/tinyproxy_stunnel/02.png" alt="" /></p><p>å¯è§æˆåŠŸçš„æ­å»ºäº†ä¸€ä¸ªåŸºäºTLSçš„HTTP/HTTPSä»£ç†ã€‚</p><h3 id="windows-stunnel"><a class="markdownIt-Anchor" href="#windows-stunnel"></a> Windows Stunnel</h3><p>å¯¹äºWindowsç³»ç»Ÿï¼Œå¯ä»¥ä» <a href="https://www.stunnel.org/downloads.html">https://www.stunnel.org/downloads.html</a> ä¸‹è½½Windowsç‰ˆæœ¬çš„stunnelï¼Œé¦–æ¬¡å¯åŠ¨stunnelè¦å›ç­”ä¸€äº›é—®é¢˜æ¥åˆ›å»ºé»˜è®¤çš„<code>stunnel.pem</code>ã€‚<br />ç°åœ¨å°†æœåŠ¡å™¨ç”Ÿæˆçš„<code>cert.pem</code>å¤åˆ¶åˆ°Windows stunnelé…ç½®æ–‡ä»¶ç›®å½•ã€‚<br /><img src="/uploads/images/tinyproxy_stunnel/03.png" alt="" /></p><p>ç„¶åç¼–è¾‘é…ç½®æ–‡ä»¶<code>stunnel.conf</code>ã€‚</p><figure class="highlight ini"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ini"><span class="hljs-attr">debug</span> = info<br><span class="hljs-attr">output</span> = stunnel.log<br><br><span class="hljs-section">[tinyproxy]</span><br><span class="hljs-attr">client</span> = <span class="hljs-literal">yes</span><br><span class="hljs-attr">accept</span> = <span class="hljs-number">6666</span><br><span class="hljs-attr">connect</span> = <span class="hljs-number">129.204</span>.<span class="hljs-number">152.8</span>:<span class="hljs-number">3128</span><br><span class="hljs-comment">;CAfile = cert.pem</span><br><span class="hljs-attr">cert</span> = cert.pem<br><span class="hljs-attr">key</span> = cert.pem<br><span class="hljs-attr">verify</span> = <span class="hljs-number">3</span><br></code></pre></div></td></tr></table></figure><p>æœ€åå¯åŠ¨stunnelï¼ŒæˆåŠŸã€‚<br /><img src="/uploads/images/tinyproxy_stunnel/04.png" alt="" /></p><p>stunnelå®˜ç½‘åœ¨çº¿å¸®åŠ©æ‰‹å†Œ: <a href="https://www.stunnel.org/static/stunnel.html">https://www.stunnel.org/static/stunnel.html</a><br />ä»¥ä¸Šä¾¿æ˜¯ä»£ç†æœåŠ¡å™¨çš„é…ç½®ï½</p><h3 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h3><p><a href="https://github.com/tinyproxy/tinyproxy/wiki">Tinyproxy Wiki</a><br /><a href="http://kb.ictbanking.net/article.php?id=380">Using stunnel and TinyProxy to obfuscate HTTP traffic</a><br /><a href="https://blog.csdn.net/qq_39702947/article/details/87714520">Windowsç³»ç»ŸStunnelä½¿ç”¨ç®€ä»‹</a></p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>CentOS</tag>
      
      <tag>TinyProxy</tag>
      
      <tag>HTTP</tag>
      
      <tag>HTTPS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Manjaro/Archç¦ç”¨ç‹¬æ˜¾</title>
    <link href="/linux-ban-nvidia/"/>
    <url>/linux-ban-nvidia/</url>
    
    <content type="html"><![CDATA[<p>ç”±äºæœ¬äººç¬”è®°æœ¬æ˜¯åŒæ˜¾å¡çš„ï¼Œæ›¾å‡ åº¦å°è¯•å®‰è£…é—­æºNVIDIAé©±åŠ¨ï¼ˆä¸ºäº†hashcatï¼‰ï¼Œç„¶è€Œæ¯æ¬¡ä»¥å¤±è´¥å‘Šç»ˆï¼Œè€Œç³»ç»Ÿè‡ªå¸¦çš„å¼€æºnouveaué©±åŠ¨å®åœ¨å¤ªå‘äº†ï¼Œç³»ç»Ÿæ€»æ˜¯ä¼šå‡ºç°ä¸€äº›è«åå…¶å¦™çš„bugï¼Œå¿æ— å¯å¿ä¹‹ä¸‹å¹²è„†ç¦æ‰ç‹¬æ˜¾ï¼Œåªç”¨æ ¸æ˜¾å¾—äº†ã€‚</p><span id="more"></span><h3 id="bbswitch"><a class="markdownIt-Anchor" href="#bbswitch"></a> bbswitch</h3><p>é¦–å…ˆéœ€è¦å®‰è£…bbswitchæ¨¡å—ï¼Œç”¨äºåˆ‡æ¢æ˜¾å¡</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">pacman bbswitch<br><br><span class="hljs-comment"># åŠ è½½æ¨¡å—</span><br>modprobe bbswitch<br><span class="hljs-comment"># å¸è½½æ¨¡å—</span><br>rmmod bbswitch<br></code></pre></div></td></tr></table></figure><h3 id="ç¦ç”¨ç‹¬æ˜¾"><a class="markdownIt-Anchor" href="#ç¦ç”¨ç‹¬æ˜¾"></a> ç¦ç”¨ç‹¬æ˜¾</h3><p>é¦–å…ˆæŸ¥çœ‹å½“å‰ç³»ç»Ÿæ˜¯å¦å·²ç»ç¦ç”¨ç‹¬æ˜¾</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">cat /proc/acpi/bbswitch<br>0000:01:00.0 OFF<br></code></pre></div></td></tr></table></figure><p>OFFè¯´æ˜ç›®å‰å·²ç»ç¦æ‰ç‹¬æ˜¾äº†ï¼Œå¦‚æœä¸ä¸ºOFFï¼Œé‚£ä¹ˆéœ€è¦å°†å…¶å…³é—­</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># å…³é—­ç‹¬æ˜¾</span><br>tee /proc/acpi/bbswitch &lt;&lt;&lt; <span class="hljs-string">OFF</span><br><span class="hljs-string"># æ‰“å¼€ç‹¬æ˜¾</span><br><span class="hljs-string">tee /proc/acpi/bbswitch &lt;&lt;&lt; ON</span><br></code></pre></div></td></tr></table></figure><p>ä¹‹åè¿˜éœ€è¦å‘Šè¯‰ç³»ç»Ÿï¼šmodprobeåŠ è½½bbswitchæ—¶å…³é—­ç‹¬æ˜¾(load_state=0)ï¼Œå¸è½½bbswitchæ—¶æ‰“å¼€ç‹¬æ˜¾(unload_state=1)</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">nano /etc/modprobe.d/bbswitch.conf<br>options bbswitch load_state=0 unload_state=1<br></code></pre></div></td></tr></table></figure><h3 id="nouveauåˆ—å…¥blacklist"><a class="markdownIt-Anchor" href="#nouveauåˆ—å…¥blacklist"></a> nouveauåˆ—å…¥blacklist</h3><p>æ‰§è¡Œ<code>tee /proc/acpi/bbswitch &lt;&lt;&lt; OFF</code>åè¿˜éœ€è¦å°†nouveauåˆ—å…¥é»‘åå•ï¼Œé˜²æ­¢å®ƒåå°è¿è¡Œã€‚<br />åœ¨<code>blacklist.conf</code>æ·»åŠ <code>blacklist nouveau</code>ç¦ç”¨nouveau</p><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">nano /etc/modprobe.d/blacklist.conf<br>blacklist nouveau<br></code></pre></div></td></tr></table></figure><p>åœ¨ä¸‹ä¸€æ¬¡é‡å¯<code>lspci</code>å°±å¯ä»¥çœ‹åˆ°<code>rev ff</code>è¡¨ç¤ºç‹¬æ˜¾å·²ç»å…³é—­äº†ï¼Œæˆ–è€…<code>dmesg|grep -i nouveau</code>æŸ¥çœ‹æ˜¯å¦å«æœ‰nouveauçš„å†…å®¹</p><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">01:00.0 3D controller: NVIDIA Corporation GP108BM [GeForce MX250] (rev ff)<br></code></pre></div></td></tr></table></figure><h3 id="rclocal"><a class="markdownIt-Anchor" href="#rclocal"></a> rc.local</h3><p>å°†ä»¥ä¸Šæ“ä½œè®¾ç½®ä¸€ä¸ªç³»ç»Ÿå¯åŠ¨æœåŠ¡ï¼Œè¿™æ ·åœ¨æ¯æ¬¡å¼€æœºæ—¶å°±èƒ½å¤Ÿå…³é—­ç‹¬æ˜¾äº†ã€‚åŸºäºArchlinux systemdå†™ä¸€ä¸ªæœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">nano /etc/systemd/system/rc-local.service<br>[Unit]<br>Description=<span class="hljs-string">&quot;/etc/rc.local Compatibility&quot;</span> <br><br>[Service]<br>Type=forking<br>ExecStart=/etc/rc.local start<br>TimeoutSec=0<br>StandardInput=tty<br>RemainAfterExit=yes<br>SysVStartPriority=99<br><br>[Install]<br>WantedBy=multi-user.target<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­<code>/etc/rc.local</code>å°±æ˜¯è¦æ‰§è¡Œshellçš„å¯åŠ¨è„šæ­¥ï¼Œå¼€æœºæ—¶è®©modprobeåŠ è½½bbswitch</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/sh</span><br>modprobe bbswitch<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ä¸€å®šè¦èµ‹äºˆrc.localæ‰§è¡Œæƒé™ <code>chmod +x /etc/rc.local</code>ï¼Œæœ€åå°†æœåŠ¡<code>rc-local</code>è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨ <code>systemctl enable rc-local.service</code>ã€‚</p><p>é‡å¯è®¡ç®—æœºå<code>systemctl status rc-local.service</code> æŸ¥çœ‹rc-localæœåŠ¡çŠ¶æ€ã€‚</p><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">â— rc-<span class="hljs-built_in">local</span>.service - <span class="hljs-string">&quot;/etc/rc.local Compatibility&quot;</span><br>   Loaded: loaded (/etc/systemd/<span class="hljs-keyword">system</span>/rc-<span class="hljs-built_in">local</span>.service; enabled; vendor preset: disabled)<br>   Active: active (exited) since Fri <span class="hljs-number">2020</span><span class="hljs-number">-02</span><span class="hljs-number">-14</span> <span class="hljs-number">09</span>:<span class="hljs-number">55</span>:<span class="hljs-number">13</span> CST; <span class="hljs-number">4</span>h <span class="hljs-number">35</span><span class="hljs-built_in">min</span> ago<br>    Tasks: <span class="hljs-number">0</span> (limit: <span class="hljs-number">4915</span>)<br>   Memory: <span class="hljs-number">0</span>B<br>   CGroup: /<span class="hljs-keyword">system</span>.slice/rc-<span class="hljs-built_in">local</span>.service<br><br><span class="hljs-number">2</span>æœˆ <span class="hljs-number">14</span> <span class="hljs-number">09</span>:<span class="hljs-number">55</span>:<span class="hljs-number">13</span> <span class="hljs-keyword">system</span> systemd[<span class="hljs-number">1</span>]: Starting <span class="hljs-string">&quot;/etc/rc.local Compatibility&quot;</span>...<br><span class="hljs-number">2</span>æœˆ <span class="hljs-number">14</span> <span class="hljs-number">09</span>:<span class="hljs-number">55</span>:<span class="hljs-number">13</span> <span class="hljs-keyword">system</span> systemd[<span class="hljs-number">1</span>]: Started <span class="hljs-string">&quot;/etc/rc.local Compatibility&quot;</span>.<br><span class="hljs-number">2</span>æœˆ <span class="hljs-number">14</span> <span class="hljs-number">10</span>:<span class="hljs-number">07</span>:<span class="hljs-number">31</span> <span class="hljs-keyword">system</span> systemd[<span class="hljs-number">1</span>]: /etc/systemd/<span class="hljs-keyword">system</span>/rc-<span class="hljs-built_in">local</span>.service:<span class="hljs-number">10</span>: Support <span class="hljs-keyword">for</span> option SysVStartPriority= has bee&gt;<br><span class="hljs-keyword">lines</span> <span class="hljs-number">1</span><span class="hljs-number">-10</span>/<span class="hljs-number">10</span> (END)<br></code></pre></div></td></tr></table></figure><h3 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h3><p><a href="https://xuchen.wang/archives/archbbswitch.html">Archä¸‹ä½¿ç”¨bbswitchå½»åº•ç¦ç”¨åŒæ˜¾å¡ç¬”è®°æœ¬çš„ç‹¬ç«‹æ˜¾å¡</a><br /><a href="https://superuser.com/questions/278396/systemd-does-not-run-etc-rc-local">systemd does not run /etc/rc.local?</a></p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äºŒå‰å †-å †æ’åº</title>
    <link href="/binaryheap-cpp/"/>
    <url>/binaryheap-cpp/</url>
    
    <content type="html"><![CDATA[<p>å †æ˜¯å®ç°<strong>ä¼˜å…ˆçº§é˜Ÿåˆ—</strong>æ•ˆç‡å¾ˆé«˜çš„æ•°æ®ç»“æ„ï¼Œå¦‚C++STL priority_queueã€Python PriorityQueueã€‚å †çš„å˜ä½“å¾ˆå¤šï¼ŒäºŒå‰å †ã€æ–æ³¢é‚£å¥‘å †â€¦ç”±å †å®ç°çš„ä¸€ç§é«˜æ•ˆæ’åºç®—æ³•ä¸ºå †æ’åºã€‚</p><span id="more"></span><h4 id="äºŒå‰å †"><a class="markdownIt-Anchor" href="#äºŒå‰å †"></a> äºŒå‰å †</h4><p>æ³¨æ„ï¼šæ•°æ®ç»“æ„ä¸­çš„å †å’Œå†…å­˜ä¸­çš„å †æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„æ¦‚å¿µï¼Œå°±åƒæ•°æ®ç»“æ„æ ˆå’Œæ ˆå†…å­˜ä¸€æ ·ï¼Œä¹‹é—´æ²¡æœ‰å¿…ç„¶è”ç³»ã€‚<br /><code>å †(Heap)</code>ä¹Ÿå¯ç§°ä¸ºå¤§/å°æ ¹å †ã€å¤§/å°æ ¹æ ‘ï¼Œæœ€å¤§/å°å †ï¼š</p><ul><li>å…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼å¤§äºç­‰äºæˆ–å°äºç­‰äºå…¶å­èŠ‚ç‚¹ï¼ˆå¦‚æœå­˜åœ¨ï¼‰çš„å€¼ï¼›</li><li>ä¸€ä¸ªå¤§æ ¹å †ï¼ˆå°æ ¹å †ï¼‰æ˜¯<code>å®Œå…¨äºŒå‰æ ‘</code>ã€‚</li></ul><p>äºŒå‰å †ç”±J.W.J.Williamsäº1964å¹´å¼•å…¥ï¼Œä½œä¸ºå †æ’åºçš„æ•°æ®ç»“æ„ã€‚<br />ä¸€èˆ¬æ¥è¯´ï¼Œé»˜è®¤<code>å †</code>æŒ‡çš„æ˜¯<strong>äºŒå‰å †(Binary heap)</strong>ã€‚<br />ç”±äºå †æ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨<code>æ•°ç»„</code>æè¿°ï¼Œä¹Ÿå¯ä»¥ç”¨<code>é“¾è¡¨</code>æè¿°ï¼Œä¸è¿‡æ•°ç»„æè¿°æ¯”è¾ƒæ™®éã€‚</p><p>äºŒå‰å †ä¸­æŸä¸ªèŠ‚ç‚¹çš„å·¦å³å­èŠ‚ç‚¹æ— è®ºè°å¤§è°å°ï¼Œåªè¦æ»¡è¶³å­èŠ‚ç‚¹çš„å€¼å°äºå…¶çˆ¶èŠ‚ç‚¹çš„å€¼ï¼ˆæœ€å¤§å †ï¼‰æˆ–å¤§äºå…¶çˆ¶èŠ‚ç‚¹çš„å€¼ï¼ˆæœ€å°å †ï¼‰å³å¯ã€‚</p><p><img src="/uploads/images/data_structure/heap_cpp/01.png" alt="" /></p><p>ç”±äºç”¨æ•°ç»„æè¿°çš„äºŒå‰å †ï¼Œå †èŠ‚ç‚¹å­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œé‚£ä¹ˆå¦‚ä½•ç”¨æ•°ç»„è¡¨ç¤ºå‘¢ï¼ŸèŠ‚ç‚¹çš„çˆ¶å­å…³ç³»åˆå¦‚ä½•è§£å†³ï¼Ÿ<br />1.å› ä¸ºäºŒå‰å †æ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œæ‰€ä»¥ä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³ä¾æ¬¡å°†äºŒå‰å †èŠ‚ç‚¹å¡«å…¥æ•°ç»„ï¼Œæ•°ç»„ä¹‹é—´æ²¡æœ‰ç©ºéš™ã€‚<br />2.è¿™é‡Œæœ‰ä¸¤ç§æ˜ å°„æ–¹å¼ã€‚å‡è®¾çˆ¶èŠ‚ç‚¹ç´¢å¼•ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>ï¼Œå·¦å­©å­èŠ‚ç‚¹ç´¢å¼•ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span>ï¼Œå³å­©å­èŠ‚ç‚¹ç´¢å¼•ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span>ï¼Œåˆ™ï¼š<br />æ•°ç»„ç´¢å¼•ä»0å¼€å§‹ï¼š</p><blockquote><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>=</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l=2i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>=</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">r=2i+2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><mo stretchy="false">âŒŠ</mo><mfrac><mrow><mi>l</mi><mo>âˆ’</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo stretchy="false">âŒ‹</mo><mo>=</mo><mo stretchy="false">âŒŠ</mo><mfrac><mrow><mi>r</mi><mo>âˆ’</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo stretchy="false">âŒ‹</mo></mrow><annotation encoding="application/x-tex">i=\lfloor \frac{l-1}{2} \rfloor=\lfloor \frac{r-1}{2} \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mopen">âŒŠ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">âŒ‹</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mopen">âŒŠ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">âŒ‹</span></span></span></span></p></blockquote><p>æ•°ç»„ç´¢å¼•ä»1å¼€å§‹ï¼š</p><blockquote><p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>=</mo><mn>2</mn><mi>i</mi></mrow><annotation encoding="application/x-tex">l=2i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>=</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r=2i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><mo stretchy="false">âŒŠ</mo><mfrac><mi>l</mi><mn>2</mn></mfrac><mo stretchy="false">âŒ‹</mo><mo>=</mo><mo stretchy="false">âŒŠ</mo><mfrac><mi>r</mi><mn>2</mn></mfrac><mo stretchy="false">âŒ‹</mo></mrow><annotation encoding="application/x-tex">i=\lfloor \frac{l}{2} \rfloor=\lfloor \frac{r}{2} \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mopen">âŒŠ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">âŒ‹</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">âŒŠ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">âŒ‹</span></span></span></span></p></blockquote><p>ä¸¤è€…å‡é‡‡ç”¨äº†<code>å‘ä¸‹å–æ•´floor</code>æ˜¯é˜²æ­¢æ•°ç»„ä¸‹æ ‡è¶Šç•ŒåŒæ—¶è¿˜èƒ½ä¿è¯ä¸åŒå·¦å³å­©å­çš„çˆ¶èŠ‚ç‚¹ç´¢å¼•ç›¸åŒï¼›æ•°ç»„ç´¢å¼•ä»1å¼€å§‹æ˜¯ä¸ºäº†ç®€åŒ–è¿ç®—ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡æœ‰å·®åˆ«ï¼Œæœ¬æ–‡æ˜¯é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼ã€‚<br /><img src="/uploads/images/data_structure/heap_cpp/02.png" alt="" /></p><p>æœ¬æ–‡ä»…ä»…æ¼”ç¤ºæœ€å¤§å †çš„åŸºæœ¬æ“ä½œï¼Œæœ€å°å †ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚<br />é¦–å…ˆå®šä¹‰å †çš„ADT</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Heap</span>&#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T&amp;)</span></span>=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">size</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> T&amp; <span class="hljs-title">top</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pop</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Heap</span>()&#123;&#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure><p>ä»<code>Heap</code>æ´¾ç”Ÿå‡ºæœ€å¤§å †<code>maxHeap</code></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">maxHeap</span>:</span> <span class="hljs-keyword">public</span> Heap&lt;T&gt;&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">maxHeap</span>(<span class="hljs-keyword">int</span> init_capacity=<span class="hljs-number">20</span>);<br>    ~<span class="hljs-built_in">maxHeap</span>();<br>    <span class="hljs-comment">// æ’å…¥å…ƒç´ </span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">push</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T&amp; data)</span></span>;<br>    <span class="hljs-comment">// åˆ é™¤å †é¡¶å…ƒç´ </span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pop</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">size</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-keyword">return</span> m_heapSize;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">capacity</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-keyword">return</span> m_capacity;&#125;<br>    <span class="hljs-comment">// è·å–å †é¡¶å…ƒç´ </span><br>    <span class="hljs-function">T&amp; <span class="hljs-title">top</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(m_heapSize&gt;=<span class="hljs-number">1</span>)<br>            <span class="hljs-keyword">return</span> m_heap[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;heap is empty&quot;</span>;<br>    &#125;;<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-keyword">return</span> m_heapSize==<span class="hljs-number">0</span>;&#125;<br><span class="hljs-keyword">protected</span>:<br>    <span class="hljs-comment">// æ”¹å˜æ•°ç»„å¤§å°</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">changeHeapCapacity</span><span class="hljs-params">(<span class="hljs-keyword">int</span> oldLength,<span class="hljs-keyword">int</span> newLength)</span></span>&#123;<br>        T *temp=<span class="hljs-keyword">new</span> T[newLength];<br>        m_capacity=newLength;<br>        std::<span class="hljs-built_in">copy</span>(m_heap,m_heap+m_heapSize,temp);<br>        <span class="hljs-keyword">delete</span>[] m_heap;<br>        m_heap=temp;<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    T *m_heap;<br>    <span class="hljs-keyword">int</span> m_capacity;<br>    <span class="hljs-keyword">int</span> m_heapSize;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h5 id="äºŒå‰å †çš„æ’å…¥"><a class="markdownIt-Anchor" href="#äºŒå‰å †çš„æ’å…¥"></a> äºŒå‰å †çš„æ’å…¥</h5><p>æœ€å¤§å †çš„æ’å…¥å¿…é¡»è¦ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‰¥</mo></mrow><annotation encoding="application/x-tex">\ge</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">â‰¥</span></span></span></span>å…¶å­èŠ‚ç‚¹ã€‚<br />å‘æœ€å¤§å †æ’å…¥ä¸€ä¸ªèŠ‚ç‚¹æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li>åœ¨æœ€å¤§å †çš„åº•éƒ¨æœ€å·¦è¾¹æ·»åŠ ä¸€ä¸ªæ–°èŠ‚ç‚¹ä½œä¸ºå­èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯åœ¨æ•°ç»„å†…æœ‰æ•ˆå…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®æ’å…¥ï¼›</li><li>è‹¥å­èŠ‚ç‚¹&gt;çˆ¶èŠ‚ç‚¹ï¼Œåˆ™äº¤æ¢å®ƒä»¬çš„å€¼ï¼Œç»§ç»­å‘ä¸Šè°ƒæ•´ï¼›å¦åˆ™è°ƒæ•´ç»“æŸã€‚</li></ul><p>äºŒå‰å †æ’å…¥æ—¶é—´å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>H</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(Height)=O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">e</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ã€‚</p><p>å‘ä¸Šè°ƒæ•´å°±åƒå†’æ³¡æ’åºä¸€æ ·ï¼Œä»å¶å­åˆ°æ ¹ä¸æ–­å°†æ–°èŠ‚ç‚¹ç§»åŠ¨åˆ°æŸä¸ªä½ç½®ç›´åˆ°è¯¥æ–°èŠ‚ç‚¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‰¤</mo></mrow><annotation encoding="application/x-tex">\le</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">â‰¤</span></span></span></span>å…¶çˆ¶èŠ‚ç‚¹ã€‚<br />ä»¥ä¸‹å›¾ä¸ºä¾‹ï¼Œå‡è®¾æ•°ç»„å¤§å°ä¸º12ï¼Œåœ¨æ•°ç»„å°¾éƒ¨æ’å…¥70åæ˜¯ä¸æ»¡è¶³äºŒå‰å †æ€§è´¨çš„ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ã€‚è°ƒæ•´æ–¹æ³•å¾ˆç®€å•ï¼Œä¾æ¬¡å°†70â€œä¸Šæµ®â€åˆ°æŸä¸ªåˆé€‚çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡æ¯”è¾ƒè¯¥èŠ‚ç‚¹ä¸çˆ¶èŠ‚ç‚¹çš„å€¼æ¥è¿›è¡Œçš„ã€‚<br /><img src="/uploads/images/data_structure/heap_cpp/03.png" alt="" /><br />ç”±äº70&gt;45ï¼Œ<code>èŠ‚ç‚¹70</code>åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•ä¸º8ï¼Œå¯ä»¥è®¡ç®—å‡º<code>çˆ¶èŠ‚ç‚¹45</code>ç´¢å¼•ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">âŒŠ</mo><mfrac><mrow><mn>8</mn><mo>âˆ’</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo stretchy="false">âŒ‹</mo><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">\lfloor \frac{8-1}{2} \rfloor=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mopen">âŒŠ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">âŒ‹</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>ï¼Œäºæ˜¯äº¤æ¢ä»–ä»¬çš„å€¼ï¼Œæ­¤æ—¶<code>èŠ‚ç‚¹70</code>æ‰€åœ¨æ•°ç»„çš„ç´¢å¼•ä¸º3ï¼›<br /><img src="/uploads/images/data_structure/heap_cpp/04.png" alt="" /></p><p>æ¥ç€ç»§ç»­åˆ¤æ–­<code>èŠ‚ç‚¹70</code>å’Œ<code>çˆ¶èŠ‚ç‚¹60</code>å¤§å°ï¼Œ70&gt;60ï¼Œç»§ç»­äº¤æ¢<code>èŠ‚ç‚¹70</code>ä¸<code>çˆ¶èŠ‚ç‚¹60</code>çš„å€¼ï¼›æ­¤æ—¶70&lt;80ï¼Œè°ƒæ•´ç»“æŸã€‚</p><p><img src="/uploads/images/data_structure/heap_cpp/05.png" alt="" /></p><p>å¦‚æœåœ¨ç©ºå †ä¸­æ’å…¥èŠ‚ç‚¹ç›´æ¥æ’å…¥å³å¯ï¼Œæ³¨æ„æ­¤å¤„å¹¶æ²¡æœ‰ç›´æ¥äº¤æ¢çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ï¼Œè€Œæ˜¯å°†çˆ¶èŠ‚ç‚¹ä¸æ–­çš„å‘ä¸‹ç§»åŠ¨ï¼Œæœ€ååœ¨åˆé€‚ä½ç½®æ’å…¥æ–°èŠ‚ç‚¹ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> maxHeap&lt;T&gt;::<span class="hljs-built_in">push</span>(<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    <span class="hljs-comment">// æ•°ç»„æ‰©å®¹</span><br>    <span class="hljs-keyword">if</span>(m_heapSize&gt;=m_capacity)&#123;<br>        <span class="hljs-built_in">changeHeapCapacity</span>(m_capacity,<span class="hljs-number">2</span>*m_capacity);<br>    &#125;<br>    <span class="hljs-comment">// å­èŠ‚ç‚¹ç´¢å¼•</span><br>    <span class="hljs-keyword">int</span> index=m_heapSize;<br>    <span class="hljs-comment">// çˆ¶èŠ‚ç‚¹ç´¢å¼•ï¼Œå‘ä¸‹å–æ•´</span><br>    <span class="hljs-keyword">int</span> parent_index=((index<span class="hljs-number">-1</span>)/<span class="hljs-number">2</span>);<br>    <br>    <span class="hljs-comment">// å‘ä¸Šè°ƒæ•´</span><br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>        <span class="hljs-keyword">if</span>(index==<span class="hljs-number">0</span>)<span class="hljs-keyword">break</span>;<br>        <span class="hljs-comment">// è‹¥å­èŠ‚ç‚¹å¤§äºçˆ¶èŠ‚ç‚¹ï¼Œç»§ç»­å‘ä¸Šè°ƒæ•´</span><br>        <span class="hljs-keyword">if</span>(data &gt; m_heap[parent_index])<br>            m_heap[index]=m_heap[parent_index];<br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-keyword">break</span>;<br>        index=parent_index;<br>        parent_index=((index<span class="hljs-number">-1</span>)/<span class="hljs-number">2</span>);<br>    &#125;<br>    m_heap[index]=data;<br>    m_heapSize++;<br>&#125;<br></code></pre></div></td></tr></table></figure><h5 id="äºŒå‰å †çš„åˆ é™¤"><a class="markdownIt-Anchor" href="#äºŒå‰å †çš„åˆ é™¤"></a> äºŒå‰å †çš„åˆ é™¤</h5><p>ä¸€èˆ¬äºŒå‰å †çš„åˆ é™¤æŒ‡çš„æ˜¯åˆ é™¤å †é¡¶å…ƒç´ ï¼Œå…¶æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li>åˆ é™¤å †é¡¶å…ƒç´ å¹¶å°†äºŒå‰å †æœ€åº•å±‚çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹(æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ )æ›¿æ¢åˆ°å †é¡¶ä½ç½®(æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ )ï¼›</li><li>å…ˆæ¯”è¾ƒçˆ¶èŠ‚ç‚¹çš„å·¦å³å­©å­çš„å¤§å°ï¼Œ<code>è¾ƒå¤§çš„å­èŠ‚ç‚¹</code>å†ä¸<code>çˆ¶èŠ‚ç‚¹</code>è¿›è¡Œæ¯”è¾ƒï¼Œè‹¥çˆ¶èŠ‚ç‚¹&lt;å…¶å­èŠ‚ç‚¹ï¼Œç»§ç»­å‘ä¸‹è°ƒæ•´ï¼›å¦åˆ™è°ƒæ•´ç»“æŸã€‚</li></ul><p>äºŒå‰å †åˆ é™¤æ—¶é—´å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>H</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(Height)=O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">e</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ã€‚</p><p><img src="/uploads/images/data_structure/heap_cpp/06.png" alt="" /><br />åˆ é™¤æ ¹èŠ‚ç‚¹80ï¼Œå°†èŠ‚ç‚¹45æ›¿æ¢åˆ°æ ¹èŠ‚ç‚¹ï¼Œæ­¤æ—¶ä¸æ»¡è¶³äºŒå‰å †æ€§è´¨ï¼Œæ•…ç»§ç»­å‘ä¸‹è°ƒæ•´ã€‚æ­¤æ—¶æœ‰æ•ˆæ•°ç»„å¤§å°ä¸º<code>heapSize-1</code>ã€‚<br /><img src="/uploads/images/data_structure/heap_cpp/07.png" alt="" /></p><ul><li>çˆ¶èŠ‚ç‚¹45çš„å·¦å³å­©å­èŠ‚ç‚¹70&gt;50ä¸”45&lt;70ï¼Œæ•…äº¤æ¢å€¼åç»§ç»­å‘ä¸‹è°ƒæ•´ï¼›</li><li>çˆ¶èŠ‚ç‚¹45çš„å·¦å³å­©å­èŠ‚ç‚¹60&gt;40ä¸”45&lt;60ï¼Œæ•…äº¤æ¢å€¼åç»§ç»­å‘ä¸‹è°ƒæ•´ï¼›</li><li>çˆ¶èŠ‚ç‚¹45åªæœ‰å·¦å­©å­ä¸”45&gt;10ï¼Œæ•…è°ƒæ•´ç»“æŸã€‚</li></ul><p><img src="/uploads/images/data_structure/heap_cpp/08.png" alt="" /></p><p>ç±»ä¼¼æ’å…¥æ“ä½œæ­¤å¤„ä¹Ÿå¹¶æ²¡æœ‰ç›´æ¥äº¤æ¢çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹å€¼ï¼Œè€Œæ˜¯å°†å­èŠ‚ç‚¹ä¸æ–­çš„å‘ä¸Šç§»åŠ¨ï¼Œæœ€ååœ¨åˆé€‚ä½ç½®æ’å…¥æ—§å€¼ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> maxHeap&lt;T&gt;::<span class="hljs-built_in">pop</span>()&#123;<br>    <span class="hljs-keyword">if</span>(m_heapSize&lt;=<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> child_index=<span class="hljs-number">2</span>*index+<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">int</span> lastChild=m_heap[--m_heapSize];<br><br>    <span class="hljs-comment">// å‘ä¸‹è°ƒæ•´</span><br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-keyword">if</span>(child_index &gt;= m_heapSize)<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-comment">// å½“çˆ¶èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå·¦å­©å­æ—¶ï¼Œchild_index+1 &lt; m_heapSizeä¸æˆç«‹</span><br>        <span class="hljs-keyword">if</span>(child_index+<span class="hljs-number">1</span> &lt; m_heapSize &amp;&amp; m_heap[child_index]&lt;m_heap[child_index+<span class="hljs-number">1</span>])&#123;<br>            child_index++;<br>        &#125;<br>        <span class="hljs-comment">// è‹¥çˆ¶èŠ‚ç‚¹&lt;å­èŠ‚ç‚¹ï¼Œç»§ç»­å‘ä¸‹è°ƒæ•´</span><br>        <span class="hljs-keyword">if</span>(lastChild &lt; m_heap[child_index])<br>            m_heap[index]=m_heap[child_index];<br>        <span class="hljs-keyword">else</span> <br>            <span class="hljs-keyword">break</span>;<br>        index=child_index;<br>        child_index=<span class="hljs-number">2</span>*index+<span class="hljs-number">1</span>;<br>    &#125;<br>    m_heap[index]=lastChild;<br>&#125;<br></code></pre></div></td></tr></table></figure><h5 id="æ„å»ºäºŒå‰å †"><a class="markdownIt-Anchor" href="#æ„å»ºäºŒå‰å †"></a> æ„å»ºäºŒå‰å †</h5><p>æ„å»ºäºŒå‰å †æ˜¯åœ¨ä¸€ä¸ªå¾ªç¯å†…ä¸æ–­åœ°æ’å…¥å…ƒç´ ï¼Œå®é™…ä¸Šè¿™æ˜¯Williamsæ³•ï¼Œå…¶å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">int</span> array[]=&#123;<span class="hljs-number">90</span> , <span class="hljs-number">40</span> ,<span class="hljs-number">30</span> ,<span class="hljs-number">60</span> ,<span class="hljs-number">70</span> ,<span class="hljs-number">200</span> ,<span class="hljs-number">20</span> ,<span class="hljs-number">10</span> ,<span class="hljs-number">50</span> ,<span class="hljs-number">80</span>&#125;;<br>maxHeap&lt;<span class="hljs-keyword">int</span>&gt;mhp;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">auto</span> &amp;&amp;x:array) &#123;<br>    mhp.<span class="hljs-built_in">push</span>(x);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä½†æ˜¯ï¼ŒWilliamsçš„æ–¹æ³•ä¸å¤Ÿå¥½ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨åŸæ•°ç»„é€šè¿‡å‘ä¸‹è°ƒæ•´çš„æ–¹æ³•æ¥å»ºå †ï¼Œè€Œä¸”è¿™ç§æ–¹æ³•æ¯”ä¸Šé¢çš„æ–¹æ³•è¿˜è¦å¿«ã€‚<br />ç»´åŸºç™¾ç§‘ä¸­æœ‰ä¸€æ®µè¯</p><blockquote><p>More specifically if all the subtrees starting at some height <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span> have already been â€œheapifiedâ€ (the bottommost level corresponding to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>), the trees at height <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> can be heapified by sending their root down along the path of maximum valued children when building a max-heap, or minimum valued children when building a min-heap</p></blockquote><p>å¤§æ¦‚æ„æ€æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªäºŒå‰å †çš„åº•å±‚å­æ ‘ä¹Ÿæ˜¯äºŒå‰å †çš„è¯ï¼Œé‚£ä¹ˆå¯ä»¥é€å±‚å‘ä¸Šåˆå¹¶è¿™äº›å­äºŒå‰å †ï¼Œä¹Ÿå°±æ˜¯åœ¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>å±‚å­˜åœ¨å¤šä¸ªå­æ ‘å·²ç»å †åŒ–ï¼Œé‚£ä¹ˆåœ¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>å±‚å¯ä»¥å¾ˆå¿«çš„å®Œæˆè°ƒæ•´ã€‚</p><figure class="highlight n1ql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs n1ql"><span class="hljs-keyword">Build</span>-<span class="hljs-built_in">Max</span>-Heap (A):<br>    heap_length[A] â† <span class="hljs-built_in">length</span>[A]<br>    <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span> <span class="hljs-keyword">index</span> i <span class="hljs-keyword">from</span> <span class="hljs-built_in">floor</span>((<span class="hljs-built_in">length</span>[A]<span class="hljs-number">-1</span><span class="hljs-number">-1</span>)/<span class="hljs-number">2</span>) downto <span class="hljs-number">0</span> <span class="hljs-keyword">do</span>:<br>        <span class="hljs-built_in">Max</span>-Heapify(A, i)<br></code></pre></div></td></tr></table></figure><p>æ¯”å¦‚ä¸‹é¢è¿™å¼ å›¾ï¼Œæ•°ç»„è¡¨ç¤ºä¸º<code>[90 40 30 60 70 200]</code>ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªäºŒå‰å †ï¼Œç°åœ¨éœ€è¦å°†å…¶è°ƒæ•´ä¸ºäºŒå‰å †ã€‚<br />ä»<code>floor((length[A]-1-1)/2)</code>å¼€å§‹ï¼ˆæœ€åä¸€ä¸ªå­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼‰ï¼Œä¾æ¬¡é€’å‡ç›´åˆ°<code>0</code>ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ï¼Œè™šçº¿æ¡†è¡¨ç¤ºå·²ç»å®Œæˆå †åŒ–çš„å­æ ‘ã€‚</p><p>å…¶ä¸­<code>parent</code>ä»£è¡¨è¦ä¸‹æµ®çš„èŠ‚ç‚¹ï¼Œä»çˆ¶èŠ‚ç‚¹å¼€å§‹å°†<code>parent</code>ä¸‹æµ®åˆ°æŸä¸ªåˆé€‚ä½ç½®ã€‚æœ€åç»“æœå°±æ˜¯çœŸæ­£çš„äºŒå‰å †<code>[200 70 90 60 40 30]</code>ã€‚</p><p><img src="/uploads/images/data_structure/heap_cpp/09.png" alt="" /></p><p>æ€»ä¹‹è¯¥æ–¹æ³•ä¸€å¥è¯æå®šï¼šé€å±‚å‘ä¸Šï¼ˆä»å³åˆ°å·¦ï¼Œä»ä¸‹åˆ°ä¸Šï¼‰çš„å‘ä¸‹è°ƒæ•´ã€‚<br />ä»£ç å¦‚ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">buildHeap</span><span class="hljs-params">(T*array,<span class="hljs-keyword">int</span> size)</span></span>&#123;<br>    <span class="hljs-keyword">delete</span> []m_heap;<br>    m_heap=array;<br>    m_capacity=size;<br>    m_heapSize=size--;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = (size<span class="hljs-number">-1</span>)/<span class="hljs-number">2</span>; i &gt;=<span class="hljs-number">0</span>; --i)&#123;<br>        <span class="hljs-comment">// çˆ¶èŠ‚ç‚¹ç´¢å¼•</span><br>        <span class="hljs-keyword">int</span> index=i;<br>        <span class="hljs-comment">// å­èŠ‚ç‚¹ç´¢å¼•</span><br>        <span class="hljs-keyword">int</span> child_index=<span class="hljs-number">2</span>*index+<span class="hljs-number">1</span>;<br>        <span class="hljs-comment">// ä¸‹æµ®çˆ¶èŠ‚ç‚¹parent          </span><br>        T parent=m_heap[index];<br><br>        <span class="hljs-comment">// å‘ä¸‹è°ƒæ•´</span><br>        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)&#123;<br>            <span class="hljs-keyword">if</span>(child_index&gt;=size)<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">if</span>(child_index+<span class="hljs-number">1</span>&lt;size&amp;&amp;m_heap[child_index]&lt;m_heap[child_index+<span class="hljs-number">1</span>])<br>                child_index++;<br>            <span class="hljs-keyword">if</span>(parent&gt;=m_heap[child_index])<br>                <span class="hljs-keyword">break</span>;<br>            m_heap[index]=m_heap[child_index];<br><br>            index=child_index;<br>            child_index=index*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>;<br>        &#125;<br>        m_heap[index]=parent;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è™½ç„¶è¯¥æ–¹æ³•å¤æ‚åº¦å¯ä»¥è¯´æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ï¼Œä½†æ¯”ç¬¬ä¸€ç§æ–¹æ³•è¦å¿«å¾ˆå¤šã€‚</p><h4 id="å †æ’åº"><a class="markdownIt-Anchor" href="#å †æ’åº"></a> å †æ’åº</h4><p>åˆ©ç”¨æœ€å¤§å †å¯ä»¥å¯¹æ•°ç»„å‡åºæ’åºï¼Œæœ€å°å †å¯ä»¥å¯¹æ•°ç»„é™åºæ’åºã€‚å †æ’åºé€šè¿‡æ¯æ¬¡â€œåˆ é™¤â€ï¼ˆäº¤æ¢æ•°ç»„é¦–å°¾å…ƒç´ ï¼‰å †é¡¶å…ƒç´ ï¼ˆæœ€å¤§/å°å€¼ï¼‰ï¼Œå†é‡æ–°æ„å»ºäºŒå‰å †ï¼Œä½¿å¾—æ•°ç»„å†…å…ƒç´ ç”±åå¾€å‰ä¾æ¬¡å‡å°ï¼Œä»è€Œæ•°ç»„å˜å¾—æœ‰åºã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">down</span><span class="hljs-params">(<span class="hljs-keyword">int</span> *array,<span class="hljs-keyword">int</span> size,<span class="hljs-keyword">int</span> i)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> index=i;<br>    <span class="hljs-keyword">int</span> child_index=<span class="hljs-number">2</span>*index+<span class="hljs-number">1</span>;            <br>    <span class="hljs-keyword">int</span> x=array[index];<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-keyword">if</span>(child_index&gt;=size)<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">if</span>(child_index+<span class="hljs-number">1</span>&lt;size&amp;&amp;array[child_index]&lt;array[child_index+<span class="hljs-number">1</span>])<br>            child_index++;<br>        <span class="hljs-keyword">if</span>(x&gt;=array[child_index])<br>            <span class="hljs-keyword">break</span>;<br>        array[index]=array[child_index];<br>        index=child_index;<br>        child_index=index*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>;<br>    &#125;<br>    array[index]=x;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">HeapSort</span><span class="hljs-params">(<span class="hljs-keyword">int</span> *array,<span class="hljs-keyword">int</span> size)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> index,child_index,parent,child;<br>    <span class="hljs-comment">// æ„å»ºå †ï¼Œä¸‹åˆ°ä¸Š</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = (size<span class="hljs-number">-1</span><span class="hljs-number">-1</span>)/<span class="hljs-number">2</span>; i &gt;=<span class="hljs-number">0</span>; --i)&#123;<br>        <span class="hljs-built_in">down</span>(array,size,i);<br>    &#125;<br>    <span class="hljs-comment">// äº¤æ¢æ•°æ®åé‡æ–°æ„å»ºå †ï¼Œä¸Šåˆ°ä¸‹</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = size<span class="hljs-number">-1</span>; i &gt;=<span class="hljs-number">0</span>; --i)&#123;<br>        <span class="hljs-built_in">swap</span>(array[i],array[<span class="hljs-number">0</span>]);<br>        <span class="hljs-built_in">down</span>(array,i,<span class="hljs-number">0</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>DataStructures</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æˆ‘æ‰€ç†è§£çš„çº¢é»‘æ ‘(RBT)</title>
    <link href="/rb-tree-cpp/"/>
    <url>/rb-tree-cpp/</url>
    
    <content type="html"><![CDATA[<p>çº¢é»‘æ ‘ï¼ˆRedâ€“Black Treeï¼‰æ˜¯ä¸€ç§è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œç”¨äºå®ç°<strong>å…³è”æ•°ç»„</strong>ã€‚å®ƒåœ¨1972å¹´ç”±é²é“å¤«Â·è´å°”ï¼ˆRudolf Bayerï¼‰å‘æ˜ï¼Œè¢«ç§°ä¸º&quot;å¯¹ç§°äºŒå‰Bæ ‘&quot;ã€‚</p><span id="more"></span><h3 id="2-3æ ‘"><a class="markdownIt-Anchor" href="#2-3æ ‘"></a> 2-3æ ‘</h3><p>ç”±äºçº¢é»‘æ ‘è¿‡äºå¤æ‚ï¼Œå› æ­¤åœ¨è®²è¿°ä¹‹å‰æˆ‘ä»¬å…ˆæ¥å¤§è‡´äº†è§£ä¸€ä¸‹<code>2-3æ ‘</code>ï¼Œ2-3æ ‘ç±»ä¼¼çº¢é»‘æ ‘ï¼Œä¹Ÿæ˜¯å¹³è¡¡æ ‘ï¼Œæ—¶é—´å¤æ‚åº¦å‡ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ã€‚<br />2â€“3æ ‘æ—©äºçº¢é»‘æ ‘å‡ºç°ï¼Œç”±çº¦ç¿°Â·éœæ™®å…‹æ´›å¤«ç‰¹äº1970å¹´å‘æ˜ã€‚2-3æ ‘ä¹Ÿç§°ä¸º<code>3é˜¶B-æ ‘</code>ã€<code>3å‰æœç´¢æ ‘</code>ã€‚<br />2-3æ ‘ä¸­çš„ä¸€ä¸ªçˆ¶èŠ‚ç‚¹å¯ä»¥æœ‰2ä¸ªå­èŠ‚ç‚¹ä¹Ÿå¯ä»¥æœ‰3ä¸ªå­èŠ‚ç‚¹ã€‚<br />æœ‰2ä¸ªå­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ç§°ä¸º<code>2-</code>èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹æœ‰1ä¸ªkeyã€‚è¿™ç±»ä¼¼äºŒå‰æ ‘çš„èŠ‚ç‚¹<br />æœ‰3ä¸ªå­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ç§°ä¸º<code>3-</code>èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹æœ‰2ä¸ªkeyã€‚å‡è®¾çˆ¶èŠ‚ç‚¹é”®ä¸ºkey1å’Œkey2ä¸”key1 &lt; key2ï¼Œå·¦å­æ ‘Lã€ä¸­å­æ ‘Mã€å³å­æ ‘Rã€‚åˆ™å·¦å­æ ‘L &lt; key1ï¼Œkey1 &lt; ä¸­å­æ ‘M &lt; key2 ï¼Œå³å­æ ‘ &gt; key2ã€‚</p><p>2-3æ ‘æ˜¯ä¸€æ£µ<code>å®Œå…¨3å‰æœç´¢æ ‘</code>ã€‚æ¯ä¸ªèŠ‚ç‚¹è¦ä¹ˆæ˜¯<code>å¶å­èŠ‚ç‚¹</code>ï¼Œè¦ä¹ˆæ˜¯<code>2-èŠ‚ç‚¹</code>æˆ–<code>3-èŠ‚ç‚¹</code>ï¼Œï¼Œè€Œä¸”æ¯ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¸€å®šæ˜¯<code>ç­‰é«˜</code>çš„ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/01.png" alt="" /></p><p>å¦‚ä¸Šå›¾ï¼Œå…³é”®å­—ä¸º <code>[f h]</code> çš„<code>3-èŠ‚ç‚¹</code>æœ‰3ä¸ªå­èŠ‚ç‚¹<code>e</code>ã€<code>g</code>ã€<code>[i j]</code>ï¼Œä¸” <code>e&lt;f</code>ã€<code>f&lt;g&lt;h</code>ã€<code>[i j]&gt;h</code></p><h4 id="æŸ¥æ‰¾"><a class="markdownIt-Anchor" href="#æŸ¥æ‰¾"></a> æŸ¥æ‰¾</h4><p>2-3æ ‘çš„æŸ¥æ‰¾ç±»ä¼¼bstï¼Œæ¯”å¦‚æŸ¥æ‰¾ä¸Šå›¾çš„<code>g</code></p><ol><li>é¦–å…ˆgå’Œdæ¯”è¾ƒï¼Œg&gt;dï¼ŒæŸ¥æ‰¾å³å­æ ‘</li><li>f&lt;g&lt;hï¼Œè¿›å…¥ä¸­å­æ ‘</li><li>g=gï¼Œè¿”å›èŠ‚ç‚¹ï¼ŒæŸ¥æ‰¾ç»“æŸ</li></ol><h4 id="æ’å…¥"><a class="markdownIt-Anchor" href="#æ’å…¥"></a> æ’å…¥</h4><p>æ’å…¥æ“ä½œåªéœ€åœ¨<code>å¶å­èŠ‚ç‚¹</code>å¤„æ’å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œä¸è¿‡ç”±äº2-3æ ‘çš„å®šä¹‰éœ€è¦è°ƒæ•´æ ‘çš„ç»“æ„ï¼Œä½¿å…¶å¹³è¡¡ã€‚<br />åœ¨å¶å­èŠ‚ç‚¹è€Œä¸æ˜¯ç©ºèŠ‚ç‚¹å¤„æ’å…¥èŠ‚ç‚¹çš„å¥½å¤„æ˜¯ä»¥åç»´æŠ¤å¹³è¡¡å°±ç®€å•äº†ï¼Œè€Œä¸”æ ‘çš„é«˜åº¦ä¹Ÿæ˜¯å°½å¯èƒ½çš„ä½ã€‚<br />æ’å…¥æ–°èŠ‚ç‚¹å¤„çš„å¶å­èŠ‚ç‚¹å¯ä¸º<code>2-èŠ‚ç‚¹</code>æˆ–<code>3-èŠ‚ç‚¹</code><br /><img src="/uploads/images/data_structure/rbtree_cpp/02.png" alt="" /></p><p>å¦‚ä¸Šå›¾å°±æ˜¯åœ¨2-èŠ‚ç‚¹ä½ç½®<code>i</code>ç›´æ¥æ’å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹<code>j</code>è€Œå˜æˆä¸€ä¸ª3-èŠ‚ç‚¹ï¼Œè¿™ç§æƒ…å†µä¸‹æ— éœ€è°ƒæ•´æ ‘ç»“æ„å°±å·²ç»å¹³è¡¡ã€‚</p><p>åœ¨3-èŠ‚ç‚¹å¤„æ’å…¥æ–°èŠ‚ç‚¹åŒæ ·ä¹Ÿæ˜¯åœ¨å¶å­èŠ‚ç‚¹æ’å…¥ï¼Œä¸è¿‡è¿™æ ·ä¼šå¯¼è‡´å½¢æˆä¸€ä¸ª<code>4-èŠ‚ç‚¹</code>ï¼Œåœ¨2-3æ ‘ä¸­è¿™æ˜¯ä¸å…è®¸çš„ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ã€‚è°ƒæ•´æ–¹å¼ä¸ºå°±æ˜¯å°†<code>4-èŠ‚ç‚¹</code>åˆ†è£‚ä¸åˆå¹¶ã€‚</p><p><code>èŠ‚ç‚¹åˆ†è£‚</code> æ˜¯å°†ä¸€ä¸ª4-èŠ‚ç‚¹çš„ä¸­é—´å€¼keyèŠ‚ç‚¹æå–å¤„æ¥ä½œä¸ºçˆ¶èŠ‚ç‚¹ï¼Œå·¦è¾¹keyä½œä¸ºå·¦èŠ‚ç‚¹ï¼Œå³è¾¹keyä½œä¸ºå³èŠ‚ç‚¹ã€‚<br />è‹¥è¯¥4-èŠ‚ç‚¹å­˜åœ¨å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°†å·¦è¾¹keyä½œä¸ºæœ€å·¦è¾¹ä¸¤ä¸ªå­èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹ï¼Œå°†å³è¾¹keyä½œä¸ºæœ€å³è¾¹ä¸¤ä¸ªå­èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹ã€‚</p><p><img src="/uploads/images/data_structure/rbtree_cpp/04.png" alt="" /></p><p>èŠ‚ç‚¹åˆ†è£‚ä¸€èˆ¬ä¼´éšç€<code>èŠ‚ç‚¹åˆå¹¶</code>ï¼Œä¹Ÿå°±æ˜¯å°†åˆ†è£‚åçš„çˆ¶èŠ‚ç‚¹ä¸ä¹‹å‰æœªåˆ†è£‚4-èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹åˆå¹¶æˆä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå¦‚æœæ–°èŠ‚ç‚¹ä¾æ—§æ˜¯4-èŠ‚ç‚¹ï¼Œé‚£ä¹ˆç»§ç»­å‘ä¸Šåˆ†è£‚åˆå¹¶ç›´åˆ°æ»¡è¶³å¹³è¡¡ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š<br />å‘è¿™æ£µ2-3æ ‘æ’å…¥<code>k</code>èŠ‚ç‚¹åæˆä¸º4-èŠ‚ç‚¹ï¼Œä¸ç¬¦åˆå®šä¹‰ï¼Œéœ€è¦åˆ†è£‚è¯¥èŠ‚ç‚¹ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/03.png" alt="" /></p><p>å°†èŠ‚ç‚¹<code>[i j k]</code>ä¸­çš„<code>j</code>æå–å‡ºæ¥ä¸ä¸çˆ¶èŠ‚ç‚¹<code>[f h]</code>åˆå¹¶æˆ<code>[f h j]</code>ï¼Œå‘ç°è¯¥èŠ‚ç‚¹ä¾ç„¶æ˜¯ä¸€ä¸ª4-èŠ‚ç‚¹ï¼Œå› æ­¤éœ€è¦ç»§ç»­åˆ†è£‚+åˆå¹¶ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/05.png" alt="" /></p><p>æ­¤æ—¶<code>[d h]</code>å·²ç»æ˜¯ä¸€ä¸ª3-èŠ‚ç‚¹äº†ï¼Œè€Œä¸”æ•´ä¸ª2-3æ ‘ä¹Ÿæ˜¯ç­‰é«˜çš„ï¼Œè°ƒæ•´ç»“æŸã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/06.png" alt="" /></p><p>æ’å…¥<code>a-k</code>çš„æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹<br /><img src="/uploads/images/data_structure/rbtree_cpp/07.gif" alt="" /></p><h4 id="åˆ é™¤"><a class="markdownIt-Anchor" href="#åˆ é™¤"></a> åˆ é™¤</h4><p>2-3æ ‘çš„åˆ é™¤è™½ç„¶è¾ƒä¸ºå¤æ‚ï¼Œä½†å¤§è‡´å¯åˆ†ä¸ºä¸¤ç±»ï¼šåˆ é™¤å¶å­èŠ‚ç‚¹å’Œåˆ é™¤éå¶å­èŠ‚ç‚¹ã€‚</p><h5 id="åˆ é™¤å¶å­èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#åˆ é™¤å¶å­èŠ‚ç‚¹"></a> åˆ é™¤å¶å­èŠ‚ç‚¹</h5><p>åˆ é™¤å¶å­èŠ‚ç‚¹åˆå¯ä»¥åˆ†ä¸º<code>åˆ é™¤2-èŠ‚ç‚¹</code>å’Œ<code>åˆ é™¤3-èŠ‚ç‚¹</code>ã€‚<br />åˆ é™¤3-èŠ‚ç‚¹çš„æƒ…å†µæœ€ç®€å•ï¼Œç›´æ¥åˆ é™¤å³å¯ã€‚å¦‚ä¸‹åˆ é™¤keyä¸ºkçš„æƒ…å†µ<br /><img src="/uploads/images/data_structure/rbtree_cpp/08.png" alt="" /></p><p>åˆ é™¤2-èŠ‚ç‚¹ä¸èƒ½ç®€å•çš„åˆ é™¤è¯¥èŠ‚ç‚¹ï¼Œå› ä¸ºè¿™æ ·ä¸€åˆ é™¤åï¼Œè¯¥ä½ç½®ä¸ºç©ºï¼Œ2-3æ ‘æ˜¯ä¸å…è®¸å­˜åœ¨è¿™ç§æƒ…å†µçš„ã€‚æ­¤æ—¶å¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»æƒ…å†µæ¥å¤„ç†ï¼š</p><ul><li>å¾…åˆ é™¤èŠ‚ç‚¹çš„<code>ä¸´è¿‘å…„å¼ŸèŠ‚ç‚¹</code>æ˜¯<code>3-èŠ‚ç‚¹</code></li><li>å¾…åˆ é™¤èŠ‚ç‚¹çš„<code>ä¸´è¿‘å…„å¼ŸèŠ‚ç‚¹</code>æ˜¯<code>2-èŠ‚ç‚¹</code>ï¼Œä½†<code>çˆ¶èŠ‚ç‚¹</code>æ˜¯<code>3-èŠ‚ç‚¹</code></li><li>å¾…åˆ é™¤èŠ‚ç‚¹çš„<code>ä¸´è¿‘å…„å¼ŸèŠ‚ç‚¹</code>å’Œ<code>çˆ¶èŠ‚ç‚¹</code>å‡æ˜¯<code>2-èŠ‚ç‚¹</code></li></ul><p>å¯¹äºç¬¬ä¸€ç§æƒ…å†µï¼Œåˆ é™¤è¯¥èŠ‚ç‚¹ååªéœ€å‘<code>ä¸´è¿‘å…„å¼ŸèŠ‚ç‚¹</code>â€œå€Ÿâ€<strong>ä¸€ä¸ªkeyä¸å¾…åˆ é™¤èŠ‚ç‚¹ç›¸è¿‘</strong>ä½œä¸ºæ–°çš„èŠ‚ç‚¹å¹¶<code>è°ƒæ•´å…¶ä¸çˆ¶èŠ‚ç‚¹</code>ï¼Œæ­¤æ—¶æ ‘çš„é«˜åº¦ä¸å˜ã€‚<br />å¦‚ä¸‹å›¾ï¼Œåˆ é™¤<code>i</code>èŠ‚ç‚¹ï¼Œè€Œä¸”å…„å¼Ÿæ˜¯3-èŠ‚ç‚¹ï¼Œå°†å…„å¼ŸèŠ‚ç‚¹ä¸­key<code>k</code>ä¸åˆ é™¤èŠ‚ç‚¹ç›¸è¿‘çš„key<code>j</code>è€Œä¸æ˜¯<code>l</code>ä½œä¸ºå·²åˆ é™¤èŠ‚ç‚¹ã€‚ç”±äº<code>k&gt;j</code>ï¼Œå› æ­¤éœ€è¦è°ƒæ•´çˆ¶å­èŠ‚ç‚¹é”®å€¼<br /><img src="/uploads/images/data_structure/rbtree_cpp/09.png" alt="" /></p><p>å¯¹äºç¬¬äºŒç§æƒ…å†µï¼Œé¦–å…ˆåˆ é™¤è¯¥èŠ‚ç‚¹åï¼Œå‘ç°<code>ä¸´è¿‘å…„å¼ŸèŠ‚ç‚¹g</code>æ˜¯ä¸€ä¸ª2-èŠ‚ç‚¹ä¸”çˆ¶èŠ‚ç‚¹<code>[f h]</code>ä¸º3-èŠ‚ç‚¹ã€‚å› æ­¤å°†çˆ¶èŠ‚ç‚¹åˆ†è§£ä¸º2-èŠ‚ç‚¹ï¼Œç”±äº<code>e&lt;f&lt;g</code>ï¼Œäºæ˜¯å°†<code>f</code>ä¸<code>ä¸´è¿‘å…„å¼ŸèŠ‚ç‚¹g</code>åˆå¹¶æˆ3-èŠ‚ç‚¹ï¼Œå¹¶ä½œä¸ºä¸€ä¸ªæ–°çš„å·¦å­©å­<br /><img src="/uploads/images/data_structure/rbtree_cpp/10.png" alt="" /></p><p>æ¼”ç¤ºè¿‡ç¨‹å¦‚ä¸‹<br /><img src="/uploads/images/data_structure/rbtree_cpp/11.gif" alt="" /></p><p>ç¬¬ä¸‰ç§æƒ…å†µå¾…åˆ é™¤èŠ‚ç‚¹çš„å…„å¼ŸèŠ‚ç‚¹å’Œçˆ¶èŠ‚ç‚¹å‡æ˜¯2-èŠ‚ç‚¹ï¼Œåˆ é™¤èŠ‚ç‚¹åå°†<code>çˆ¶èŠ‚ç‚¹b</code>å’Œ<code>å…„å¼ŸèŠ‚ç‚¹c</code>åˆå¹¶æˆ3-èŠ‚ç‚¹ã€‚<br />1.è‹¥æ­¤æ—¶<code>å…„å¼ŸèŠ‚ç‚¹få’Œçˆ¶èŠ‚ç‚¹dåˆæ˜¯2-èŠ‚ç‚¹</code>ï¼Œæ•…ç»§ç»­åˆå¹¶dã€fç›´åˆ°å¹³è¡¡ï¼Œæœ€ç»ˆçš„ç»“æ„å¦‚ä¸‹ã€‚å›¾ä¸­ç©ºä½ç½®åªæ˜¯ç›´è§‚ä¸Šè¡¨ç¤ºä¸€æ£µç­‰é«˜çš„2-3æ ‘ä¸”è¯¥èŠ‚ç‚¹è¢«â€œåˆ é™¤â€äº†ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/12.png" alt="" /></p><p>2.è‹¥æ­¤æ—¶<code>ä¸´è¿‘å…„å¼ŸèŠ‚ç‚¹æ˜¯2-èŠ‚ç‚¹ã€çˆ¶èŠ‚ç‚¹æ˜¯3-èŠ‚ç‚¹</code>ï¼Œåˆ™å¯çœ‹ä½œæ˜¯ä¸Šè¿°ç¬¬äºŒç§åˆ é™¤æƒ…å†µã€‚<br />å¦‚ä¸‹ï¼Œåˆ é™¤<code>2-èŠ‚ç‚¹a</code>ï¼Œæ­¤æ—¶å…„å¼ŸèŠ‚ç‚¹cå’Œçˆ¶èŠ‚ç‚¹bå‡ä¸º2-èŠ‚ç‚¹ï¼Œå› æ­¤åˆå¹¶æˆ<code>3-èŠ‚ç‚¹[b c]</code>ï¼Œæ­¤æ—¶ä»ç„¶æœªå¹³è¡¡ï¼Œä¸”<code>ä¸´è¿‘å…„å¼ŸèŠ‚fç‚¹æ˜¯2-èŠ‚ç‚¹ã€çˆ¶èŠ‚ç‚¹[d h]æ˜¯3-èŠ‚ç‚¹</code>ï¼Œå› æ­¤åˆ†è§£çˆ¶èŠ‚ç‚¹<code>[d h]</code>ï¼Œå°†<code>d</code>ä¸ä¸´è¿‘å…„å¼ŸèŠ‚<code>f</code>åˆå¹¶ä¸º3-èŠ‚ç‚¹<code>[d-f]</code><br /><img src="/uploads/images/data_structure/rbtree_cpp/13.png" alt="" /></p><p>æ¼”ç¤ºè¿‡ç¨‹å¦‚ä¸‹<br /><img src="/uploads/images/data_structure/rbtree_cpp/14.gif" alt="" /></p><p>3.è‹¥æ­¤æ—¶<code>ä¸´è¿‘å…„å¼ŸèŠ‚ç‚¹æ˜¯3-èŠ‚ç‚¹</code>ï¼Œè¯¥è¿‡ç¨‹ä¹Ÿå¯çœ‹ä½œæ˜¯ä¸Šè¿°ç¬¬ä¸€ç§åˆ é™¤æƒ…å†µï¼Œæ­¤å¤„ä¸å†å™è¿°ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/15.png" alt="" /></p><p>æ¼”ç¤ºè¿‡ç¨‹å¦‚ä¸‹<br /><img src="/uploads/images/data_structure/rbtree_cpp/16.gif" alt="" /></p><h5 id="åˆ é™¤éå¶å­èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#åˆ é™¤éå¶å­èŠ‚ç‚¹"></a> åˆ é™¤éå¶å­èŠ‚ç‚¹</h5><p>åˆ é™¤éå¶å­èŠ‚ç‚¹é¦–å…ˆä¹Ÿéœ€è¦æ‰¾åˆ°ä¸€ä¸ª<code>å‰é©±/åç»§èŠ‚ç‚¹</code>ï¼Œæœ‰ç‚¹ç±»ä¼¼BSTã€‚<br />æ€»ä¹‹ç®€å•æ¥è¯´ï¼Œå‰é©±èŠ‚ç‚¹å°±æ˜¯èŠ‚ç‚¹çš„å·¦å­æ ‘çš„æœ€å³èŠ‚ç‚¹ï¼Œåç»§èŠ‚ç‚¹å°±æ˜¯èŠ‚ç‚¹çš„å³å­æ ‘çš„æœ€å·¦èŠ‚ç‚¹ã€‚</p><p>å¦‚ä¸‹åˆ é™¤<code>key=d</code>çš„èŠ‚ç‚¹ï¼Œè¯¥keyä½äº3-èŠ‚ç‚¹ï¼Œä¸è¿‡æ²¡å…³ç³»ã€‚æ‰¾åˆ°å…¶<code>å‰é©±èŠ‚ç‚¹c</code>ï¼Œå°†é”®å€¼æ›¿æ¢ååˆ é™¤<code>å‰é©±èŠ‚ç‚¹c</code>ï¼Œåˆ é™¤æ“ä½œå°±è½¬åŒ–ä¸ºä¸Šè¿°3ç§æƒ…å†µä¹‹ä¸€ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/17.png" alt="" /></p><p>æ¼”ç¤ºè¿‡ç¨‹å¦‚ä¸‹<br /><img src="/uploads/images/data_structure/rbtree_cpp/18.gif" alt="" /></p><p>ä»¥ä¸Šå¤§è‡´æ˜¯å…³äº2-3æ ‘çš„ä¸€äº›åŸºæœ¬æ“ä½œäº†ã€‚è¯´äº†è¿™ä¹ˆå¤šï¼Œå°±æ˜¯ä¸ºäº†2-3æ ‘å’Œä¸ºçº¢é»‘æ ‘ä¹‹é—´çš„è½¬åŒ–ã€‚<br />å…ˆæ¥çœ‹è¿™å¼ å›¾ï¼Œå°†2-3æ ‘çš„<code>3-èŠ‚ç‚¹</code>æ‹†è§£æˆçˆ¶å­èŠ‚ç‚¹ï¼Œä¸”ç”¨çº¢è‰²ç®­å¤´è¡¨æ˜ä¸¤è€…çˆ¶å­å…³ç³»ï¼Œå°†å­èŠ‚ç‚¹æŸ“æˆçº¢è‰²ï¼Œçˆ¶èŠ‚ç‚¹æŸ“æˆé»‘è‰²ï¼›å†å°†å…¶ä½™<code>2-èŠ‚ç‚¹</code>å…¨éƒ¨æŸ“æˆé»‘è‰²ã€‚ç»è¿‡é€‚å½“è°ƒæ•´æ ‘ç»“æ„åå‘ç°è¿™æ˜¯ä¸€æ£µçº¢é»‘æ ‘ï¼å®é™…ä¸Šï¼Œè¿™æ˜¯çº¢é»‘æ ‘çš„å˜ä½“â€”â€”<code>å·¦åçº¢é»‘æ ‘</code>ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/19.png" alt="" /></p><p>å®é™…ä¸Šå‘ä¸€æ£µæ™®é€šçš„çº¢é»‘æ ‘æ’å…¥keyä¸º<code>a-l</code>åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š<br /><img src="/uploads/images/data_structure/rbtree_cpp/20.png" alt="" /></p><p>2-3æ ‘ä¸€å®šèƒ½è½¬åŒ–ä¸ºçº¢é»‘æ ‘(å·¦åçº¢é»‘æ ‘)ï¼Œè€Œçº¢é»‘æ ‘ä¸ä¸€å®šèƒ½è½¬åŒ–ä¸º2-3æ ‘ï¼<br />ç”±äº<code>2-3-4æ ‘</code>æ˜¯çº¢é»‘æ ‘çš„ä¸€ç§ç­‰åŒï¼Œæ•…2-3-4æ ‘ä¸€å®šèƒ½è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œè€Œçº¢é»‘æ ‘ä¹Ÿä¸€å®šèƒ½è½¬åŒ–ä¸º2-3-4æ ‘ï¼</p><h3 id="çº¢é»‘æ ‘"><a class="markdownIt-Anchor" href="#çº¢é»‘æ ‘"></a> çº¢é»‘æ ‘</h3><h4 id="åŸºæœ¬æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#åŸºæœ¬æ¦‚å¿µ"></a> åŸºæœ¬æ¦‚å¿µ</h4><blockquote><p>çº¢é»‘æ ‘ï¼ˆè‹±è¯­ï¼šRedâ€“black treeï¼‰æ˜¯ä¸€ç§è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œæ˜¯åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ç”¨åˆ°çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå…¸å‹çš„ç”¨é€”æ˜¯å®ç°å…³è”æ•°ç»„ã€‚å®ƒåœ¨1972å¹´ç”±é²é“å¤«Â·è´å°”å‘æ˜ï¼Œè¢«ç§°ä¸º&quot;å¯¹ç§°äºŒå‰Bæ ‘&quot;ï¼Œå®ƒç°ä»£çš„åå­—æºäºLeo J. Guibaså’ŒRobert Sedgewickäº1978å¹´å†™çš„ä¸€ç¯‡è®ºæ–‡ã€‚çº¢é»‘æ ‘çš„ç»“æ„å¤æ‚ï¼Œä½†å®ƒçš„æ“ä½œæœ‰ç€è‰¯å¥½çš„æœ€åæƒ…å†µè¿è¡Œæ—¶é—´ï¼Œå¹¶ä¸”åœ¨å®è·µä¸­é«˜æ•ˆï¼šå®ƒå¯ä»¥åœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>log</mi><mo>â¡</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">\log N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> æ—¶é—´å†…å®ŒæˆæŸ¥æ‰¾ï¼Œæ’å…¥å’Œåˆ é™¤ï¼Œè¿™é‡Œçš„ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> æ˜¯æ ‘ä¸­å…ƒç´ çš„æ•°ç›®ã€‚</p><p>çº¢é»‘æ ‘ç›¸å¯¹äºAVLæ ‘æ¥è¯´ï¼Œç‰ºç‰²äº†éƒ¨åˆ†å¹³è¡¡æ€§ä»¥æ¢å–æ’å…¥/åˆ é™¤æ“ä½œæ—¶å°‘é‡çš„æ—‹è½¬æ“ä½œï¼Œæ•´ä½“æ¥è¯´æ€§èƒ½è¦ä¼˜äºAVLæ ‘ã€‚</p></blockquote><p>æ ¹æ®2-3æ ‘è½¬åŒ–ä¸ºçº¢é»‘æ ‘å¯ä»¥è¿™æ ·å®šä¹‰çº¢é»‘æ ‘ï¼Œæˆ–è€…æ˜¯<code>è§„åˆ™</code>ï¼š</p><ul><li>çº¢é»‘æ ‘ä¸€å®šæ˜¯äºŒå‰æœç´¢æ ‘ï¼Œå› ä¸º2-3æ ‘ä¹Ÿæ˜¯äºŒå‰æœç´¢æ ‘ï¼›</li><li>æ ¹èŠ‚ç‚¹å’Œæ‰€æœ‰å¤–éƒ¨èŠ‚ç‚¹(Nil)éƒ½æ˜¯<code>é»‘è‰²</code>ï¼Œæ ¹æ®2-3æ ‘è½¬åŒ–ä¸ºå·¦åçº¢é»‘æ ‘å¯çœ‹å‡ºæ¥ï¼›</li><li>åœ¨æ ¹è‡³å¤–éƒ¨èŠ‚ç‚¹(Nil)è·¯å¾„ä¸Šï¼Œæ²¡æœ‰è¿ç»­ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯<code>çº¢è‰²</code>çš„ï¼›</li><li>åœ¨æ‰€æœ‰æ ¹è‡³å¤–éƒ¨èŠ‚ç‚¹çš„è·¯å¾„ä¸Šï¼Œ<code>é»‘è‰²</code>èŠ‚ç‚¹çš„æ•°ç›®ç›¸åŒï¼Œå³<code>é»‘é«˜</code>ç›¸ç­‰ã€‚</li></ul><p>å¦‚æœå†æ·»åŠ è¿™ä¸€è§„åˆ™<code>çº¢è‰²èŠ‚ç‚¹ä½äºå·¦ä¾§</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¢é»‘æ ‘æ˜¯ä¸€æ£µå·¦åçº¢é»‘æ ‘ã€‚ä¸è¿‡æœ¬æ–‡ä¸»è¦æ˜¯ä»‹ç»æ™®é€šçš„çº¢é»‘æ ‘ã€‚<br />ä¸Šè¿°è§„åˆ™3å’Œè§„åˆ™4æ˜¯æå…¶é‡è¦çš„ï¼Œä½†å‡¡æ¶‰åŠæ’å…¥å’Œåˆ é™¤æ“ä½œéƒ½æ˜¯è¦ä½¿çº¢é»‘æ ‘æ»¡è¶³è¿™ä¸¤æ¡è§„åˆ™ã€‚</p><p>æœ¬æ–‡çº¢é»‘æ ‘C++ç±»</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedBlackTree</span>&#123;</span><br><span class="hljs-keyword">private</span>:<br>    RBNodeEntry *m_RB_Root;<br>    RBNodeEntry *m_Nil;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">RedBlackTree</span>();<br>    <span class="hljs-built_in">RedBlackTree</span>(<span class="hljs-keyword">int</span> key,<span class="hljs-keyword">int</span> data);<br>    ~<span class="hljs-built_in">RedBlackTree</span>();<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key,<span class="hljs-keyword">int</span> data)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Remove</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key)</span></span>;<br>    <span class="hljs-function">RBNodeEntry* <span class="hljs-title">Search</span><span class="hljs-params">(RBNodeEntry* pNode,<span class="hljs-keyword">int</span> key)</span></span>;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ClearAll</span><span class="hljs-params">(RBNodeEntry*&amp; root)</span></span>;<br>    <span class="hljs-function">RBNodeEntry* <span class="hljs-title">successor</span><span class="hljs-params">(RBNodeEntry* pnode)</span></span>;<br>    <span class="hljs-function">RBNodeEntry* <span class="hljs-title">predecessor</span><span class="hljs-params">(RBNodeEntry* pnode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Height</span><span class="hljs-params">(RBNodeEntry* pnode)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(pnode==m_Nil)<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">int</span> hl= <span class="hljs-built_in">Height</span>(pnode-&gt;leftChild);<br>        <span class="hljs-keyword">int</span> hr= <span class="hljs-built_in">Height</span>(pnode-&gt;rightChild);<br>        <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">max</span>(hl,hr)+<span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-function">RBNodeEntry* &amp;<span class="hljs-title">root</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;m_RB_Root;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PreOrder</span><span class="hljs-params">(RBNodeEntry* pnode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InOrder</span><span class="hljs-params">(RBNodeEntry* pnode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PostOrder</span><span class="hljs-params">(RBNodeEntry* pnode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LevelOrder</span><span class="hljs-params">(RBNodeEntry* pnode)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">leftRotate</span><span class="hljs-params">(RBNodeEntry *pnode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">rightRotate</span><span class="hljs-params">(RBNodeEntry *pnode)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RedBlack_insertFixup</span><span class="hljs-params">(RBNodeEntry* pnode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RedBlack_removeFixup</span><span class="hljs-params">(RBNodeEntry* pnode)</span></span>;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h4 id="å“¨å…µèŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#å“¨å…µèŠ‚ç‚¹"></a> å“¨å…µèŠ‚ç‚¹</h4><p>æœ¬æ–‡çº¢é»‘æ ‘åˆ©ç”¨äº†<code>å“¨å…µèŠ‚ç‚¹</code>æŠ€å·§ï¼Œçœå»äº†åˆ¤æ–­nullptrçš„éº»çƒ¦ï¼Œä¸è¿‡BSTéƒ¨åˆ†ä»£ç éœ€è¦ç¨å¾®ä¿®æ”¹ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/48.png" alt="" /></p><p>ç”±äºå“¨å…µèŠ‚ç‚¹ä¹Ÿæ˜¯<code>RBNodeEntry</code>ç»“æ„ï¼Œä½†å“¨å…µèŠ‚ç‚¹æ— çˆ¶èŠ‚ç‚¹ï¼Œå› æ­¤è®¾ç½®ä¸º<code>nullptr</code>ï¼›åŒæ—¶è¿˜éœ€è¦è®¾ç½®å…¶<code>leftChild</code>å’Œ<code>rightChild</code>æŒ‡å‘è‡ªèº«ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp">RedBlackTree::<span class="hljs-built_in">RedBlackTree</span>()&#123;<br>    <span class="hljs-keyword">this</span>-&gt;m_RB_Root=<span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-comment">// å“¨å…µèŠ‚ç‚¹</span><br>    <span class="hljs-keyword">this</span>-&gt;m_Nil=<span class="hljs-keyword">new</span> RBNodeEntry;<br>    <span class="hljs-keyword">this</span>-&gt;m_Nil-&gt;color=BLACK;<br>    <span class="hljs-keyword">this</span>-&gt;m_Nil-&gt;key=<span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">this</span>-&gt;m_Nil-&gt;data=<span class="hljs-number">0xffffff</span>;<br>    <span class="hljs-keyword">this</span>-&gt;m_Nil-&gt;leftChild=<span class="hljs-keyword">this</span>-&gt;m_Nil;<br>    <span class="hljs-keyword">this</span>-&gt;m_Nil-&gt;rightChild=<span class="hljs-keyword">this</span>-&gt;m_Nil;<br>&#125;<br>RedBlackTree::<span class="hljs-built_in">RedBlackTree</span>(<span class="hljs-keyword">int</span> key,<span class="hljs-keyword">int</span> data):RedBlackTree&#123;&#125;&#123;<br>    <span class="hljs-keyword">this</span>-&gt;m_RB_Root=<span class="hljs-keyword">new</span> <span class="hljs-built_in">RBNodeEntry</span>(key,data);<br>    <span class="hljs-keyword">this</span>-&gt;m_RB_Root-&gt;parent=<span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-keyword">this</span>-&gt;m_RB_Root-&gt;leftChild=<span class="hljs-keyword">this</span>-&gt;m_Nil;<br>    <span class="hljs-keyword">this</span>-&gt;m_RB_Root-&gt;rightChild=<span class="hljs-keyword">this</span>-&gt;m_Nil;    <br>    <span class="hljs-keyword">this</span>-&gt;m_RB_Root-&gt;color=BLACK;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="æŸ¥æ‰¾-2"><a class="markdownIt-Anchor" href="#æŸ¥æ‰¾-2"></a> æŸ¥æ‰¾</h4><p>ç”±äºçº¢é»‘æ ‘ä¹Ÿæ˜¯å¹³è¡¡æ ‘ï¼Œå…¶æŸ¥æ‰¾ä¹Ÿä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>ï¼ŒæŸ¥æ‰¾è¿‡ç¨‹ä¸æ™®é€šçš„äºŒå‰æŸ¥æ‰¾æ ‘æ²¡æœ‰å¤ªå¤§åŒºåˆ«ã€‚ä¸è¿‡çº¢é»‘æ ‘å’ŒAVLæ ‘ç›¸æ¯”ï¼Œåœ¨æœ€åæƒ…å†µä¸‹å´æ˜¯AVLæ ‘å ä¼˜åŠ¿ã€‚è¿™æ˜¯å› ä¸ºAVLæ ‘æ˜¯ä¸¥æ ¼çš„è‡ªå¹³è¡¡æ ‘ï¼Œåœ¨æœ€åæƒ…å†µä¸‹åŒæ ·å¤šçš„èŠ‚ç‚¹ï¼Œå…¶é«˜åº¦å°äºçº¢é»‘æ ‘ï¼Œè¿™å°±å¯¼è‡´å…¶æŸ¥æ‰¾æ•ˆç‡é«˜äºçº¢é»‘æ ‘ã€‚</p><h4 id="æ—‹è½¬"><a class="markdownIt-Anchor" href="#æ—‹è½¬"></a> æ—‹è½¬</h4><p>çº¢é»‘æ ‘çš„æ—‹è½¬æ“ä½œåªæœ‰å·¦æ—‹å’Œå³æ—‹ï¼Œè€Œä¸”ä¹Ÿæ˜¯æ ¸å¿ƒã€‚<br />ä»¥è¿™å¼ å›¾ä¸ºä¾‹ï¼Œæ’å…¥çº¢è‰²èŠ‚ç‚¹42åæ— éœ€è¿›è¡Œä»»ä½•æ“ä½œå°±æ»¡è¶³çº¢é»‘æ ‘æ€§è´¨ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/21.png" alt="" /></p><p>ä¸‹é¢è¿™ä¸ªä¾‹å­å°±æ˜¯å…¸å‹çš„<code>LLb</code>å‹ï¼Œè‡³äºä»€ä¹ˆæ˜¯LLbï¼Œæ­¤å¤„ç®€å•ä»‹ç»ä¸‹ã€‚<br />å›¾ä¸­uè¡¨ç¤ºpuçš„å·¦å­©å­ã€puè¡¨ç¤ºguçš„å·¦å­©å­ã€grè¡¨ç¤ºguçš„å³å­©å­ï¼Œä¹Ÿå°±æ˜¯puçš„å…„å¼Ÿï¼Œuçš„å”å”ã€‚<br />è€ŒLLbçš„æ„æ€æ˜¯ï¼špuæ˜¯guçš„å·¦å­©å­ã€uæ˜¯puçš„å·¦å­©å­ï¼Œä¸”guçš„å¦å¤–ä¸€ä¸ªå­©å­æ˜¯é»‘è‰²çš„ï¼ˆ<code>NilèŠ‚ç‚¹æ˜¯é»‘è‰²èŠ‚ç‚¹</code>ï¼‰ã€‚</p><p>é¦–å…ˆæ’å…¥èŠ‚ç‚¹41åè¿èƒŒ<code>è§„åˆ™3</code>ï¼Œéœ€è¦å¯¹èŠ‚ç‚¹45å³æ—‹ï¼Œä¸è¿‡ä¸ºäº†ç›´è§‚è¡¨ç¤ºï¼Œæˆ‘å°†å›¾ä¸­çš„æ—‹è½¬ç®­å¤´æ–¹å‘ä½ç½®äº42ä¸45ä¹‹é—´ã€‚æ—‹è½¬æ“ä½œå®è´¨æ˜¯å¯¹èŠ‚ç‚¹æŒ‡é’ˆå…³ç³»çš„ä¿®æ”¹ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/22.png" alt="" /></p><p>è€Œè¿™ä¸ªä¾‹å­å°±æ˜¯<code>LRb</code>å‹ï¼Œå¯¹èŠ‚ç‚¹42<code>å·¦æ—‹</code>åå†å¯¹èŠ‚ç‚¹45<code>å³æ—‹</code>ã€‚è¿™è¯´æ˜LRbå¯ä»¥è½¬åŒ–ä¸ºLLbç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºæ’å…¥æ“ä½œå…¶å®ä¹Ÿå°±é‚£å‡ ç§ä¸å¹³è¡¡ç±»å‹ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/23.png" alt="" /></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">COLOR</span>&#123;</span><br>    RED,<br>    BLACK<br>&#125;;<br><span class="hljs-comment">// çº¢é»‘æ ‘èŠ‚ç‚¹</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">RBNodeEntry</span>&#123;</span><br>    <span class="hljs-keyword">int</span> key;<br>    <span class="hljs-keyword">int</span> data;<br>    <span class="hljs-keyword">int</span> color;<br>    RBNodeEntry *parent;<br>    RBNodeEntry *leftChild;<br>    RBNodeEntry *rightChild;<br>    <span class="hljs-built_in">RBNodeEntry</span>()&#123;&#125;<br>    <span class="hljs-built_in">RBNodeEntry</span>(<span class="hljs-keyword">int</span> k,<span class="hljs-keyword">int</span> d)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;key=k;<br>        <span class="hljs-keyword">this</span>-&gt;data=d;<br>        <span class="hljs-keyword">this</span>-&gt;color=RED;<br>    &#125;<br>&#125;;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RedBlackTree::leftRotate</span><span class="hljs-params">(RBNodeEntry *pnode)</span></span>&#123;<br>    RBNodeEntry *right = pnode-&gt;rightChild;<br>    pnode-&gt;rightChild = right-&gt;leftChild;<br><br>    <span class="hljs-keyword">if</span> (right-&gt;leftChild != m_Nil)<br>        right-&gt;leftChild-&gt;parent = pnode;<br>    right-&gt;parent = pnode-&gt;parent;<br>    <br>    <span class="hljs-comment">// è¡¨ç¤ºæ ¹èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">if</span> (pnode-&gt;parent == <span class="hljs-literal">NULL</span>)&#123;<br>        root = right;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">          parent                    parent</span><br><span class="hljs-comment">           / \                      /    \</span><br><span class="hljs-comment">       pnode  brother           right  brother</span><br><span class="hljs-comment">        /  \            ---&gt;     / \</span><br><span class="hljs-comment">       l    right           pnode  y</span><br><span class="hljs-comment">           / \                / \</span><br><span class="hljs-comment">           x  y              l  x</span><br><span class="hljs-comment">    */</span><br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pnode-&gt;parent-&gt;leftChild == pnode)&#123;<br>        pnode-&gt;parent-&gt;leftChild = right;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        parent                    parent</span><br><span class="hljs-comment">        / \                       /   \</span><br><span class="hljs-comment">   brother pnode            brother  right</span><br><span class="hljs-comment">           /  \        ---&gt;          /  \</span><br><span class="hljs-comment">           l   right             pnode   y</span><br><span class="hljs-comment">              / \                 / \</span><br><span class="hljs-comment">              x  y                l  x</span><br><span class="hljs-comment">    */</span><br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        pnode-&gt;parent-&gt;rightChild = right;            <br>    &#125;<br>    right-&gt;leftChild = pnode;<br>    pnode-&gt;parent = right;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RedBlackTree::rightRotate</span><span class="hljs-params">(RBNodeEntry *pnode)</span></span>&#123;<br>    RBNodeEntry *left = pnode-&gt;leftChild;<br>    pnode-&gt;leftChild=left-&gt;rightChild;<br><br>    <span class="hljs-keyword">if</span>(left-&gt;rightChild!=m_Nil)&#123;<br>        left-&gt;rightChild-&gt;parent=pnode;<br>    &#125;<br>    left-&gt;parent=pnode-&gt;parent;<br>    <span class="hljs-comment">// æ ¹èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">if</span>(pnode-&gt;parent==<span class="hljs-literal">nullptr</span>)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;m_RB_Root=left;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">          parent                parent</span><br><span class="hljs-comment">           / \                   / \</span><br><span class="hljs-comment">       pnode  brother        left   brother</span><br><span class="hljs-comment">        /  \          ---&gt;   / \</span><br><span class="hljs-comment">     left   r               x   pnode</span><br><span class="hljs-comment">      / \                        / \</span><br><span class="hljs-comment">     x   y                      y   r</span><br><span class="hljs-comment">    */</span><br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(pnode-&gt;parent-&gt;leftChild==pnode)&#123;<br>        pnode-&gt;parent-&gt;leftChild=left;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">         parent                  parent</span><br><span class="hljs-comment">          /  \                    /  \</span><br><span class="hljs-comment">    brother   pnode         brother  left   </span><br><span class="hljs-comment">              /  \   ---&gt;             / \</span><br><span class="hljs-comment">            left  r                  x   pnode</span><br><span class="hljs-comment">            / \                          / \</span><br><span class="hljs-comment">           x   y                        y   r</span><br><span class="hljs-comment">    */</span><br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        pnode-&gt;parent-&gt;rightChild=left;<br>    &#125;<br>    left-&gt;rightChild=pnode;<br>    pnode-&gt;parent=left;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="æ’å…¥-2"><a class="markdownIt-Anchor" href="#æ’å…¥-2"></a> æ’å…¥</h4><p>çº¢é»‘æ ‘çš„æ’å…¥æ“ä½œç±»ä¼¼BSTæ’å…¥ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜è¦å¯¹èŠ‚ç‚¹è¿›è¡Œ<code>æŸ“è‰²</code>ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ¯•ç«Ÿæ˜¯çº¢é»‘æ ‘å˜›åˆ°åº•æ˜¯æŸ“æˆé»‘è‰²è¿˜æ˜¯çº¢è‰²ï¼Ÿ<br />1.è‹¥æŸ“æˆ<code>é»‘è‰²</code>ï¼Œé‚£ä¹ˆå°±ä¼šä¸€å®šä¼šè¿èƒŒ<code>è§„åˆ™4</code>ï¼Œå³é»‘è‰²èŠ‚ç‚¹æ•°ç›®ä¸ç›¸åŒï¼Œä¹‹åè¿˜éœ€è¦é‡æ–°è°ƒæ•´çº¢é»‘æ ‘ï¼Œè¦çŸ¥é“çº¢é»‘æ ‘è°ƒæ•´æ˜¯å¾ˆå¤æ‚çš„ï¼Œè‹¥æ˜¯æ”¹å†™æˆä»£ç é‚£ä¼°è®¡å¾—ç´¯æ­»äººã€‚<br />2.è‹¥æŸ“æˆ<code>çº¢è‰²</code>ï¼Œæ­¤æ—¶ä¸€å®šä¸ä¼šè¿èƒŒ<code>è§„åˆ™4</code>ï¼Œä¸è¿‡è¿™æœ‰<code>å¯èƒ½</code>ä¼šè¿èƒŒ<code>è§„åˆ™3</code>ï¼Œå³æœ‰è¿ç»­ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯<code>çº¢è‰²</code>çš„ã€‚è™½è¯´è¿˜éœ€è¦è¿›è¡Œè°ƒæ•´ï¼Œä¸è¿‡è¿™ä»£ç é‡ç›¸æ¯”ä¹‹å‰å°±ä¼šå°‘å¾ˆå¤šäº†â€¦åŸºäºæ­¤ï¼ŒæŸ“æˆ<code>çº¢è‰²</code>æ˜¯æ­£ç¡®çš„é€‰æ‹©ã€‚</p><p>æ’å…¥å®Œæˆåå¾€å¾€éœ€è¦<code>ä¿®æ­£Fixup</code>æ ‘ç»“æ„ï¼Œè€Œä¿®æ­£è¿‡ç¨‹éœ€è¦<code>æ—‹è½¬Rotate</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">RedBlackTree::Insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key,<span class="hljs-keyword">int</span> data)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>-&gt;m_RB_Root==<span class="hljs-literal">nullptr</span>)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;m_RB_Root=<span class="hljs-keyword">new</span> <span class="hljs-built_in">RBNodeEntry</span>(key,data);<br>        <span class="hljs-keyword">this</span>-&gt;m_RB_Root-&gt;leftChild=m_Nil;<br>        <span class="hljs-keyword">this</span>-&gt;m_RB_Root-&gt;rightChild=m_Nil;<br>        <span class="hljs-keyword">this</span>-&gt;m_RB_Root-&gt;parent=<span class="hljs-literal">nullptr</span>;<br>        <span class="hljs-keyword">this</span>-&gt;m_RB_Root-&gt;color=BLACK;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    RBNodeEntry *x=<span class="hljs-keyword">this</span>-&gt;m_RB_Root;<br>    RBNodeEntry *p=<span class="hljs-literal">nullptr</span>;<br><br>    <span class="hljs-keyword">while</span> (x!=m_Nil)&#123;<br>        <span class="hljs-comment">// ä¿å­˜çˆ¶èŠ‚ç‚¹p</span><br>        p=x;<br>        <span class="hljs-keyword">if</span>(key &lt; x-&gt;key)<br>            x=x-&gt;leftChild;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(key &gt; x-&gt;key)<br>            x=x-&gt;rightChild;<br>        <span class="hljs-comment">// å·²ç»å­˜åœ¨</span><br>        <span class="hljs-keyword">else</span>&#123;<br>            x-&gt;data=data;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>    &#125;<br><br>    RBNodeEntry *pnode=<span class="hljs-keyword">new</span> <span class="hljs-built_in">RBNodeEntry</span>(key,data);<br>    pnode-&gt;leftChild=m_Nil;<br>    pnode-&gt;rightChild=m_Nil;<br>    pnode-&gt;color=RED;<br>    pnode-&gt;parent=p;<br><br>    <span class="hljs-comment">// åˆ¤æ–­æ’å…¥èŠ‚ç‚¹ä½äºçˆ¶èŠ‚ç‚¹çš„å“ªè¾¹</span><br>    <span class="hljs-keyword">if</span>(key &lt; p-&gt;key)<br>        p-&gt;leftChild=pnode;<br>    <span class="hljs-keyword">else</span> <br>        p-&gt;rightChild=pnode;<br>    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ»¡è¶³çº¢é»‘æ ‘çš„å¹³è¡¡æ¡ä»¶å¹¶é‡æ–°å¹³è¡¡</span><br>    <span class="hljs-built_in">RedBlack_insertFixup</span>(pnode);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="insertfixup"><a class="markdownIt-Anchor" href="#insertfixup"></a> InsertFixup</h4><p>æ’å…¥æ“ä½œæ‰€å¼•èµ·çš„ä¸å¹³è¡¡ä¸»è¦æ˜¯ä»¥ä¸‹8ç§ç±»å‹ï¼ˆä¸»è¦é’ˆå¯¹æ’å…¥åœ¨çº¢è‰²èŠ‚ç‚¹ä¹‹åï¼‰ï¼š<br />LLrã€LRrã€RRrã€RLrã€LLbã€LRbã€RRbã€RLbã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/24.png" alt="" /><br />å›¾ä¸­uè¡¨ç¤ºpuçš„å·¦å­©å­ã€puè¡¨ç¤ºguçš„å·¦å­©å­ã€grè¡¨ç¤ºguçš„å³å­©å­ï¼Œä¹Ÿå°±æ˜¯puçš„å…„å¼Ÿï¼Œuçš„å”å”ã€‚è€ŒLLbçš„æ„æ€æ˜¯ï¼špuæ˜¯guçš„å·¦å­©å­ã€uæ˜¯puçš„å·¦å­©å­ï¼Œä¸”guçš„å¦å¤–ä¸€ä¸ªå­©å­(å¯ä»¥æ˜¯NilèŠ‚ç‚¹)æ˜¯é»‘è‰²çš„ã€‚</p><p>å¯ä»¥æ€»ç»“ä¸ºä¸‹é¢è¿™ä¸¤ç§ç±»å‹ï¼Œæ’å…¥æ–°èŠ‚ç‚¹åçš„å¹³è¡¡ä¸»è¦æ˜¯å¯¹<code>æ–°æ’å…¥èŠ‚ç‚¹uã€å…¶çˆ¶èŠ‚ç‚¹puã€ç¥–çˆ¶èŠ‚ç‚¹guä»¥åŠå”å”èŠ‚ç‚¹gl/gr</code>æ¥æ“ä½œçš„ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/25.png" alt="" /></p><p>å¦‚æœå”å”èŠ‚ç‚¹ä¸å­˜åœ¨ä¸€å®šæ˜¯<code>Nilé»‘è‰²èŠ‚ç‚¹</code>ï¼ï¼ï¼</p><p>æ ¹æ®<code>å”å”èŠ‚ç‚¹uncle</code>çš„é¢œè‰²æ˜¯çº¢è‰²æˆ–é»‘è‰²ï¼ŒInsertFixupå¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§ç±»å‹ï¼š</p><ul><li>uncleèŠ‚ç‚¹æ˜¯<code>çº¢è‰²</code>ï¼Œä¹Ÿå°±æ˜¯<code>LLrã€LRrã€RRrã€RLr</code>ç±»å‹ï¼Œç›´æ¥<code>æ¢è‰²</code>å³å¯å®Œæˆçº¢é»‘æ ‘å¹³è¡¡ï¼›</li><li>uncleèŠ‚ç‚¹æ˜¯<code>é»‘è‰²</code>ï¼Œä¹Ÿå°±æ˜¯<code>LLbã€LRbã€RRbã€RLb</code>ç±»å‹ï¼Œéœ€è¦æ—‹è½¬å’Œæ¢è‰²ã€‚</li></ul><h5 id="llr-lrr-rrr-rlr"><a class="markdownIt-Anchor" href="#llr-lrr-rrr-rlr"></a> LLrã€LRrã€RRrã€RLr</h5><p>å¤„ç†è¿™ç±»ä¸å¹³è¡¡é—®é¢˜ï¼Œåªéœ€è¦æ¢è‰²å³å¯ï¼Œè¿™æ˜¯å› ä¸º<code>çˆ¶èŠ‚ç‚¹å’Œå”å”èŠ‚ç‚¹</code>æ­¤æ—¶ä¸€å®šæ˜¯<code>çº¢è‰²</code>çš„ï¼Œé‚£ä¹ˆ<code>ç¥–çˆ¶èŠ‚ç‚¹</code>ä¹Ÿä¸€å®šæ˜¯<code>é»‘è‰²</code>çš„ã€‚<br />è¿™ä¸ªè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ul><li>è‹¥<code>çˆ¶èŠ‚ç‚¹pu/parentå­˜åœ¨ä¸”ä¸ºçº¢è‰²</code>ï¼Œåˆ™æ‰§è¡Œè¯¥è¿‡ç¨‹ï¼›å¦åˆ™å°†<code>æ ¹èŠ‚ç‚¹root</code>æŸ“æˆä¸º<code>é»‘è‰²</code>å¹¶ç»“æŸï¼›</li><li>å°†<code>çˆ¶èŠ‚ç‚¹pu/parentå’Œå”å”èŠ‚ç‚¹gl/gr/uncle</code>æŸ“æˆé»‘è‰²ï¼›</li><li>å°†<code>ç¥–çˆ¶èŠ‚ç‚¹gu</code>æŸ“æˆçº¢è‰²ï¼›</li><li>ç§»åŠ¨å½“å‰<code>æ–°æ’å…¥çº¢è‰²èŠ‚ç‚¹u</code>åˆ°<code>ç¥–çˆ¶èŠ‚ç‚¹gu</code>ï¼Œé‡å¤æ‰§è¡Œç¬¬ä¸€æ­¥éª¤ã€‚</li></ul><p>ç¬¬4æ­¥çš„ä½œç”¨æ˜¯ç¡®ä¿æ•´æ£µçº¢é»‘æ ‘å‡ç¬¦åˆå…¶è§„åˆ™ï¼Œå› æ­¤å°†<code>ç¥–çˆ¶èŠ‚ç‚¹gu</code>æŸ“æˆçº¢è‰²ä¹‹åï¼Œå¯èƒ½<code>ç¥–çˆ¶èŠ‚ç‚¹guçš„çˆ¶èŠ‚ç‚¹æ˜¯çº¢è‰²</code>ï¼Œé‚£ä¹ˆè¿˜éœ€è¦å†æ¬¡å‘ä¸Šä¿®æ­£ï¼Œç›´åˆ°æŸä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸å­˜åœ¨ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰æˆ–å…¶çˆ¶èŠ‚ç‚¹æ˜¯é»‘è‰²èŠ‚ç‚¹ã€‚</p><p>ä¾‹å­ï¼š<br />æ’å…¥èŠ‚ç‚¹30ï¼Œå¯¼è‡´å½¢æˆLLrä¸å¹³è¡¡ï¼Œå°†<code>çˆ¶èŠ‚ç‚¹å’Œå”å”èŠ‚ç‚¹</code>ä¸<code>ç¥–çˆ¶èŠ‚ç‚¹</code>æ¢è‰²åç§»åŠ¨uåˆ°guï¼Œæ­¤æ—¶å†åˆ¤æ–­å…¶çˆ¶èŠ‚ç‚¹ä¸ºnullptrè¡¨ç¤ºè¾¾åˆ°äº†æ ¹èŠ‚ç‚¹rootï¼Œå› æ­¤ä¿®æ­£ç»“æŸï¼Œå¹¶å°†æ ¹èŠ‚ç‚¹rootæŸ“æˆé»‘è‰²ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/26.png" alt="" /></p><p>å…¶ä»–3ç§æƒ…å†µå¤„ç†ç±»ä¼¼ã€‚</p><h5 id="llb-lrb-rrb-rlb"><a class="markdownIt-Anchor" href="#llb-lrb-rrb-rlb"></a> LLbã€LRbã€RRbã€RLb</h5><p>è¿™4ç§æƒ…å†µåªéœ€è§£é‡Šå…¶ä¸­ä¸€ç§å°±èƒ½å¤Ÿä¸¾ä¸€åä¸‰äº†ã€‚<br />å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>è‹¥<code>çˆ¶èŠ‚ç‚¹pu/parentå­˜åœ¨ä¸”ä¸ºçº¢è‰²</code>ï¼Œåˆ™æ‰§è¡Œè¯¥è¿‡ç¨‹ï¼›å¦åˆ™å°†<code>æ ¹èŠ‚ç‚¹root</code>æŸ“æˆä¸º<code>é»‘è‰²</code>å¹¶ç»“æŸï¼›</li><li>æ ¹æ®<code>æ’å…¥èŠ‚ç‚¹u</code>ä½äº<code>çˆ¶èŠ‚ç‚¹pu</code>çš„å“ªä¸€ä¾§å¯¹<code>çˆ¶èŠ‚ç‚¹pu</code>æ—‹è½¬ï¼šè‹¥uåœ¨puå·¦è¾¹ï¼Œå¯¹puå³æ—‹ï¼›å¦åˆ™å·¦æ—‹ï¼›</li><li>æ—‹è½¬å®Œæˆåå¯¹<code>çˆ¶èŠ‚ç‚¹pu/parentå’Œå”å”èŠ‚ç‚¹gl/gr/uncleï¼ˆå¦‚æœå­˜åœ¨ï¼‰</code>ä¸<code>ç¥–çˆ¶èŠ‚ç‚¹gu</code>äº¤æ¢é¢œè‰²ï¼›ï¼ˆå®é™…ä¸Šï¼Œåªéœ€è¦å¯¹çˆ¶èŠ‚ç‚¹å’Œç¥–çˆ¶èŠ‚ç‚¹æ¢è‰²ï¼‰</li><li>æ ¹æ®<code>ç¥–çˆ¶èŠ‚ç‚¹gu</code>ä½äº<code>ç¥–çˆ¶èŠ‚ç‚¹guçˆ¶èŠ‚ç‚¹pgu</code>çš„å“ªä¸€ä¾§å¯¹<code>ç¥–çˆ¶èŠ‚ç‚¹gu</code>æ—‹è½¬ï¼šè‹¥guåœ¨pguå·¦è¾¹ï¼Œå¯¹guå³æ—‹ï¼›å¦åˆ™å·¦æ—‹ã€‚</li></ul><p>æ³¨æ„ï¼Œè¿™ç§ç±»å‹æ— éœ€å‘ä¸Šä¿®æ­£ï¼š<code>ç§»åŠ¨å½“å‰æ–°æ’å…¥çº¢è‰²èŠ‚ç‚¹uåˆ°ç¥–çˆ¶èŠ‚ç‚¹guï¼Œå†é‡å¤æ‰§è¡Œç¬¬ä¸€æ­¥éª¤</code>ï¼Œè¿™æ˜¯å› ä¸ºç»è¿‡ç¬¬2æ­¥æ—‹è½¬æ¢è‰²åï¼Œæ­¤æ—¶<code>çˆ¶èŠ‚ç‚¹pu</code>ä¸€å®šæ˜¯<code>é»‘è‰²</code>çš„ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡å†æ—‹è½¬åï¼Œæ­¤æ—¶<code>æ–°çš„ç¥–çˆ¶èŠ‚ç‚¹gu</code>ä¹Ÿä¸€å®šæ˜¯é»‘è‰²çš„ã€‚</p><p>ä¾‹å­ï¼š<br />å‘è¿™æ£µçº¢é»‘æ ‘æ’å…¥èŠ‚ç‚¹35ï¼Œå¯ä»¥çœ‹å‡ºè¿™æ˜¯LRbå‹ï¼Œè™½ç„¶ç¥–çˆ¶èŠ‚ç‚¹40çš„å³å­©å­æ˜¯NilèŠ‚ç‚¹ã€‚å…ˆæ˜¯å¯¹çˆ¶èŠ‚ç‚¹30å·¦æ—‹åå†äº¤æ¢ç¥–çˆ¶èŠ‚ç‚¹40(é»‘)å’Œçˆ¶èŠ‚ç‚¹35(çº¢)çš„é¢œè‰²ï¼ˆæ­¤å¤„å”å”èŠ‚ç‚¹ä¸ºNilï¼Œå› æ­¤æ²¡æœ‰æ¢è‰²ï¼‰ï¼Œç„¶åå¯¹ç¥–çˆ¶èŠ‚ç‚¹40å³æ—‹åå®Œæˆäº†ä¿®æ­£ã€‚<br />å®é™…ä¸Šï¼ŒLRbå‹ç»è¿‡<code>å·¦æ—‹</code>è½¬åŒ–ä¸ºLLbå‹ï¼ŒåŒæ ·RLbå‹ç»è¿‡<code>å³æ—‹</code>è½¬åŒ–ä¸ºRRbå‹ã€‚</p><p><img src="/uploads/images/data_structure/rbtree_cpp/27.png" alt="" /><br /><img src="/uploads/images/data_structure/rbtree_cpp/28.gif" alt="" /></p><p>å†çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå…¶å¤§è‡´è¿‡ç¨‹ï¼šæ’å…¥èŠ‚ç‚¹41åå½¢æˆ<code>LLr</code>å‹ï¼Œé‚£ä¹ˆäº¤æ¢<code>ç¥–çˆ¶èŠ‚ç‚¹45</code>å’Œ<code>çˆ¶èŠ‚ç‚¹44ã€å”å”èŠ‚ç‚¹46</code>çš„é¢œè‰²ï¼›ç§»åŠ¨uåˆ°guä½ç½®åå‘ç°æ­¤æ—¶u<code>å­˜åœ¨çˆ¶èŠ‚ç‚¹ä¸”ä¸ºçº¢è‰²</code>ï¼Œé‚£ä¹ˆè¿˜å¾—ç»§ç»­ä¿®æ­£ï¼›è€Œæ­¤æ—¶æ˜¯<code>LRb</code>å‹ï¼Œæ•…å…ˆå¯¹<code>çˆ¶èŠ‚ç‚¹40</code>å·¦æ—‹åè¿˜è¦äº¤æ¢<code>ç¥–çˆ¶èŠ‚ç‚¹50</code>å’Œ<code>çˆ¶èŠ‚ç‚¹45ã€å”å”èŠ‚ç‚¹60</code>çš„é¢œè‰²ï¼›ä¹‹åå†å¯¹<code>ç¥–çˆ¶èŠ‚ç‚¹45</code>å³æ—‹ï¼›æœ€åè¿˜è¦å°†<code>æ ¹èŠ‚ç‚¹root</code>æŸ“æˆé»‘è‰²ï¼Œè‡³æ­¤çº¢é»‘æ ‘å¹³è¡¡ï¼Œä¿®æ­£ç»“æŸã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/29.png" alt="" /></p><p>æ¼”ç¤ºè¿‡ç¨‹<br /><img src="/uploads/images/data_structure/rbtree_cpp/30.gif" alt="" /></p><h5 id="cä»£ç "><a class="markdownIt-Anchor" href="#cä»£ç "></a> C++ä»£ç </h5><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RedBlackTree::RedBlack_insertFixup</span><span class="hljs-params">(RBNodeEntry *pNode)</span></span>&#123;<br>    <span class="hljs-comment">// çˆ¶èŠ‚ç‚¹</span><br>    RBNodeEntry *parent=<span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-comment">// ç¥–çˆ¶èŠ‚ç‚¹</span><br>    RBNodeEntry *gparent=<span class="hljs-literal">nullptr</span>;<br>    <br>    <span class="hljs-comment">// å¦‚æœçˆ¶èŠ‚ç‚¹å­˜åœ¨ä¸”ä¸ºçº¢è‰²</span><br>    <span class="hljs-keyword">while</span>((parent=pNode-&gt;parent) &amp;&amp; parent-&gt;color==RED)&#123;<br>        gparent=parent-&gt;parent;<br>        <span class="hljs-comment">// L-å‹</span><br>        <span class="hljs-keyword">if</span>(parent==gparent-&gt;leftChild)&#123;        <br>            RBNodeEntry * uncle=gparent-&gt;rightChild;<br>            <span class="hljs-comment">// LLr/LRrå‹ å”å”èŠ‚ç‚¹æ˜¯çº¢è‰²ï¼Œé‚£ä¹ˆç›´æ¥æ¢è‰²</span><br>            <span class="hljs-keyword">if</span>(uncle!=m_Nil &amp;&amp; uncle-&gt;color==RED)&#123;<br>                parent-&gt;color=BLACK;<br>                uncle-&gt;color=BLACK;<br>                gparent-&gt;color=RED;<br>                <span class="hljs-comment">// ä»å½“å‰ç¥–çˆ¶èŠ‚ç‚¹å¼€å§‹ç»§ç»­å‘ä¸Šè°ƒæ•´</span><br>                pNode=gparent;<br>                <span class="hljs-keyword">continue</span>;<br>            <span class="hljs-comment">// LRbï¼Œå”å”èŠ‚ç‚¹græ˜¯é»‘è‰²èŠ‚ç‚¹(å¯ä»¥Nil)ï¼Œä¸”å½“å‰èŠ‚ç‚¹æ˜¯çˆ¶èŠ‚ç‚¹çš„å³å­©å­</span><br>            <span class="hljs-comment">// å°†LRbè½¬åŒ–ä¸ºLLbå‹</span><br>            &#125;<span class="hljs-keyword">if</span>(pNode==parent-&gt;rightChild)&#123;<br>                <span class="hljs-comment">// å¯¹çˆ¶èŠ‚ç‚¹å·¦æ—‹</span><br>                <span class="hljs-built_in">leftRotate</span>(parent);<br>            &#125;<br>            <span class="hljs-comment">// å¤„ç†LLbçš„æƒ…å†µ</span><br>            <span class="hljs-comment">// å…ˆæ¢è‰²ï¼Œåœ¨æ—‹è½¬</span><br>            parent-&gt;color=BLACK;<br>            gparent-&gt;color=RED;<br>            <span class="hljs-built_in">rightRotate</span>(gparent);<br>        &#125;<br>        <span class="hljs-comment">// R-å‹</span><br>        <span class="hljs-keyword">else</span>&#123;<br>            RBNodeEntry *uncle=gparent-&gt;leftChild;<br>            <span class="hljs-comment">// RLr/RRrå‹ å”å”èŠ‚ç‚¹æ˜¯çº¢è‰²</span><br>            <span class="hljs-keyword">if</span> (uncle!=m_Nil &amp;&amp; uncle-&gt;color==RED)&#123;<br>                uncle-&gt;color=BLACK;<br>                parent-&gt;color=BLACK;<br>                gparent-&gt;color=RED;<br>                <span class="hljs-comment">// ç»§ç»­å‘ä¸Šè°ƒæ•´</span><br>                pNode=gparent;<br>                <span class="hljs-keyword">continue</span>;<br>             <span class="hljs-comment">// RLbå‹ å”å”æ˜¯é»‘è‰²ï¼Œä¸”å½“å‰èŠ‚ç‚¹æ˜¯å·¦å­©å­</span><br>             <span class="hljs-comment">// è½¬åŒ–ä¸º RRb</span><br>            &#125; <span class="hljs-keyword">if</span>(pNode==parent-&gt;leftChild)&#123;<br>                <span class="hljs-built_in">rightRotate</span>(parent);<br>            &#125;<br>            <span class="hljs-comment">// RRbå‹</span><br>            parent-&gt;color=BLACK;<br>            gparent-&gt;color=RED;<br>            <span class="hljs-built_in">leftRotate</span>(gparent);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// æ ¹èŠ‚ç‚¹å¿…é¡»ä¸ºé»‘è‰²ï¼</span><br>    <span class="hljs-keyword">this</span>-&gt;m_RB_Root-&gt;color=BLACK;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="åˆ é™¤-2"><a class="markdownIt-Anchor" href="#åˆ é™¤-2"></a> åˆ é™¤</h4><p>çº¢é»‘æ ‘åˆ é™¤ç±»ä¼¼BSTï¼Œåˆ é™¤æ“ä½œçš„å‰åŠéƒ¨åˆ†ä»£ç ä¸€æ ·ï¼Œå·®åˆ«åœ¨äºåˆ é™¤åçº¢é»‘æ ‘çš„ä¿®æ­£ã€‚äº‹å®ä¸Šåˆ é™¤æ“ä½œçš„ä¿®æ­£è¦ååˆ†å¤æ‚ï¼Œè¦è€ƒè™‘çš„æƒ…å†µè¾ƒå¤šã€‚</p><ul><li>åœ¨çº¢é»‘æ ‘ä¸­æŸ¥æ‰¾è¯¥èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ï¼›</li><li>è‹¥å­˜åœ¨å·¦å­æ ‘å’Œå³å­æ ‘ï¼Œå¯»æ‰¾<code>å‰é©±/åç»§èŠ‚ç‚¹</code>å°†å…¶è½¬åŒ–ä¸º<code>åªæœ‰ä¸€ä¸ªå­æ ‘/å¶å­</code>æƒ…å†µï¼›</li><li>æ ¹æ®<code>childèŠ‚ç‚¹</code>ã€<code>childçš„å…„å¼ŸèŠ‚ç‚¹</code>ã€<code>childçš„çˆ¶èŠ‚ç‚¹</code>ä¿®æ­£åˆ é™¤åçš„çº¢é»‘æ ‘ï¼›</li><li>åˆ é™¤è¯¥èŠ‚ç‚¹ã€‚</li></ul><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">RedBlackTree::Remove</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key)</span> </span>&#123;<br>    RBNodeEntry *node=<span class="hljs-built_in">Search</span>(<span class="hljs-keyword">this</span>-&gt;m_RB_Root,key);<br>    <span class="hljs-keyword">if</span>(!node)<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>    RBNodeEntry *child=m_Nil;<br>    RBNodeEntry *parent=<span class="hljs-literal">nullptr</span>;<br><br>    <span class="hljs-comment">// å­˜åœ¨å·¦å­æ ‘å’Œå³å­æ ‘ï¼Œå°†å…¶è½¬åŒ–ä¸ºåªæœ‰ä¸€ä¸ªå­æ ‘/å¶å­æƒ…å†µ</span><br>    <span class="hljs-keyword">if</span> (node-&gt;leftChild!=m_Nil &amp;&amp; node-&gt;rightChild!=m_Nil) &#123;<br>        <span class="hljs-comment">// åç»§èŠ‚ç‚¹ï¼Œå³å°†æ˜¯è¦è¢«åˆ é™¤çš„èŠ‚ç‚¹</span><br>        RBNodeEntry *successor = <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">successor</span>(node);<br>        <span class="hljs-comment">// æ•°æ®æ›¿æ¢</span><br>        node-&gt;key=successor-&gt;key;<br>        node-&gt;data=successor-&gt;data;<br>        <span class="hljs-comment">// åˆ é™¤åç»§èŠ‚ç‚¹</span><br>        node=successor;<br>    &#125;<br>    <span class="hljs-comment">// è‹¥nodeæ˜¯å¶å­èŠ‚ç‚¹é‚£ä¹ˆleftChild=rightChild=m_Nil</span><br>    <span class="hljs-keyword">if</span>(node-&gt;leftChild!=m_Nil)&#123;<br>        child=node-&gt;leftChild;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        child=node-&gt;rightChild;<br>    &#125;<br>    <span class="hljs-comment">// å³ä½¿childæ˜¯Nilä¹Ÿè¦è®¾ç½®childçš„parentã€‚å› ä¸ºremoveFixupéœ€è¦parentæ¥ä¿®æ­£</span><br>    child-&gt;parent=node-&gt;parent;<br><br>    <span class="hljs-comment">// åˆ é™¤çš„æ˜¯æ ¹èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">if</span>(node-&gt;parent==<span class="hljs-literal">nullptr</span>)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;m_RB_Root=child;<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(node-&gt;parent-&gt;leftChild==node)&#123;<br>        node-&gt;parent-&gt;leftChild=child;<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>        node-&gt;parent-&gt;rightChild=child;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(node-&gt;color==BLACK)&#123;<br>        <span class="hljs-built_in">RedBlack_removeFixup</span>(child);<br>    &#125;<br>    <span class="hljs-comment">// ç›´æ¥åˆ é™¤èŠ‚ç‚¹å³å¯</span><br>    <span class="hljs-keyword">delete</span> node;<br>    node=<span class="hljs-literal">nullptr</span>;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h4 id="removefixup"><a class="markdownIt-Anchor" href="#removefixup"></a> RemoveFixup</h4><p>ç»™å‡ºä¸‹å›¾çš„åˆ é™¤æ“ä½œæ‰€å¼•èµ·çš„ä¸å¹³è¡¡æƒ…å†µæ¨¡æ¿<br /><img src="/uploads/images/data_structure/rbtree_cpp/31.png" alt="" /><br />å…¶ä¸­<code>ç™½è‰²èŠ‚ç‚¹</code>å¤„äº<code>æœªå®šå‹çŠ¶æ€</code>ï¼Œè¡¨ç¤ºå¯ä»¥ä¸ºé»‘/çº¢/èŠ‚ç‚¹ç”šè‡³NilèŠ‚ç‚¹ï¼Œä½†æ ¹èŠ‚ç‚¹ä¸€å®šæ˜¯é»‘è‰²èŠ‚ç‚¹ã€‚<code>èŠ‚ç‚¹u</code>è¡¨ç¤ºåˆ é™¤èŠ‚ç‚¹çš„<code>childèŠ‚ç‚¹</code>ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆè®¨è®ºåˆ é™¤<code>é»‘è‰²èŠ‚ç‚¹</code>çš„å¤æ‚æƒ…å†µã€‚è€Œä¸”æ˜¯ä¸Šå›¾çš„ç¬¬ä¸€ä¸ªæ¨¡æ¿ï¼Œå¦ä¸€ä¸ªä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼ˆæ—‹è½¬æ–¹å‘ç›¸åï¼‰ã€‚</p><h5 id="åˆ é™¤é»‘è‰²èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#åˆ é™¤é»‘è‰²èŠ‚ç‚¹"></a> åˆ é™¤é»‘è‰²èŠ‚ç‚¹</h5><p>åˆ é™¤é»‘è‰²èŠ‚ç‚¹å¼•èµ·çš„ä¸å¹³è¡¡å¤§è‡´æœ‰4ç§æƒ…å†µï¼š</p><ul><li>Case1ï¼š<code>å…„å¼ŸèŠ‚ç‚¹brother</code>ä¸º<code>çº¢è‰²</code>ï¼›</li><li>Case2ï¼š<code>å…„å¼ŸèŠ‚ç‚¹brother</code>ä¸º<code>é»‘è‰²</code>ï¼Œè€Œä¸”<code>brother</code>çš„<code>ä¸¤ä¸ªchild</code>ä¹Ÿéƒ½æ˜¯é»‘è‰²ï¼›</li><li>Case3ï¼š<code>å…„å¼ŸèŠ‚ç‚¹brother</code>ä¸º<code>é»‘è‰²</code>ï¼Œè€Œä¸”<code>brother</code>çš„<code>leftchild</code>æ˜¯çº¢è‰²ï¼Œ<code>rightchild</code>æ˜¯é»‘è‰²ï¼›</li><li>Case4ï¼š<code>å…„å¼ŸèŠ‚ç‚¹brother</code>ä¸º<code>é»‘è‰²</code>ï¼Œè€Œä¸”<code>brother</code>çš„<code>rightchild</code>æ˜¯çº¢è‰²ã€‚</li></ul><p><img src="/uploads/images/data_structure/rbtree_cpp/32.png" alt="" /></p><h6 id="case1"><a class="markdownIt-Anchor" href="#case1"></a> Case1</h6><p>è¿™ç§æƒ…å†µä¸‹æ˜¯<code>å…„å¼ŸèŠ‚ç‚¹brother</code>ä¸º<code>çº¢è‰²</code>ï¼Œé‚£ä¹ˆ<code>parentèŠ‚ç‚¹</code>ä¸€å®šé»‘è‰²ã€‚ä¿®æ­£è¿‡ç¨‹ä¸ºï¼š</p><ul><li>å°†<code>å…„å¼ŸèŠ‚ç‚¹brother</code>æŸ“æˆ<code>é»‘è‰²</code>ï¼›</li><li>å°†<code>uçš„çˆ¶èŠ‚ç‚¹parent</code>æŸ“æˆ<code>çº¢è‰²</code>ï¼›</li><li>å¯¹<code>parent</code>è¿›è¡Œ<code>å·¦æ—‹</code>ï¼›</li><li>ç§»åŠ¨<code>brother</code>åˆ°<code>uçš„çˆ¶èŠ‚ç‚¹parent</code>çš„<code>å³å­©å­rightchild</code>ã€‚</li></ul><p>æ³¨æ„ï¼Œè¿™ç§æƒ…å†µä¸‹ä¿®æ­£è¿˜æ²¡æœ‰ç»“æŸï¼<br /><img src="/uploads/images/data_structure/rbtree_cpp/33.png" alt="" /></p><p>å‡è®¾å­˜åœ¨å¦‚ä¸‹çº¢é»‘æ ‘ï¼Œåˆ é™¤èŠ‚ç‚¹aåä¸º<code>case 1</code>æƒ…å†µï¼Œç„¶è€Œç»è¿‡ç¬¬ä¸€æ¬¡ä¿®æ­£å‘ç°å¹¶æ²¡æœ‰å®Œå…¨å¹³è¡¡ï¼Œä¸è¿‡ç»è¿‡<code>case 1</code>å´æ„å¤–çš„è¿›å…¥äº†<code>case 2/3/4</code>ï¼Œé‚£ä¹ˆå°±ç»§ç»­ä¿®æ­£ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/34.png" alt="" /></p><h6 id="case2"><a class="markdownIt-Anchor" href="#case2"></a> Case2</h6><p>è¿™ç§æƒ…å†µæ˜¯ï¼š<code>brother</code>ä¸º<code>é»‘è‰²</code>ï¼Œè€Œä¸”<code>brother</code>çš„<code>ä¸¤ä¸ªchild</code>ä¹Ÿéƒ½æ˜¯é»‘è‰²ã€‚ä¿®æ­£çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><ul><li>å°†<code>brother</code>æŸ“æˆ<code>çº¢è‰²</code>ï¼›</li><li>ç§»åŠ¨<code>u</code>åˆ°å…¶<code>çˆ¶èŠ‚ç‚¹parent</code>ï¼›</li></ul><p>è‡³æ­¤ï¼Œå†æ ¹æ®<code>u</code>(å›¾ä¸­çš„<code>B</code>)çš„é¢œè‰²å¯ä»¥åˆ†ä¸¤ç§æƒ…å†µï¼š</p><ul><li><code>u</code>æ˜¯<code>çº¢è‰²</code>ï¼Œç»“æŸä¿®æ­£åŒæ—¶æŠŠ<code>u</code>æŸ“æˆ<code>é»‘è‰²</code>ï¼›</li><li><code>u</code>æ˜¯<code>é»‘è‰²ä¸”ä¸æ˜¯æ ¹èŠ‚ç‚¹root</code>ï¼Œåˆ™ç»§ç»­ä¸‹ä¸€è½®ä¿®æ­£è¿‡ç¨‹ï¼Œå†æ ¹æ®ä¸åŒæƒ…å†µè¿›è¡Œä¿®æ­£ã€‚</li></ul><p><img src="/uploads/images/data_structure/rbtree_cpp/35.png" alt="" /></p><h6 id="case3"><a class="markdownIt-Anchor" href="#case3"></a> Case3</h6><p>è¿™ç§æƒ…å†µæ˜¯ï¼š<code>brother</code>ä¸º<code>é»‘è‰²</code>ï¼Œè€Œä¸”<code>brother</code>çš„<code>leftchild</code>æ˜¯çº¢è‰²ï¼Œ<code>rightchild</code>æ˜¯é»‘è‰²ã€‚ä¿®æ­£çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><ul><li>å°†<code>brother</code>çš„<code>å·¦å­©å­leftchild</code>æŸ“æˆ<code>é»‘è‰²</code>ï¼›</li><li>å°†<code>brother</code>æŸ“æˆ<code>çº¢è‰²</code>ï¼›</li><li>å¯¹<code>brother</code>å³æ—‹ï¼›</li><li>ç§»åŠ¨<code>brother</code>åˆ°<code>uçš„çˆ¶èŠ‚ç‚¹parent</code>çš„<code>å³å­©å­rightchild</code>ã€‚</li></ul><p><img src="/uploads/images/data_structure/rbtree_cpp/36.png" alt="" /></p><h6 id="case4"><a class="markdownIt-Anchor" href="#case4"></a> Case4</h6><p>è¿™æ˜¯æœ€åä¸€ç§æƒ…å†µäº†ï¼š<code>brother</code>ä¸º<code>é»‘è‰²</code>ï¼Œè€Œä¸”<code>brother</code>çš„<code>rightchild</code>æ˜¯çº¢è‰²ã€‚ä¿®æ­£æ–¹æ³•ï¼š</p><ul><li>å°†<code>brother</code>æŸ“æˆ<code>uçš„çˆ¶èŠ‚ç‚¹parent</code>çš„é¢œè‰²(é»‘æˆ–çº¢)ï¼›</li><li>å°†<code>parent</code>æŸ“æˆé»‘è‰²ï¼›</li><li>å°†<code>brother</code>çš„<code>å³å­©å­rightchild</code>æŸ“æˆé»‘è‰²ï¼›</li><li>å¯¹<code>parent</code>å·¦æ—‹ï¼›</li><li>ç§»åŠ¨<code>u</code>ç§»è‡³<code>æ ¹èŠ‚ç‚¹root</code>ï¼Œç”¨äºç»“æŸä¿®æ­£å¾ªç¯ï¼ˆå›¾ä¸­èŠ‚ç‚¹båªæ˜¯èµ·æ¼”ç¤ºä½œç”¨ï¼Œä¸ä¸€å®šä¸ºrootï¼‰ï¼›</li><li>æœ€åä¿®æ”¹æ ¹èŠ‚ç‚¹rooté¢œè‰²ä¸ºé»‘è‰²ã€‚</li></ul><p><img src="/uploads/images/data_structure/rbtree_cpp/37.png" alt="" /></p><p>æ€»ç»“ä»¥ä¸Š4ç§æƒ…å†µï¼Œå®ƒä»¬ä¹‹é—´çš„è½¬åŒ–å…³ç³»å¤§æ¦‚å¦‚ä¸‹ï¼š</p><ul><li>Case1-&gt;Case2/3/4</li><li>Case3-&gt;Case4</li><li>Case1-&gt;Case3-&gt;Case4</li></ul><p>ä¿®æ­£å®ŒCase4å°±è¯´æ˜çº¢é»‘æ ‘å¹³è¡¡äº†</p><h6 id="case5"><a class="markdownIt-Anchor" href="#case5"></a> Case5</h6><p>å…¶å®è¿™ç±»æƒ…å†µæœ€ç®€å•äº†ï¼Œä¹Ÿå°±æ˜¯åˆ é™¤ä¸€ä¸ª<code>é»‘è‰²èŠ‚ç‚¹p</code>ï¼Œä½†å…¶<code>å­èŠ‚ç‚¹child</code>æ˜¯ä¸€ä¸ª<code>çº¢è‰²èŠ‚ç‚¹</code>ï¼Œæ— è®ºé»‘è‰²èŠ‚ç‚¹pçš„çˆ¶èŠ‚ç‚¹æ˜¯é»‘è‰²è¿˜æ˜¯çº¢è‰²ã€‚è¿™æ ·çš„è¯æ ¹æœ¬æ²¡å¿…è¦å†å»è€ƒè™‘ä¸Šè¿°4ç§æƒ…å†µäº†ã€‚</p><ul><li>åˆ é™¤é»‘è‰²èŠ‚ç‚¹ï¼Œå¦‚æœå­˜åœ¨<code>çº¢è‰²childèŠ‚ç‚¹</code>ï¼Œé‚£ä¹ˆå°†å…¶æŸ“æˆ<code>é»‘è‰²</code>ã€‚</li></ul><p><img src="/uploads/images/data_structure/rbtree_cpp/38.png" alt="" /></p><h5 id="åˆ é™¤çº¢è‰²èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#åˆ é™¤çº¢è‰²èŠ‚ç‚¹"></a> åˆ é™¤çº¢è‰²èŠ‚ç‚¹</h5><p>åˆ é™¤çº¢è‰²èŠ‚ç‚¹å¯èƒ½æ˜¯åˆ é™¤å¶å­èŠ‚ç‚¹æˆ–è€…å«æœ‰å­æ ‘çš„èŠ‚ç‚¹ã€‚å‰è€…å¾ˆå®¹æ˜“å®ç°ï¼Œå¯¹äºåè€…éœ€è¦æ‰¾åˆ°ä¸€ä¸ª<code>å‰é©±/åç»§èŠ‚ç‚¹</code>ï¼Œè€Œè¿™ä¸ªå‰é©±/åç»§èŠ‚ç‚¹å¯èƒ½æ˜¯é»‘è‰²æˆ–çº¢è‰²çš„ã€‚å¦‚æœæ˜¯çº¢è‰²ï¼Œé‚£å°±åˆ é™¤è¯¥çº¢è‰²å‰é©±/åç»§èŠ‚ç‚¹å¹¶å‘ä¸Šä¿®æ­£ç›´åˆ°å¹³è¡¡ï¼›å¦‚æœæ˜¯é»‘è‰²ï¼Œé‚£ä¹ˆå°±åˆ¤æ–­ä¸åŒçš„æƒ…å†µ<code>case1/2/3/4/5</code>å¹¶è¿›è¡Œä¿®æ­£ï¼›</p><p>åˆ é™¤çº¢è‰²èŠ‚ç‚¹55ï¼Œå‰é©±èŠ‚ç‚¹53ä¹Ÿæ˜¯çº¢è‰²èŠ‚ç‚¹<br /><img src="/uploads/images/data_structure/rbtree_cpp/39.png" alt="" /></p><p>åˆ é™¤çº¢è‰²èŠ‚ç‚¹65ï¼Œå‰é©±èŠ‚ç‚¹60æ˜¯é»‘è‰²èŠ‚ç‚¹ï¼Œéœ€è¦è¿›å…¥<code>case3</code>å’Œ<code>case4</code>ä¿®æ­£è¿‡ç¨‹ï¼›<br />åˆ é™¤çº¢è‰²èŠ‚ç‚¹65ï¼Œåç»§èŠ‚ç‚¹67æ˜¯çº¢è‰²èŠ‚ç‚¹ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/40.png" alt="" /></p><h5 id="ä¾‹å­"><a class="markdownIt-Anchor" href="#ä¾‹å­"></a> ä¾‹å­</h5><p>ä¸ºäº†è¯´æ˜æƒ…å†µï¼Œç°åœ¨ä»¥ä¸‹é¢è¿™æ£µçº¢é»‘æ ‘ä¸ºä¾‹å­æ¥è¯´æ˜åˆ é™¤æ“ä½œã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/41.png" alt="" /></p><p>åˆ é™¤<code>é»‘è‰²èŠ‚ç‚¹55</code>ï¼Œç”±äºå…¶å­èŠ‚ç‚¹ä¸º<code>Nil</code>ï¼Œæ•…å½¢æˆå¦‚ä¸‹çš„<code>case4</code>ï¼š</p><ul><li>å°†<code>å…„å¼ŸèŠ‚ç‚¹57</code>æŸ“æˆ<code>uèŠ‚ç‚¹Nil</code>çš„<code>çˆ¶èŠ‚ç‚¹56</code>çš„<code>çº¢è‰²</code>ï¼›</li><li>å°†<code>çˆ¶èŠ‚ç‚¹56</code>æŸ“æˆ<code>é»‘è‰²</code>å’Œ<code>å…„å¼ŸèŠ‚ç‚¹57</code>çš„<code>å³èŠ‚ç‚¹58</code>æŸ“æˆ<code>é»‘è‰²</code>ï¼›</li><li>å¯¹<code>çˆ¶èŠ‚ç‚¹56</code>å·¦æ—‹ï¼›</li><li>ç§»åŠ¨<code>u</code>ç§»è‡³æ ¹èŠ‚ç‚¹rootï¼Œç»“æŸä¿®æ­£å¾ªç¯ï¼›</li><li>ä¿®æ”¹<code>æ ¹èŠ‚ç‚¹root</code>é¢œè‰²ä¸ºé»‘è‰²ã€‚</li></ul><p><img src="/uploads/images/data_structure/rbtree_cpp/42.png" alt="" /><br />æœ€ç»ˆæ•ˆæœ<br /><img src="/uploads/images/data_structure/rbtree_cpp/43.png" alt="" /><br />åˆ é™¤<code>é»‘è‰²èŠ‚ç‚¹58</code>ï¼Œç”±äºå…¶å­èŠ‚ç‚¹ä¹Ÿä¸º<code>Nil</code>ï¼Œæ•…å½¢æˆå¦‚ä¸‹çš„<code>case2</code>ï¼š</p><ul><li>å°†<code>å…„å¼ŸèŠ‚ç‚¹56</code>æŸ“æˆ<code>çº¢è‰²</code>ï¼›</li><li>ç§»åŠ¨<code>u</code>åˆ°å…¶<code>çˆ¶èŠ‚ç‚¹57</code>ï¼›</li><li>ç”±äº<code>u</code>æ˜¯<code>çº¢è‰²</code>çš„ï¼Œå› æ­¤æŠŠ<code>çˆ¶èŠ‚ç‚¹57</code>æŸ“æˆ<code>é»‘è‰²</code>ï¼›</li><li>ç»“æŸä¿®æ­£ã€‚</li></ul><p><img src="/uploads/images/data_structure/rbtree_cpp/44.png" alt="" /><br />æœ€ç»ˆæ•ˆæœ<br /><img src="/uploads/images/data_structure/rbtree_cpp/45.png" alt="" /><br />ç°åœ¨åˆ é™¤<code>é»‘è‰²èŠ‚ç‚¹60</code>ï¼Œç”±äºå…¶å­˜åœ¨å·¦å³å­æ ‘ï¼Œå› æ­¤éœ€è¦å¯»æ‰¾å‰é©±/åç»§èŠ‚ç‚¹ï¼Œæ­¤å¤„å¯»æ‰¾å¾—<code>å‰é©±é»‘è‰²èŠ‚ç‚¹57</code>ï¼Œæ›¿æ¢<code>å‰é©±é»‘è‰²èŠ‚ç‚¹57</code>é”®å€¼åˆ°<code>é»‘è‰²èŠ‚ç‚¹60</code>ã€‚æ­¤æ—¶è½¬åŒ–ä¸ºåˆ é™¤<code>å‰é©±é»‘è‰²èŠ‚ç‚¹57</code>åå½¢æˆ<code>case5</code>ï¼Œç”±äºå…¶<code>å­èŠ‚ç‚¹56</code>ä¸ºçº¢è‰²ï¼Œæ•…åˆ é™¤äº†<code>å‰é©±é»‘è‰²èŠ‚ç‚¹57</code>åï¼Œå°†<code>å­èŠ‚ç‚¹56</code>æŸ“æˆ<code>é»‘è‰²</code>å¹¶ç»“æŸä¿®æ­£ã€‚<br /><img src="/uploads/images/data_structure/rbtree_cpp/46.png" alt="" /></p><p>ä¸Šè¿°æ¼”ç¤ºè¿‡ç¨‹<br /><img src="/uploads/images/data_structure/rbtree_cpp/47.gif" alt="" /></p><h5 id="cä»£ç -2"><a class="markdownIt-Anchor" href="#cä»£ç -2"></a> C++ä»£ç </h5><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RedBlackTree::RedBlack_removeFixup</span><span class="hljs-params">(RBNodeEntry*node)</span> </span>&#123;<br>    <span class="hljs-comment">// case5:</span><br>    <span class="hljs-comment">// è‹¥nodeæ˜¯çº¢è‰²ï¼Œé‚£ä¹ˆæŠŠå­èŠ‚ç‚¹nodeç›´æ¥æŸ“é»‘</span><br>    <span class="hljs-comment">// è‹¥nodeæ˜¯rootï¼Œé‚£ä¹ˆä¹ŸæŠŠå®ƒç›´æ¥æŸ“é»‘</span><br>    <span class="hljs-keyword">while</span> (node!=m_RB_Root &amp;&amp; node-&gt;color==BLACK) &#123;<br>        <span class="hljs-comment">// nodeæ˜¯å·¦èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">if</span> (node==node-&gt;parent-&gt;leftChild) &#123;<br>            RBNodeEntry *brother=node-&gt;parent-&gt;rightChild;<br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">            case1:</span><br><span class="hljs-comment">            case1æœ€ç»ˆè½¬åŒ–ä¸ºcase2/3/4</span><br><span class="hljs-comment">                1.å°†å…„å¼ŸèŠ‚ç‚¹brotheræŸ“æˆé»‘è‰²ï¼›</span><br><span class="hljs-comment">                2.å°†nodeçš„çˆ¶èŠ‚ç‚¹parentæŸ“æˆçº¢è‰²ï¼›</span><br><span class="hljs-comment">                3.å¯¹parentè¿›è¡Œå·¦æ—‹ï¼›</span><br><span class="hljs-comment">                4.ç§»åŠ¨brotheråˆ°nodeçš„çˆ¶èŠ‚ç‚¹parentçš„å³å­©å­rightchildã€‚</span><br><span class="hljs-comment">            */</span><br>            <span class="hljs-keyword">if</span>(brother-&gt;color==RED)&#123;<br>                brother-&gt;color=BLACK;<br>                node-&gt;parent-&gt;color=RED;<br>                <span class="hljs-built_in">leftRotate</span>(node-&gt;parent);<br>                brother=node-&gt;parent-&gt;rightChild;<br>            &#125;<br>            <br>            <span class="hljs-comment">/*</span><br><span class="hljs-comment">            case2:(å•ç‹¬å¤„ç†)</span><br><span class="hljs-comment">                1.å°†brotheræŸ“æˆçº¢è‰²ï¼›</span><br><span class="hljs-comment">                2.ç§»åŠ¨nodeåˆ°å…¶çˆ¶èŠ‚ç‚¹parentï¼›</span><br><span class="hljs-comment">            */</span>    <br>            <span class="hljs-keyword">if</span>(brother-&gt;leftChild-&gt;color==BLACK&amp;&amp;brother-&gt;rightChild-&gt;color==BLACK)&#123;<br>                brother-&gt;color=RED;<br>                node=node-&gt;parent;<br>            &#125;<br>            <span class="hljs-comment">// case3-&gt;case4</span><br>            <span class="hljs-keyword">else</span> &#123;   <br>                <span class="hljs-comment">/*</span><br><span class="hljs-comment">                case3:</span><br><span class="hljs-comment">                    1.å°†brotherçš„å·¦å­©å­leftchildæŸ“æˆé»‘è‰²ï¼›</span><br><span class="hljs-comment">                    2.å°†brotheræŸ“æˆçº¢è‰²ï¼›</span><br><span class="hljs-comment">                    3.å¯¹brotherå³æ—‹ï¼›</span><br><span class="hljs-comment">                    4.ç§»åŠ¨brotheråˆ°nodeçš„çˆ¶èŠ‚ç‚¹parentçš„å³å­©å­rightchildã€‚</span><br><span class="hljs-comment">                */</span><br>                <span class="hljs-keyword">if</span>(brother-&gt;rightChild-&gt;color==BLACK)&#123;<br>                    brother-&gt;leftChild-&gt;color=BLACK;<br>                    brother-&gt;color=RED;<br>                    <span class="hljs-built_in">rightRotate</span>(brother);<br>                    brother=node-&gt;parent-&gt;rightChild;<br>                &#125;<br>                <span class="hljs-comment">/*</span><br><span class="hljs-comment">                case4:</span><br><span class="hljs-comment">                    1.å°†brotheræŸ“æˆnodeçš„çˆ¶èŠ‚ç‚¹parentçš„é¢œè‰²(é»‘æˆ–çº¢)ï¼›</span><br><span class="hljs-comment">                    2.å°†parentæŸ“æˆé»‘è‰²ï¼›</span><br><span class="hljs-comment">                    3.å°†brotherçš„å³å­©å­rightchildæŸ“æˆé»‘è‰²ï¼›</span><br><span class="hljs-comment">                    4.å¯¹parentå·¦æ—‹ï¼›</span><br><span class="hljs-comment">                    5.ç§»åŠ¨nodeç§»è‡³æ ¹èŠ‚ç‚¹rootï¼Œç”¨äºç»“æŸä¿®æ­£å¾ªç¯ã€‚</span><br><span class="hljs-comment">                */</span><br>                brother-&gt;color=node-&gt;parent-&gt;color;<br>                node-&gt;parent-&gt;color=BLACK;<br>                brother-&gt;rightChild-&gt;color=BLACK;<br>                <span class="hljs-built_in">leftRotate</span>(node-&gt;parent);<br>                node=<span class="hljs-keyword">this</span>-&gt;m_RB_Root;<br>            &#125;<br>        <span class="hljs-comment">// nodeæ˜¯å³èŠ‚ç‚¹</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            RBNodeEntry *brother=node-&gt;parent-&gt;leftChild;<br>            <span class="hljs-comment">// case1-&gt;case2/3/4:</span><br>            <span class="hljs-keyword">if</span> (brother-&gt;color == RED) &#123;<br>                brother-&gt;color = BLACK;<br>                node-&gt;parent-&gt;color = RED;<br>                <span class="hljs-built_in">rightRotate</span>(node-&gt;parent);<br>                brother = node-&gt;parent-&gt;leftChild;<br>            &#125;<br>            <span class="hljs-comment">// case2:</span><br>            <span class="hljs-keyword">if</span> (brother-&gt;leftChild-&gt;color == BLACK&amp;&amp;brother-&gt;rightChild-&gt;color == BLACK) &#123;<br>                brother-&gt;color = RED;<br>                node = node-&gt;parent;<br>            &#125;<span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// case3:</span><br>                <span class="hljs-keyword">if</span> (brother-&gt;leftChild-&gt;color == BLACK)&#123;<br>                    brother-&gt;rightChild-&gt;color = BLACK;<br>                    brother-&gt;color = RED;<br>                    <span class="hljs-built_in">leftRotate</span>(brother);<br>                    brother = node-&gt;parent-&gt;leftChild;<br>                &#125;<br>                <span class="hljs-comment">// case4: </span><br>                brother-&gt;color = node-&gt;parent-&gt;color;<br>                node-&gt;parent-&gt;color = BLACK;<br>                brother-&gt;leftChild-&gt;color = BLACK;<br>                <span class="hljs-built_in">rightRotate</span>(node-&gt;parent);<br>                node = <span class="hljs-keyword">this</span>-&gt;m_RB_Root;<br>            &#125;<br>        &#125; <br>    &#125;<br>    <span class="hljs-comment">// å³ä½¿nodeæ˜¯Nilä¹ŸæŸ“é»‘</span><br>    node-&gt;color=BLACK;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h4><p>çº¢é»‘æ ‘å®åœ¨æ˜¯å¤ªå¤æ‚äº†ï¼Œè¿˜å¾—æ…¢æ…¢æ¥ï½å…³äºçº¢é»‘æ ‘å’ŒAVLæ ‘å·®åˆ«ï¼Œå¯ä»¥çœ‹çœ‹ <a href="https://stackoverflow.com/questions/13852870/red-black-tree-over-avl-tree">https://stackoverflow.com/questions/13852870/red-black-tree-over-avl-tree</a><br />ç¯‡å¹…æœ‰é™ï¼Œçº¢é»‘æ ‘å…¨éƒ¨æºç å°±ä¸å…¨æ”¾å‡ºæ¥äº†ï¼Œæ¯•ç«Ÿä¹Ÿå‚è€ƒäº†åˆ«äººå†™çš„ï¼Œä»…ä¾›å­¦ä¹ ç½¢äº†ï½<br />æœ‰å…´è¶£çš„å¯ä»¥å»çœ‹çœ‹æœ¬æ–‡çº¢é»‘æ ‘å¤§æ¦‚å®ç°æºç ï¼š<a href="https://josephxrays.coding.net/p/rbt_cpp_learn/d/rbt_cpp_learn/git">æºç é“¾æ¥</a></p><p>æ€»ä¹‹ï¼Œçº¢é»‘æ ‘ä¸Šçº¢é»‘æœï¼Œçº¢é»‘æ ‘ä¸‹ä½ å’Œæˆ‘ï½</p><p>bye~</p><h4 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h4><p><a href="https://zh.wikipedia.org/zh-hans/%E7%BA%A2%E9%BB%91%E6%A0%91">çº¢é»‘æ ‘-ç»´åŸºç™¾ç§‘</a><br /><a href="http://alrightchiu.github.io/SecondRound/red-black-tree-introjian-jie.html">Red Black Tree: Intro(ç°¡ä»‹)</a><br /><a href="https://riteme.site/blog/2016-3-12/2-3-tree-and-red-black-tree.html">2-3æ ‘ä¸çº¢é»‘æ ‘</a><br />ã€Šæ•°æ®ç»“æ„ã€ç®—æ³•ä¸åº”ç”¨ C++è¯­è¨€æè¿°ã€‹</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>DataStructures</tag>
      
      <tag>C</tag>
      
      <tag>çº¢é»‘æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„-AVLæ ‘</title>
    <link href="/avl-tree-cpp/"/>
    <url>/avl-tree-cpp/</url>
    
    <content type="html"><![CDATA[<p>AVLæ ‘æ˜¯æœ€æ—©è¢«å‘æ˜çš„<strong>è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘</strong>ã€‚å…¶æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤åœ¨<strong>å¹³å‡</strong>å’Œ<strong>æœ€å</strong>æƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ã€‚AVLæ ‘ç”±<strong>G. M. Adelson-Velsky</strong>å’Œ<strong>Evgenii Landis</strong>å‘æ˜ï¼ŒAVLæ ‘çš„åç§°å–è‡ªä»–ä»¬åå­—ä¸­çš„å­—æ¯ã€‚</p><span id="more"></span><h3 id="avlæ ‘"><a class="markdownIt-Anchor" href="#avlæ ‘"></a> AVLæ ‘</h3><p>åœ¨è®¨è®ºAVLæ ‘ä¹‹å‰å…ˆæ¥çœ‹ä¸€ä¸‹è¿™å¼ è¡¨</p><table>   <tr>        <td rowspan="2" align="center">æ–¹æ³•</td>        <td colspan="3" align="center">æœ€åæƒ…å†µ</td>        <td colspan="3" align="center">å¹³å‡æƒ…å†µ</td>   </tr>   <tr>   <td>æŸ¥æ‰¾</td><td>æ’å…¥</td><td>åˆ é™¤</td><td>æŸ¥æ‰¾</td><td>æ’å…¥</td><td>åˆ é™¤</td></tr>   <tr>   <td align="center">æœ‰åºæ•°ç»„</td>   <td>logn</td><td>n</td><td>n</td><td>logn</td><td>n</td><td>n</td></tr>   <tr><td align="center">æœ‰åºé“¾è¡¨</td>   <td>n</td><td>n</td><td>n</td><td>n</td><td>n</td><td>n</td></tr>   <tr><td align="center">è·³è¡¨</td>   <td>n</td><td>n</td><td>n</td><td>logn</td><td>logn</td><td>logn</td></tr>   <tr><td align="center">å“ˆå¸Œè¡¨</td>   <td>n</td><td>n</td><td>n</td><td>1</td><td>1</td><td>1</td></tr>   <tr><td align="center">BST</td>   <td>n</td><td>n</td><td>n</td><td>logn</td><td>logn</td><td>logn</td></tr>   <tr><td align="center">AVLæ ‘</td>   <td>logn</td><td>logn</td><td>logn</td><td>logn</td><td>logn</td><td>logn</td></tr>   <tr><td align="center">çº¢é»‘æ ‘</td>   <td>logn</td><td>logn</td><td>logn</td><td>logn</td><td>logn</td><td>logn</td></tr></table><p>åœ¨æœ€åæƒ…å†µä¸‹äºŒå‰æŸ¥æ‰¾æ ‘çš„å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ï¼Œè¿™ç§æƒ…å†µä¸‹BSTå‡ºç°ä¸¥é‡â€œç•¸å½¢â€ï¼Œæˆ–è€…é€€åŒ–æˆå•é“¾è¡¨ã€‚<br /><img src="/uploads/images/data_structure/avlTree_cpp/01.png" alt="" /></p><p>è¿™äº›æƒ…å†µç¡®å®å­˜åœ¨ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯ä¸ä¼šå‡ºç°â€œä¸€è¾¹å€’â€æƒ…å†µå‘¢ï¼Ÿè¿™æ—¶AVLæ ‘å°±è¯¥ç™»åœºäº†ã€‚</p><p>é¦–å…ˆæ¥å›é¡¾ä¹‹å‰çš„æ–‡ç« ï¼Œäº†è§£åˆ°äºŒå‰æŸ¥æ‰¾æ ‘çš„æ€§è´¨3ï¼š</p><blockquote><p>ä¸€æ£µäºŒå‰æ ‘æœ‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ä¸ªå…ƒç´ ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>ï¼Œå®ƒçš„é«˜åº¦æœ€å¤§ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ï¼Œæœ€å°é«˜åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">âŒˆ</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">âŒ‰</mo></mrow><annotation encoding="application/x-tex">\lceil log_2(n+1) \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">âŒˆ</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">âŒ‰</span></span></span></span>ã€‚</p></blockquote><p>AVLæ ‘è¦åšçš„å°±æ˜¯å°† é«˜åº¦æœ€å¤§ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> çš„æƒ…å†µå°½å¯èƒ½çš„è½¬åŒ–ä¸º æœ€å°é«˜åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">âŒˆ</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">âŒ‰</mo></mrow><annotation encoding="application/x-tex">\lceil log_2(n+1) \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">âŒˆ</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">âŒ‰</span></span></span></span> ã€‚</p><p><strong>AVLæ ‘ä¹Ÿæ˜¯äºŒå‰æŸ¥æ‰¾æ ‘ï¼ï¼ï¼</strong></p><h4 id="ç‰¹å¾"><a class="markdownIt-Anchor" href="#ç‰¹å¾"></a> ç‰¹å¾</h4><ul><li>ä¸€æ£µnä¸ªå…ƒç´ çš„AVLæ ‘é«˜åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li><li>å¯¹ä¸€æ£µnä¸ªå…ƒç´ çš„AVLæ ‘ï¼Œåœ¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>H</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(Height)=O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">e</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">h</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> æ—¶é—´å†…å¯ä»¥å®ç°æŸ¥æ‰¾æ“ä½œ</li><li>å¯¹ä¸€æ£µnä¸ªå…ƒç´ çš„AVLæ ‘æ’å…¥å’Œåˆ é™¤ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></li></ul><h4 id="å¹³è¡¡å› å­bf"><a class="markdownIt-Anchor" href="#å¹³è¡¡å› å­bf"></a> å¹³è¡¡å› å­bf</h4><p>AVLæ ‘æ˜¯é€šè¿‡å¹³è¡¡å› å­æ¥è°ƒæ•´äºŒå‰æŸ¥æ‰¾æ ‘ç»“æ„ä½¿å…¶å¹³è¡¡,ä¸”AVLæ ‘çš„å¹³è¡¡å› å­åªèƒ½æ˜¯ <strong>1ã€-1ã€0</strong>ï¼Œå¦åˆ™è¯¥æ ‘ä¸æ˜¯AVLæ ‘<br />èŠ‚ç‚¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>çš„å¹³è¡¡å› å­<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">bf(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>=<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>çš„å·¦å­æ ‘é«˜åº¦-<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>çš„å³å­æ ‘é«˜åº¦<br />ç”±äºå¹³è¡¡å› å­bfçš„é™å®šï¼Œä½¿å¾—AVLæ ‘å˜æˆ<strong>ä¸¥æ ¼å¹³è¡¡</strong>äºŒå‰æŸ¥æ‰¾æ ‘</p><p><img src="/uploads/images/data_structure/avlTree_cpp/02.png" alt="" /></p><h3 id="avlæ ‘çš„æ—‹è½¬"><a class="markdownIt-Anchor" href="#avlæ ‘çš„æ—‹è½¬"></a> AVLæ ‘çš„æ—‹è½¬</h3><p>é€ æˆäºŒå‰æŸ¥æ‰¾æ ‘çš„ä¸å¹³è¡¡æ¥è‡ªäºæ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œåœ¨æ’å…¥æˆ–åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹æ—¶æœ‰å‡ ç§ä¸å¹³è¡¡çŠ¶æ€ï¼Œåˆ†åˆ«ä¸ºâ€œå·¦å·¦/LLâ€ã€â€œå·¦å³/LRâ€ã€â€œå³å³/RRâ€ã€â€œå³å·¦/RLâ€ã€‚AVLæ ‘è¦åšçš„ï¼Œå°±æ˜¯å¤„ç†è¿™äº›ä¸å¹³è¡¡ç»“æ„ã€‚<br /><img src="/uploads/images/data_structure/avlTree_cpp/03.png" alt="" /></p><p>æ’å…¥æˆ–åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹åï¼Œå¯¼è‡´æ ¹èŠ‚ç‚¹çš„ <strong>å¹³è¡¡å› å­=å·¦å­æ ‘çš„é«˜åº¦-å³å­æ ‘çš„é«˜åº¦=2</strong>ï¼Œç»“æœAVLæ ‘å¤±å»äº†å¹³è¡¡</p><h4 id="ll"><a class="markdownIt-Anchor" href="#ll"></a> LL</h4><p>æ—‹è½¬è¿‡ç¨‹ï¼š<br />å°†<strong>å¹³è¡¡å› å­=2</strong>çš„æ ¹èŠ‚ç‚¹Xçš„<strong>å·¦èŠ‚ç‚¹L</strong>ä½œä¸ºæ—‹è½¬åçš„æ ¹èŠ‚ç‚¹ï¼ŒåŒæ—¶å°†Lçš„å³å­©å­è°ƒæ•´ä¸ºXçš„å·¦å­©å­ã€‚<br />æœ€åæ›´æ–°å„ä¸ªèŠ‚ç‚¹çš„bf</p><p><img src="/uploads/images/data_structure/avlTree_cpp/04.png" alt="" /></p><h4 id="rr"><a class="markdownIt-Anchor" href="#rr"></a> RR</h4><p>æ—‹è½¬è¿‡ç¨‹ï¼š<br />å°†<strong>å¹³è¡¡å› å­=2</strong>çš„æ ¹èŠ‚ç‚¹Xçš„<strong>å³èŠ‚ç‚¹R</strong>ä½œä¸ºæ—‹è½¬åçš„æ ¹èŠ‚ç‚¹ï¼ŒåŒæ—¶å°†Rçš„å·¦å­©å­è°ƒæ•´ä¸ºXçš„å³å­©å­ã€‚<br />æœ€åæ›´æ–°å„ä¸ªèŠ‚ç‚¹çš„bf</p><p><img src="/uploads/images/data_structure/avlTree_cpp/05.png" alt="" /></p><h4 id="lr"><a class="markdownIt-Anchor" href="#lr"></a> LR</h4><p>LRå‹æ—‹è½¬éœ€è¦ä¸¤æ¬¡æ—‹è½¬ï¼Œå³å…ˆå·¦æ—‹(RR)åå³æ—‹(LL)<br />é¦–å…ˆå›´ç»•ä¸å¹³è¡¡æ ¹èŠ‚ç‚¹bf=2çš„<strong>å·¦å­©å­</strong>è¿›è¡Œå·¦æ—‹ï¼Œå†å›´ç»•<strong>æ ¹èŠ‚ç‚¹</strong>è¿›è¡Œå³æ—‹</p><p><img src="/uploads/images/data_structure/avlTree_cpp/06.png" alt="" /></p><h4 id="rl"><a class="markdownIt-Anchor" href="#rl"></a> RL</h4><p>RLå‹æ—‹è½¬ä¹Ÿéœ€è¦ä¸¤æ¬¡æ—‹è½¬ï¼Œå³å…ˆå³æ—‹(LL)åå·¦æ—‹(RR)<br />é¦–å…ˆå›´ç»•ä¸å¹³è¡¡æ ¹èŠ‚ç‚¹bf=2çš„<strong>å³å­©å­</strong>è¿›è¡Œå³æ—‹ï¼Œå†å›´ç»•<strong>æ ¹èŠ‚ç‚¹</strong>è¿›è¡Œå·¦æ—‹</p><p><img src="/uploads/images/data_structure/avlTree_cpp/07.png" alt="" /></p><h3 id="cä»£ç "><a class="markdownIt-Anchor" href="#cä»£ç "></a> C++ä»£ç </h3><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ªèŠ‚ç‚¹ç»“æ„ä½“</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">AVLNodeEntry</span>&#123;</span><br>    <span class="hljs-keyword">int</span> key;<br>    T data;<br>    <span class="hljs-keyword">int</span> height;<br>    AVLNodeEntry *parent;<br>    AVLNodeEntry *left_nodes;<br>    AVLNodeEntry *right_nodes;<br>&#125;;<br></code></pre></div></td></tr></table></figure><p>AVLæ ‘æ¨¡æ¿ç±»</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AVLTree</span> &#123;</span><br><span class="hljs-keyword">private</span>:<br>    AVLNodeEntry&lt;T&gt;* m_NodeRoot;<br>    <span class="hljs-keyword">int</span> m_binaryTree_length;<br>    <span class="hljs-keyword">int</span> m_m_binaryTree_maxKey;<br>    <span class="hljs-keyword">int</span> m_m_binaryTree_minKey;<br>    <span class="hljs-keyword">bool</span> m_isClear;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">AVLTree</span>();<br>    <span class="hljs-built_in">AVLTree</span>(<span class="hljs-keyword">int</span>  k,<span class="hljs-keyword">const</span> T&amp; v);<br>    ~<span class="hljs-built_in">AVLTree</span>();<br><br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Height</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* pNode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Insert</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* &amp; pNode,AVLNodeEntry&lt;T&gt;* pNodeParent,<span class="hljs-keyword">int</span> key,<span class="hljs-keyword">const</span> T&amp; value)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Remove</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* pNode,<span class="hljs-keyword">int</span> key)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Delete</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* &amp; pNode,<span class="hljs-keyword">int</span> key)</span></span>;<br>    <span class="hljs-function">AVLNodeEntry&lt;T&gt;* &amp; <span class="hljs-title">GetRootNoder</span><span class="hljs-params">()</span></span>;<br>    <br>    <span class="hljs-function">AVLNodeEntry&lt;T&gt;* <span class="hljs-title">Search</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* pNode,<span class="hljs-keyword">int</span> key)</span></span>;<br>    <span class="hljs-function">AVLNodeEntry&lt;T&gt;* <span class="hljs-title">GetMaxNode</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function">AVLNodeEntry&lt;T&gt;* <span class="hljs-title">GetMinNode</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function">AVLNodeEntry&lt;T&gt;* <span class="hljs-title">predecessor</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* cur_node)</span></span>;<br>    <span class="hljs-function">AVLNodeEntry&lt;T&gt;* <span class="hljs-title">successor</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* cur_node)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">static</span> AVLNodeEntry&lt;T&gt;* <span class="hljs-title">CreateElementBy</span><span class="hljs-params">(<span class="hljs-keyword">int</span>  key,<span class="hljs-keyword">const</span> T&amp; value,AVLNodeEntry&lt;T&gt;* pParent= <span class="hljs-literal">nullptr</span>)</span></span>;<br>   <br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ClearAll</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* &amp; pNode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PreOrder</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* pRootNode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InOrder</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* pRootNode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PostOrder</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* pRootNode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LevelOrder</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* pRootNode)</span></span>;<br><br>    <span class="hljs-comment">// è®¡ç®—èŠ‚ç‚¹çš„é«˜åº¦</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">CalcHeight</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* pNode)</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(!pNode)<span class="hljs-keyword">return</span>;<br>        pNode-&gt;height=std::<span class="hljs-built_in">max</span>(<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes),<span class="hljs-built_in">Height</span>(pNode-&gt;right_nodes))+<span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-function">AVLNodeEntry&lt;T&gt;* <span class="hljs-title">LLRotation</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* &amp;pRootNode)</span></span>;<br>    <span class="hljs-function">AVLNodeEntry&lt;T&gt;* <span class="hljs-title">RRRotation</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* &amp;pRootNode)</span></span>;<br>    <span class="hljs-function">AVLNodeEntry&lt;T&gt;* <span class="hljs-title">LRRotation</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* &amp;pRootNode)</span></span>;<br>    <span class="hljs-function">AVLNodeEntry&lt;T&gt;* <span class="hljs-title">RLRotation</span><span class="hljs-params">(AVLNodeEntry&lt;T&gt;* &amp;pRootNode)</span></span>;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h4 id="æ—‹è½¬"><a class="markdownIt-Anchor" href="#æ—‹è½¬"></a> æ—‹è½¬</h4><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>AVLNodeEntry&lt;T&gt;* AVLTree&lt;T&gt;::<span class="hljs-built_in">LLRotation</span>(AVLNodeEntry&lt;T&gt;* &amp;pRootNode)&#123;<br>    <span class="hljs-keyword">if</span>(!pRootNode)<span class="hljs-keyword">return</span> pRootNode;<br>    AVLNodeEntry&lt;T&gt;*  leftChild=pRootNode-&gt;left_nodes;<br>    pRootNode-&gt;left_nodes=leftChild-&gt;right_nodes;<br>    <span class="hljs-keyword">if</span>(leftChild-&gt;right_nodes!=<span class="hljs-literal">nullptr</span>)&#123;<br>        leftChild-&gt;right_nodes-&gt;parent=pRootNode;<br>    &#125;<br>    leftChild-&gt;right_nodes=pRootNode;<br>    <br>    leftChild-&gt;parent=pRootNode-&gt;parent;<br>    pRootNode-&gt;parent=leftChild;<br><br>    <span class="hljs-built_in">CalcHeight</span>(pRootNode);<br>    <span class="hljs-built_in">CalcHeight</span>(leftChild);<br><br>    pRootNode=leftChild;<br>    <span class="hljs-keyword">if</span>(pRootNode-&gt;parent==<span class="hljs-literal">nullptr</span>)<br>        <span class="hljs-keyword">this</span>-&gt;m_NodeRoot=pRootNode;<br>    <span class="hljs-keyword">return</span> leftChild;<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>AVLNodeEntry&lt;T&gt;* AVLTree&lt;T&gt;::<span class="hljs-built_in">RRRotation</span>(AVLNodeEntry&lt;T&gt;* &amp;pRootNode)&#123;<br>    <span class="hljs-keyword">if</span>(!pRootNode)<span class="hljs-keyword">return</span> pRootNode;<br>    AVLNodeEntry&lt;T&gt;*  rightChild=pRootNode-&gt;right_nodes;<br>    pRootNode-&gt;right_nodes=rightChild-&gt;left_nodes;<br>    <span class="hljs-keyword">if</span>(rightChild-&gt;left_nodes!=<span class="hljs-literal">nullptr</span>)&#123;<br>        rightChild-&gt;left_nodes-&gt;parent=pRootNode;<br>    &#125;<br>    rightChild-&gt;left_nodes=pRootNode;<br><br>    rightChild-&gt;parent=pRootNode-&gt;parent;<br>    pRootNode-&gt;parent=rightChild; <br><br>    <span class="hljs-built_in">CalcHeight</span>(pRootNode);<br>    <span class="hljs-built_in">CalcHeight</span>(rightChild);<br><br>    pRootNode=rightChild;<br>    <span class="hljs-keyword">if</span>(pRootNode-&gt;parent==<span class="hljs-literal">nullptr</span>)<br>        <span class="hljs-keyword">this</span>-&gt;m_NodeRoot=pRootNode;<br>    <span class="hljs-keyword">return</span> rightChild;<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>AVLNodeEntry&lt;T&gt;* AVLTree&lt;T&gt;::<span class="hljs-built_in">LRRotation</span>(AVLNodeEntry&lt;T&gt;* &amp;pRootNode)&#123;<br>    <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">RRRotation</span>(pRootNode-&gt;left_nodes);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">LLRotation</span>(pRootNode);<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>AVLNodeEntry&lt;T&gt;* AVLTree&lt;T&gt;::<span class="hljs-built_in">RLRotation</span>(AVLNodeEntry&lt;T&gt;* &amp;pRootNode)&#123;<br>    <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">LLRotation</span>(pRootNode-&gt;right_nodes);<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">RRRotation</span>(pRootNode);<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="æ’å…¥"><a class="markdownIt-Anchor" href="#æ’å…¥"></a> æ’å…¥</h4><p>æ’å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹åï¼Œå¯èƒ½å¯¼è‡´AVLæ ‘ä¸å¹³è¡¡ï¼Œå› æ­¤éœ€è¦åˆ¤æ–­å¹³è¡¡å› å­bfï¼Œè‹¥bfä¸º2æˆ–-2è¯´æ˜éœ€è¦è¿›è¡Œæ—‹è½¬æ“ä½œã€‚ä¸è¿‡åªéœ€è¦åˆ¤æ–­bfæ˜¯å¦ä¸º2å³å¯ï¼Œè¿™æ˜¯ç”±éå†çš„é¡ºåºå†³å®šçš„ã€‚<br />æ¯æ¬¡æ’å…¥å®Œæˆéƒ½éœ€è¦æ›´æ–°èŠ‚ç‚¹çš„é«˜åº¦</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> AVLTree&lt;T&gt;::<span class="hljs-built_in">Insert</span>(AVLNodeEntry&lt;T&gt;* &amp; pNode,AVLNodeEntry&lt;T&gt;* pNodeParent,<span class="hljs-keyword">int</span> key,<span class="hljs-keyword">const</span> T&amp; value) &#123;<br>    <span class="hljs-keyword">if</span>(pNode == <span class="hljs-literal">nullptr</span>)&#123;<br>        pNode=<span class="hljs-keyword">new</span> AVLNodeEntry&lt;T&gt;;<br>        pNode-&gt;key=key;<br>        pNode-&gt;left_nodes= <span class="hljs-literal">nullptr</span>;<br>        pNode-&gt;right_nodes= <span class="hljs-literal">nullptr</span>;<br>        pNode-&gt;data=value;<br>        pNode-&gt;parent=pNodeParent;<br>        pNode-&gt;height=<span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-comment">// éå†å·¦å­æ ‘</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(key &lt; pNode-&gt;key)&#123;<br>        <span class="hljs-built_in">Insert</span>(pNode-&gt;left_nodes,pNode,key,value);<br>        <span class="hljs-comment">// æ’å…¥å®Œæˆåæ£€æŸ¥æ˜¯å¦å¹³è¡¡äº†</span><br>        <span class="hljs-comment">// è‹¥å¹³è¡¡å› å­ä¸º2è¡¨ç¤ºä¸å¹³è¡¡</span><br>        <span class="hljs-comment">// åªéœ€è¦åˆ¤æ–­å·¦å³ä¸¤è¾¹æ ‘çš„é«˜åº¦ä¹‹å·®</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes)-<span class="hljs-built_in">Height</span>(pNode-&gt;right_nodes)==<span class="hljs-number">2</span>)&#123;<br>            <span class="hljs-keyword">if</span>(key &lt; pNode-&gt;left_nodes-&gt;key)&#123;<br>                <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">LLRotation</span>(pNode);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">LRRotation</span>(pNode);<br>            &#125;<br>        &#125;<br><br>    &#125;<span class="hljs-comment">// å¦åˆ™å³å­æ ‘</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(key &gt; pNode-&gt;key)&#123;<br>        <span class="hljs-built_in">Insert</span>(pNode-&gt;right_nodes,pNode,key,value);<br>        <span class="hljs-comment">// æ’å…¥å®Œæˆåæ£€æŸ¥æ˜¯å¦å¹³è¡¡äº†</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Height</span>(pNode-&gt;right_nodes)-<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes)==<span class="hljs-number">2</span>)&#123;<br>            <span class="hljs-keyword">if</span>(key &gt; pNode-&gt;right_nodes-&gt;key)&#123;<br>                <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">RRRotation</span>(pNode);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">RLRotation</span>(pNode);<br>            &#125;<br>        &#125;<br>    &#125;<span class="hljs-comment">//å¦‚æœå·²ç»å­˜åœ¨äº†</span><br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">//cout&lt;&lt;&quot;Already exist!&quot;&lt;&lt;endl;</span><br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-comment">// æ’å…¥å®Œæˆåæ›´æ–°é«˜åº¦!</span><br>    <span class="hljs-comment">// ä» 0 å¼€å§‹è®¡æ•°ï¼Œå› æ­¤éœ€è¦åŠ 1</span><br>    <span class="hljs-built_in">CalcHeight</span>(pNode); <span class="hljs-comment">// +1è¡¨ç¤ºåŒ…æ‹¬å½“å‰æ ¹èŠ‚ç‚¹</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="åˆ é™¤"><a class="markdownIt-Anchor" href="#åˆ é™¤"></a> åˆ é™¤</h4><p>åˆ é™¤æ“ä½œç±»ä¼¼äºŒå‰æŸ¥æ‰¾æ ‘çš„åˆ é™¤æ“ä½œï¼ŒåŒæ ·éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå‰é©±/åç»§èŠ‚ç‚¹ã€‚<br />ä¸è¿‡æ­¤å¤„åˆ é™¤æ“ä½œæ˜¯åœ¨ä¸€ä¸ªé€’å½’å‡½æ•°ä¸­è¿›è¡Œçš„</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> AVLTree&lt;T&gt;::<span class="hljs-built_in">Delete</span>(AVLNodeEntry&lt;T&gt;* &amp; pNode,<span class="hljs-keyword">int</span> key) &#123;<br>    <span class="hljs-keyword">if</span>(!pNode)<span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">if</span> (key &lt; pNode-&gt;key)&#123;<br>        <span class="hljs-comment">// åœ¨å·¦å­æ ‘ä¸­åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹</span><br>        <span class="hljs-built_in">Delete</span>(pNode-&gt;left_nodes,key);<br>        <span class="hljs-comment">// åˆ é™¤åé‡æ–°å¹³è¡¡</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Height</span>(pNode-&gt;right_nodes)-<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes)==<span class="hljs-number">2</span>)&#123; <br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Height</span>(pNode-&gt;right_nodes-&gt;left_nodes)&gt;=<span class="hljs-built_in">Height</span>(pNode-&gt;right_nodes-&gt;right_nodes))&#123;<br>                <span class="hljs-built_in">RLRotation</span>(pNode);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-built_in">RRRotation</span>(pNode);<br>            &#125;                <br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key &gt; pNode-&gt;key)&#123;<br>        <span class="hljs-comment">// åœ¨å³å­æ ‘ä¸­åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹</span><br>        <span class="hljs-built_in">Delete</span>(pNode-&gt;right_nodes,key);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes)-<span class="hljs-built_in">Height</span>(pNode-&gt;right_nodes)==<span class="hljs-number">2</span>)&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes-&gt;left_nodes)&gt;=<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes-&gt;right_nodes))&#123;<br>                <span class="hljs-built_in">LLRotation</span>(pNode);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-built_in">LRRotation</span>(pNode);<br>            &#125;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// å·¦å³å­æ ‘éƒ½å­˜åœ¨</span><br>        <span class="hljs-keyword">if</span> (pNode-&gt;left_nodes&amp;&amp;pNode-&gt;right_nodes)&#123;<br>            <span class="hljs-comment">// æ‰¾åˆ°ä¸€ä¸ªåç»§èŠ‚ç‚¹ </span><br>            AVLNodeEntry&lt;T&gt;* successor=<span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">successor</span>(pNode);<br>            pNode-&gt;key=successor-&gt;key;<br>            pNode-&gt;data=successor-&gt;data;<br>            <span class="hljs-comment">// åˆ é™¤é‚£ä¸ªåç»§èŠ‚ç‚¹</span><br>            <span class="hljs-built_in">Delete</span>(pNode-&gt;right_nodes,successor-&gt;key);<br>            <span class="hljs-comment">// ç„¶åå†æ¬¡é‡æ–°å¹³è¡¡</span><br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes)-<span class="hljs-built_in">Height</span>(pNode-&gt;right_nodes)==<span class="hljs-number">2</span>)&#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes-&gt;left_nodes)&gt;=<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes-&gt;right_nodes))&#123;<br>                    <span class="hljs-built_in">LLRotation</span>(pNode);<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-built_in">LRRotation</span>(pNode);<br>                &#125;<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-comment">// åˆ é™¤åªæœ‰ä¸€ä¸ªå­æ ‘å’Œå¶å­æƒ…å†µ</span><br>            <span class="hljs-keyword">auto</span> pDeleteNode=pNode;<br>             <span class="hljs-comment">// ä¿å­˜å…¶å­èŠ‚ç‚¹ï¼Œæ— è®ºæ˜¯å¦ä¸ºç©º</span><br>            AVLNodeEntry&lt;T&gt;* childNode=<span class="hljs-literal">nullptr</span>;<br>            <span class="hljs-keyword">if</span>(pDeleteNode-&gt;left_nodes!=<span class="hljs-literal">nullptr</span>)&#123;<br>                childNode=pDeleteNode-&gt;left_nodes;<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(pDeleteNode-&gt;right_nodes!=<span class="hljs-literal">nullptr</span>)&#123;<br>                childNode=pDeleteNode-&gt;right_nodes;<br>            &#125;<br>            <span class="hljs-comment">// å¦‚æœå­˜åœ¨å­èŠ‚ç‚¹ï¼ˆä¸æ˜¯å¶å­ï¼‰ï¼Œé‚£ä¹ˆä¿®æ”¹å…¶æŒ‡å‘çˆ¶èŠ‚ç‚¹</span><br>            <span class="hljs-keyword">if</span>(childNode!=<span class="hljs-literal">nullptr</span>)&#123;<br>                childNode-&gt;parent=pDeleteNode-&gt;parent;<br>            &#125;<br>            <span class="hljs-comment">// åˆ é™¤çš„æ˜¯æ ¹èŠ‚ç‚¹</span><br>            <span class="hljs-keyword">if</span>(pDeleteNode-&gt;parent==<span class="hljs-literal">nullptr</span>)&#123;<br>                <span class="hljs-keyword">this</span>-&gt;m_NodeRoot=childNode;<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(pDeleteNode-&gt;parent-&gt;left_nodes==pDeleteNode)&#123;<br>                <span class="hljs-comment">// ä¿®æ”¹å¾…åˆ é™¤èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æŒ‡å‘å¾…åˆ é™¤èŠ‚ç‚¹çš„å­èŠ‚ç‚¹</span><br>                pDeleteNode-&gt;parent-&gt;left_nodes=childNode;<br>            &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pDeleteNode-&gt;parent-&gt;right_nodes==pDeleteNode)&#123;<br>                pDeleteNode-&gt;parent-&gt;right_nodes=childNode;<br>            &#125;<br>            <span class="hljs-keyword">delete</span> pDeleteNode;<br>            pDeleteNode=<span class="hljs-literal">nullptr</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// è·Ÿæ–°èŠ‚ç‚¹é«˜åº¦</span><br>    <span class="hljs-keyword">if</span>(pNode)&#123;<br>        <span class="hljs-built_in">CalcHeight</span>(pNode);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æºç ï¼š <a href="https://josephxrays.coding.net/p/avlTree_c/git">https://josephxrays.coding.net/p/avlTree_c/git</a></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>DataStructures</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„-äºŒå‰æŸ¥æ‰¾æ ‘(BST)</title>
    <link href="/bst-cpp/"/>
    <url>/bst-cpp/</url>
    
    <content type="html"><![CDATA[<p>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæ ‘æ˜¯ä¸€ç§<strong>éçº¿æ€§æ•°æ®ç»“æ„</strong>ï¼Œæ ‘çš„ç§ç±»æœ‰å¤§è‡´åˆ†ä¸ºä¸¤ç±»:<strong>æ— åºæ ‘</strong>å’Œ<strong>æœ‰åºæ ‘</strong>ã€‚æœ‰åºæ ‘åˆåˆ†ä¸ºäºŒå‰æŸ¥æ‰¾æ ‘ã€å †ã€å·¦é«˜æ ‘ã€AVLæ ‘ã€çº¢é»‘æ ‘ç­‰ã€‚æ ‘æ˜¯ä¸€ç§éå¸¸é‡è¦çš„æ•°æ®ç»“æ„ï¼Œå¦‚C++ STLä¸­çš„mapåº•å±‚å®ç°åŸç†æ˜¯çº¢é»‘æ ‘ï¼ŒJava (jdk1.8) HashMapæ›´æ˜¯é‡‡ç”¨äº†æ•£åˆ—è¡¨+é“¾è¡¨+çº¢é»‘æ ‘ã€‚<br />ä¸è¿‡åœ¨è®¨è®ºäºŒå‰æŸ¥æ‰¾æ ‘ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£æ ‘çš„ä¸€äº›åŸºæœ¬çŸ¥è¯†ã€‚</p><span id="more"></span><h3 id="æ ‘"><a class="markdownIt-Anchor" href="#æ ‘"></a> æ ‘</h3><p>ä¸€æ£µæ ‘tæ˜¯ä¸€ä¸ª<strong>éç©º</strong>çš„<strong>æœ‰é™</strong>ä¸ªå…ƒç´ çš„é›†åˆï¼Œå…¶ä¸­ä¸€ä¸ªå…ƒç´ ä¸ºæ ¹(root)ï¼Œè‹¥å…¶ä½™å…ƒç´ å­˜åœ¨ï¼Œåˆ™ç»„æˆtçš„å­æ ‘</p><p>å¦‚ä¸‹å›¾å›¾3ä¸ºä»…æœ‰ä¸€ä¸ªå…ƒç´ çš„æ ‘ï¼Œä¸”è¯¥å…ƒç´ ä¸ºæ ‘çš„æ ¹(root)<br /><img src="/uploads/images/data_structure/bst_cpp/01.png" alt="" /></p><h4 id="å…³äºæ ‘çš„æœ¯è¯­æ‘˜è‡ªç»´åŸºç™¾ç§‘"><a class="markdownIt-Anchor" href="#å…³äºæ ‘çš„æœ¯è¯­æ‘˜è‡ªç»´åŸºç™¾ç§‘"></a> å…³äºæ ‘çš„æœ¯è¯­(æ‘˜è‡ªç»´åŸºç™¾ç§‘)</h4><p><strong>èŠ‚ç‚¹çš„åº¦</strong>ï¼šä¸€ä¸ªèŠ‚ç‚¹å«æœ‰çš„<strong>å­æ ‘çš„ä¸ªæ•°</strong>ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„åº¦<br /><strong>æ ‘çš„åº¦</strong>ï¼šä¸€æ£µæ ‘ä¸­ï¼Œ<strong>æœ€å¤§çš„èŠ‚ç‚¹åº¦</strong>ç§°ä¸ºæ ‘çš„åº¦<br /><strong>å¶èŠ‚ç‚¹æˆ–ç»ˆç«¯èŠ‚ç‚¹</strong>ï¼š<strong>åº¦ä¸ºé›¶</strong>çš„èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰èŠ‚ç‚¹çš„èŠ‚ç‚¹<br /><strong>éç»ˆç«¯èŠ‚ç‚¹æˆ–åˆ†æ”¯èŠ‚ç‚¹</strong>ï¼š<strong>åº¦ä¸ä¸ºé›¶</strong>çš„èŠ‚ç‚¹<br /><strong>çˆ¶äº²èŠ‚ç‚¹æˆ–çˆ¶èŠ‚ç‚¹</strong>ï¼šè‹¥ä¸€ä¸ªèŠ‚ç‚¹<strong>å«æœ‰å­èŠ‚ç‚¹</strong>ï¼Œåˆ™è¿™ä¸ªèŠ‚ç‚¹ç§°ä¸ºå…¶å­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹<br /><strong>å­©å­èŠ‚ç‚¹æˆ–å­èŠ‚ç‚¹</strong>ï¼šä¸€ä¸ªèŠ‚ç‚¹å«æœ‰çš„å­æ ‘çš„æ ¹èŠ‚ç‚¹ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹<br /><strong>å…„å¼ŸèŠ‚ç‚¹</strong>ï¼šå…·æœ‰<strong>ç›¸åŒçˆ¶èŠ‚ç‚¹</strong>çš„èŠ‚ç‚¹äº’ç§°ä¸ºå…„å¼ŸèŠ‚ç‚¹<br /><strong>èŠ‚ç‚¹çš„å±‚æ¬¡</strong>ï¼šä»æ ¹å¼€å§‹å®šä¹‰èµ·ï¼Œæ ¹ä¸ºç¬¬1å±‚ï¼Œæ ¹çš„å­èŠ‚ç‚¹ä¸ºç¬¬2å±‚ï¼Œä»¥æ­¤ç±»æ¨<br /><font color=red><strong>æ·±åº¦</strong>ï¼šå¯¹äºä»»æ„èŠ‚ç‚¹n,nçš„æ·±åº¦ä¸ºä»æ ¹åˆ°nçš„å”¯ä¸€è·¯å¾„é•¿ï¼Œæ ¹çš„æ·±åº¦ä¸º0</font><br /><font color=red><strong>é«˜åº¦</strong>ï¼šå¯¹äºä»»æ„èŠ‚ç‚¹n,nçš„é«˜åº¦ä¸ºä»nåˆ°<strong>å¶å­èŠ‚ç‚¹</strong>çš„<strong>æœ€é•¿è·¯å¾„é•¿</strong>ï¼Œæ‰€æœ‰æ ‘å¶çš„é«˜åº¦ä¸º0</font><br /><strong>å ‚å…„å¼ŸèŠ‚ç‚¹</strong>ï¼šçˆ¶èŠ‚ç‚¹åœ¨åŒä¸€å±‚çš„èŠ‚ç‚¹äº’ä¸ºå ‚å…„å¼Ÿ<br /><strong>èŠ‚ç‚¹çš„ç¥–å…ˆ</strong>ï¼šä»æ ¹åˆ°è¯¥èŠ‚ç‚¹æ‰€ç»åˆ†æ”¯ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹<br /><strong>å­å­™</strong>ï¼šä»¥æŸèŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘ä¸­ä»»ä¸€èŠ‚ç‚¹éƒ½ç§°ä¸ºè¯¥èŠ‚ç‚¹çš„å­å­™<br /><strong>æ£®æ—</strong>ï¼šç”±mï¼ˆm&gt;=0ï¼‰æ£µ<strong>äº’ä¸ç›¸äº¤</strong>çš„æ ‘çš„é›†åˆç§°ä¸ºæ£®æ—</p><p>é«˜åº¦å’Œæ·±åº¦çš„åŒºåˆ«å…¶å®ä¸ç”¨å¤ªåœ¨æ„ï¼Œä¸åŒçš„äººæœ‰ä¸åŒçš„å®šä¹‰ã€‚<br />è‹¥æœ‰å…´è¶£å¯ä»¥å»stackoverflow <a href="https://stackoverflow.com/questions/2603692/what-is-the-difference-between-tree-depth-and-height">What is the difference between tree depth and height?<br /></a> çœ‹çœ‹</p><h3 id="äºŒå‰æ ‘"><a class="markdownIt-Anchor" href="#äºŒå‰æ ‘"></a> äºŒå‰æ ‘</h3><p>å®šä¹‰ï¼šä¸€æ£µäºŒå‰æ ‘(binary tree) t æ˜¯<strong>æœ‰é™</strong>ä¸ªå…ƒç´ çš„é›†åˆ(å¯ä»¥ä¸ºç©º)ã€‚å½“äºŒå‰æ ‘éç©ºæ—¶ï¼Œå…¶ä¸­ä¸€ä¸ªå…ƒç´ ç§°ä¸º<strong>æ ¹</strong>ï¼Œè‹¥å­˜åœ¨å…¶ä½™å…ƒç´ ï¼Œåˆ™åˆ†ä¸ºä¸¤é¢—äºŒå‰æ ‘ï¼Œåˆ†åˆ«ç§°ä¸º t çš„<strong>å·¦å­æ ‘</strong>å’Œ<strong>å³å­æ ‘</strong></p><p>äºŒå‰æ ‘ä¸­æ¯ä¸ªå…ƒç´ çš„å·¦å­æ ‘å’Œå³å­æ ‘æ˜¯<strong>æœ‰åºçš„</strong>ï¼Œè€Œæ ‘çš„å­æ ‘æ˜¯<strong>æ— åºçš„</strong></p><h4 id="æ€§è´¨"><a class="markdownIt-Anchor" href="#æ€§è´¨"></a> æ€§è´¨</h4><p>äºŒå‰æ ‘çš„æ€§è´¨æœ‰å¾ˆå¤šï¼Œè¿™é‡Œä»…åˆ—ä¸¾å…¶ä¸­çš„ä¸€äº›ã€‚</p><p>æ€§è´¨1ï¼šä¸€æ£µäºŒå‰æ ‘æœ‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ä¸ªå…ƒç´ ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>ï¼Œå®ƒæœ‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>æ¡è¾¹<br />æ€§è´¨2ï¼šä¸€æ£µäºŒå‰æ ‘çš„é«˜åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>â‰¥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">h\ge0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>ï¼Œå®ƒæœ€å°‘æœ‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>ä¸ªå…ƒç´ ï¼Œæœ€å¤šæœ‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>h</mi></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^h-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ä¸ªå…ƒç´ <br />æ€§è´¨3ï¼šä¸€æ£µäºŒå‰æ ‘æœ‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ä¸ªå…ƒç´ ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">n&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>ï¼Œå®ƒçš„é«˜åº¦æœ€å¤§ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ï¼Œæœ€å°é«˜åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">âŒˆ</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">âŒ‰</mo></mrow><annotation encoding="application/x-tex">\lceil log_2(n+1) \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">âŒˆ</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">âŒ‰</span></span></span></span>ã€‚<br />æ€§è´¨4ï¼šè®¾<strong>å®Œå…¨äºŒå‰æ ‘</strong>å…¶ä¸­ä¸€ä¸ªå…ƒç´ ç¼–å·<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mi mathvariant="normal">ï¼Œ</mi><mn>1</mn><mo>â‰¤</mo><mi>i</mi><mo>â‰¤</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">iï¼Œ1 \le i \le n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">i</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ï¼Œåˆ™:</p><ul><li>è‹¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ï¼Œåˆ™è¯¥å…ƒç´ ä¸ºäºŒå‰æ ‘çš„æ ¹ã€‚è‹¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ï¼Œåˆ™å…¶çˆ¶èŠ‚ç‚¹çš„ç¼–å·ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">âŒŠ</mo><mfrac><mi>i</mi><mn>2</mn></mfrac><mo stretchy="false">âŒ‹</mo></mrow><annotation encoding="application/x-tex">\lfloor \frac{i}{2} \rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.200664em;vertical-align:-0.345em;"></span><span class="mopen">âŒŠ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.855664em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">âŒ‹</span></span></span></span></li><li>è‹¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>i</mi><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">2i&gt;n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ï¼Œåˆ™è¯¥å…ƒç´ æ— å·¦å­©å­ã€‚å¦åˆ™ï¼Œå…¶å·¦å­©å­ç¼–å·<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>i</mi></mrow><annotation encoding="application/x-tex">2i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span></span></span></span></li><li>è‹¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">2i+1&gt;n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ï¼Œåˆ™è¯¥å…ƒç´ æ— å³å­©å­ã€‚å¦åˆ™ï¼Œå…¶å³å­©å­ç¼–å·<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2i+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li></ul><p>å½“é«˜åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span></span></span></span>çš„äºŒå‰æ ‘æ°å¥½æœ‰<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>h</mi></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^h-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.932438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>ä¸ªå…ƒç´ æ—¶ï¼Œç§°ä¸º<strong>æ»¡äºŒå‰æ ‘</strong>ã€‚<br /><img src="/uploads/images/data_structure/bst_cpp/02.png" alt="" /></p><p><strong>å®Œå…¨äºŒå‰æ ‘</strong>å¯ä»¥çœ‹ä½œæ˜¯æ»¡äºŒå‰æ ‘åˆ é™¤æœ€åº•å±‚æœ€å³è¾¹çš„å…ƒç´ åå½¢æˆçš„ä¸€æ£µæ ‘ã€‚<br />æ»¡äºŒå‰æ ‘ä¸€å®šæ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œå®Œå…¨äºŒå‰æ ‘ä¸ä¸€å®šæ˜¯æ»¡äºŒå‰æ ‘<br /><img src="/uploads/images/data_structure/bst_cpp/03.png" alt="" /></p><h4 id="äºŒå‰æ ‘æè¿°"><a class="markdownIt-Anchor" href="#äºŒå‰æ ‘æè¿°"></a> äºŒå‰æ ‘æè¿°</h4><p>äºŒå‰æ ‘æè¿°æ—¢å¯ä»¥<strong>æ•°ç»„</strong>ä¹Ÿå¯ä»¥ç”¨<strong>é“¾è¡¨</strong>ã€‚å…¶ä¸­ç”¨æ•°ç»„æè¿°çš„ä¸€èˆ¬æ˜¯<strong>äºŒå‰å †</strong>ï¼Œç”¨é“¾è¡¨æè¿°çš„æ¯”è¾ƒå¸¸ç”¨ï¼Œé€‚ç”¨èŒƒå›´å¹¿ã€‚å› æ­¤æœ¬æ–‡ä¸»è¦æ˜¯åŸºäºé“¾è¡¨æè¿°çš„äºŒå‰æŸ¥æ‰¾æ ‘æ¥å±•å¼€</p><h3 id="äºŒå‰æŸ¥æ‰¾æ ‘binary-search-tree"><a class="markdownIt-Anchor" href="#äºŒå‰æŸ¥æ‰¾æ ‘binary-search-tree"></a> äºŒå‰æŸ¥æ‰¾æ ‘(Binary Search Tree)</h3><p>äºŒå‰æŸ¥æ‰¾æ ‘ä¹Ÿå¯å«åšäºŒå‰æœç´¢æ ‘ï¼Œå…¶æ»¡è¶³ä»¥ä¸‹ç‰¹å¾:</p><ul><li>æ¯ä¸ªå…ƒç´ æœ‰<strong>å”¯ä¸€</strong>çš„ä¸€ä¸ªå…³é”®å­—</li><li><strong>å·¦å­æ ‘</strong>çš„å…ƒç´ çš„å…³é”®å­—<strong>å°äº</strong> <strong>æ ¹èŠ‚ç‚¹</strong>çš„å…³é”®å­—</li><li><strong>å³å­æ ‘</strong>çš„å…ƒç´ çš„å…³é”®å­—<strong>å¤§äº</strong> <strong>æ ¹èŠ‚ç‚¹</strong>çš„å…³é”®å­—</li><li>æ ¹èŠ‚ç‚¹çš„å·¦å³å­æ ‘ä¹Ÿæ˜¯äºŒå‰æŸ¥æ‰¾æ ‘</li></ul><p><img src="/uploads/images/data_structure/bst_cpp/03.png" alt="" /></p><p>å®šä¹‰ä¸€ä¸ªbstèŠ‚ç‚¹ç»“æ„</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">NodeEntry</span>&#123;</span><br>    <span class="hljs-keyword">int</span> key; <span class="hljs-comment">// å…³é”®å­—</span><br>    T data; <span class="hljs-comment">// æ•°æ®åŸŸ </span><br>    NodeEntry *parent; <span class="hljs-comment">// çˆ¶èŠ‚ç‚¹</span><br>    NodeEntry *left_nodes; <span class="hljs-comment">// å·¦å­æ ‘</span><br>    NodeEntry *right_nodes; <span class="hljs-comment">// å³å­æ ‘</span><br>&#125;;<br></code></pre></div></td></tr></table></figure><p>bstæ¨¡æ¿ç±»</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">binaryTree</span></span><br><span class="hljs-class">&#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-keyword">typedef</span> T value_type;<br>    <span class="hljs-keyword">typedef</span> T&amp; reference_type;<br>    <span class="hljs-keyword">typedef</span> <span class="hljs-keyword">const</span> T&amp; const_reference_type;<br>    <span class="hljs-keyword">typedef</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span>&amp; const_key_type;<br><br>    <span class="hljs-keyword">typedef</span> NodeEntry&lt;T&gt; NODE;<br>    <span class="hljs-keyword">typedef</span> NodeEntry&lt;T&gt;&amp; REF_NODE;<br>    <span class="hljs-keyword">typedef</span> NodeEntry&lt;T&gt;* PNODE;<br>    <span class="hljs-keyword">typedef</span> NodeEntry&lt;T&gt;* &amp; REF_PNODE;<br><span class="hljs-keyword">private</span>:<br>    PNODE m_NodeRoot;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">binaryTree</span>();<br>    <span class="hljs-built_in">binaryTree</span>(const_key_type  k,const_reference_type v);<br>    ~<span class="hljs-built_in">binaryTree</span>();<br><br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">Height</span><span class="hljs-params">(PNODE pNode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Insert</span><span class="hljs-params">(REF_PNODE pNode,PNODE pNodeParent,const_key_type key,const_reference_type value)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Delete</span><span class="hljs-params">(PNODE pNode,const_key_type key)</span></span>;<br>    <span class="hljs-function">NodeEntry&lt;T&gt;* <span class="hljs-title">Search</span><span class="hljs-params">(PNODE pNode,const_key_type key)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ClearAll</span><span class="hljs-params">(REF_PNODE pNode)</span></span>;<br><br>    <span class="hljs-function">NodeEntry&lt;T&gt;* <span class="hljs-title">predecessor</span><span class="hljs-params">(NODE* pNode)</span></span>;<br>    <span class="hljs-function">NodeEntry&lt;T&gt;* <span class="hljs-title">successor</span><span class="hljs-params">(NODE* pNode)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PreOrder</span><span class="hljs-params">(NODE * pRootNode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">InOrder</span><span class="hljs-params">(NODE * pRootNode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PostOrder</span><span class="hljs-params">(NODE * pRootNode)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">LevelOrder</span><span class="hljs-params">(NODE * pRootNode)</span></span>;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h4 id="éå†"><a class="markdownIt-Anchor" href="#éå†"></a> éå†</h4><p>bstæœ‰ä¸‰ç§éå†æ–¹å¼</p><ul><li>å‰åºéå†</li><li>ä¸­åºéå†</li><li>ååºéå†</li><li>å±‚çº§éå†</li></ul><h5 id="å‰åºéå†"><a class="markdownIt-Anchor" href="#å‰åºéå†"></a> å‰åºéå†</h5><p>å…ˆè®¿é—®å½“å‰èŠ‚ç‚¹ï¼Œç„¶åå†éå†å·¦å­æ ‘ï¼Œæœ€åéå†å³å­æ ‘<br /><img src="/uploads/images/data_structure/bst_cpp/04.png" alt="" /></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br><span class="hljs-keyword">void</span> binaryTree&lt;T&gt;::<span class="hljs-built_in">PreOrder</span>(binaryTree::NODE *pRootNode) &#123;<br>    <span class="hljs-keyword">if</span>(pRootNode== <span class="hljs-literal">nullptr</span>)&#123;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    cout&lt;&lt;pRootNode-&gt;key&lt;&lt;endl;<br>    <span class="hljs-built_in">PreOrder</span>(pRootNode-&gt;left_nodes);<br>    <span class="hljs-built_in">PreOrder</span>(pRootNode-&gt;right_nodes);<br>&#125;<br></code></pre></div></td></tr></table></figure><h5 id="ä¸­åºéå†"><a class="markdownIt-Anchor" href="#ä¸­åºéå†"></a> ä¸­åºéå†</h5><p>å…ˆéå†å·¦å­æ ‘ï¼Œå†è®¿é—®å½“å‰èŠ‚ç‚¹ï¼Œæœ€åéå†å³å­æ ‘<br /><img src="/uploads/images/data_structure/bst_cpp/05.png" alt="" /></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br><span class="hljs-keyword">void</span> binaryTree&lt;T&gt;::<span class="hljs-built_in">InOrder</span>(binaryTree::NODE *pRootNode) &#123;<br>    <span class="hljs-keyword">if</span>(pRootNode == <span class="hljs-literal">nullptr</span>)&#123;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-built_in">InOrder</span>(pRootNode-&gt;left_nodes);<br>    cout&lt;&lt;pRootNode-&gt;key&lt;&lt;endl;<br>    <span class="hljs-built_in">InOrder</span>(pRootNode-&gt;right_nodes);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯è§ä¸­åºéå†èƒ½å¤Ÿæœ‰åºè¾“å‡ºèŠ‚ç‚¹</p><h5 id="ååºéå†"><a class="markdownIt-Anchor" href="#ååºéå†"></a> ååºéå†</h5><p>å…ˆéå†å·¦å­æ ‘ï¼Œå†éå†å³å­æ ‘ï¼Œæœ€åè®¿é—®å½“å‰èŠ‚ç‚¹<br /><img src="/uploads/images/data_structure/bst_cpp/06.png" alt="" /></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">void</span> binaryTree&lt;T&gt;::<span class="hljs-built_in">PostOrder</span>(binaryTree::NODE *pRootNode) &#123;<br>    <span class="hljs-keyword">if</span>(pRootNode== <span class="hljs-literal">nullptr</span>)&#123;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-built_in">PostOrder</span>(pRootNode-&gt;left_nodes);<br>    <span class="hljs-built_in">PostOrder</span>(pRootNode-&gt;right_nodes);<br>    cout&lt;&lt;pRootNode-&gt;key&lt;&lt;endl;<br>&#125;<br></code></pre></div></td></tr></table></figure><h5 id="å±‚çº§éå†"><a class="markdownIt-Anchor" href="#å±‚çº§éå†"></a> å±‚çº§éå†</h5><p>ä¸»è¦æ˜¯åˆ©ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢å®ç°çš„<br /><img src="/uploads/images/data_structure/bst_cpp/07.png" alt="" /></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br><span class="hljs-keyword">void</span> binaryTree&lt;T&gt;::<span class="hljs-built_in">LevelOrder</span>(binaryTree::NODE *pRootNode) &#123;<br>    <span class="hljs-keyword">if</span>(!pRootNode)<span class="hljs-keyword">return</span>;<br>    queue&lt;binaryTree::PNODE&gt;q;<br>    q.<span class="hljs-built_in">push</span>(pRootNode);<br>    <span class="hljs-keyword">while</span> (!q.<span class="hljs-built_in">empty</span>())&#123;<br>        binaryTree::PNODE pNode=q.<span class="hljs-built_in">front</span>();<br>        cout&lt;&lt;pNode-&gt;key&lt;&lt;endl;<br>        <span class="hljs-comment">// å·¦å­æ ‘å­˜åœ¨ï¼Œå…ˆå¤„ç†å·¦è¾¹</span><br>        <span class="hljs-keyword">if</span>(pNode-&gt;left_nodes)&#123;<br>            q.<span class="hljs-built_in">push</span>(pNode-&gt;left_nodes);<br>        &#125;<br>        <span class="hljs-comment">// å³å­æ ‘å­˜åœ¨ï¼Œåœ¨å¤„ç†å³è¾¹</span><br>        <span class="hljs-keyword">if</span>(pNode-&gt;right_nodes) &#123;<br>            q.<span class="hljs-built_in">push</span>(pNode-&gt;right_nodes);<br>        &#125;<br>        <span class="hljs-comment">// å¤„ç†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>        q.<span class="hljs-built_in">pop</span>();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="é«˜åº¦"><a class="markdownIt-Anchor" href="#é«˜åº¦"></a> é«˜åº¦</h4><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br><span class="hljs-keyword">int</span> binaryTree&lt;T&gt;::<span class="hljs-built_in">Height</span>(binaryTree::PNODE pNode) &#123;<br>    <span class="hljs-keyword">if</span>(!pNode)<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> h1=<span class="hljs-built_in">Height</span>(pNode-&gt;left_nodes);<br>    <span class="hljs-keyword">int</span> h2=<span class="hljs-built_in">Height</span>(pNode-&gt;right_nodes);<br>    <span class="hljs-comment">// é«˜åº¦ä»0å¼€å§‹è®¡æ•°ï¼Œå› æ­¤é«˜åº¦è¦åŠ 1</span><br>    <span class="hljs-keyword">return</span> std::<span class="hljs-built_in">max</span>(h1,h2)+<span class="hljs-number">1</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="æŸ¥æ‰¾"><a class="markdownIt-Anchor" href="#æŸ¥æ‰¾"></a> æŸ¥æ‰¾</h4><p>bstæŸ¥æ‰¾ç±»ä¼¼<strong>äºŒåˆ†æŸ¥æ‰¾</strong>ã€‚å¾ˆç®€å•</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br>NodeEntry&lt;T&gt; *binaryTree&lt;T&gt;::<span class="hljs-built_in">Search</span>(PNODE pNode,const_key_type key) &#123;<br>    <span class="hljs-keyword">if</span>(!pNode)<span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-keyword">if</span>(pNode-&gt;key==key)&#123;<br>        <span class="hljs-keyword">return</span> pNode;<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(key&lt;pNode-&gt;key)&#123;<br>        <span class="hljs-comment">//left</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Search</span>(pNode-&gt;left_nodes,key);<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(key&gt;pNode-&gt;key)&#123;<br>        <span class="hljs-comment">//right</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Search</span>(pNode-&gt;right_nodes,key);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="å‰é©±åç»§èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#å‰é©±åç»§èŠ‚ç‚¹"></a> å‰é©±/åç»§èŠ‚ç‚¹</h4><p>è¦å®Œæˆbstçš„åˆ é™¤æ“ä½œï¼Œé‚£ä¹ˆå°±å¿…é¡»è¦çŸ¥é“å‰é©±/åç»§èŠ‚ç‚¹æ€ä¹ˆæ‰¾ã€‚<br /><strong>å‰é©±èŠ‚ç‚¹</strong>ï¼š å‡è®¾å­˜åœ¨ä¸€ä¸ªèŠ‚ç‚¹Nï¼Œé‚£ä¹ˆå®ƒçš„å‰é©±èŠ‚ç‚¹å°±æ˜¯<strong>å…³é”®å­—</strong>å°äºNçš„ä¸”æœ€å¤§çš„èŠ‚ç‚¹ã€‚å³<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">[</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>o</mi><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>&lt;</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">[</mo><mi>N</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">key[max(predecessor)]&lt;key[N]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">]</span></span></span></span></p><p><strong>åç»§èŠ‚ç‚¹</strong>ï¼š å‡è®¾å­˜åœ¨ä¸€ä¸ªèŠ‚ç‚¹Nï¼Œé‚£ä¹ˆå®ƒçš„åç»§èŠ‚ç‚¹å°±æ˜¯<strong>å…³é”®å­—</strong>å¤§äºNçš„ä¸”æœ€å°çš„èŠ‚ç‚¹ã€‚å³<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">[</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>s</mi><mi>u</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>o</mi><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>&gt;</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">[</mo><mi>N</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">key[min(successor)]&gt;key[N]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">]</span></span></span></span></p><p>æ ¹æ®å‰é©±èŠ‚ç‚¹å®šä¹‰æŸ¥æ‰¾ï¼š</p><ul><li>è‹¥èŠ‚ç‚¹N<strong>æœ‰å·¦å­æ ‘L</strong>ï¼šä¸”å·¦å­æ ‘Lçš„å³å­æ ‘å­˜åœ¨ï¼Œåˆ™ä¾æ¬¡éå†Lçš„å³å­æ ‘ç›´åˆ°<strong>å¶å­èŠ‚ç‚¹</strong>ï¼Œå°±æ˜¯å‰é©±èŠ‚ç‚¹ï¼›å¦åˆ™è¯¥å·¦å­æ ‘Lå°±æ˜¯å‰é©±èŠ‚ç‚¹</li><li>è‹¥èŠ‚ç‚¹N<strong>æ— å·¦å­æ ‘</strong>ï¼Œä½†èŠ‚ç‚¹Næ˜¯å…¶çˆ¶èŠ‚ç‚¹Pçš„<strong>å³å­©å­</strong>ï¼Œé‚£ä¹ˆçˆ¶èŠ‚ç‚¹På°±æ˜¯è¯¥èŠ‚ç‚¹Nçš„å‰é©±ç»“ç‚¹</li><li>è‹¥èŠ‚ç‚¹N<strong>æ— å·¦å­æ ‘</strong>ï¼Œä½†è¯¥èŠ‚ç‚¹Næ˜¯å…¶çˆ¶èŠ‚ç‚¹Pçš„<strong>å·¦å­©å­</strong>ï¼Œé‚£ä¹ˆéœ€è¦æ²¿ç€çˆ¶äº²èŠ‚ç‚¹Pä¸€ç›´å‘æ ‘çš„é¡¶ç«¯å¯»æ‰¾ï¼Œ<strong>ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹Xæ˜¯å…¶çˆ¶èŠ‚ç‚¹Mçš„å³å­©å­</strong>ï¼Œåˆ™èŠ‚ç‚¹Mä¸ºå‰é©±èŠ‚ç‚¹</li></ul><p>ä»¥ä¸Šä¸‰ç§æƒ…å†µåˆ†åˆ«å¯¹åº”ä¸‹å›¾<br /><img src="/uploads/images/data_structure/bst_cpp/08.png" alt="" /></p><p>åç»§èŠ‚ç‚¹æŸ¥æ‰¾ç±»ä¼¼å‰é©±èŠ‚ç‚¹</p><ul><li>è‹¥èŠ‚ç‚¹N<strong>æœ‰å³å­æ ‘R</strong>ï¼šä¸”å³å­æ ‘Rçš„å·¦å­æ ‘å­˜åœ¨ï¼Œåˆ™ä¾æ¬¡éå†Rçš„å·¦å­æ ‘ç›´åˆ°<strong>å¶å­èŠ‚ç‚¹</strong>ï¼Œå°±æ˜¯åç»§èŠ‚ç‚¹ï¼›å¦åˆ™è¯¥å³å­æ ‘Rå°±æ˜¯åç»§èŠ‚ç‚¹</li><li>è‹¥èŠ‚ç‚¹N<strong>æ— å³å­æ ‘</strong>ï¼Œä½†èŠ‚ç‚¹Næ˜¯å…¶çˆ¶èŠ‚ç‚¹Pçš„<strong>å·¦å­©å­</strong>ï¼Œé‚£ä¹ˆçˆ¶èŠ‚ç‚¹På°±æ˜¯è¯¥èŠ‚ç‚¹Nçš„åç»§ç»“ç‚¹</li><li>è‹¥èŠ‚ç‚¹N<strong>æ— å³å­æ ‘</strong>ï¼Œä½†è¯¥èŠ‚ç‚¹Næ˜¯å…¶çˆ¶èŠ‚ç‚¹Pçš„<strong>å³å­©å­</strong>ï¼Œé‚£ä¹ˆéœ€è¦æ²¿ç€çˆ¶äº²èŠ‚ç‚¹Pä¸€ç›´å‘æ ‘çš„é¡¶ç«¯å¯»æ‰¾ï¼Œ<strong>ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªèŠ‚ç‚¹Xæ˜¯å…¶çˆ¶èŠ‚ç‚¹Mçš„å·¦å­©å­</strong>ï¼Œåˆ™èŠ‚ç‚¹Mä¸ºåç»§èŠ‚ç‚¹</li></ul><p><img src="/uploads/images/data_structure/bst_cpp/09.png" alt="" /></p><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br>NodeEntry&lt;T&gt;* binaryTree&lt;T&gt;::<span class="hljs-built_in">predecessor</span>(NODE* pNode)<br>&#123;<br>    <span class="hljs-keyword">if</span>(!pNode)<span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-comment">// å¦‚æœå­˜åœ¨å·¦å­æ ‘</span><br>    <span class="hljs-keyword">if</span> (pNode-&gt;left_nodes)&#123;<br>        <span class="hljs-keyword">auto</span> x=pNode-&gt;left_nodes;<br>        <span class="hljs-keyword">while</span> (x-&gt;right_nodes)&#123;<br>            x=x-&gt;right_nodes;<br>        &#125;<br>        <span class="hljs-keyword">return</span> x;<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(pNode-&gt;parent)&#123;<br>        <span class="hljs-comment">// è¯¥èŠ‚ç‚¹ä¸ºçˆ¶èŠ‚ç‚¹çš„å³å­©å­</span><br>        <span class="hljs-keyword">if</span> (pNode-&gt;parent-&gt;right_nodes==pNode)&#123;<br>            <span class="hljs-keyword">return</span> pNode-&gt;parent;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-comment">// è¯¥èŠ‚ç‚¹ä¸ºçˆ¶èŠ‚ç‚¹çš„å·¦å­©å­</span><br>            NodeEntry&lt;T&gt;* parent=pNode-&gt;parent;<br>            <span class="hljs-comment">// å‘çˆ¶èŠ‚ç‚¹æ–¹å‘éå†</span><br>            <span class="hljs-keyword">while</span> (parent &amp;&amp; parent-&gt;left_nodes==pNode)&#123;<br>                pNode=parent;<br>                parent=parent-&gt;parent;<br>            &#125;<br>            <span class="hljs-keyword">return</span> parent;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br>NodeEntry&lt;T&gt;* binaryTree&lt;T&gt;::<span class="hljs-built_in">successor</span>(NODE* pNode)<br>&#123;<br>    <span class="hljs-keyword">if</span>(!pNode)<span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-comment">// å¦‚æœå­˜åœ¨å³å­æ ‘</span><br>    <span class="hljs-keyword">if</span> (pNode-&gt;right_nodes)&#123;<br>        <span class="hljs-keyword">auto</span> x=pNode-&gt;right_nodes;<br>        <span class="hljs-keyword">while</span> (x-&gt;left_nodes)&#123;<br>            x=x-&gt;left_nodes;<br>        &#125;<br>        <span class="hljs-keyword">return</span> x;<br>    <span class="hljs-comment">// å³å­æ ‘ä¸å­˜åœ¨</span><br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(pNode-&gt;parent)&#123;<br>        <span class="hljs-keyword">if</span> (pNode-&gt;parent-&gt;left_nodes==pNode)&#123;<br>            <span class="hljs-keyword">return</span> pNode-&gt;parent;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            NodeEntry&lt;T&gt;* parent=pNode-&gt;parent;<br>            <span class="hljs-keyword">while</span> (parent &amp;&amp; parent-&gt;right_nodes==pNode)&#123;<br>                pNode=parent;<br>                parent=parent-&gt;parent;<br>            &#125;<br>            <span class="hljs-keyword">return</span> parent;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="æ’å…¥"><a class="markdownIt-Anchor" href="#æ’å…¥"></a> æ’å…¥</h4><p>è®²å®Œå‰é©±åç»§çš„æŸ¥æ‰¾åï¼Œæ¥ä¸‹æ¥æ˜¯æ’å…¥æ“ä½œï¼Œbstçš„æ’å…¥æ¯”è¾ƒç®€å•ï¼Œä¹Ÿå°±æ˜¯åœ¨<strong>ç©ºèŠ‚ç‚¹nullptr</strong>å¤„æ›´æ–°ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œæ’å…¥æ–¹æ³•ç±»ä¼¼æŸ¥æ‰¾æ–¹æ³•ã€‚æ’å…¥æ“ä½œè¦ä¿è¯keyçš„å”¯ä¸€æ€§</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br><span class="hljs-keyword">bool</span> binaryTree&lt;T&gt;::<span class="hljs-built_in">Insert</span>(REF_PNODE pNode,PNODE pNodeParent,const_key_type key,const_reference_type value) &#123;<br>    <span class="hljs-comment">// è¡¨ç¤ºå½“å‰ä¸ºç©ºèŠ‚ç‚¹</span><br>    <span class="hljs-keyword">if</span>(pNode == <span class="hljs-literal">nullptr</span>)&#123;<br>        <span class="hljs-comment">// æ–°å»ºä¸€ä¸ªå¾…æ’å…¥çš„èŠ‚ç‚¹</span><br>        pNode=<span class="hljs-keyword">new</span> <span class="hljs-built_in">NODE</span>();<br>        pNode-&gt;key=key;<br>        pNode-&gt;left_nodes= <span class="hljs-literal">nullptr</span>;<br>        pNode-&gt;right_nodes= <span class="hljs-literal">nullptr</span>;<br>        pNode-&gt;data=value;<br>        pNode-&gt;parent=pNodeParent;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(key &lt; pNode-&gt;key)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Insert</span>(pNode-&gt;left_nodes,pNode,key,value);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(key &gt; pNode-&gt;key)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Insert</span>(pNode-&gt;right_nodes,pNode,key,value);<br>    &#125;<br>    <span class="hljs-comment">// å·²ç»å­˜åœ¨äº†</span><br>    <span class="hljs-keyword">else</span>&#123;<br>        cout&lt;&lt;<span class="hljs-string">&quot;Already exist!&quot;</span>&lt;&lt;endl;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="åˆ é™¤"><a class="markdownIt-Anchor" href="#åˆ é™¤"></a> åˆ é™¤</h4><p>åˆ é™¤æ“ä½œå°±æœ‰ç‚¹å¤æ‚äº†ï¼Œä¸è¿‡ç…§ç€æ€è·¯ä¹Ÿå¾ˆå®¹æ˜“å†™å‡ºæ¥ã€‚<br />å¤§è‡´åˆ†ä¸ºä¸‰ç±»</p><ul><li>åˆ é™¤å¶å­ç»“ç‚¹</li><li>åˆ é™¤åªæœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹</li><li>åˆ é™¤æœ‰ä¸¤æ£µå­æ ‘çš„èŠ‚ç‚¹</li></ul><p><strong>æ³¨æ„ï¼šåˆ é™¤æ“ä½œä¸€å®šè¦ç»´æŠ¤äºŒå‰æŸ¥æ‰¾æ ‘çš„æ€§è´¨ï¼ï¼ï¼</strong></p><p>åˆ é™¤å¶å­ç»“ç‚¹ï¼Œè¿™ç±»æƒ…å†µæœ€ä¸ºç®€å•ï¼Œæ‰¾åˆ°å¾…åˆ é™¤èŠ‚ç‚¹åç›´æ¥deleteï¼ŒåŒæ—¶æ›´æ–°çˆ¶å­èŠ‚ç‚¹å…³ç³»ï¼›<br />åˆ é™¤æœ‰ä¸¤æ£µå­æ ‘çš„èŠ‚ç‚¹çš„æ“ä½œå¯ä»¥è½¬åŒ–ä¸ºåˆ é™¤åªæœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹ï¼Œè½¬åŒ–ç­–ç•¥æœ‰<strong>å‰é©±</strong>å’Œ<strong>åç»§</strong>ä¸¤ç§ï¼Œæœ¬æ–‡åˆ é™¤èŠ‚ç‚¹ä½¿ç”¨çš„ç­–ç•¥ä¸ºåç»§æ³•ã€‚</p><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­<br /><img src="/uploads/images/data_structure/bst_cpp/10.png" alt="" /><br />åˆ é™¤key=8çš„èŠ‚ç‚¹ï¼Œä¸ä¸€å®šçœŸçš„æ˜¯åˆ é™¤è¯¥èŠ‚ç‚¹ï¼Œä¸ç„¶çš„è¯è¿˜è¦é‡æ–°å»ºç«‹çˆ¶å­èŠ‚ç‚¹å…³ç³»ä»¥åŠç»´æŠ¤bstçš„æ€§è´¨ã€‚å› æ­¤ï¼Œåˆ©ç”¨å‰é©±/åç»§èŠ‚ç‚¹çš„æ–¹æ³•å¯ä»¥å·§å¦™çš„é¿å¼€è¿™äº›ä¸å¿…è¦çš„éº»çƒ¦ï¼šåªéœ€è¦<strong>æ›¿æ¢</strong>å¾…åˆ é™¤èŠ‚ç‚¹å’Œå‰é©±/åç»§èŠ‚ç‚¹çš„æ•°æ®ï¼Œç„¶ååˆ©ç”¨åˆ é™¤åªæœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹çš„æ–¹æ³•æ¥<strong>åˆ é™¤</strong>å‰é©±/åç»§èŠ‚ç‚¹å³å¯ã€‚</p><p>åˆ é™¤åªæœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹æƒ…å†µå¦‚ä¸‹<br /><img src="/uploads/images/data_structure/bst_cpp/11.png" alt="" /></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">bool</span> binaryTree&lt;T&gt;::<span class="hljs-built_in">Delete</span>(PNODE pNode,const_key_type key) &#123;<br>    PNODE  pDeletenode = <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">Search</span>(pNode,key);<br>    <span class="hljs-keyword">if</span>(!pDeletenode) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>    <span class="hljs-comment">// èŠ‚ç‚¹çš„å·¦å³å­æ ‘éƒ½å­˜åœ¨æƒ…å†µä¸‹ï¼Œæ­¤æ—¶å°†å…¶è½¬åŒ–ä¸ºå…¶ä»–ä¸¤ç§æƒ…å†µ</span><br>    <span class="hljs-keyword">if</span>(pDeletenode-&gt;left_nodes!=<span class="hljs-literal">nullptr</span>&amp;&amp;pDeletenode-&gt;right_nodes!=<span class="hljs-literal">nullptr</span>)&#123;<br>        PNODE successor=<span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">successor</span>(pDeletenode);<br>        <span class="hljs-comment">// åªéœ€è¦äº¤æ¢æ•°æ®</span><br>        pDeletenode-&gt;key=successor-&gt;key;<br>        pDeletenode-&gt;data=successor-&gt;data;<br>        <span class="hljs-comment">// æ ‡è®°pDeletenodeä¸ºåç»§èŠ‚ç‚¹ï¼Œ</span><br>        pDeletenode=successor;<br>    &#125;<br>    <span class="hljs-comment">// æ˜¯å¦æœ‰å­èŠ‚ç‚¹</span><br>    PNODE child=<span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">        80              80</span><br><span class="hljs-comment">        /                 \ </span><br><span class="hljs-comment">       70[delete]         86[delete]</span><br><span class="hljs-comment">        \                   \</span><br><span class="hljs-comment">         75                  90</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-comment">// åˆ é™¤åªæœ‰ä¸€æ£µå­æ ‘çš„æƒ…å†µ</span><br>   <span class="hljs-comment">// åˆ¤æ–­å¾…åˆ é™¤èŠ‚ç‚¹çš„å­èŠ‚ç‚¹å·¦å³å­©å­</span><br>    <span class="hljs-keyword">if</span>(pDeletenode-&gt;left_nodes!=<span class="hljs-literal">nullptr</span>)&#123;<br>        child=pDeletenode-&gt;left_nodes;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        child=pDeletenode-&gt;right_nodes;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(child!=<span class="hljs-literal">nullptr</span>)&#123;<br>        child-&gt;parent=pDeletenode-&gt;parent;<br>    &#125;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">æƒ…å†µ1           æƒ…å†µ2               æƒ…å†µ3               æƒ…å†µ4</span><br><span class="hljs-comment">         9               9                  9               9</span><br><span class="hljs-comment">        /               /                  /               / </span><br><span class="hljs-comment">       7                7                 7[delete]        7[delete]</span><br><span class="hljs-comment">      /                  \               /                  \</span><br><span class="hljs-comment">     6[delete]           8[delete]      6                    8</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">æƒ…å†µ5           æƒ…å†µ6               æƒ…å†µ7               æƒ…å†µ8</span><br><span class="hljs-comment">      1                1                 1              1</span><br><span class="hljs-comment">       \                \                 \              \ </span><br><span class="hljs-comment">       7                 7                 7[delete]      7[delete]</span><br><span class="hljs-comment">      /                  \                /                \</span><br><span class="hljs-comment">     6[delete]           8[delete]       6                  8</span><br><span class="hljs-comment">    */</span><br><br>    <span class="hljs-comment">// åˆ é™¤çš„æ˜¯æ ¹èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">if</span>(pDeletenode-&gt;parent==<span class="hljs-literal">nullptr</span>)&#123;<br>        m_NodeRoot=child;<br>    <span class="hljs-comment">// åˆ¤æ–­å¾…åˆ é™¤èŠ‚ç‚¹æ˜¯å…¶çˆ¶èŠ‚ç‚¹çš„å·¦å³å­©å­</span><br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(pDeletenode-&gt;parent-&gt;left_nodes==pDeletenode)&#123;<br>        pDeletenode-&gt;parent-&gt;left_nodes=child;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        pDeletenode-&gt;parent-&gt;right_nodes=child;<br>    &#125;<br>    <span class="hljs-keyword">delete</span> pDeletenode;<br>    pDeletenode=<span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="bsté‡Šæ”¾"><a class="markdownIt-Anchor" href="#bsté‡Šæ”¾"></a> bsté‡Šæ”¾</h4><p>é€’å½’æ–¹å¼é‡Šæ”¾æ‰€æœ‰èŠ‚ç‚¹</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt;<br><span class="hljs-keyword">void</span> binaryTree&lt;T&gt;::<span class="hljs-built_in">ClearAll</span>(binaryTree::REF_PNODE pNode) &#123;<br>    <span class="hljs-keyword">if</span>(!pNode)<span class="hljs-keyword">return</span>;<br>    <span class="hljs-built_in">ClearAll</span>(pNode-&gt;left_nodes);<br>    <span class="hljs-built_in">ClearAll</span>(pNode-&gt;right_nodes);<br>    <span class="hljs-keyword">delete</span> pNode;<br>    pNode= <span class="hljs-literal">nullptr</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>okï¼ŒåŸºæœ¬ä¸Šbstå¤§è‡´è®²å®Œäº†ï¼Œbye~</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>DataStructures</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„-è·³è·ƒè¡¨C++å®ç°</title>
    <link href="/skiplist-cpp/"/>
    <url>/skiplist-cpp/</url>
    
    <content type="html"><![CDATA[<p>è·³è·ƒè¡¨/è·³è¡¨(SkipList)<br />In computer science, a skip list is a data structure that allows <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> search complexity as well as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> insertion complexity within an ordered sequence of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> elements.  â€”â€” ç»´åŸºç™¾ç§‘</p><span id="more"></span><h3 id="æ¦‚è¿°"><a class="markdownIt-Anchor" href="#æ¦‚è¿°"></a> æ¦‚è¿°</h3><p>ç”±äºæœ¬äººçŸ¥è¯†æœ‰é™ï¼Œå¯¹äºè·³è·ƒè¡¨çš„è®¤è¯†å¯èƒ½ä¸å¤Ÿæ·±å…¥ï¼Œä¸è¿‡è¿˜æ˜¯æƒ³æŠŠè‡ªå·±çš„çœ‹æ³•å†™ä¸‹æ¥â€¦åˆå­¦è·³è·ƒè¡¨æ—¶ä¹Ÿè®¸æ— æ³•ç†è§£ï¼Œä¸è¿‡å½“æ·±å…¥ç†è§£äº†è·³è·ƒè¡¨çš„åŸç†æ—¶ï¼Œä¸€åˆ‡éƒ½å˜å¾—easyã€‚æ¯”èµ·æ‰‹å†™ä¸€ä¸ªçº¢é»‘æ ‘ä»£ç è·³è·ƒè¡¨è¦ç®€å•å¾—å¤šï¼Œè€Œä¸”è·³è·ƒè¡¨ä¹Ÿæœ‰å¾ˆå¤šå®ç°ä¾‹å­çš„ï¼Œå¦‚ Qtä¸­çš„ <a href="https://doc.qt.io/archives/qt-4.8/qmap.html#details">QMap</a> ,MemSQL ,Redisâ€¦ è™½ç„¶æˆ‘éƒ½æ²¡æœ‰æ¥è§¦è¿‡â€¦</p><h3 id="è·³è·ƒè¡¨"><a class="markdownIt-Anchor" href="#è·³è·ƒè¡¨"></a> è·³è·ƒè¡¨</h3><p>ä¸€ä¸ªç®€å•çš„è·³è·ƒè¡¨ç»“æ„<br /><img src="/uploads/images/data_structure/skiplist_cpp/01.png" alt="" /></p><p><img src="/uploads/images/data_structure/skiplist_cpp/03.png" alt="" /></p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¯¹ä¸€ä¸ª <code>æœ‰åºé“¾è¡¨</code> æ‰§è¡ŒæŸ¥æ‰¾çš„å¤æ‚åº¦ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ,è€Œå¯¹æ•°ç»„ä½¿ç”¨<strong>äºŒåˆ†æŸ¥æ‰¾</strong>çš„å¤æ‚åº¦åˆ™æ˜¯ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ï¼Œè€Œè·³è·ƒè¡¨çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³<code>æœ‰åºé“¾è¡¨</code>çš„æŸ¥æ‰¾é—®é¢˜(å½“ç„¶è¿˜è¦å…¶ä»–æ›´é‡è¦çš„ä½œç”¨)ï¼Œä½¿å…¶å¤æ‚åº¦å°†ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ï¼Œä¸è¿‡æœ€åæƒ…å†µä¸‹å´ä»æ˜¯<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><br />æ³¨æ„: è·³è·ƒè¡¨é€‚ç”¨äºæœ‰åºé“¾è¡¨ã€‚</p><p>åˆ©ç”¨è·³è·ƒè¡¨ä¹‹åçš„æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤å¤æ‚åº¦å¦‚ä¸‹</p><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">æŸ¥æ‰¾</th><th style="text-align:center">æ’å…¥</th><th style="text-align:center">åˆ é™¤</th></tr></thead><tbody><tr><td style="text-align:center">å¹³å‡æƒ…å†µ</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>â¡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td></tr><tr><td style="text-align:center">æœ€åæƒ…å†µ</td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td><td style="text-align:center"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></td></tr></tbody></table><p>è·³è·ƒè¡¨æ˜¯ä¸€ä¸ªç©ºé—´æ¢æ—¶é—´çš„æ•°æ®ç»“æ„ã€‚</p><p>é‚£ä¹ˆè·³è·ƒè¡¨æ˜¯å¦‚ä½•å®ç°å¿«é€ŸæŸ¥æ‰¾çš„å‘¢ï¼Ÿè·³è·ƒè¡¨é€šè¿‡å»ºç«‹ <code>ç´¢å¼•èŠ‚ç‚¹</code> ï¼Œæ¯æ¬¡æŸ¥æ‰¾æ—¶ï¼Œå…ˆé€šè¿‡æœ€é¡¶å±‚ç´¢å¼•èŠ‚ç‚¹ä¸€å±‚å±‚çš„å‘ä¸‹å¯»æ‰¾æ»¡è¶³æ¡ä»¶çš„èŠ‚ç‚¹ï¼Œæ¯æ¬¡æŸ¥æ‰¾éƒ½æœ‰å¯èƒ½è·¨è¶Šåˆ°å…¶ä»–ä¸ç›¸é‚»çš„èŠ‚ç‚¹ï¼Œç›´åˆ°æŠµè¾¾æœ€åº•å±‚ä¹Ÿå°±æ˜¯åŸå§‹å±‚é“¾è¡¨æŸå¤„èŠ‚ç‚¹ä½ç½®ã€‚</p><p>è¿™é‡Œçš„ <strong>ç´¢å¼•èŠ‚ç‚¹</strong> å…¶å®å°±æ˜¯ä¸€ç»„èŠ‚ç‚¹åœ°å€ï¼Œåœ¨newä¸€ä¸ªæ–°èŠ‚ç‚¹æ—¶å°±åˆ†é…å¥½ï¼Œç„¶ååœ¨å¯¹æ¯ä¸€å±‚ç´¢å¼•èŠ‚ç‚¹è¿›è¡Œé‡ç»„ï¼Œä½¿å…¶å‰åä¸²è”èµ·æ¥ï¼Œè¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>çº§é“¾è¡¨ä¸” <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>âˆˆ</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>M</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">i\in(0,M-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> Mä¸ºè·³è·ƒè¡¨çš„æœ€é«˜å±‚çº§æ•°MaxLevelï¼Œè¿™æ ·æ¯ä¸€å±‚çº§å‡å¯å½¢æˆä¸€æ¡é“¾ã€‚</p><p>è¦æŸ¥æ‰¾keyä¸º5çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä»headå¼€å§‹ä¸€å±‚å±‚çš„æŸ¥æ‰¾ï¼Œæ­¤æ¬¡è¿‡ç¨‹è·³è¿‡äº†èŠ‚ç‚¹1å’ŒèŠ‚ç‚¹3ï¼Œæœ€åæ‰¾åˆ°äº†èŠ‚ç‚¹5ã€‚<br /><img src="/uploads/images/data_structure/skiplist_cpp/02.png" alt="" /></p><p>è¿™é‡Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªæœ‰åºé“¾è¡¨ä¸ºå¸¦æœ‰headå’ŒtailèŠ‚ç‚¹ï¼Œå…¶ä¸­headèŠ‚ç‚¹çš„nextæŒ‡é’ˆå°±æ˜¯æœ‰åºé“¾è¡¨çš„èµ·å§‹ï¼Œè€ŒtailèŠ‚ç‚¹ä¸€èˆ¬ä¸º<code>nullptr</code>ï¼Œä¸è¿‡è¿™é‡Œæˆ‘ä»¬å°†tailä½œä¸º<code>å“¨å…µèŠ‚ç‚¹</code>ï¼Œè¿™æ ·å°±æ— éœ€å¤„ç†<code>nullptr</code>é—®é¢˜äº†ã€‚</p><h4 id="æ’å…¥åˆ é™¤"><a class="markdownIt-Anchor" href="#æ’å…¥åˆ é™¤"></a> æ’å…¥/åˆ é™¤</h4><p>åœ¨ä¸€ä¸ª<code>è§„åˆ™è·³è¡¨ç»“æ„</code>ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>çº§é“¾è¡¨æœ‰ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>n</mi><msup><mn>2</mn><mi>i</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">\frac{n}{2^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7570857142857143em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> ä¸ªèŠ‚ç‚¹ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ä¸ºæœ€åº•å±‚é“¾è¡¨çš„æ€»èŠ‚ç‚¹æ•°ã€‚å¦‚:<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mo>â†’</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">0 \rightarrow i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span> å±‚æœ‰ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo separator="true">,</mo><mfrac><mi>n</mi><mn>2</mn></mfrac><mo separator="true">,</mo><mfrac><mi>n</mi><mn>4</mn></mfrac><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mfrac><mi>n</mi><msup><mn>2</mn><mi>i</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">n,\frac{n}{2},\frac{n}{4},\cdots,\frac{n}{2^{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.040392em;vertical-align:-0.345em;"></span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7570857142857143em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨æ’å…¥æ—¶ç¬¦åˆè¿™ç§ç»“æ„ï¼Œè€Œæ’å…¥çš„èŠ‚ç‚¹å±äº<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>çº§é“¾è¡¨çš„æ¦‚ç‡ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><msup><mn>2</mn><mi>i</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{2^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7570857142857143em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> (ä¸éš¾æƒ³å‡ºï¼Œæ’å…¥èŠ‚ç‚¹å±äº0çº§é“¾è¡¨æ¦‚ç‡æ°¸è¿œä¸º1ï¼Œè€Œå±äº1çº§é“¾è¡¨çš„æ¦‚ç‡ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>â‹¯</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">â‹¯</span></span></span></span>ï¼Œå±äº<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>çº§é“¾è¡¨çš„ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mn>1</mn><msup><mn>2</mn><mi>i</mi></msup></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{2^i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7570857142857143em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>)</p><p>è¿™æ—¶æ¥çœ‹çœ‹è¿™æ®µè¯ï¼Œæ‘˜è‡ªWilliam Pugh(å°±æ˜¯ä»–æå‡ºäº†è·³è¡¨)å†™çš„è®ºæ–‡é‡Œçš„ä¸€æ®µè¯ã€‚<br />æ–‡æœ«å‚è€ƒä¸­æœ‰ä»–å…³äºè·³è¡¨çš„è®ºæ–‡</p><blockquote><p>åŸæ–‡<br />Skip lists are a data structure that can be used in place of balanced trees.<br />Skip lists use probabilistic balancing rather than strictly enforced balancing<br />and as a result the algorithms for insertion and deletion in skip lists are<br />much simpler and significantly faster than equivalent algorithms for<br />balanced trees.<br />ç¿»è¯‘:<br />è·³è·ƒè¡¨æ˜¯ä¸€ç§å¯ä»¥ç”¨æ¥ä»£æ›¿å¹³è¡¡æ ‘çš„æ•°æ®ç»“æ„ã€‚<strong>è·³è·ƒè¡¨ä½¿ç”¨æ¦‚ç‡å¹³è¡¡è€Œä¸æ˜¯ä¸¥æ ¼æ‰§è¡Œçš„å¹³è¡¡</strong>ã€‚å› æ­¤ï¼Œåœ¨è·³è·ƒè¡¨ä¸­æ’å…¥å’Œåˆ é™¤çš„ç®—æ³•æ˜¯è¦æ¯”ç­‰æ•ˆç®—æ³•ç®€å•å¾—å¤šï¼Œä¹Ÿå¿«å¾—å¤šå¹³è¡¡æ ‘ã€‚</p></blockquote><p>æ³¨æ„ <code>è·³è·ƒè¡¨ä½¿ç”¨æ¦‚ç‡å¹³è¡¡è€Œä¸æ˜¯ä¸¥æ ¼æ‰§è¡Œçš„å¹³è¡¡</code> è¿™å‘Šè¯‰æˆ‘ä»¬ï¼Œæ’å…¥æ“ä½œæ˜¯åŠ¨æ€çš„æ’å…¥åˆ°ä¸åŒå±‚çº§çš„ä½ç½®ã€‚å› æ­¤ï¼ŒæŠŠä¸€ä¸ªæ–°èŠ‚ç‚¹æ’å…¥åˆ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>çº§é“¾è¡¨çš„æ¦‚ç‡ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>p</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">p^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.019104em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span></span></span></span></span></span></span> (åœ¨ä¸€ä¸ªè§„åˆ™è·³è¡¨ç»“æ„ä¸­ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">p=0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span> )ã€‚</p><p>è€Œè¿™ä¸ªåŠ¨æ€æ’å…¥æ³•å°±åˆ©ç”¨åˆ° éšæœºæ•°ç”Ÿæˆå‡½æ•° æ¥å®Œæˆï¼Œä¸€ä¸ªå¥½çš„éšæœºæ•°ç”Ÿæˆå‡½æ•°ï¼Œèƒ½å¤Ÿä½¿è·³è¡¨ç»“æ„è¾¾åˆ°æœ€ä¼˜çš„æ•ˆæœä½¿å…¶å¤æ‚åº¦ä¸ä¼šå¤ªé«˜ã€‚</p><p>é™¤æ­¤ä¹‹å¤–æ¯ä¸€æ¬¡æ’å…¥/åˆ é™¤æ“ä½œï¼Œéƒ½å¿…é¡»è¦ç»´æŠ¤è·³è¡¨ç»“æ„ï¼Œä¹Ÿå°±æ˜¯å¤„ç†å¥½é“¾è¡¨èŠ‚ç‚¹çš„æŒ‡å‘å…³ç³»ï¼Œé¿å…æ··ä¹±ã€‚</p><h4 id="çº§çš„åˆ†é…"><a class="markdownIt-Anchor" href="#çº§çš„åˆ†é…"></a> çº§çš„åˆ†é…</h4><p>ä¸è¯´é‚£ä¹ˆå¤šï¼Œçº§çš„åˆ†é…å¯ä»¥åˆ©ç”¨ä¸€ä¸ªéšæœºæ•°ç”Ÿæˆå‡½æ•°æ¥å®Œæˆã€‚<br />ä¼ªç :</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-built_in">randomLevel</span>()<br>    lvl := <span class="hljs-number">1</span><br>    -- <span class="hljs-built_in">random</span>() that returns a random value in [<span class="hljs-number">0.</span>.<span class="hljs-number">.1</span>)<br>    <span class="hljs-keyword">while</span> <span class="hljs-built_in">random</span>() &lt; p <span class="hljs-keyword">and</span> lvl &lt; MaxLevel <span class="hljs-keyword">do</span><br>        lvl := lvl + <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> lvl<br></code></pre></div></td></tr></table></figure><p>è½¬åŒ–æˆC++ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">random_level</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">int</span> level= <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">while</span> (((<span class="hljs-keyword">double</span>)(<span class="hljs-built_in">rand</span>()%<span class="hljs-number">101</span>)/<span class="hljs-number">101</span>) &lt; (m_prob) <br>    &amp;&amp; level &lt; m_maxLevel) &#123;<br>        level++;<br>    &#125;<br>    <span class="hljs-keyword">return</span> level;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œè¿˜è¦ä¸€ä¸ªç³Ÿç³•çš„éšæœºæ•°ç”Ÿæˆå‡½æ•°ä»…ä¾›å‚è€ƒ</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">random_level</span><span class="hljs-params">()</span></span>&#123;<br><span class="hljs-keyword">int</span> level = <span class="hljs-built_in">rand</span>() % m_maxLevel + <span class="hljs-number">1</span>;<br><span class="hljs-keyword">return</span> level;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="cå®ç°è·³è·ƒè¡¨"><a class="markdownIt-Anchor" href="#cå®ç°è·³è·ƒè¡¨"></a> C++å®ç°è·³è·ƒè¡¨</h3><p>OKï¼Œç°åœ¨å¼€å§‹ç”¨C++å®ç°è·³è·ƒè¡¨<br />é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªç»“æ„ä½“ï¼Œç”¨äºä¿å­˜èŠ‚ç‚¹æ•°æ®</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyType</span>,<span class="hljs-keyword">class</span> <span class="hljs-title">ValueType</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Element</span>&#123;</span><br>    KeyType key;<br>    ValueType value;<br>    <span class="hljs-built_in">Element</span>()&#123;&#125;<br>    <span class="hljs-built_in">Element</span>(KeyType key,<span class="hljs-keyword">const</span> ValueType&amp; value)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;key=key;<br>        <span class="hljs-keyword">this</span>-&gt;value=value;<br>    &#125;<br>&#125;;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyType</span>,<span class="hljs-keyword">class</span> <span class="hljs-title">ValueType</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">skipNode</span>&#123;</span><br>    Element&lt;KeyType,ValueType&gt; element;<br>    skipNode**next;<br>    <span class="hljs-built_in">skipNode</span>(<span class="hljs-keyword">const</span> Element&lt;KeyType,ValueType&gt;&amp;theElement,<span class="hljs-keyword">int</span> size)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;element=theElement;<br>        <span class="hljs-keyword">this</span>-&gt;next=<span class="hljs-keyword">new</span> skipNode&lt;KeyType,ValueType&gt;*[size];<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h4 id="ç¡®å®šmaxlevel"><a class="markdownIt-Anchor" href="#ç¡®å®šmaxlevel"></a> ç¡®å®šMaxLevel</h4><p>MaxLevelå¤ªå¤§ï¼Œé€ æˆç©ºé—´çš„æµªè´¹ï¼Œå¤ªå°åˆä¼šå¯¼è‡´é€€åŒ–æˆä¸€ä¸ªå†—æ‚çš„ â€˜å•é“¾è¡¨â€™ ç»“æ„ï¼Œä¸¤è€…å‡ä¼šå½±å“è·³è·ƒè¡¨çš„æ€§èƒ½ã€‚å› æ­¤åˆé€‚çš„MaxLevelååˆ†é‡è¦ã€‚</p><p>ä»ã€ŠSkip Lists: A Probabilistic Alternative to<br />Balanced Treesã€‹ ä¸­æˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰ä¸€ä¸ªMaxLevelï¼Œå³<br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">âŒˆ</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mfrac><mn>1</mn><mi>p</mi></mfrac></msub><mi>n</mi><mo stretchy="false">âŒ‰</mo></mrow><annotation encoding="application/x-tex">L(n)=\lceil log_\frac{1}{p}n \rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3342399999999999em;vertical-align:-0.5842399999999999em;"></span><span class="mopen">âŒˆ</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.75378em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.48288571428571425em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5842399999999999em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span><span class="mclose">âŒ‰</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>a</mi><mi>x</mi><mi>L</mi><mi>e</mi><mi>v</mi><mi>e</mi><mi>l</mi><mo>=</mo><mi>L</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">MaxLevel=L(N),N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mord mathdefault">L</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>ä¸ºå¾…æ’å…¥å…ƒç´ èŠ‚ç‚¹æ€»æ•°</p><p>åˆ©ç”¨æ¢åº•å…¬å¼ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo><mi>log</mi><mo>â¡</mo></mo><mi>a</mi></msub><mi>b</mi><mo>=</mo><mfrac><mrow><msub><mo><mi>log</mi><mo>â¡</mo></mo><mi>c</mi></msub><mi>b</mi></mrow><mrow><msub><mo><mi>log</mi><mo>â¡</mo></mo><mi>c</mi></msub><mi>a</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\log_ab=\frac{\log_cb}{\log_ca}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.93858em;vertical-align:-0.24414em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.513324em;vertical-align:-0.5311079999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.982216em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.04167428571428572em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">a</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.496108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop mtight">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.04167428571428572em;"><span style="top:-2.2341314285714287em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.26586857142857145em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5311079999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> è½¬åŒ–ä¸ºC++ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">MaxLevel</span><span class="hljs-params">(<span class="hljs-keyword">int</span> numberOfnode,<span class="hljs-keyword">float</span> prob)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">int</span>)(<span class="hljs-built_in">ceil</span>(<span class="hljs-built_in">logf</span>((<span class="hljs-keyword">float</span>)numberOfnode)/<span class="hljs-built_in">logf</span>((<span class="hljs-keyword">float</span>)<span class="hljs-number">1</span>/prob)));<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="skipliståˆå§‹åŒ–"><a class="markdownIt-Anchor" href="#skipliståˆå§‹åŒ–"></a> skipliståˆå§‹åŒ–</h4><p>æˆ‘ä»¬åªéœ€åœ¨æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–å³å¯ã€‚<br />è¿™é‡Œæˆ‘ä»¬æ—¢å¯ä»¥è‡ªå®šä¹‰è·³è·ƒè¡¨çš„<code>MaxLevel</code>ï¼Œä¹Ÿå¯ä»¥é€šè¿‡<code>numberOfnode</code>æ¥è®¡ç®—ä¸€ä¸ª<code>MaxLevel</code></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyType</span>,<span class="hljs-keyword">class</span> <span class="hljs-title">ValueType</span>&gt;</span><br>skiplist&lt;KeyType,ValueType&gt;::<span class="hljs-built_in">skiplist</span>(<span class="hljs-keyword">float</span> prob,KeyType tailLargeKey,<span class="hljs-keyword">int</span> max_level,<span class="hljs-keyword">int</span> numberOfnode) &#123;<br>    <span class="hljs-built_in">srand</span>(<span class="hljs-built_in">time</span>(<span class="hljs-literal">nullptr</span>));<br>    m_prob=prob;<br>    m_size=<span class="hljs-number">0</span>;<br><br>    <span class="hljs-comment">// è®¡ç®—æœ€å¤§é“¾è¡¨å±‚æ•°</span><br>    <span class="hljs-keyword">if</span>(numberOfnode!=<span class="hljs-number">-1</span>)<br>        m_maxLevel=<span class="hljs-built_in">MaxLevel</span>(numberOfnode,prob);<br>    <span class="hljs-keyword">else</span><br>        m_maxLevel=max_level;<br>        <br>    m_curMaxLevel=<span class="hljs-number">0</span>;<br><br>    <span class="hljs-comment">// åˆå§‹åŒ–å°¾èŠ‚ç‚¹</span><br>    m_tailKey=tailLargeKey;<br>    Element&lt;KeyType,ValueType&gt;tailPair&#123;m_tailKey,<span class="hljs-number">0</span>&#125;;<br>    m_tailNode=<span class="hljs-keyword">new</span> skipNode&lt;KeyType,ValueType&gt;(tailPair,<span class="hljs-number">0</span>);<br><br>    <span class="hljs-comment">// åˆå§‹åŒ–å¤´ç»“ç‚¹</span><br>    m_headNode=<span class="hljs-keyword">new</span> skipNode&lt;KeyType,ValueType&gt;(tailPair,m_maxLevel);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; m_maxLevel; i++)&#123;<br>        m_headNode-&gt;next[i]=m_tailNode;<br>    &#125;<br>    m_forwardNodes=<span class="hljs-keyword">new</span> skipNode&lt;KeyType,ValueType&gt;*[m_maxLevel];<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å°¾èŠ‚ç‚¹å†…å­˜åˆ†é…ç±»ä¼¼<code>malloc(0)</code>å½¢å¼</p><h4 id="skiplistæŸ¥æ‰¾-findå’Œsearch"><a class="markdownIt-Anchor" href="#skiplistæŸ¥æ‰¾-findå’Œsearch"></a> skiplistæŸ¥æ‰¾ findå’Œsearch</h4><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyType</span>,<span class="hljs-keyword">class</span> <span class="hljs-title">ValueType</span>&gt;</span><br>skipNode&lt;KeyType,ValueType&gt;* skiplist&lt;KeyType,ValueType&gt;::<span class="hljs-built_in">search</span>(<span class="hljs-keyword">const</span> KeyType&amp;key)&#123;<br>    skipNode&lt;KeyType,ValueType&gt;*forwardNode=m_headNode;<br>    <span class="hljs-comment">// å¤–å±‚å¾ªç¯: ä¸æ–­çš„æŒ‡å‘ä¸‹ä¸€å±‚çº§é“¾è¡¨</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = m_curMaxLevel<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; --i)&#123;<br>        <span class="hljs-comment">// å†…å±‚å¾ªç¯: æŒ‡å‘å½“å‰å±‚çº§é“¾è¡¨çš„é‚»æ¥èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">while</span> (forwardNode-&gt;next[i]!=m_tailNode&amp;&amp;forwardNode-&gt;next[i]-&gt;element.key&lt;key)&#123;<br>            forwardNode=forwardNode-&gt;next[i];<br>        &#125;<br>        <span class="hljs-comment">// ä¿å­˜å‰é©±èŠ‚ç‚¹æŒ‡é’ˆ</span><br>        <span class="hljs-keyword">this</span>-&gt;m_forwardNodes[i]=forwardNode;<br>    &#125;<br>    <span class="hljs-keyword">return</span> forwardNode-&gt;next[<span class="hljs-number">0</span>];<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyType</span>,<span class="hljs-keyword">class</span> <span class="hljs-title">ValueType</span>&gt;</span><br>Element&lt;KeyType,ValueType&gt;* skiplist&lt;KeyType,ValueType&gt;::<span class="hljs-built_in">find</span>(<span class="hljs-keyword">const</span> KeyType&amp;key)&#123;<br>    <span class="hljs-keyword">if</span>(key &gt; <span class="hljs-keyword">this</span>-&gt;m_tailKey)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    skipNode&lt;KeyType,ValueType&gt;*forwardNode=m_headNode;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = m_curMaxLevel<span class="hljs-number">-1</span>; i &gt;=<span class="hljs-number">0</span> ; --i)&#123;<br>        <span class="hljs-keyword">while</span> (forwardNode-&gt;next[i]!=m_tailNode &amp;&amp; forwardNode-&gt;next[i]-&gt;element.key &lt; key)&#123;<br>            forwardNode=forwardNode-&gt;next[i];<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// æœ€ç»ˆä¼šéå†åˆ°ç¬¬0å±‚-&gt;åŸå§‹å±‚ï¼Œåªéœ€è¦åœ¨ç¬¬0å±‚åˆ¤æ–­å³å¯</span><br>    <span class="hljs-keyword">if</span>(forwardNode-&gt;next[<span class="hljs-number">0</span>]-&gt;element.key==key)&#123;<br>        <span class="hljs-keyword">return</span> &amp;forwardNode-&gt;next[<span class="hljs-number">0</span>]-&gt;element;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­<code>find</code>å’Œ<code>search</code>éƒ½æ˜¯ä»å½“å‰æœ€å¤§å±‚çº§ä¾æ¬¡å‘ä¸‹éå†ï¼Œä¸åŒçš„æ˜¯ï¼Œ<code>search</code>åœ¨éå†çš„åŒæ—¶å°†æ¯æ¬¡éå†åˆ°æ¯ä¸€å±‚çš„<code>å‰é©±èŠ‚ç‚¹</code>ä¿å­˜åœ¨<code>m_forwardNodes</code>ä¸­ï¼Œç›®çš„æ˜¯ä¸ºäº†è¡”æ¥åé¢çš„æ’å…¥/åˆ é™¤èŠ‚ç‚¹</p><p><img src="/uploads/images/data_structure/skiplist_cpp/04.png" alt="" /></p><p>å…¶ä¸­çš„ <code>forwardNode-&gt;next[0]</code> å°±æ˜¯ä¸‹ä¸€ä¸ªè¦æŸ¥æ‰¾çš„èŠ‚ç‚¹(å¦‚æœå­˜åœ¨çš„è¯)</p><h4 id="skiplistæ’å…¥"><a class="markdownIt-Anchor" href="#skiplistæ’å…¥"></a> skiplistæ’å…¥</h4><p>æ¯ä¸€æ¬¡æ’å…¥ï¼Œéœ€è¦é€šè¿‡<code>search</code>ä¿å­˜ <code>å‰é©±èŠ‚ç‚¹m_forwardNodes</code> ä»è€Œå°†å¾…æ’å…¥èŠ‚ç‚¹è¿æ¥èµ·æ¥ã€‚å¦‚ä¸‹å›¾çº¢è‰²ç®­å¤´è¡¨ç¤ºå‰åéœ€è¦é“¾æ¥çš„èŠ‚ç‚¹ã€‚<br />éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè·³è·ƒè¡¨æ˜¯<code>æœ‰åºé“¾è¡¨</code>ï¼Œä¸‹å›¾åªæ˜¯ä¸ºäº†è§£é‡Šè€Œå·² (å…¶å®æ˜¯å½“æ—¶ä¸å°å¿ƒç”»é”™äº†â€¦ ğŸ˜¦)<br /><img src="/uploads/images/data_structure/skiplist_cpp/05.png" alt="" /></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyType</span>,<span class="hljs-keyword">class</span> <span class="hljs-title">ValueType</span>&gt;</span><br><span class="hljs-keyword">void</span> skiplist&lt;KeyType,ValueType&gt;::<span class="hljs-built_in">insert</span>(<span class="hljs-keyword">const</span> Element&lt;KeyType,ValueType&gt;&amp;element)&#123;<br>    <span class="hljs-comment">// éšæœºç”Ÿæˆç´¢å¼•èŠ‚ç‚¹å±‚æ•° 1&lt;=level&lt;=m_maxLevel</span><br>    <span class="hljs-keyword">int</span> level=<span class="hljs-built_in">random_level</span>();<br>    <span class="hljs-keyword">if</span>(level &gt; <span class="hljs-keyword">this</span>-&gt;m_curMaxLevel)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;m_curMaxLevel=level;<br>    &#125;<br>    skipNode&lt;KeyType,ValueType&gt;*pNode=<span class="hljs-built_in">search</span>(element.key);<br>    <span class="hljs-comment">// å·²ç»å­˜åœ¨</span><br>    <span class="hljs-keyword">if</span>(pNode-&gt;element.key==element.key)&#123;<br>        pNode-&gt;element.value=element.value;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-comment">// æ­¤æ—¶å·²ç»ä¿å­˜äº†åˆé€‚çš„å‰é©±èŠ‚ç‚¹m_forwardNodes</span><br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå…·æœ‰levelå±‚çš„èŠ‚ç‚¹</span><br>    skipNode&lt;KeyType,ValueType&gt;*pNewNode = <span class="hljs-keyword">new</span> skipNode&lt;KeyType,ValueType&gt;(element,level);<br>    <br>    <span class="hljs-comment">// å»ºç«‹ç´¢å¼•èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = level<span class="hljs-number">-1</span>; i &gt;=<span class="hljs-number">0</span>; --i)&#123;<br>        pNewNode-&gt;next[i]=m_forwardNodes[i]-&gt;next[i];<br>        m_forwardNodes[i]-&gt;next[i]=pNewNode;<br>    &#125;<br>    m_size++;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="skipliståˆ é™¤"><a class="markdownIt-Anchor" href="#skipliståˆ é™¤"></a> skipliståˆ é™¤</h4><p>åˆ é™¤æ“ä½œç±»ä¼¼æ’å…¥æ“ä½œï¼Œä¹Ÿéœ€è¦é€šè¿‡<code>search</code>ä¿å­˜ <code>å‰é©±èŠ‚ç‚¹m_forwardNodes</code><br /><img src="/uploads/images/data_structure/skiplist_cpp/06.png" alt="" /></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyType</span>,<span class="hljs-keyword">class</span> <span class="hljs-title">ValueType</span>&gt;</span><br><span class="hljs-keyword">bool</span> skiplist&lt;KeyType,ValueType&gt;::<span class="hljs-built_in">erase</span>(<span class="hljs-keyword">const</span> KeyType&amp;key)&#123;<br>    <span class="hljs-comment">// ä¸ç¬¦åˆçš„key</span><br>    <span class="hljs-keyword">if</span>(key&gt;m_tailKey)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    skipNode&lt;KeyType,ValueType&gt;*pNode=<span class="hljs-built_in">search</span>(key);<br>    <span class="hljs-comment">// ä¸å­˜åœ¨ </span><br>    <span class="hljs-keyword">if</span>(pNode-&gt;element.key!=key)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-comment">// æ›´æ–°è·³è¡¨é“¾è¡¨ç»“æ„</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = m_curMaxLevel<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; --i)&#123;<br>        <span class="hljs-comment">// æ­¤å¤„ m_forwardNodes[i]-&gt;next[i] å¯èƒ½ä¸æ˜¯ pNode</span><br>        <span class="hljs-keyword">if</span>(m_forwardNodes[i]-&gt;next[i]==pNode)<br>            m_forwardNodes[i]-&gt;next[i]=pNode-&gt;next[i];<br>    &#125;<br>    <br>    <span class="hljs-comment">// ç»´æŠ¤å½“å‰æœ€å¤§å±‚çº§æ•°</span><br>    <span class="hljs-comment">// å½“åˆ é™¤ä¸€ä¸ªå…·æœ‰æœ€å¤§å±‚çº§çš„èŠ‚ç‚¹æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ m_headNode-&gt;next[m_maxLevel-1]=m_tailNodeï¼Œé‚£ä¹ˆæ­¤æ—¶éœ€è¦é™ä½å±‚çº§</span><br>    <span class="hljs-keyword">while</span> (m_curMaxLevel<span class="hljs-number">-1</span> &gt; <span class="hljs-number">0</span>&amp;&amp;m_headNode-&gt;next[m_curMaxLevel<span class="hljs-number">-1</span>]==m_tailNode)&#123;<br>        m_curMaxLevel--;<br>    &#125;<br>    <span class="hljs-keyword">delete</span> pNode;   <br>    m_size--;    <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆ é™¤èŠ‚ç‚¹åè¿˜è¦ç»´æŠ¤<code>m_curMaxLevel</code>ä½¿å…¶ä¸èƒ½å¤ªé«˜ï¼Œè¿™æ ·çš„è¯å¯ä»¥å‡å°‘éå†æ¬¡æ•°ã€‚<br /><img src="/uploads/images/data_structure/skiplist_cpp/07.png" alt="" /></p><h4 id="é‡Šæ”¾è·³è·ƒè¡¨"><a class="markdownIt-Anchor" href="#é‡Šæ”¾è·³è·ƒè¡¨"></a> é‡Šæ”¾è·³è·ƒè¡¨</h4><p>åœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾æ‰€æœ‰å†…å­˜</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyType</span>,<span class="hljs-keyword">class</span> <span class="hljs-title">ValueType</span>&gt;</span><br>skiplist&lt;KeyType,ValueType&gt;::~<span class="hljs-built_in">skiplist</span>()&#123;<br>    <span class="hljs-keyword">while</span> (m_headNode!=m_tailNode)&#123;<br>        <span class="hljs-keyword">auto</span> x=m_headNode-&gt;next[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">delete</span> m_headNode;<br>        m_headNode=x;<br>    &#125;<br>    <span class="hljs-keyword">delete</span> m_tailNode;<br>    <span class="hljs-keyword">delete</span> []m_forwardNodes;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="æµ‹è¯•"><a class="markdownIt-Anchor" href="#æµ‹è¯•"></a> æµ‹è¯•</h3><p>ç”¨skiplistå’ŒSTL mapæµ‹è¯•æ’å…¥æ“ä½œï¼Œä»…ä¾›å‚è€ƒ</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;map&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;skiplist.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;ClockTest.h&quot;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">// ä¸€ä¸ªæ— ç©·æ•°</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> TAIL_INFINITY_KEY 0xffffff</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> <span class="hljs-keyword">const</span> *argv[])</span></span>&#123;<br>    <span class="hljs-keyword">int</span> n=<span class="hljs-number">1000000</span>;<br>    <span class="hljs-built_in">srand</span>(<span class="hljs-built_in">time</span>(<span class="hljs-literal">nullptr</span>));<br>    <span class="hljs-comment">// æµ‹è¯•skiplist insert</span><br>    CClock::<span class="hljs-built_in">start_timeclock</span>();<br>    <span class="hljs-function">skiplist&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt; <span class="hljs-title">sk</span><span class="hljs-params">(<span class="hljs-number">0.5</span>,TAIL_INFINITY_KEY,<span class="hljs-number">0</span>,n)</span></span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;= <span class="hljs-number">0</span>; --i)&#123;<br>        sk.<span class="hljs-built_in">insert</span>(Element&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt;&#123;<span class="hljs-built_in">rand</span>()%n,i&#125;);<br>    &#125;<br>    CClock::<span class="hljs-built_in">stop_timeclock</span>();<br>    <span class="hljs-keyword">auto</span> skiplist_insert_time=CClock::<span class="hljs-built_in">time_duration</span>();<br>    <br>    <span class="hljs-comment">// æµ‹è¯•map insert</span><br>    CClock::<span class="hljs-built_in">start_timeclock</span>();<br>    map&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt; mp;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;=<span class="hljs-number">0</span>; --i)&#123;<br>        mp.<span class="hljs-built_in">insert</span>(pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt;(<span class="hljs-built_in">rand</span>()%n,i));<br>    &#125;<br>    CClock::<span class="hljs-built_in">stop_timeclock</span>();<br>    <span class="hljs-keyword">auto</span> map_insert_time=CClock::<span class="hljs-built_in">time_duration</span>();<br>    <br>    <span class="hljs-comment">// æµ‹è¯•skiplist find</span><br>    CClock::<span class="hljs-built_in">start_timeclock</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;=<span class="hljs-number">0</span>; --i)&#123;<br>        sk.<span class="hljs-built_in">find</span>(<span class="hljs-built_in">rand</span>()%n);<br>    &#125;<br>    CClock::<span class="hljs-built_in">stop_timeclock</span>();<br>    <span class="hljs-keyword">auto</span> skip_find_time=CClock::<span class="hljs-built_in">time_duration</span>();<br><br>    <span class="hljs-comment">// æµ‹è¯•map find</span><br>    CClock::<span class="hljs-built_in">start_timeclock</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;=<span class="hljs-number">0</span>; --i)&#123;<br>        mp.<span class="hljs-built_in">find</span>(<span class="hljs-built_in">rand</span>()%n);<br>    &#125;<br>    CClock::<span class="hljs-built_in">stop_timeclock</span>();<br>    <span class="hljs-keyword">auto</span> map_find_time=CClock::<span class="hljs-built_in">time_duration</span>();<br>    <br>    <span class="hljs-comment">// æµ‹è¯•skiplist erase</span><br>    CClock::<span class="hljs-built_in">start_timeclock</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;=<span class="hljs-number">0</span>; --i)&#123;<br>        sk.<span class="hljs-built_in">erase</span>(<span class="hljs-built_in">rand</span>()%n);<br>    &#125;<br>    CClock::<span class="hljs-built_in">stop_timeclock</span>();<br>    <span class="hljs-keyword">auto</span> skip_erase_time=CClock::<span class="hljs-built_in">time_duration</span>();<br><br>    <span class="hljs-comment">// æµ‹è¯•map erase</span><br>    CClock::<span class="hljs-built_in">start_timeclock</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n; i &gt;=<span class="hljs-number">0</span>; --i)&#123;<br>        mp.<span class="hljs-built_in">erase</span>(<span class="hljs-built_in">rand</span>()%n);<br>    &#125;<br>    CClock::<span class="hljs-built_in">stop_timeclock</span>();<br>    <span class="hljs-keyword">auto</span> map_erase_time=CClock::<span class="hljs-built_in">time_duration</span>();<br><br>    cout&lt;&lt;<span class="hljs-string">&quot;SkipList insert time: &quot;</span>&lt;&lt;skiplist_insert_time&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;SkipList find time: &quot;</span>&lt;&lt;skip_find_time&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;SkipList erase time: &quot;</span>&lt;&lt;skip_erase_time&lt;&lt;endl;<br>    cout&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;Map insert time: &quot;</span>&lt;&lt;map_insert_time&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;Map find time: &quot;</span>&lt;&lt;map_find_time&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;Map erase time: &quot;</span>&lt;&lt;map_erase_time&lt;&lt;endl;<br><br>    cout&lt;&lt;<span class="hljs-string">&quot;SkipList size: &quot;</span>&lt;&lt;sk.<span class="hljs-built_in">size</span>()&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;Map size: &quot;</span>&lt;&lt;mp.<span class="hljs-built_in">size</span>()&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æˆ‘æœºå™¨ä¸Šæµ‹è¯• éšæœºæ’å…¥/æŸ¥æ‰¾/åˆ é™¤ï¼Œç»“æœä»…ä¾›å‚è€ƒã€‚å•ä½ç§’</p><table><thead><tr><th></th><th>insert</th><th>find</th><th>erase</th></tr></thead><tbody><tr><td>skiplist1</td><td>1.44737</td><td>2.03802</td><td>2.158</td></tr><tr><td>skiplist2</td><td>1.34377</td><td>1.61364</td><td>1.52145</td></tr><tr><td>skiplist3</td><td>1.35671</td><td>2.31105</td><td>1.57659</td></tr><tr><td>map1</td><td>1.48519</td><td>1.28156</td><td>1.93228</td></tr><tr><td>map2</td><td>1.00754</td><td>1.099</td><td>1.29245</td></tr><tr><td>map3</td><td>1.23837</td><td>1.28021</td><td>1.35214</td></tr></tbody></table><p>ç”±æ­¤å¯è§ï¼Œè·³è·ƒè¡¨ä¹Ÿæ˜¯å¾ˆé«˜æ•ˆçš„ä¸€ç§æ•°æ®ç»“æ„</p><p>skiplistæºç åœ°å€: <a href="https://github.com/josexy/skiplist_c">https://github.com/josexy/skiplist_c</a></p><h3 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h3><p><a href="https://en.wikipedia.org/wiki/Skip_list">ç»´åŸºç™¾ç§‘-skiplist</a><br /><a href="https://www.cl.cam.ac.uk/teaching/0506/Algorithms/skiplists.pdf">Skip Lists: A Probabilistic Alternative toBalanced Trees</a><br /><a href="https://blog.csdn.net/ict2014/article/details/17394259">æµ…æSkipListè·³è·ƒè¡¨åŸç†åŠä»£ç å®ç°</a></p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>DataStructures</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„-é˜Ÿåˆ—</title>
    <link href="/queue-cpp/"/>
    <url>/queue-cpp/</url>
    
    <content type="html"><![CDATA[<p>é˜Ÿåˆ—æ˜¯ä¸€ç§å…ˆè¿›å…ˆå‡º(FIFO)çš„æ•°æ®ç»“æ„ï¼Œä¸æ ˆ(åè¿›å…ˆå‡ºLIFO)ä¸åŒï¼Œä½†ä¸¤è€…éƒ½æ˜¯çº¿æ€§ç»“æ„ï¼Œå› æ­¤å¯ä»¥ç”¨çº¿æ€§è¡¨å»æè¿°é˜Ÿåˆ—ï¼Œæœ¬æ–‡ä¸»è¦æ˜¯ç”¨æ•°ç»„å»å®ç°ä¸€ä¸ªç®€å•çš„é˜Ÿåˆ—</p><span id="more"></span><h3 id="é˜Ÿåˆ—"><a class="markdownIt-Anchor" href="#é˜Ÿåˆ—"></a> é˜Ÿåˆ—</h3><p>å¯¹ä¸€ä¸ªé˜Ÿåˆ—æ“ä½œï¼Œåªèƒ½ä»é˜Ÿé¦–åˆ é™¤å…ƒç´ ï¼Œé˜Ÿå°¾æ’å…¥å…ƒç´ ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸¤ä¸ªé˜Ÿåˆ—å…ƒç´ æŒ‡é’ˆfront,backï¼Œç”¨äºè·Ÿè¸ªé˜Ÿåˆ—é¦–å°¾å…ƒç´ ã€‚<br />C++ STLå®ç°äº†é˜Ÿåˆ—æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬ç”¨æ—¶ä¸å¯èƒ½ç«‹å³æ‰‹å†™ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå› è€Œåªéœ€includeå¤´æ–‡ä»¶å³å¯ï¼Œä¸è¿‡å¯¹äºé˜Ÿåˆ—è¿™ä¸€æ•°æ®ç»“æ„åŸç†è¿˜æ˜¯è¦ç†è§£çš„</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œé˜Ÿåˆ—å¯ä»¥ç”¨æ•°ç»„æˆ–é“¾è¡¨å®ç°ï¼Œä¸è¿‡æœ¬æ–‡æ˜¯ä»¥æ•°ç»„æ¥è®²è¿°çš„å› æ­¤è¾ƒä¸ºç®€å•</p><h4 id="æ’å…¥"><a class="markdownIt-Anchor" href="#æ’å…¥"></a> æ’å…¥</h4><p>é˜Ÿåˆ—æ’å…¥ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå…ˆå°†é˜Ÿå°¾æŒ‡é’ˆback+1ï¼Œä½¿å…¶æŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²åŒº<br />åŸŸï¼Œç„¶ååœ¨æ’å…¥å…ƒç´ ã€‚å¤æ‚åº¦ä¸ºO(1)</p><h4 id="åˆ é™¤"><a class="markdownIt-Anchor" href="#åˆ é™¤"></a> åˆ é™¤</h4><p>åˆ é™¤é˜Ÿé¦–å…ƒç´ æœ‰ä¸¤ç§ç­–ç•¥</p><ol><li>ç›´æ¥æ•´ä¸ªæ•°ç»„å·¦ç§»ä¸€ä½ï¼Œfrontä¸å˜ï¼Œbackå‘å‰ç§»åŠ¨ä¸€ä½ã€‚å¤æ‚åº¦O(n)</li><li>æ•°ç»„ä¸ç§»åŠ¨ï¼Œfrontç§»åŠ¨åˆ°ä¸‹ä¸€ä½ï¼Œbackä¸å˜ã€‚å¤æ‚åº¦O(1)</li></ol><p>æ˜¾ç„¶åˆ é™¤æ“ä½œæƒ…å†µ1ä¸èƒ½æ¥å—ï¼Œç„¶è€Œå¯¹äºåˆ é™¤æ“ä½œæƒ…å†µ2ï¼Œä¼šå¯¼è‡´æ•°ç»„ç©ºé—´æµªè´¹ï¼Œè¿™æ˜¯å› ä¸ºfrontæŒ‡é’ˆä¹‹å‰çš„åŒºåŸŸæœªèƒ½è¢«åˆ©ç”¨ï¼Œè€ŒbackæŒ‡é’ˆä¹‹åçš„åŒºåŸŸæ˜¾ç„¶ä¸å¤Ÿ(è¿™é‡Œåœ¨æ²¡æœ‰è€ƒè™‘æ•°ç»„å˜å¢çš„æƒ…å†µä¸‹)ã€‚</p><p>å¦‚æœå°†æ•°ç»„â€œä¸²â€èµ·æ¥æ€æ ·ï¼Ÿäº‹å®ä¸Šç¡®å®å¯ä»¥ï¼Œè¿™ç§æ•°ç»„å«ç¯å½¢æ•°ç»„ï¼Œç”¨æ­¤ç±»å‹æ•°ç»„å®ç°çš„é˜Ÿåˆ—ç§°ä¸º<strong>å¾ªç¯é˜Ÿåˆ—</strong> ä¸”å…¶æ’å…¥åˆ é™¤å¤æ‚åº¦å‡ä¸ºO(1)</p><p>ç¯å½¢æ•°ç»„è¡¨ç¤ºé˜Ÿåˆ—é€šè¿‡ä¸‹é¢å…¬å¼å®ç°:</p><blockquote><p>location(i)=(location(front)+i)%arrayLength</p></blockquote><p>å¦‚ä¸‹å›¾ä¸€ä¸ªç©ºé˜Ÿåˆ—ï¼Œæ­¤æ—¶ front=back<br /><img src="/uploads/images/data_structure/queue_cpp/01.png" alt="" /></p><p>å½“æ’å…¥ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œä¹Ÿæœ‰ä¸¤ç§ç­–ç•¥</p><blockquote><p>1.å…ˆç§»åŠ¨backï¼Œåæ’å…¥å…ƒç´ ã€‚é‚£ä¹ˆfrontæŒ‡å‘å…ƒç´ ä¸º&quot;ç©º&quot;<br />2.å…ˆæ’å…¥å…ƒç´ ï¼Œåç§»åŠ¨backã€‚é‚£ä¹ˆbackæŒ‡å‘å…ƒç´ ä¸º&quot;ç©º&quot;</p></blockquote><img src="/uploads/images/data_structure/queue_cpp/02.png" width="70%" height="70%"><p>æ¯æ¬¡æ’å…¥éƒ½éœ€è¦åˆ¤æ–­ (back+1)%size == front ï¼Œä¸ºä»€ä¹ˆï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œåˆå§‹æ—¶front=backè¡¨ç¤ºç©ºé˜Ÿåˆ—ï¼Œé‚£ä¹ˆå½“æ’å…¥å…ƒç´ æ•°é‡è¾¾åˆ°æ•°ç»„é•¿åº¦æ­¤æ—¶front=backï¼è¿™è¡¨ç¤ºè¿™ä¸ªé˜Ÿåˆ—æ»¡çš„è¿˜æ˜¯ç©ºçš„ï¼Ÿå› æ­¤æˆ‘ä»¬é¢„ç•™ä¸€ä¸ªä½ç½®ï¼Œä¹Ÿå°±æ˜¯é˜Ÿåˆ—ä¸èƒ½æ’æ»¡ã€‚å³</p><blockquote><p>front=back  ç©ºé˜Ÿåˆ—<br />(back+1)%size = front æ»¡é˜Ÿåˆ—</p></blockquote><img src="/uploads/images/data_structure/queue_cpp/03.png" width="70%" height="70%"><p>å¦‚ä½•è·å–é˜Ÿåˆ—ä¸­ç¬¬nä¸ªå…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ï¼Ÿ<br />å‡è®¾front=10ï¼Œback=4ã€‚<br /><img src="/uploads/images/data_structure/queue_cpp/04.png" width="70%" height="70%"></p><p>å› æ­¤æˆ‘ä»¬ç”¨C++å®ç°è¯¥å¾ªç¯é˜Ÿåˆ—</p><h3 id="é˜Ÿåˆ—å®ç°"><a class="markdownIt-Anchor" href="#é˜Ÿåˆ—å®ç°"></a> é˜Ÿåˆ—å®ç°</h3><p>é˜Ÿåˆ—æŠ½è±¡æ•°æ®ç±»å‹</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QueueBase</span>&#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">QueueBase</span>()&#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push_back</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T &amp;)</span></span>=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pop_front</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> T &amp; <span class="hljs-title">front</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> T &amp; <span class="hljs-title">back</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">size</span><span class="hljs-params">()</span></span>=<span class="hljs-number">0</span>;<br>&#125;;<br></code></pre></div></td></tr></table></figure><p>ä¹‹ååœ¨å¦å¤–å®šä¹‰ä¸€ä¸ªæ´¾ç”Ÿç±»ç»§æ‰¿QueueBaseæ¥å£ã€‚<br />æˆ‘æ˜¯æŒ‰ç…§ç­–ç•¥2æ¥æ’å…¥å…ƒç´ çš„ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">arrayQueue</span>&#123;</span><br><span class="hljs-keyword">private</span>:<br>    T *m_array;<br>    <span class="hljs-keyword">int</span> m_capacity;<br>    <span class="hljs-keyword">int</span> front;<br>    <span class="hljs-keyword">int</span> back;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">arrayQueue</span>(<span class="hljs-keyword">int</span> initCapacity=<span class="hljs-number">10</span>)&#123;<br>        m_capacity=initCapacity;<br>        m_array=<span class="hljs-keyword">new</span> T[m_capacity];<br>        front=<span class="hljs-number">0</span>;<br>        back=<span class="hljs-number">0</span>;<br>    &#125;<br>    ~<span class="hljs-built_in">arrayQueue</span>()&#123;<span class="hljs-keyword">delete</span> []m_array;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">push_back</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T &amp;)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pop_front</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function">T &amp; <span class="hljs-title">Front</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> m_array[front];<br>    &#125;<br>    <span class="hljs-function">T &amp; <span class="hljs-title">Back</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> m_array[back<span class="hljs-number">-1</span>];<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-keyword">return</span> front==back;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">size</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(front&lt;back)<br>            <span class="hljs-keyword">return</span> back-front;<br>        <span class="hljs-keyword">else</span> <br>            <span class="hljs-keyword">return</span> back+m_capacity-front;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">changeLength</span><span class="hljs-params">(T* &amp;,<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">output</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">empty</span>())<span class="hljs-keyword">return</span>;<br>        <span class="hljs-comment">// æƒ…å†µ1</span><br>        <span class="hljs-keyword">if</span>(front&lt;back)&#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = front; i &lt; back; i++)&#123;<br>                cout&lt;&lt;<span class="hljs-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="hljs-string">&quot;] &quot;</span>&lt;&lt;m_array[i]&lt;&lt;<span class="hljs-string">&quot;\n&quot;</span>;<br>            &#125;<br>        <span class="hljs-comment">// æƒ…å†µ2</span><br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = front; i &lt; m_capacity; i++)&#123;<br>                cout&lt;&lt;<span class="hljs-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="hljs-string">&quot;] &quot;</span>&lt;&lt;m_array[i]&lt;&lt;<span class="hljs-string">&quot;\n&quot;</span>;<br>            &#125;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; back; i++)&#123;<br>                cout&lt;&lt;<span class="hljs-string">&quot;[&quot;</span>&lt;&lt;i&lt;&lt;<span class="hljs-string">&quot;] &quot;</span>&lt;&lt;m_array[i]&lt;&lt;<span class="hljs-string">&quot;\n&quot;</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> arrayQueue&lt;T&gt;::<span class="hljs-built_in">push_back</span>(<span class="hljs-keyword">const</span> T &amp;element)&#123;<br>    <span class="hljs-comment">// æ»¡é˜Ÿåˆ—</span><br>    <span class="hljs-keyword">if</span>((back+<span class="hljs-number">1</span>)%m_capacity==front)&#123;<br>        <span class="hljs-comment">// æ•°ç»„å€å¢</span><br>        <span class="hljs-built_in">changeLength</span>(m_array,m_capacity,m_capacity*<span class="hljs-number">2</span>);<br>        m_capacity*=<span class="hljs-number">2</span>;<br>    &#125;<br>    <span class="hljs-comment">// æŒ‰ç…§ç­–ç•¥2æ’å…¥: å…ˆæ’å…¥å…ƒç´ ï¼Œåç§»åŠ¨back</span><br>    m_array[back]=element;<br>    <span class="hljs-comment">// æ³¨æ„ï¼Œæ­¤å¤„ä¸èƒ½ç›´æ¥ back++ï¼Œè¿™æ ·åšä¼šä½¿backè¶…å‡ºæ•°ç»„é•¿åº¦ä»è€Œå¯¼è‡´æ•°ç»„è®¿é—®è¶Šç•Œ</span><br>    <span class="hljs-comment">// ç›¸åï¼Œ(back+1)%m_capacity ä¼šä½¿backæŒ‡é’ˆå›åˆ°æ•°ç»„èµ·å§‹å¤„ç»§ç»­æ’å…¥</span><br>    back=(back+<span class="hljs-number">1</span>)%m_capacity;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> arrayQueue&lt;T&gt;::<span class="hljs-built_in">pop_front</span>()&#123;<br>    <span class="hljs-comment">// åˆ¤ç©º</span><br>    <span class="hljs-keyword">if</span>(back==front)<span class="hljs-keyword">return</span>;<br>    m_array[front].~<span class="hljs-built_in">T</span>();<br>    <span class="hljs-comment">// åŒæ ·è¿™é‡Œä¹Ÿæ˜¯æ§åˆ¶frontåªèƒ½å¤„äºæ•°ç»„ä¹‹é—´</span><br>    front=(front+<span class="hljs-number">1</span>)%<span class="hljs-keyword">this</span>-&gt;m_capacity;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> arrayQueue&lt;T&gt;::<span class="hljs-built_in">changeLength</span>(T* &amp;array,<span class="hljs-keyword">int</span> oldLength,<span class="hljs-keyword">int</span> newLength)&#123;<br>    <span class="hljs-keyword">if</span>(newLength&lt;<span class="hljs-number">0</span>)<span class="hljs-keyword">return</span>;<br>    T* temp=<span class="hljs-keyword">new</span> T[newLength];<br>    <span class="hljs-comment">// ä»æœ‰æ•ˆå…ƒç´ å¼€å§‹å¤åˆ¶</span><br>    <span class="hljs-keyword">if</span>(front&lt;back)<br>        <span class="hljs-comment">// æ²¡æœ‰å½¢æˆç¯</span><br>        std::<span class="hljs-built_in">copy</span>(array+front,array+back,temp);<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// å½¢æˆç¯</span><br>        std::<span class="hljs-built_in">copy</span>(array+front,array+oldLength,temp);<br>        std::<span class="hljs-built_in">copy</span>(array,array+back,temp+oldLength-front);<br>        <span class="hljs-comment">// é‡æ–°è®¾ç½®front,back</span><br>        front=<span class="hljs-number">0</span>;<br>        back=oldLength<span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-keyword">delete</span> []array;<br>    array=temp;<br>&#125;   <br><br></code></pre></div></td></tr></table></figure><p>æˆ‘è®¤ä¸ºæ¯”è¾ƒéš¾ç†è§£çš„æ˜¯changeLengthæ”¹å˜æ•°ç»„é•¿åº¦å‡½æ•°ï¼Œå…¶å®ç”¨ä¸€å¼ å›¾è¡¨ç¤ºå°±å¾ˆç®€å•äº†</p><img src="/uploads/images/data_structure/queue_cpp/05.png" width="70%" height="70%"><h3 id="æµ‹è¯•"><a class="markdownIt-Anchor" href="#æµ‹è¯•"></a> æµ‹è¯•</h3><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    arrayQueue&lt;<span class="hljs-keyword">int</span>&gt;<span class="hljs-built_in">q</span>(<span class="hljs-number">5</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">1</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">2</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">3</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">4</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">40</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">400</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">4000</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">40000</span>);<br><br>    q.<span class="hljs-built_in">pop_front</span>();<br>    q.<span class="hljs-built_in">pop_front</span>();<br>    q.<span class="hljs-built_in">pop_front</span>();<br>    q.<span class="hljs-built_in">pop_front</span>();<br>    q.<span class="hljs-built_in">pop_front</span>();<br>    q.<span class="hljs-built_in">pop_front</span>();<br><br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">5</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">6</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">7</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">8</span>);<br>    q.<span class="hljs-built_in">push_back</span>(<span class="hljs-number">9</span>);<br><br>    q.<span class="hljs-built_in">output</span>();<br>    cout&lt;&lt;<span class="hljs-string">&quot;size: &quot;</span>&lt;&lt;q.<span class="hljs-built_in">size</span>()&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;front: &quot;</span>&lt;&lt;q.<span class="hljs-built_in">Front</span>()&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;back: &quot;</span>&lt;&lt;q.<span class="hljs-built_in">Back</span>()&lt;&lt;endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight angelscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs angelscript"><span class="hljs-string">[6]</span> <span class="hljs-number">4000</span><br><span class="hljs-string">[7]</span> <span class="hljs-number">40000</span><br><span class="hljs-string">[8]</span> <span class="hljs-number">5</span><br><span class="hljs-string">[9]</span> <span class="hljs-number">6</span><br><span class="hljs-string">[0]</span> <span class="hljs-number">7</span><br><span class="hljs-string">[1]</span> <span class="hljs-number">8</span><br><span class="hljs-string">[2]</span> <span class="hljs-number">9</span><br>size: <span class="hljs-number">7</span><br>front: <span class="hljs-number">4000</span><br>back: <span class="hljs-number">9</span><br></code></pre></div></td></tr></table></figure><h3 id="stl-queue"><a class="markdownIt-Anchor" href="#stl-queue"></a> STL queue</h3><p>å°†è‡ªå·±å†™çš„arrayQueueå’ŒSTL queueåˆ†åˆ«æµ‹è¯•ï¼Œçœ‹çœ‹è°å¿«äº›ï¼Œè¿™é‡Œæˆ‘ä»…ä»…æµ‹è¯•äº†å…ˆæ’å…¥å®Œæˆåå†åˆ é™¤ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    arrayQueue&lt;<span class="hljs-keyword">int</span>&gt;q2;<br>    <span class="hljs-keyword">int</span> n=<span class="hljs-number">100000000</span>;<br>    CClock::<span class="hljs-built_in">start_timeclock</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        q2.<span class="hljs-built_in">push_back</span>(i);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        q2.<span class="hljs-built_in">pop_front</span>();<br>    &#125;<br>    q2.<span class="hljs-built_in">output</span>();<br>    CClock::<span class="hljs-built_in">stop_timeclock</span>();<br>    <span class="hljs-keyword">auto</span> t1=CClock::<span class="hljs-built_in">time_duration</span>();<br><br>    CClock::<span class="hljs-built_in">start_timeclock</span>();<br>    queue&lt;<span class="hljs-keyword">int</span>&gt;q3;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        q3.<span class="hljs-built_in">push</span>(i);<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)&#123;<br>        q3.<span class="hljs-built_in">pop</span>();<br>    &#125;<br>    CClock::<span class="hljs-built_in">stop_timeclock</span>();<br>    <span class="hljs-keyword">auto</span> t2=CClock::<span class="hljs-built_in">time_duration</span>();<br><br>    cout&lt;&lt;<span class="hljs-string">&quot;arrayQueue: &quot;</span>&lt;&lt;t1&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;queue: &quot;</span>&lt;&lt;t2&lt;&lt;endl;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼Œå•ä½ç§’</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">arrayQueue</span>: <span class="hljs-number">2</span>.<span class="hljs-number">32446</span><br><span class="hljs-attribute">queue</span>: <span class="hljs-number">2</span>.<span class="hljs-number">63278</span><br></code></pre></div></td></tr></table></figure><p>ä¸çŸ¥é“è¯¥å¦‚ä½•è¡¨è¾¾â€¦<br />(âŠ™oâŠ™)â€¦</p><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>DataStructures</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®ç»“æ„-C++é“¾è¡¨å®ç°</title>
    <link href="/linkedlist-cpp/"/>
    <url>/linkedlist-cpp/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ç ”ç©¶ã€Šæ•°æ®ç»“æ„ã€ç®—æ³•ä¸åº”ç”¨C++è¯­è¨€æè¿°ã€‹ï¼ŒæŠŠä¸€äº›è‡ªå·±çš„çœ‹æ³•å’Œä»£ç å®ç°å†™åœ¨è¿™é‡Œï¼Œç®—æ˜¯ä¸ªè®°å½•å§ï¼Œä»¥å…ä»¥åå¿˜è®°ã€‚</p><span id="more"></span><h3 id="çº¿æ€§è¡¨é“¾è¡¨æè¿°"><a class="markdownIt-Anchor" href="#çº¿æ€§è¡¨é“¾è¡¨æè¿°"></a> çº¿æ€§è¡¨â€”â€”é“¾è¡¨æè¿°</h3><p>æ€»æ‰€å‘¨çŸ¥ï¼Œæ•°ç»„ä¸­å…ƒç´ åœ°å€åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­åˆ†å¸ƒçš„ï¼Œè€Œé“¾è¡¨çš„å…ƒç´ åœ¨å†…å­˜ä¸­çš„å­˜å‚¨ä½ç½®æ˜¯éšæœºçš„ã€‚å…¶ä¸­æ¯”è¾ƒç®€å•çš„é“¾è¡¨ç±»å‹å°±æ˜¯å•å‘é“¾è¡¨ï¼Œè¿™ç§ç±»å‹çš„é“¾è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªé“¾ï¼Œä¸”æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿æ¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆé™¤äº†æœ€åä¸€ä¸ªèŠ‚ç‚¹:NULLç”¨æ¥æ ‡è®°é“¾è¡¨çš„ç»“æŸï¼‰ã€‚</p><p><img src="/uploads/images/data_structure/linkedlist_cpp/node.jpg" alt="" /></p><p>ä¸ºäº†ç”¨é“¾è¡¨æè¿°çº¿æ€§è¡¨ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªèŠ‚ç‚¹ç»“æ„ä½“ï¼Œä½¿ç”¨C++æ¨¡æ¿èƒ½å¤Ÿæ”¯æŒæ›´å¤šçš„ç±»å‹</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">chainNode</span>&#123;</span><br>    T data;<br>    chainNode* next;<br>    <span class="hljs-built_in">chainNode</span>()&#123;&#125;<br>    <span class="hljs-built_in">chainNode</span>(<span class="hljs-keyword">const</span> T &amp;data)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;data=data;<br>        <span class="hljs-keyword">this</span>-&gt;next=<span class="hljs-literal">nullptr</span>;<br>    &#125;<br>    <span class="hljs-built_in">chainNode</span>(<span class="hljs-keyword">const</span> T &amp;data,chainNode*next)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;data=data;<br>        <span class="hljs-keyword">this</span>-&gt;next=next;<br>    &#125;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h3 id="é“¾è¡¨ç±»linkedlist"><a class="markdownIt-Anchor" href="#é“¾è¡¨ç±»linkedlist"></a> é“¾è¡¨ç±»LinkedList</h3><p>æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œç”¨äºç®¡ç†é“¾è¡¨æ“ä½œ</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LinkedList</span>&#123;</span><br><span class="hljs-keyword">protected</span>:<br>    chainNode&lt;T&gt;*m_Header;<br>    <span class="hljs-keyword">int</span> m_size;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">LinkedList</span>();<br>    <span class="hljs-built_in">LinkedList</span>(<span class="hljs-keyword">const</span> T&amp;);<br>    <span class="hljs-comment">// æ‹·è´æ„é€ å‡½æ•°</span><br>    <span class="hljs-built_in">LinkedList</span>(<span class="hljs-keyword">const</span> LinkedList&lt;T&gt;&amp;);<br>    <span class="hljs-comment">// ç§»åŠ¨æ„é€ å‡½æ•°</span><br>    <span class="hljs-built_in">LinkedList</span>(LinkedList&lt;T&gt;&amp;&amp;);<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">LinkedList</span>();<br>    <span class="hljs-comment">// æ’å…¥èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span>,<span class="hljs-keyword">const</span> T&amp;)</span></span>;<br>    <span class="hljs-comment">// åœ¨é“¾è¡¨å°¾æ’å…¥èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">append</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T&amp;)</span></span>;<br>    <span class="hljs-comment">// åˆ é™¤æŒ‡å®šç´¢å¼•çš„èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">eraseByIndex</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<br>    <span class="hljs-comment">// åˆ é™¤æ‰€æœ‰å…ƒç´ ä¸ºTçš„èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">erase</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T&amp;)</span></span>;<br>    <span class="hljs-comment">// åˆ é™¤æ‰€æœ‰èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">clearAll</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">size</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-comment">// è¿”å›é¦–æ¬¡å‡ºç°çš„èŠ‚ç‚¹ç´¢å¼•</span><br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">indexOf</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T&amp;)</span></span>;<br>    <span class="hljs-function">T &amp;<span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<br>    <span class="hljs-function">chainNode&lt;T&gt;*<span class="hljs-title">getFirstchainNode</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function">chainNode&lt;T&gt;*<span class="hljs-title">getLastchainNode</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-comment">// è¾“å‡ºæ‰€æœ‰èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">outputLinkedList</span><span class="hljs-params">()</span></span>;<br>&#125;;<br></code></pre></div></td></tr></table></figure><h3 id="æ’å…¥èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#æ’å…¥èŠ‚ç‚¹"></a> æ’å…¥èŠ‚ç‚¹</h3><p>é“¾è¡¨çš„æ’å…¥å…¶å®å¾ˆç®€å•ï¼Œé¦–å…ˆéœ€è¦æ‰¾åˆ°ç´¢å¼•indexçš„èŠ‚ç‚¹ï¼Œç„¶ååœ¨<strong>è¯¥èŠ‚ç‚¹ä¹‹åæˆ–è€…ä¹‹å‰</strong>æ’å…¥æ–°å…ƒç´ èŠ‚ç‚¹ï¼Œé‚£ä¹ˆï¼Ÿå¦‚ä½•æ’å…¥å‘¢ï¼Ÿå…¶å®å°±æ˜¯é€šè¿‡ <code>chainNode* next</code> æŒ‡é’ˆå°†å†…å­˜ä¸­çš„èŠ‚ç‚¹åœ°å€é“¾æ¥èµ·æ¥ï¼Œ<code>chainNode* next</code> ä¹Ÿåªæ˜¯ä¸€ä¸ªå˜é‡æ ‡è¯†ç¬¦æ¥æ ‡è¯†å†…å­˜ä¸­çš„åœ°å€ç½¢äº†ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡æ›¿æ¢nextæŒ‡é’ˆå°†éœ€è¦æ’å…¥çš„èŠ‚ç‚¹å’Œå·²ç»å­˜åœ¨çš„é“¾è¡¨ä¸²èµ·æ¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="/uploads/images/data_structure/linkedlist_cpp/insert_node.jpg" alt="" /></p><p>ä¸ºäº†è¯´æ˜ï¼Œæˆ‘ä»¬å…ˆæ¥ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼Œåœ¨é“¾è¡¨å°¾å¤„æ’å…¥èŠ‚ç‚¹</p><h4 id="append"><a class="markdownIt-Anchor" href="#append"></a> append()</h4><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">append</span>(<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    chainNode&lt;T&gt;*pNode=m_Header;<br>    <span class="hljs-keyword">while</span> (pNode-&gt;next)&#123;<br>        pNode=pNode-&gt;next;   <br>    &#125;<br>    pNode-&gt;next=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(data);<br>    <span class="hljs-keyword">this</span>-&gt;m_size++;<br>&#125;   <br></code></pre></div></td></tr></table></figure><p>è¦åœ¨å°¾éƒ¨æ’å…¥èŠ‚ç‚¹ï¼Œé‚£ä¹ˆéœ€è¦å•å‘éå†æ•´ä¸ªé“¾è¡¨ï¼Œæ³¨æ„ <code>while (pNode-&gt;next)</code> ä¸èƒ½æ˜¯ <code>while (pNode)</code> ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ç”¨å°¾èŠ‚ç‚¹æ·»åŠ ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼ŒåŒæ—¶æ›´æ–°é“¾è¡¨å¤§å°</p><p>æ³¨æ„ï¼šå¯èƒ½æœ‰äººä¼šæœ‰ç–‘æƒ‘ï¼špNode=pNode-&gt;next ä¼šè®©m_Header æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å•Šï¼Ÿå…¶å® <font color=red>chainNode<T>*pNode=m_Header;Â  åªæ˜¯å°† m_Header çš„åœ°å€å€¼å¤åˆ¶ç»™pNodeå˜é‡è€Œå·²ï¼Œè™½ç„¶pNodeä¼šä¿®æ”¹å…¶åœ°å€å€¼ï¼Œä½†æ˜¯å®ƒå†…å­˜ä¸­çš„æ•°æ®å¯¹è±¡æ²¡æœ‰æ”¹å˜ï¼Œæ”¹å˜çš„åªæ˜¯ä¸€ä¸ªæ™®é€šçš„æŒ‡é’ˆå˜é‡</font></p><h4 id="insert"><a class="markdownIt-Anchor" href="#insert"></a> insert()</h4><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">insert</span>(<span class="hljs-keyword">int</span> theIndex,<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    <span class="hljs-keyword">if</span>(theIndex&lt;<span class="hljs-number">0</span>||theIndex&gt;=m_size)<span class="hljs-keyword">return</span>;    <br>    <span class="hljs-comment">// æ–°å»ºå¤´èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">if</span>(theIndex==<span class="hljs-number">0</span> &amp;&amp; m_Header==<span class="hljs-literal">nullptr</span>)&#123;<br>        m_Header=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(data);<br>        m_size++;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        chainNode&lt;T&gt;*pNode=m_Header;<br>        <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (pNode)&#123;<br>            <span class="hljs-comment">// åœ¨ theIndexä¹‹å æ’å…¥èŠ‚ç‚¹</span><br>            <span class="hljs-comment">// æ‰¾åˆ°äº†è¦æ’å…¥çš„ç´¢å¼•</span><br>            <span class="hljs-keyword">if</span>(index==theIndex)&#123;<br>                <span class="hljs-comment">// æ–°èŠ‚ç‚¹</span><br>                pNode-&gt;next=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(data,pNode-&gt;next);<br>                <span class="hljs-comment">// è¯¥è¯­å¥ç­‰åŒäº: å³æ›¿æ¢nextæŒ‡é’ˆï¼Œä½¿å…¶è¡”æ¥èµ·æ¥</span><br>                <span class="hljs-comment">// auto p=new chainNode&lt;T&gt;(data);</span><br>                <span class="hljs-comment">// p-&gt;next=pNode-&gt;next;</span><br>                <span class="hljs-comment">// pNode-&gt;next=p;</span><br>                m_size++;<br>            &#125;<br>            index++;<br>            <span class="hljs-comment">// æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>            pNode=pNode-&gt;next;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="è¾“å‡ºé“¾è¡¨èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#è¾“å‡ºé“¾è¡¨èŠ‚ç‚¹"></a> è¾“å‡ºé“¾è¡¨èŠ‚ç‚¹</h3><p>åœ¨ä»‹ç»åˆ é™¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è¾“å‡ºé“¾è¡¨èŠ‚ç‚¹å†…å®¹æ–¹ä¾¿è°ƒè¯•ï¼Œè¿™æ®µä»£ç å¾ˆç®€å•ï¼ŒåŸºæœ¬éƒ½æ˜¯while(pNode)å¾ªç¯çš„å¥—è·¯</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">outputLinkedList</span>()&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>-&gt;m_Header==<span class="hljs-literal">nullptr</span>)<span class="hljs-keyword">return</span>;<br>    chainNode&lt;T&gt;*pNode=<span class="hljs-keyword">this</span>-&gt;m_Header;<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (pNode)&#123;<br>        std::cout&lt;&lt;<span class="hljs-string">&quot;[&quot;</span>&lt;&lt;index&lt;&lt;<span class="hljs-string">&quot;] =&gt; &quot;</span>&lt;&lt;pNode-&gt;data&lt;&lt;std::endl;<br>        index++;<br>        pNode=pNode-&gt;next;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="åˆ é™¤èŠ‚ç‚¹"><a class="markdownIt-Anchor" href="#åˆ é™¤èŠ‚ç‚¹"></a> åˆ é™¤èŠ‚ç‚¹</h3><p>åˆ é™¤é“¾è¡¨ä¸­çš„æŸä¸ªèŠ‚ç‚¹ç±»ä¼¼äºæ’å…¥èŠ‚ç‚¹ï¼Œä¹Ÿæ˜¯é€šè¿‡æŒ‡é’ˆæ›¿æ¢çš„æ‰‹æ®µï¼Œç„¶ådeleteæ‰è¦åˆ é™¤çš„èŠ‚ç‚¹å³å¯ã€‚ä¸è¿‡æœ‰äº›åœ°æ–¹éœ€è¦æ³¨æ„ã€‚<br /><img src="/uploads/images/data_structure/linkedlist_cpp/delete_node.jpg" alt="" /></p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">eraseByIndex</span>(<span class="hljs-keyword">int</span> theIndex)&#123;<br>    <span class="hljs-keyword">if</span>(theIndex&lt;<span class="hljs-number">0</span> || theIndex&gt;=m_size)<span class="hljs-keyword">return</span>;  <br>    <span class="hljs-comment">// deletedNode ä¸ºå¾…åˆ é™¤èŠ‚ç‚¹</span><br>    chainNode&lt;T&gt;*deletedNode=<span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-comment">// å¤„ç†åˆ é™¤å¤´èŠ‚ç‚¹ç‰¹æ®Šæƒ…å†µï¼Œå› ä¸ºå•å‘é“¾è¡¨å¤´ç»“ç‚¹æ— å‰é©±èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">if</span>(theIndex==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-comment">// å°† m_Header æ ‡è®°ä¸ºåˆ é™¤</span><br>        deletedNode = m_Header;<br>        <span class="hljs-comment">// æ›´æ–°å¤´èŠ‚ç‚¹</span><br>        m_Header=m_Header-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// å…¶ä»–æƒ…å†µ</span><br>        chainNode&lt;T&gt;*pNodePre=m_Header;<br>        <span class="hljs-comment">// æŸ¥æ‰¾ å¾…åˆ é™¤èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ï¼Œå…¶ç´¢å¼•ä¸ºtheIndex-1</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; theIndex<span class="hljs-number">-1</span>; i++)&#123;<br>            pNodePre=pNodePre-&gt;next;   <br>        &#125;<br>        <span class="hljs-comment">// æŒ‡é’ˆæ›¿æ¢</span><br>        deletedNode=pNodePre-&gt;next;<br>        pNodePre-&gt;next=deletedNode-&gt;next;<br>    &#125;<br>    <span class="hljs-comment">// åˆ é™¤èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">delete</span> deletedNode;<br>    deletedNode=<span class="hljs-literal">nullptr</span>;<br>    m_size--;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­è¦æ³¨æ„å¦‚æœè¦åˆ é™¤ç´¢å¼•ä¸º0çš„èŠ‚ç‚¹ä¹Ÿå°±æ˜¯å¤´ç»“ç‚¹ï¼Œé‚£ä¹ˆåªéœ€è¦è®©å¤´ç»“ç‚¹æ›´æ–°ä¸ºåŸæ¥çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç„¶åå†deleteè¦åˆ é™¤çš„èŠ‚ç‚¹ï¼Œè¿™ç§æƒ…å†µå¾ˆç‰¹æ®Šï¼Œå› ä¸º<strong>å•å‘é“¾è¡¨å¤´ç»“ç‚¹æ— å‰é©±èŠ‚ç‚¹</strong>ã€‚å…¶ä»–æƒ…å†µéœ€è¦ä¸€ä¸ªå‰é©±èŠ‚ç‚¹ï¼ˆä¹Ÿå°±æ˜¯å½“å‰èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼‰æ¥è¡”æ¥æ•´ä¸ªé“¾è¡¨ã€‚</p><p>å†æ¥çœ‹ä¸‹é¢çš„ä»£ç ï¼Œåˆ é™¤é“¾è¡¨ä¸­æ‰€æœ‰æ•°æ®ä¸ºdataçš„èŠ‚ç‚¹ï¼ŒåŒæ—¶è¿˜å¤„ç†çš„å¤´ç»“ç‚¹çš„ç‰¹æ®Šæƒ…å†µ</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">erase</span>(<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    chainNode&lt;T&gt;*pNode=m_Header;<br>    chainNode&lt;T&gt;*pNodePre;<br>    <span class="hljs-keyword">while</span> (pNode)&#123;<br>        <span class="hljs-keyword">if</span>(pNode-&gt;data==data)&#123;<br>            <span class="hljs-comment">// å¤„ç†åˆ é™¤å¤´ç»“ç‚¹æƒ…å†µ</span><br>            <span class="hljs-keyword">if</span>(pNode==m_Header)&#123;<br>                <span class="hljs-keyword">auto</span> next=m_Header-&gt;next;<br>                <span class="hljs-keyword">delete</span> m_Header;<br>                m_Header=next;<br>                <span class="hljs-comment">// å¹¶ä½¿å…¶æŒ‡å‘åŸæ¥å¤´ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>                pNode=next;<br>                m_size--;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                pNodePre-&gt;next=pNode-&gt;next;<br>                <span class="hljs-keyword">delete</span> pNode;<br>                <span class="hljs-comment">// è¿™æ¡è¯­å¥èƒ½å¤Ÿç»§ç»­åˆ é™¤é“¾è¡¨ä¸­æ•°æ®ä¸ºdataçš„èŠ‚ç‚¹</span><br>                pNode=pNodePre;<br>                m_size--;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// ä¿å­˜å‰é©±èŠ‚ç‚¹</span><br>        pNodePre=pNode;<br>        pNode=pNode-&gt;next;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å…¶ä»–æˆå‘˜å‡½æ•°"><a class="markdownIt-Anchor" href="#å…¶ä»–æˆå‘˜å‡½æ•°"></a> å…¶ä»–æˆå‘˜å‡½æ•°</h3><p>äº‹å®ä¸Šï¼Œå½“çœŸæ­£äº†è§£çš„å•å‘é“¾è¡¨çš„æ’å…¥åˆ é™¤çš„æœ¬è´¨æ—¶ï¼Œå…¶ä»–çš„é“¾è¡¨ç±»å‹ä¹Ÿèƒ½ç†è§£ã€‚</p><p>å•å‘é“¾è¡¨æ˜¯æœ€åŸºç¡€çš„ä¸€ç§é“¾è¡¨ç±»å‹ï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–çš„ä¸€äº›å˜ç§ï¼šå¾ªç¯åˆ—è¡¨ã€åŒå‘é“¾è¡¨ã€åŒå‘å¾ªç¯é“¾è¡¨ã€ç”šè‡³æ˜¯æ ‘ç»“æ„ï¼ˆå±‚æ¬¡ç»“æ„ï¼‰ä¹Ÿä¸é“¾è¡¨å¯†ä¸å¯åˆ†ã€‚å› æ­¤ï¼Œå¿…é¡»è¦å¯¹é“¾è¡¨ååˆ†ç†Ÿæ‚‰ï¼ï¼ï¼</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">bool</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">empty</span>()&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;m_Header==<span class="hljs-literal">nullptr</span>&amp;&amp;<span class="hljs-keyword">this</span>-&gt;m_size&lt;=<span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">int</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">size</span>()&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;m_size;<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">int</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">indexOf</span>(<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    chainNode&lt;T&gt;*pNode=m_Header;<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (pNode&amp;&amp;pNode-&gt;data!=data)&#123;<br>        index++;<br>        pNode=pNode-&gt;next;<br>    &#125;<br>    <span class="hljs-comment">// åˆ°è¾¾é“¾è¡¨å°¾pNodeæ ‡è¯†ä¸ºnullptrï¼Œè¡¨ç¤ºæ²¡æœ‰æ‰¾åˆ°</span><br>    <span class="hljs-keyword">if</span>(pNode==<span class="hljs-literal">nullptr</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">return</span> index;    <br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>T &amp;LinkedList&lt;T&gt;::<span class="hljs-built_in">get</span>(<span class="hljs-keyword">int</span> index)&#123;<br>    <span class="hljs-keyword">if</span>(index&lt;<span class="hljs-number">0</span> || index&gt;=m_size)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">length_error</span>(<span class="hljs-string">&quot;the index is invalid!&quot;</span>);<br>    chainNode&lt;T&gt;*pNode=m_Header;<br>    <span class="hljs-keyword">int</span> count=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (pNode&amp;&amp;index!=(count++))&#123;<br>        pNode=pNode-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> pNode-&gt;data;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>chainNode&lt;T&gt;* LinkedList&lt;T&gt;::<span class="hljs-built_in">getFirstchainNode</span>()&#123;<br>    <span class="hljs-keyword">return</span> m_Header;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>chainNode&lt;T&gt;* LinkedList&lt;T&gt;::<span class="hljs-built_in">getLastchainNode</span>()&#123;<br>    <span class="hljs-keyword">auto</span> p=m_Header;<br>    <span class="hljs-keyword">while</span> (p&amp;&amp;p-&gt;next)&#123;<br>        p=p-&gt;next;   <br>    &#125;<br>    <span class="hljs-keyword">return</span> p;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å®Œæ•´ä»£ç :</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">chainNode</span>&#123;</span><br>    T data;<br>    chainNode* next;<br>    <span class="hljs-built_in">chainNode</span>()&#123;&#125;<br>    <span class="hljs-built_in">chainNode</span>(<span class="hljs-keyword">const</span> T &amp;data)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;data=data;<br>        <span class="hljs-keyword">this</span>-&gt;next=<span class="hljs-literal">nullptr</span>;<br>    &#125;<br>    <span class="hljs-built_in">chainNode</span>(<span class="hljs-keyword">const</span> T &amp;data,chainNode*next)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;data=data;<br>        <span class="hljs-keyword">this</span>-&gt;next=next;<br>    &#125;<br>&#125;;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LinkedList</span>&#123;</span><br><span class="hljs-keyword">protected</span>:<br>    chainNode&lt;T&gt;*m_Header;<br>    <span class="hljs-keyword">int</span> m_size;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">LinkedList</span>();<br>    <span class="hljs-built_in">LinkedList</span>(<span class="hljs-keyword">const</span> T&amp;);<br>    <span class="hljs-comment">// æ‹·è´æ„é€ å‡½æ•°</span><br>    <span class="hljs-built_in">LinkedList</span>(<span class="hljs-keyword">const</span> LinkedList&lt;T&gt;&amp;);<br>    <span class="hljs-comment">// ç§»åŠ¨æ„é€ å‡½æ•°</span><br>    <span class="hljs-built_in">LinkedList</span>(LinkedList&lt;T&gt;&amp;&amp;);<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">LinkedList</span>();<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">int</span>,<span class="hljs-keyword">const</span> T&amp;)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">append</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T&amp;)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">eraseByIndex</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<br>    <span class="hljs-comment">// åˆ é™¤æ‰€æœ‰å…ƒç´ ä¸ºTçš„èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">erase</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T&amp;)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">clearAll</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">empty</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">size</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-comment">// è¿”å›é¦–æ¬¡å‡ºç°çš„èŠ‚ç‚¹ç´¢å¼•</span><br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">indexOf</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T&amp;)</span></span>;<br>    <span class="hljs-function">T &amp;<span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<br>    <span class="hljs-function">chainNode&lt;T&gt;*<span class="hljs-title">getFirstchainNode</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function">chainNode&lt;T&gt;*<span class="hljs-title">getLastchainNode</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">outputLinkedList</span><span class="hljs-params">()</span></span>;<br>&#125;;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>LinkedList&lt;T&gt;::<span class="hljs-built_in">LinkedList</span>()&#123;<br>    m_Header=<span class="hljs-literal">nullptr</span>;<br>    m_size=<span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>LinkedList&lt;T&gt;::<span class="hljs-built_in">LinkedList</span>(<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    m_Header=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(data);<br>    m_size=<span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-comment">// æ‹·è´æ„é€ å‡½æ•°-&gt;æ·±æ‹·è´</span><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>LinkedList&lt;T&gt;::<span class="hljs-built_in">LinkedList</span>(<span class="hljs-keyword">const</span> LinkedList&lt;T&gt;&amp;ll)&#123;<br>    <span class="hljs-keyword">if</span>(ll.m_Header==<span class="hljs-literal">nullptr</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">&quot;The source object can not nullptr!&quot;</span>);<br>    <span class="hljs-keyword">this</span>-&gt;m_size=ll.m_size;<br>    <span class="hljs-comment">// æ„å»ºå¤´èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">this</span>-&gt;m_Header=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(ll.m_Header-&gt;data);<br>    chainNode&lt;T&gt;*pNodeSource=ll.m_Header-&gt;next;<br>    chainNode&lt;T&gt;*pNodeTarget=<span class="hljs-keyword">this</span>-&gt;m_Header;<br>    <span class="hljs-comment">// ä»æºé“¾è¡¨çš„å¤´ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹é€ä¸ªå¤åˆ¶</span><br>    <span class="hljs-keyword">while</span> (pNodeSource)&#123;<br>        pNodeTarget-&gt;next=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(pNodeSource-&gt;data);<br>        pNodeSource=pNodeSource-&gt;next;<br>        pNodeTarget=pNodeTarget-&gt;next;<br>    &#125;<br>    pNodeTarget-&gt;next=<span class="hljs-literal">nullptr</span>;<br>&#125;<br><br><span class="hljs-comment">// ç§»åŠ¨æ„é€ å‡½æ•°-&gt;æµ…æ‹·è´</span><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>LinkedList&lt;T&gt;::<span class="hljs-built_in">LinkedList</span>(LinkedList&lt;T&gt;&amp;&amp;ll)&#123;<br>    <span class="hljs-keyword">this</span>-&gt;m_size=ll.m_size;<br>    <span class="hljs-keyword">this</span>-&gt;m_Header=ll.m_Header;<br>    <span class="hljs-comment">// ç¦æ­¢å†…å­˜åŒºåŸŸå…±äº«</span><br>    ll.m_Header=<span class="hljs-literal">nullptr</span>;<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>LinkedList&lt;T&gt;::~<span class="hljs-built_in">LinkedList</span>()&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>-&gt;m_Header)&#123;<br>        <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">clearAll</span>();<br>    &#125;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">insert</span>(<span class="hljs-keyword">int</span> theIndex,<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    <span class="hljs-keyword">if</span>(theIndex&lt;<span class="hljs-number">0</span>||theIndex&gt;=m_size)<span class="hljs-keyword">return</span>;    <br>    <span class="hljs-comment">// æ–°å»ºå¤´èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">if</span>(theIndex==<span class="hljs-number">0</span>&amp;&amp;m_Header==<span class="hljs-literal">nullptr</span>)&#123;<br>        m_Header=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(data);<br>        m_size++;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        chainNode&lt;T&gt;*pNode=m_Header;<br>        <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> (pNode)&#123;<br>            <span class="hljs-comment">// åœ¨ theIndexä¹‹å æ’å…¥èŠ‚ç‚¹</span><br>            <span class="hljs-keyword">if</span>(index==theIndex)&#123;<br>                pNode-&gt;next=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(data,pNode-&gt;next);<br><span class="hljs-comment">// auto p=new chainNode&lt;T&gt;(data);</span><br>                <span class="hljs-comment">// p-&gt;next=pNode-&gt;next;</span><br>                <span class="hljs-comment">// pNode-&gt;next=p;</span><br>                m_size++;<br>            &#125;<br>            index++;<br>            pNode=pNode-&gt;next;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">append</span>(<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    chainNode&lt;T&gt;*pNode=m_Header;<br>    <span class="hljs-keyword">while</span> (pNode-&gt;next)&#123;<br>        pNode=pNode-&gt;next;   <br>    &#125;<br>    pNode-&gt;next=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(data);<br>    <span class="hljs-keyword">this</span>-&gt;m_size++;<br>&#125;   <br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">clearAll</span>()&#123;<br>    <span class="hljs-keyword">while</span> (m_Header)&#123;<br>        chainNode&lt;T&gt;*pNextNode=m_Header-&gt;next;<br>        <span class="hljs-keyword">delete</span> m_Header;<br>        m_Header=<span class="hljs-literal">nullptr</span>;<br>        m_Header=pNextNode;<br>    &#125;<br>    m_Header=<span class="hljs-literal">nullptr</span>;<br>    m_size=<span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">eraseByIndex</span>(<span class="hljs-keyword">int</span> theIndex)&#123;<br>    <span class="hljs-keyword">if</span>(theIndex&lt;<span class="hljs-number">0</span>||theIndex&gt;=m_size)<span class="hljs-keyword">return</span>;    <br>    chainNode&lt;T&gt;*deletedNode=<span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-comment">// å¤„ç†åˆ é™¤å¤´èŠ‚ç‚¹æƒ…å†µï¼Œå› ä¸ºå•å‘é“¾è¡¨å¤´ç»“ç‚¹æ— å‰é©±èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">if</span>(theIndex==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-comment">// å°† m_Header æ ‡è®°ä¸ºåˆ é™¤</span><br>        deletedNode = m_Header;<br>        m_Header=m_Header-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        chainNode&lt;T&gt;*pNodePre=m_Header;<br>        <span class="hljs-comment">// æ‰¾å¾…åˆ é™¤èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; theIndex<span class="hljs-number">-1</span>; i++)&#123;<br>            pNodePre=pNodePre-&gt;next;   <br>        &#125;<br>        deletedNode=pNodePre-&gt;next;<br>        pNodePre-&gt;next=deletedNode-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">delete</span> deletedNode;<br>    deletedNode=<span class="hljs-literal">nullptr</span>;<br>    m_size--;<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">erase</span>(<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    chainNode&lt;T&gt;*pNode=m_Header;<br>    chainNode&lt;T&gt;*pNodePre;<br>    <span class="hljs-keyword">while</span> (pNode)&#123;<br>        <span class="hljs-keyword">if</span>(pNode-&gt;data==data)&#123;<br>            <span class="hljs-comment">// å¤„ç†åˆ é™¤å¤´ç»“ç‚¹æƒ…å†µ</span><br>            <span class="hljs-keyword">if</span>(pNode==m_Header)&#123;<br>                <span class="hljs-keyword">auto</span> next=m_Header-&gt;next;<br>                <span class="hljs-keyword">delete</span> m_Header;<br>                m_Header=next;<br>                <span class="hljs-comment">// å¹¶ä½¿å…¶æŒ‡å‘åŸæ¥å¤´ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>                pNode=next;<br>                m_size--;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                pNodePre-&gt;next=pNode-&gt;next;<br>                <span class="hljs-keyword">delete</span> pNode;<br>                pNode=pNodePre;<br>                m_size--;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// ä¿å­˜å‰é©±èŠ‚ç‚¹</span><br>        pNodePre=pNode;<br>        pNode=pNode-&gt;next;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">bool</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">empty</span>()&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;m_Header==<span class="hljs-literal">nullptr</span>&amp;&amp;<span class="hljs-keyword">this</span>-&gt;m_size&lt;=<span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">int</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">size</span>()&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;m_size;<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">int</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">indexOf</span>(<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    chainNode&lt;T&gt;*pNode=m_Header;<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (pNode&amp;&amp;pNode-&gt;data!=data)&#123;<br>        index++;<br>        pNode=pNode-&gt;next;<br>    &#125;<br>    <span class="hljs-comment">// åˆ°è¾¾å°¾èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">if</span>(pNode==<span class="hljs-literal">nullptr</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">return</span> index;    <br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>T &amp;LinkedList&lt;T&gt;::<span class="hljs-built_in">get</span>(<span class="hljs-keyword">int</span> index)&#123;<br>    <span class="hljs-keyword">if</span>(index&lt;<span class="hljs-number">0</span>||index&gt;=m_size)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">length_error</span>(<span class="hljs-string">&quot;the index is invalid!&quot;</span>);<br>    chainNode&lt;T&gt;*pNode=m_Header;<br>    <span class="hljs-keyword">int</span> count=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (pNode&amp;&amp;index!=count++)&#123;<br>        pNode=pNode-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> pNode-&gt;data;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>chainNode&lt;T&gt;* LinkedList&lt;T&gt;::<span class="hljs-built_in">getFirstchainNode</span>()&#123;<br>    <span class="hljs-keyword">return</span> m_Header;<br>&#125;<br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br>chainNode&lt;T&gt;* LinkedList&lt;T&gt;::<span class="hljs-built_in">getLastchainNode</span>()&#123;<br>    <span class="hljs-keyword">auto</span> p=m_Header;<br>    <span class="hljs-keyword">while</span> (p&amp;&amp;p-&gt;next)&#123;<br>        p=p-&gt;next;   <br>    &#125;<br>    <span class="hljs-keyword">return</span> p;<br>&#125;<br><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>&gt;</span><br><span class="hljs-keyword">void</span> LinkedList&lt;T&gt;::<span class="hljs-built_in">outputLinkedList</span>()&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>-&gt;m_Header==<span class="hljs-literal">nullptr</span>)<span class="hljs-keyword">return</span>;<br>    chainNode&lt;T&gt;*pNode=<span class="hljs-keyword">this</span>-&gt;m_Header;<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (pNode)&#123;<br>        std::cout&lt;&lt;<span class="hljs-string">&quot;[&quot;</span>&lt;&lt;index&lt;&lt;<span class="hljs-string">&quot;] =&gt; &quot;</span>&lt;&lt;pNode-&gt;data&lt;&lt;std::endl;<br>        index++;<br>        pNode=pNode-&gt;next;<br>    &#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h3 id="æœ‰åºé“¾è¡¨"><a class="markdownIt-Anchor" href="#æœ‰åºé“¾è¡¨"></a> æœ‰åºé“¾è¡¨</h3><p>å…¶å®æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨ä¸Šé¢çš„å•å‘é“¾è¡¨å®ç°ä¸€ä¸ªç®€å•çš„æœ‰åºé“¾è¡¨</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&quot;LinkedList.h&quot;</span></span><br><br><span class="hljs-comment">// é»˜è®¤å‡åº</span><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>,<span class="hljs-keyword">class</span> <span class="hljs-title">Compare</span>=</span>less&lt;T&gt;&gt;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SortedLinkedList</span>:</span> <span class="hljs-keyword">public</span> LinkedList&lt;T&gt; &#123;<br><span class="hljs-keyword">public</span>: <br>    <span class="hljs-keyword">using</span> LinkedList&lt;T&gt;::LinkedList;<br>    <span class="hljs-keyword">using</span> LinkedList&lt;T&gt;::insert;<br>    ~<span class="hljs-built_in">SortedLinkedList</span>()&#123;&#125;<br>    <span class="hljs-comment">// å­ç±»insertä¸ºæœ‰åºæ’å…¥</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T&amp;)</span></span>;<br>    <span class="hljs-comment">// åŸºç±»insertä¸ºæ— åºæ’å…¥</span><br>&#125;;<br><span class="hljs-comment">// é‡è½½insert()å‡½æ•°</span><br><span class="hljs-keyword">template</span>&lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>,<span class="hljs-keyword">class</span> <span class="hljs-title">Compare</span>&gt;</span><br><span class="hljs-keyword">void</span> SortedLinkedList&lt;T,Compare&gt;::<span class="hljs-built_in">insert</span>(<span class="hljs-keyword">const</span> T&amp;data)&#123;<br>    chainNode&lt;T&gt;*pNode=<span class="hljs-keyword">this</span>-&gt;m_Header;<br>    chainNode&lt;T&gt;*pNodePre=<span class="hljs-literal">nullptr</span>;<br>    <span class="hljs-comment">// Compare()(pNode-&gt;data,data) ç­‰ä»·äº pNode-&gt;data &lt; data</span><br>    <span class="hljs-comment">// æ‰¾å‰é©±èŠ‚ç‚¹</span><br>    <span class="hljs-keyword">while</span> (pNode&amp;&amp;<span class="hljs-built_in">Compare</span>()(pNode-&gt;data,data))&#123;<br>        pNodePre=pNode;<br>        pNode=pNode-&gt;next;<br>    &#125;<br>    <span class="hljs-comment">// è‹¥æ— å‰é©±èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ²¡æœ‰å¤´ç»“ç‚¹ æˆ–è€… pNode-&gt;data &gt; data</span><br>    <span class="hljs-keyword">if</span>(pNodePre==<span class="hljs-literal">nullptr</span>)&#123;<br>        <span class="hljs-comment">// æ›´æ–°å¤´ç»“ç‚¹</span><br>        <span class="hljs-keyword">this</span>-&gt;m_Header=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(data,pNode);<br>        <span class="hljs-comment">// ç­‰ä»·äº</span><br>        <span class="hljs-comment">// auto p=new chainNode&lt;T&gt;(data);</span><br>        <span class="hljs-comment">// p-&gt;next=pNode; </span><br>        <span class="hljs-comment">// this-&gt;m_Header=p;</span><br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-comment">// æ’å…¥æ–°èŠ‚ç‚¹</span><br>        chainNode&lt;T&gt;*p=<span class="hljs-keyword">new</span> chainNode&lt;T&gt;(data,pNode);<br>        pNodePre-&gt;next=p;<br>        <span class="hljs-comment">// ç­‰ä»·äº</span><br>        <span class="hljs-comment">// auto p=new chainNode&lt;T&gt;(data);</span><br>        <span class="hljs-comment">// p-&gt;next=pNode;</span><br>        <span class="hljs-comment">// pNodePre-&gt;next=p;</span><br>    &#125;<br>    <span class="hljs-keyword">this</span>-&gt;m_size++;<br>&#125;   <br></code></pre></div></td></tr></table></figure><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>é“¾è¡¨å…ƒç´ åœ¨å†…å­˜éšæœºå­˜å‚¨çš„ï¼Œå ç”¨ä¸€å®šçš„å†…å­˜ç©ºé—´ï¼Œä¸”æŸ¥æ‰¾é€Ÿåº¦è¦æ…¢äºé¡ºåºè¡¨ï¼Œä½†åœ¨æ’å…¥å’Œåˆ é™¤æ–¹é¢è¦ä¼˜äºé¡ºåºè¡¨ã€‚å¦‚æœæœ‰ä¸€ç§æ•°æ®ç»“æ„å¤Ÿå°†ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œé‚£ä¹ˆå°±èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ä¸¤è€…çš„ä¼˜ç‚¹ï¼Œè¿™ç§æ•°æ®ç»“æ„å°±æ˜¯è·³è¡¨å’Œæ•£åˆ—è¡¨ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>DataStructures</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++ç®€å•å®ç°MySQLè¡¨æ ¼è¾“å‡ºåŠŸèƒ½</title>
    <link href="/cpp-printtable/"/>
    <url>/cpp-printtable/</url>
    
    <content type="html"><![CDATA[<p>å…¶å®åœ¨å¾ˆæ—©ä¹‹å‰ï¼Œæˆ‘å°±å¯¹MySQLçš„è¡¨æ ¼è¾“å‡ºå¾ˆæ„Ÿå…´è¶£å¹¶æƒ³ç”¨C++å®ç°ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒæ”¯æŒä¸­æ–‡è¾“å‡ºã€‚å› æ­¤å‰ä¸€æ®µæ—¶é—´æˆ‘å®ç°äº†ç¬¬ä¸€ç‰ˆçš„MyPrettyTable(ç®€åŒ–ç‰ˆçš„Pythonçš„åº“PrettyTable?)ï¼Œç„¶è€Œä»¤äººå¤±æœ›çš„æ˜¯å®ƒåœ¨å«æœ‰ä¸­æ–‡æ±‰å­—çš„æƒ…å†µä¸‹ä¼šå‘ç”Ÿæ··ä¹±è€Œæ— æ³•å¯¹é½ï¼Œäºæ˜¯æˆ‘æ”¾å¼ƒäº†ã€‚ä¸è¿‡æ˜¨å¤©åœ¨å†™ä»£ç æ—¶å¶ç„¶çœ‹åˆ°ä¹‹å‰é‚£ä¸ªè¢«æç½®çš„projectï¼Œäºæ˜¯ä¸ç”˜å¿ƒçš„æˆ‘å†æ¬¡é‡æ–°å®ç°äº†è¿™ä¸ªåŠŸèƒ½â€¦å…¶å®å°±æ˜¯åˆ©ç”¨çš„setwå’Œleft</p><span id="more"></span><h2 id="pythonä¸­çš„prettytable"><a class="markdownIt-Anchor" href="#pythonä¸­çš„prettytable"></a> Pythonä¸­çš„PrettyTable</h2><p>ç”¨C++å†™MyPrettyTableçš„ä»£ç æ ¼å¼æ˜¯æŒ‰ç…§Pythonä¸­çš„PrettyTableã€‚å› æ­¤MyPrettyTableç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•</p><h2 id="ä¸­æ–‡æ±‰å­—å¤„ç†é—®é¢˜"><a class="markdownIt-Anchor" href="#ä¸­æ–‡æ±‰å­—å¤„ç†é—®é¢˜"></a> ä¸­æ–‡æ±‰å­—å¤„ç†é—®é¢˜</h2><p>ç”±äºUTF-8ç¼–ç æ˜¯å˜é•¿ç¼–ç ï¼Œé€šå¸¸æ±‰å­—å ä¸‰ä¸ªå­—èŠ‚ï¼Œè€Œè‹±æ–‡å ä¸€ä¸ªå­—èŠ‚<br />åœ¨ç»ˆç«¯ä¸‹æ˜¾ç¤ºæ±‰å­—å ä¸¤ä¸ªå­—ç¬¦å®½ï¼Œè€Œè‹±æ–‡å­—æ¯åªå ä¸€ä¸ªå­—ç¬¦å®½</p><p>æ¯”å¦‚ <code>string s = &quot;å¥½&quot;;</code><br />åœ¨Linuxä¸‹ s.size() = 3  åœ¨Windowsä¸‹ s.size() = 2<br />å†æ¯”å¦‚ä¸‹é¢çš„ä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp">string s1 = <span class="hljs-string">&quot;ä½ å¥½ä¸–ç•Œ&quot;</span>;<br>string s2 = <span class="hljs-string">&quot;ä½ å¥½ä¸–&quot;</span>;<br>string s3 = <span class="hljs-string">&quot;ä½ å¥½&quot;</span>;<br><span class="hljs-keyword">int</span> size = s1.<span class="hljs-built_in">size</span>();<br>cout &lt;&lt; size &lt;&lt; endl;<br><br>cout.<span class="hljs-built_in">fill</span>(<span class="hljs-string">&#x27;.&#x27;</span>);<br>cout &lt;&lt; left &lt;&lt; <span class="hljs-built_in">setw</span>(size) &lt;&lt; <span class="hljs-string">&quot;&quot;</span> &lt;&lt; endl;<br>cout &lt;&lt; left &lt;&lt; <span class="hljs-built_in">setw</span>(size) &lt;&lt; s1 &lt;&lt; endl;<br>cout &lt;&lt; left &lt;&lt; <span class="hljs-built_in">setw</span>(size) &lt;&lt; s2 &lt;&lt; endl;<br>cout &lt;&lt; left &lt;&lt; <span class="hljs-built_in">setw</span>(size) &lt;&lt; s3 &lt;&lt; endl;<br></code></pre></div></td></tr></table></figure><p>åœ¨Windowsä¸‹</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-number">8</span><br>........    <span class="hljs-regexp">//</span><span class="hljs-number">8</span>  <br>ä½ å¥½ä¸–ç•Œ    <span class="hljs-regexp">//</span> <span class="hljs-number">2</span>x4=<span class="hljs-number">8</span><br>ä½ å¥½ä¸–..    <span class="hljs-regexp">//</span> <span class="hljs-number">2</span>x3+<span class="hljs-number">2</span>=<span class="hljs-number">8</span><br>ä½ å¥½.... <span class="hljs-regexp">//</span> <span class="hljs-number">2</span>x2+<span class="hljs-number">4</span>=<span class="hljs-number">8</span><br></code></pre></div></td></tr></table></figure><p>ç„¶è€Œåœ¨Linuxä¸‹é¢å´æ˜¯</p><figure class="highlight lasso"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs lasso"><span class="hljs-number">12</span><br><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span> <span class="hljs-comment">//12</span><br>ä½ å¥½ä¸–ç•Œxxxx  <span class="hljs-comment">// 3x4=12</span><br>ä½ å¥½ä¸–<span class="hljs-params">...</span>xxx  <span class="hljs-comment">// 3x3+3=12</span><br>ä½ å¥½<span class="hljs-params">...</span><span class="hljs-params">...</span>xx   <span class="hljs-comment">// 3x2+6=12</span><br></code></pre></div></td></tr></table></figure><p>å› æ­¤åœ¨Windowsä¸‹ï¼Œè¾“å‡ºä¸­æ–‡èƒ½å¤Ÿå¾ˆå¥½çš„å¯¹é½ï¼Œä½†åœ¨Linuxä¸‹å°±ä¸æ˜¯è¿™æ ·äº†ã€‚<br />Windowsä¸‹çš„æ˜¾ç¤ºä¸­æ–‡å­—ç¬¦å®½æ°å¥½æ˜¯ä¸¤ä¸ªè‹±æ–‡å­—æ¯ï¼Œè€ŒLinuxä¸‹æ˜¾ç¤ºä¸­æ–‡å­—ç¬¦å®½ç­‰äºä¸¤ä¸ªè‹±æ–‡å­—æ¯ï¼Œä½†æ˜¯ç¼–ç æ—¶å´æ˜¯å 3ä¸ªå­—èŠ‚ï¼</p><p>å½“æˆ‘å°†ä¸Šé¢Linuxä¸‹æ²¡æœ‰å¯¹é½çš„å†…å®¹ç”¨ x å¡«å……åå‘ç°  <strong>ä¸è¶³çš„å¡«å…… x çš„ä¸ªæ•°ç­‰äºä¸­æ–‡æ±‰å­—çš„ä¸ªæ•°</strong>ï¼<br />äºæ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªä¸å¯¹é½é—®é¢˜ï¼Œæˆ‘åœ¨å¤„ç†setw()æ˜¯é‡‡ç”¨äº†WIN32/__linux__å®åŒºåˆ†ä¸åŒçš„å¹³å°</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-built_in">padding_left</span>(<span class="hljs-keyword">this</span>-&gt;m_ColumnsContent_max_len[i] + _get_Chinese_len(str));<br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> WIN32</span><br>        <span class="hljs-built_in">padding_left</span>(<span class="hljs-keyword">this</span>-&gt;m_ColumnsContent_max_len[i]);<br><span class="hljs-meta">#<span class="hljs-meta-keyword">elif</span> __linux__</span><br>        <span class="hljs-built_in">padding_left</span>(<span class="hljs-keyword">this</span>-&gt;m_ColumnsContent_max_len[i] + _get_Chinese_len(str));<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br></code></pre></div></td></tr></table></figure><p>æ­¤æ—¶ä¸­æ–‡æ±‰å­—çš„å¤„ç†é—®é¢˜å¾—ä»¥è§£å†³ï¼Œä½†æ˜¯å¦‚æœè¿˜æœ‰å…¶ä»–ä¸€äº›ä¸­æ–‡æ ‡ç‚¹ç¬¦å·å‘¢ï¼Ÿæˆ–è€…è¯´æ€ä¹ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸­æ–‡æˆ–ä¸­æ–‡æ ‡ç‚¹ç¬¦å·å‘¢ï¼Ÿ</p><p>å› æ­¤æˆ‘å®šä¹‰ä¸€ä¸ªSign.hå¤´æ–‡ä»¶ç”¨äºå­˜æ”¾é‚£äº›ç‰¹æ®Šçš„ç¬¦å·ï¼Œä»¥ä¸‹ä¸ºå¯¹åº”ä¸­æ–‡æ ‡ç‚¹ç¬¦å·çš„unicodeç </p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> PRETTYTABLE_SIGN_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PRETTYTABLE_SIGN_H</span><br><span class="hljs-comment">// special punctuation character</span><br><span class="hljs-class"><span class="hljs-keyword">enum</span>&#123;</span><br>    PC1=<span class="hljs-number">0x3002</span>u,<br>    PC2=<span class="hljs-number">0xFF1F</span>u,<br>    PC3=<span class="hljs-number">0xFF01</span>u,<br>    PC4=<span class="hljs-number">0xFF0C</span>u,<br>    PC5=<span class="hljs-number">0x3001</span>u,<br>    PC6=<span class="hljs-number">0xFF1B</span>u,<br>    PC7=<span class="hljs-number">0xFF1A</span>u,<br>    PC8=<span class="hljs-number">0x300C</span>u,<br>    PC9=<span class="hljs-number">0x300D</span>u,<br>    PC10=<span class="hljs-number">0x2018</span>u,<br>    PC11=<span class="hljs-number">0x2019</span>u,<br>    PC12=<span class="hljs-number">0xFF08</span>u,<br>    PC13=<span class="hljs-number">0xFF09</span>u,<br>    PC14=<span class="hljs-number">0x3014</span>u,<br>    PC15=<span class="hljs-number">0x3015</span>u,<br>    PC16=<span class="hljs-number">0x3010</span>u,<br>    PC17=<span class="hljs-number">0x3011</span>u,<br>    PC18=<span class="hljs-number">0x2014</span>u,<br>    PC19=<span class="hljs-number">0x2026</span>u,<br>    PC20=<span class="hljs-number">0x2013</span>u,<br>    PC21=<span class="hljs-number">0xFF0E</span>u,<br>    PC22=<span class="hljs-number">0x300A</span>u,<br>    PC23=<span class="hljs-number">0x300B</span>u,<br>    PC24=<span class="hljs-number">0x3008</span>u,<br>    PC25=<span class="hljs-number">0x3009</span>u,<br>&#125;;<br><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Sign</span>&#123;</span><br>    PT_PLUS=<span class="hljs-string">&#x27;+&#x27;</span>, <br>    PT_H =<span class="hljs-string">&#x27;-&#x27;</span>, <br>    PT_V =<span class="hljs-string">&#x27;|&#x27;</span>, <br>    PT_DOT= <span class="hljs-string">&#x27;.&#x27;</span>, <br>    PT_EQUAL= <span class="hljs-string">&#x27;=&#x27;</span> ,<br>    PT_SIG_1= <span class="hljs-string">&#x27;@&#x27;</span> ,<br>    PT_SIG_2= <span class="hljs-string">&#x27;#&#x27;</span> ,<br>    PT_SIG_3= <span class="hljs-string">&#x27;$&#x27;</span>, <br>    PT_SIG_4= <span class="hljs-string">&#x27;%&#x27;</span>, <br>    PT_SIG_5= <span class="hljs-string">&#x27;\\&#x27;</span>, <br>    PT_SIG_6=<span class="hljs-string">&#x27;*&#x27;</span>, <br>    PT_SIG_7=<span class="hljs-string">&#x27;/&#x27;</span><br>&#125;;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br></code></pre></div></td></tr></table></figure><p>åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨ä¸­æ–‡ä¸”å­˜åœ¨å¤šå°‘ä¸ªä¸­æ–‡æ±‰å­—æˆ–æ ‡ç‚¹ç¬¦å·ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è½¬åŒ–ä¸ºwchar_t æŒ‡é’ˆç±»å‹çš„å­—ç¬¦ä¸²ï¼Œå‡½æ•°StringToWStringè®²ä¸€ä¸ªstringç±»å‹å­—ç¬¦ä¸²è½¬åŒ–ä¸ºwstringç±»å‹å­—ç¬¦ä¸²ã€‚éœ€è¦æ³¨æ„çš„æ˜¯åœ¨Windowsä¸‹mbstowcsæ˜¯ä¸å®‰å…¨çš„ï¼Œéœ€è¦æ›¿æ¢ä¸ºmbstowcs_sï¼Œä¸è¿‡è¿™é‡Œæˆ‘ç®€å•çš„ç¦æ­¢äº†è¯¥é”™è¯¯</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> WIN32</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> <span class="hljs-meta-keyword">warning</span>(disable:4996)</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br><br><span class="hljs-function">wstring <span class="hljs-title">PrettyTable::StringToWString</span><span class="hljs-params">(<span class="hljs-keyword">const</span> string &amp; str)</span></span>&#123;<br>    <span class="hljs-keyword">size_t</span> nLen=str.<span class="hljs-built_in">length</span>()*<span class="hljs-number">2</span>;<br>    <span class="hljs-built_in">setlocale</span>(LC_CTYPE,<span class="hljs-string">&quot;&quot;</span>);<br>    <span class="hljs-keyword">wchar_t</span> *wcs=<span class="hljs-keyword">new</span> <span class="hljs-keyword">wchar_t</span>[nLen];<br>    <span class="hljs-built_in">wmemset</span>(wcs,<span class="hljs-number">0</span>,nLen);<br>    <span class="hljs-keyword">size_t</span> s;<br>    <span class="hljs-built_in">mbstowcs</span>(wcs,str.<span class="hljs-built_in">c_str</span>(),nLen);<br>    wstring w=wcs;<br>    <span class="hljs-keyword">delete</span>[]wcs;<br>    <span class="hljs-keyword">return</span> w;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åˆ¤æ–­å­—ç¬¦ä¸²ä¸­ä¸­æ–‡æ±‰å­—å’Œæ ‡ç‚¹ç¬¦å·æ•°ç›®</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">int</span> PrettyTable::_get_Chinese_len(<span class="hljs-keyword">const</span> string&amp; str)&#123;<br>    wstring ss=<span class="hljs-built_in">StringToWString</span>(str);<br>    <span class="hljs-keyword">int</span> sum=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;ss.<span class="hljs-built_in">length</span>() ; ++i) &#123;<br>        <span class="hljs-keyword">wchar_t</span> wcs=ss.<span class="hljs-built_in">c_str</span>()[i];<br>        <span class="hljs-keyword">if</span>((wcs&gt;=<span class="hljs-number">0x4E00</span>u&amp;&amp;wcs&lt;=<span class="hljs-number">0x9FFF</span>u)<br> ||wcs==PC1||wcs==PC2||wcs==PC3||wcs==PC4||wcs==PC5||wcs==PC6||wcs==PC7||wcs==PC8||wcs==PC9  ||wcs==PC10||wcs==PC11||wcs==PC12||wcs==PC13||wcs==PC14||wcs==PC15||wcs==PC16||wcs==PC17<br> ||wcs==PC18||wcs==PC19||wcs==PC20||wcs==PC21||wcs==PC22||wcs==PC23||wcs==PC24||wcs==PC25)&#123;<br>            sum++;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> sum;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æ·»åŠ header-_draw_header"><a class="markdownIt-Anchor" href="#æ·»åŠ header-_draw_header"></a> æ·»åŠ Header &amp;  _draw_header</h2><p>åœ¨æ·»åŠ ä¸€ä¸ªHeaderæ—¶ï¼Œæˆ‘å°±è·å–å…¶è¡¨å¤´(åˆ—)çš„æ•°ç›®ï¼Œå¹¶æ·»åŠ åˆ° <code>this-&gt;m_multiColumns</code> ä¸­ï¼Œåç»­å†æ¯æ·»åŠ ä¸€è¡Œrowæ—¶åŒæ—¶è¿˜è¦å°†rowè½¬åŒ–ä¸ºcolumnå¹¶åœ¨æ·»åŠ åˆ°<code>this-&gt;m_multiColumns</code>ä¸­ï¼Œä¸ºçš„æ˜¯ <strong>è·å–æ¯ä¸€åˆ—ä¸­å­—ç¬¦ä¸²çš„æœ€å¤§å®½åº¦</strong> ä½¿å¾—æ•´ä¸ªè¡¨æ ¼å¯¹é½ã€‚</p><p>æ¯”å¦‚æˆ‘è¦ç”»ä¸€ä¸ªè¡¨æ ¼å¤´ï¼Œæˆ‘æ˜¯æŒ‰ç…§ä¸€è¡Œä¸€è¡Œå»è¾“å‡ºç›¸åº”çš„æ•°æ®å¹¶é‡å®šå‘åˆ°å†…éƒ¨çš„ <code>stringstream m_innerOss</code><br />æ³¨æ„çš„æ˜¯ï¼Œæ¯ä¸ªè¡¨å¤´å†…è¾¹è·ä¸º1ä¸ªç©ºæ ¼ï¼Œå› æ­¤æˆ‘è¿˜å®šä¹‰äº†ä¸€ä¸ª</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PADDING_LEFT_RIGHT 2</span><br></code></pre></div></td></tr></table></figure><p>è¡¨ç¤ºå†…è¾¹è·çš„å¤§å°</p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc"><span class="hljs-code">+----+</span>------------------<span class="hljs-code">+----------+</span>----------<span class="hljs-code">+---------------------+</span><br><span class="hljs-section">| xx | xx               | xx       | xx       | xx                  |</span><br><span class="hljs-section">+----+------------------+----------+----------+---------------------+</span><br></code></pre></div></td></tr></table></figure><h2 id="æ·»åŠ rows-_draw_rows"><a class="markdownIt-Anchor" href="#æ·»åŠ rows-_draw_rows"></a> æ·»åŠ Rows &amp;  _draw_rows</h2><p>è¿™é‡Œæˆ‘æƒ³è¯´çš„æ˜¯<br />set()ä¸­å¯ä»¥æœ‰ä¸¤ç§å†™æ³•</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-built_in">setw</span>() = MaxSizeStr + String.<span class="hljs-built_in">Size</span>() - <span class="hljs-built_in">StringCapacity</span>(String)<br><span class="hljs-built_in">setw</span>() = MaxSizeStr + <span class="hljs-built_in">Length</span>(Chinese hans)<br></code></pre></div></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ setw()åº”è¯¥è®¾ç½®çš„å€¼ä¸º <strong>æ¯ä¸€ä¸ªthis-&gt;m_multiColumns ä¸­æœ€å¤§å­—ç¬¦ä¸²å®½åº¦+ä¸­æ–‡æ±‰å­—/æ ‡ç‚¹ç¬¦å·æ•°ç›®</strong><br />è¿™ä¸ª StringCapacity å‡½æ•°å°±æ˜¯è·å–å­—ç¬¦ä¸²ä¸­æ˜¾ç¤ºçš„å­—ç¬¦å®½åº¦ &lt;= string.size()</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">PrettyTable::StringCapacity</span><span class="hljs-params">(<span class="hljs-keyword">const</span> string &amp; raw_str)</span></span>&#123;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> WIN32</span><br>    <span class="hljs-keyword">return</span> raw_str.<span class="hljs-built_in">size</span>();<br><span class="hljs-meta">#<span class="hljs-meta-keyword">elif</span> __linux__</span><br>    <span class="hljs-keyword">return</span> raw_str.<span class="hljs-built_in">size</span>() - <span class="hljs-keyword">this</span>-&gt;_get_Chinese_len(raw_str);<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h2><p>æˆ‘å·²ç»æŠŠä»£ç æ”¾åœ¨ <a href="https://github.com/josexy/MyPrettyTable/">Github</a> ä¸Šäº†ï¼Œå¯ä»¥å»çœ‹çœ‹ä»£ç ï¼Œè™½ç„¶å†™å¾—æœ‰ç‚¹ç³Ÿâ€¦ ä¸è¿‡æ ¸å¿ƒéƒ¨åˆ†è¿˜æ˜¯åˆ©ç”¨C++çš„setwå’Œleftã€‚<br />è¿™ä¸ªprojectç®—æ˜¯åˆ°æ­¤ç»“æŸäº†å§ï¼Œä¸è¿‡ä»¥åæœ‰æ²¡æœ‰å¯èƒ½å†ç»§ç»­æ·»åŠ ä¸€äº›ä¸œè¥¿å°±ä¸çŸ¥é“äº†â€¦</p><p>å›¾ç‰‡å±•ç¤ºå¦‚ä¸‹</p><p><img src="/uploads/images/cpp_table/photo_linux.png" alt="image" /></p><p><img src="/uploads/images/cpp_table/photo_windows.png" alt="image" /></p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½è¿ç®—å®ç°åŠ å‡ä¹˜é™¤</title>
    <link href="/add-subtract-multiply-divide/"/>
    <url>/add-subtract-multiply-divide/</url>
    
    <content type="html"><![CDATA[<p>è®¡ç®—æœºå†…éƒ¨å®ç°æ•°æ®çš„åŠ å‡ä¹˜é™¤è¿ç®—æ˜¯é€šè¿‡å¯¹äºŒè¿›åˆ¶ä½è¿ç®—æ¥å®ç°çš„ï¼ŒåŸºæœ¬è¿ç®—&quot; + - Ã— Ã· &quot; å‡å¯è½¬æ¢ä¸ºä½è¿ç®—ã€‚</p><span id="more"></span><p>åœ¨ä»‹ç»åŠ å‡ä¹˜é™¤è¿ç®—å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€äº›åŸºæœ¬çš„ä½è¿ç®—ã€‚</p><p>ä¸ &amp;<br />1 and 1 = 1<br />1 and 0 = 0<br />0 and 1 = 0<br />0 and 0 = 0</p><p>æˆ– |<br />1 or 1 = 1<br />1 or 0 = 1<br />0 or 1 = 1<br />0 or 0 = 0</p><p>å¼‚æˆ– ^<br />1 xor 1 = 0<br />1 xor 0 = 1<br />0 xor 1 = 1<br />0 xor 0 = 0</p><h2 id="åŠ æ³•è¿ç®—"><a class="markdownIt-Anchor" href="#åŠ æ³•è¿ç®—"></a> åŠ æ³•è¿ç®—</h2><p>å‡å¦‚å³ä¸¤ä¸ª32ä½çš„intæ•´æ•°ï¼š</p><blockquote><p>a=10: 00000000000000000000000000001010<br />b=13: 00000000000000000000000000001101</p></blockquote><p>å°†è¿™ä¸¤ä¸ªæ•°10å’Œ13ç›¸åŠ ï¼š<br />a=01010 (10)<br />b=01101 (13)<br />c=10111 (23)</p><p>æŠŠä¸Šé¢çš„äºŒè¿›åˆ¶åˆ†å‰²ä¸ºæ¯ä¸€ä½åa+b=c</p><table><thead><tr><th>a</th><th>b</th><th>xor ^</th><th style="text-align:left">and &amp;</th><th>c</th></tr></thead><tbody><tr><td>0</td><td>1</td><td>1</td><td style="text-align:left">0</td><td>1</td></tr><tr><td>1</td><td>0</td><td>1</td><td style="text-align:left">0</td><td>1</td></tr><tr><td>0</td><td>1</td><td>1</td><td style="text-align:left">0</td><td>1</td></tr><tr><td>1</td><td>1</td><td>0</td><td style="text-align:left">1</td><td>0</td></tr><tr><td>0</td><td>0</td><td>0</td><td style="text-align:left">0</td><td>1</td></tr></tbody></table><p>æˆ‘ä»¬å‘ç° ä½å¼‚æˆ–^ å•çº¯çš„å°†ä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œä¸è¿‡å¹¶æ²¡æœ‰è€ƒè™‘ <strong>è¿›ä½</strong> )ï¼Œä½†æ˜¯ ä¸è¿ç®—&amp; èƒ½å¤Ÿè¡¨ç¤ºä¸¤ä¸ªäºŒè¿›åˆ¶ç›¸åŠ æ˜¯å¦å‘ç”Ÿäº†è¿›ä½ï¼ˆå¦‚ä¸Šè¡¨æ‰€ç¤ºï¼‰ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ©ç”¨ xor å°†ä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œand åˆ¤æ–­æ˜¯å¦æœ‰è¿›ä½ï¼Œå¦‚æœæœ‰ï¼Œé‚£ä¸ªæ»¡2è¿›1ä½ carry&lt;&lt;=1</p><blockquote><p>sum = a^b<br />carry = a&amp;b<br />carry &lt;&lt;= 1</p></blockquote><p>å‡å¦‚è¿™æ ·è®¡ç®—ä¼šå‘ç”Ÿä»€ä¹ˆ?</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-built_in">add</span>(a,b)<br>a=<span class="hljs-number">01010</span><br>b=<span class="hljs-number">01101</span><br><br>sum=a^b =&gt; <span class="hljs-number">00111</span> <span class="hljs-comment">// æ±‚å’Œ</span><br>carry=a&amp;b =&gt; <span class="hljs-number">01000</span> <span class="hljs-comment">// æ±‚è¿›ä½: 1&amp;1</span><br>carry=carry&lt;&lt;<span class="hljs-number">1</span> =&gt; <span class="hljs-number">10000</span> <span class="hljs-comment">//æ»¡2è¿›1</span><br><br>å¦‚æœcarryè¿›ä½!=<span class="hljs-number">0</span>,å¦åˆ™å°±ç»“æŸ<br>å‡è®¾<br>a=sum=  <span class="hljs-number">00111</span><br>b=carry=<span class="hljs-number">10000</span><br>é‡å¤ä¹‹å‰çš„æ­¥éª¤...æ­¤æ—¶æ–°çš„a=sum,b=carry<br>sum=a^b =&gt; <span class="hljs-number">10111</span><br>carry=a&amp;b =&gt; <span class="hljs-number">00000</span><br>carry=carry&lt;&lt;<span class="hljs-number">1</span> =&gt; <span class="hljs-number">00000</span><br><br>æ­¤æ—¶sum=<span class="hljs-number">10111</span> ä¸” carry=<span class="hljs-number">0</span> <br>ç»“æœæ­£ç¡®ï¼<br></code></pre></div></td></tr></table></figure><p>sum=a^b è¡¨æ˜å¯¹aå’Œbæ±‚å’Œï¼ˆä¸è€ƒè™‘è¿›ä½ï¼‰ï¼Œè€Œ (a&amp;b)&lt;&lt;1 è¡¨æ˜æ±‚aå’Œbä¸­å“ªä¸ªä½å‘ç”Ÿäº†è¿›ä½ï¼Œå¹¶ä¸”å°†è¯¥ä½ç½®äºæœ€é«˜ä½(é€šè¿‡å·¦ç§»ä¸€ä½)</p><p>å› æ­¤C++ä»£ç å¦‚ä¸‹:</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-comment">// è¿­ä»£1ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ€è·¯æ¥å†™</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> sum=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">int</span> carry=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">do</span><br>    &#123;<br>        sum=a^b;<br>        carry=(a&amp;b)&lt;&lt;<span class="hljs-number">1</span>;<br>        a=sum;<br>        b=carry;<br>    &#125; <span class="hljs-keyword">while</span> (carry); <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦æœ‰è¿›ä½ã€‚å¦‚æ— ï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰å¯ä»¥åŠ çš„å€¼</span><br>    <span class="hljs-keyword">return</span> sum;<br>&#125;<br><span class="hljs-comment">// è¿­ä»£2</span><br><span class="hljs-comment">// è¿˜å¯ä»¥ä¿®æ”¹ä¸ºä»¥ä¸‹ä»£ç </span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> sum=a; <br>    <span class="hljs-keyword">int</span> carry=b;<br>    <span class="hljs-keyword">while</span> (carry)&#123;<br>        <span class="hljs-keyword">int</span> temp=sum;<br>        sum=temp^carry; <span class="hljs-comment">//a+b</span><br>        carry=(temp&amp;carry)&lt;&lt;<span class="hljs-number">1</span>; <span class="hljs-comment">//è¿›1ä½</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> sum;<br>&#125;<br><span class="hljs-comment">//é€’å½’</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">if</span>(b==<span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> a;<br>    <span class="hljs-keyword">int</span> carry=(a&amp;b)&lt;&lt;<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">int</span> sum=a^b;<br>    <span class="hljs-comment">// å°†a+bè½¬åŒ–ä¸ºsum+carry</span><br>    <span class="hljs-built_in">add</span>(sum,carry);<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å‡æ³•è¿ç®—"><a class="markdownIt-Anchor" href="#å‡æ³•è¿ç®—"></a> å‡æ³•è¿ç®—</h2><p>ç”±äºè®¡ç®—æœºåªä¼šè¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œé‚£ä¹ˆå‡æ³•å°±å¯ä»¥è½¬å˜ä¸ºåŠ æ³•è¿ç®—ï¼Œè¿™æ¶‰åŠåˆ°è®¡ç®—æœºçš„åŸç åç å’Œè¡¥ç çŸ¥è¯†äº†ã€‚è¿™é‡Œç®€å•æä¸‹</p><ul><li>æ­£æ•°çš„ <strong>åŸç =åç =è¡¥ç </strong></li><li>è´Ÿæ•°çš„ åŸç =æ­£æ•°çš„åŸç ä¸”æœ€é«˜ä½ç½®ä¸º1ã€‚<br />å¦‚32ä½-3åŸç å¯è¡¨ç¤ºä¸º 10000000000000000000000000000011</li><li>è´Ÿæ•°çš„åç ä¸ºå…¶åŸç çš„æœ€é«˜ä½1ä¸å˜ï¼Œå…¶ä½™ä½å–å(~)<br />å¦‚32ä½-3åç å¯è¡¨ç¤ºä¸º 11111111111111111111111111111100</li><li>è´Ÿæ•°çš„è¡¥ç ä¸ºå…¶åç +1<br />å¦‚32ä½-3è¡¥ç å¯è¡¨ç¤ºä¸º 11111111111111111111111111111101</li></ul><p><strong>ç›®å‰è¡¥ç æ™®éæ˜¯è®¡ç®—æœºå†…éƒ¨æ•°å€¼çš„è¡¨ç¤ºæ–¹å¼ï¼Œå®ƒå¾ˆå¥½çš„è§£å†³äº† +0 å’Œ -0çš„é—®é¢˜</strong></p><p>å› æ­¤å‡æ³•è¿ç®—å°±å˜å¾—ååˆ†ç®€å•çš„<br />ä»£ç å¦‚ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-comment">// a - b = a + (-b) = a + (~b + 1 )</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">subtract</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> negative=<span class="hljs-built_in">add</span>(~b,<span class="hljs-number">1</span>); <span class="hljs-comment">// ~b + 1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">add</span>(a,negative); <br>&#125;<br></code></pre></div></td></tr></table></figure><p>è´Ÿæ•°å’Œæ­£æ•°è½¬æ¢(è®¾x&gt;0)ï¼š</p><blockquote><p>-x=(~x+1)  å¦‚ -10=(~10+1)<br />x=~(-x-1)  å¦‚ 10=~(-10-1)<br />x=~(-x)+1 å¦‚ 10=~(-10)+1</p></blockquote><h2 id="ä¹˜æ³•è¿ç®—"><a class="markdownIt-Anchor" href="#ä¹˜æ³•è¿ç®—"></a> ä¹˜æ³•è¿ç®—</h2><p>å…¶å®ä¹˜æ³•ä¹Ÿå°±æ˜¯å¤šä¸ªåŠ æ³•çš„ç´¯ç§¯æ±‚å’Œï¼Œåœ¨æˆ‘ä»¬å°å­¦æ—¶ï¼Œ25Ã—5åº”è¯¥æ˜¯è¿™æ ·è®¡ç®—çš„</p><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">   <span class="hljs-number"> 2 </span>5<br> Ã— <span class="hljs-number"> 0 </span>5<br> â€”â€”â€”â€”â€”â€”â€”â€”<br> <span class="hljs-number"> 1 </span>2 5<br>+<span class="hljs-number"> 0 </span>0<br> â€”â€”â€”â€”â€”â€”â€”â€”<br> <span class="hljs-number"> 1 </span>2 5<br></code></pre></div></td></tr></table></figure><p>äºŒè¿›åˆ¶ä¹Ÿå¯ä»¥è¿™æ ·è®¡ç®—ï¼Œä¸è¿‡å°±æ˜¯æ»¡2è¿›1ã€‚è¿™é‡Œè¿˜æ˜¯ä»¥25Ã—5=125ä¸ºä¾‹</p><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">      <span class="hljs-number"> 0 </span>1<span class="hljs-number"> 1 </span>0<span class="hljs-number"> 0 </span>1   = 25<br>     Ã—      <span class="hljs-number"> 1 </span>0<span class="hljs-number"> 1 </span>  = 5<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>      <span class="hljs-number"> 0 </span>1<span class="hljs-number"> 1 </span>0<span class="hljs-number"> 0 </span>1   = 25<br>+   <span class="hljs-number"> 0 </span>0<span class="hljs-number"> 0 </span>0<span class="hljs-number"> 0 </span>0     = 0<br>+ <span class="hljs-number"> 0 </span>1<span class="hljs-number"> 1 </span>0<span class="hljs-number"> 0 </span>1       = 25&lt;&lt;2 = 25*2^2=120<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” <br>  <span class="hljs-number"> 0 </span>1<span class="hljs-number"> 1 </span>1<span class="hljs-number"> 1 </span>1<span class="hljs-number"> 0 </span>1   =<span class="hljs-number"> 125 </span>= 25+120<br></code></pre></div></td></tr></table></figure><p>å°†ä¹˜æ³•åˆ†è§£ä¸ºåŠ æ³•å³å¯å®ç°ä½è¿ç®—ï¼Œå¤§è‡´æ€è·¯å¦‚ä¸‹ï¼Œ<br />å­˜åœ¨ä¸€ä¸ªå‡½æ•° <code>int multiply(int a,int b);</code><br />1.è‹¥b&lt;0ï¼Œåˆ™å¯¹bæ±‚è´ŸåŒ–ä¸º<strong>æ­£æ•°</strong>ï¼ŒåŒæ—¶è®¾ç½®ä¸€ä¸ªæ ‡è¯†neagtive_maskè®°å½•è¯¥bæ˜¯è´Ÿæ•°<br />2.å¯¹é™¤æ•°bä¸æ–­å³ç§»b&gt;&gt;=1å¹¶ä¸”å–å¾—bæœ€ä½ä½çš„å€¼(0æˆ–1)ï¼Œç›´åˆ°b=0<br />3.è‹¥ä¸º1ï¼Œåˆ™addæ“ä½œå¾—sum<br />4.aä¸æ–­å·¦ç§»1ä½ a&lt;&lt;=1<br />5.ç»“å°¾åˆ¤æ–­neagtive_maskæ¥è®¾ç½®sumçš„æ­£è´Ÿ</p><p>æ³¨æ„ï¼Œé™¤æ•°å¦‚æœä¸ºè´Ÿæ•°ï¼Œå‡è®¾ä¸º 11111111111111111111111111111011 (-5)ï¼Œé‚£ä¹ˆå…¶å³ç§»å¾—ä¸åˆ°b=0ï¼Œè‡³äºè¢«é™¤æ•°å¯ä»¥å°äº0<br />å…·ä½“ä»£ç å¦‚ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">multiply</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;<br>    <span class="hljs-comment">// åˆ¤æ–­æ­£è´Ÿ</span><br>    <span class="hljs-keyword">bool</span> neagtive_mask=(b&lt;<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span>(b&lt;<span class="hljs-number">0</span>)&#123;<span class="hljs-number">2</span><br>        b=~(b<span class="hljs-number">-1</span>); <span class="hljs-comment">// åŒ–ä¸ºæ­£æ•°: -x=(~x+1) &lt;-&gt; x=-(-x-1) (x&gt;0) </span><br>    &#125;<br>    <span class="hljs-keyword">int</span> sum=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (b) <br>    &#123;<br>        <span class="hljs-keyword">if</span>(b&amp;<span class="hljs-number">0x1</span>)&#123; <span class="hljs-comment">//å–æœ€ä½ä½ï¼Œæœ€ä½ä½ä¸º1ï¼Œæ±‚å’Œ</span><br>            sum=<span class="hljs-built_in">add</span>(sum,a); <span class="hljs-comment">//ç´¯åŠ </span><br>        &#125;<br>        b&gt;&gt;=<span class="hljs-number">1</span>; <span class="hljs-comment">// é™¤æ•°å³ç§»å°†æœ€ä½ä½æº¢å‡º</span><br>        a&lt;&lt;=<span class="hljs-number">1</span>; <span class="hljs-comment">// è¢«é™¤æ•°å·¦ç§»</span><br>    &#125;<br>    <span class="hljs-keyword">if</span>(neagtive_mask)&#123;<br>        sum=~(sum<span class="hljs-number">-1</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> sum;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="é™¤æ³•è¿ç®—"><a class="markdownIt-Anchor" href="#é™¤æ³•è¿ç®—"></a> é™¤æ³•è¿ç®—</h2><p>é™¤æ³•å°±ç›¸å¯¹æ¥è¯´å¤æ‚äº†ï¼Œä¸è¿‡é™¤æ³•ç±»ä¼¼å‡æ³•ï¼Œä¸æ–­åœ°å‡å»é™¤æ•°å¾—åˆ°å•†ï¼Œæœ€åå‰©ä¸‹ä½™æ•°<br />è¿™é‡Œè¿˜æ˜¯ä»¥å°å­¦æ•°å­¦é™¤æ³•ä¸ºä¾‹å­ 37Ã·3=12â€¦1</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp">     <span class="hljs-number">12</span> <br>  -----<br><span class="hljs-number">3</span> | <span class="hljs-number">37</span><br>  - <span class="hljs-number">3</span><br>   ----<br>      <span class="hljs-number">7</span><br>    - <span class="hljs-number">6</span>   <br>    ---<br>      <span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­è¿™æ“ä½œè¿˜å¯ä»¥è½¬æ¢ä¸º</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp">æ­¥éª¤<span class="hljs-number">1</span><br>     <span class="hljs-number">1</span><br>   -----<br><span class="hljs-number">30</span> | <span class="hljs-number">37</span>    <br>   - <span class="hljs-number">30</span><br>    ----<br>  <span class="hljs-number">7</span>  <br>æ­¥éª¤<span class="hljs-number">2</span><br>    <span class="hljs-number">2</span><br>   ----<br> <span class="hljs-number">3</span>| <span class="hljs-number">7</span>   <br>   <span class="hljs-number">-6</span><br>    ---<br>    <span class="hljs-number">1</span><br>  <br>å•†: <span class="hljs-number">1</span>*<span class="hljs-number">10</span>^<span class="hljs-number">1</span> + <span class="hljs-number">2</span>*<span class="hljs-number">10</span>^<span class="hljs-number">0</span> = <span class="hljs-number">10</span>+<span class="hljs-number">2</span>=<span class="hljs-number">12</span><br>æœ€åä½™ä¸‹<span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><p>å‘ç°äº†ä»€ä¹ˆå—ï¼Ÿ</p><p>ç°åœ¨æˆ‘ä»¬æŠŠä¸Šé¢åè¿›åˆ¶æ¢æˆäºŒè¿›åˆ¶</p><blockquote><p>37: 100101<br />3:       0011<br />7:       1101</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp">æ­¥éª¤<span class="hljs-number">1</span><br>         <span class="hljs-number">1</span><br>      --------<br> <span class="hljs-number">11000</span>|<span class="hljs-number">100101</span> -&gt;a=<span class="hljs-number">37</span>  <br>       - <span class="hljs-number">11000</span> <br>    -------<br>      <span class="hljs-number">1101</span> -&gt;<span class="hljs-number">7</span><br>æ­¥éª¤<span class="hljs-number">2</span><br>       <span class="hljs-number">1</span><br>    ------<br><span class="hljs-number">1100</span>| <span class="hljs-number">1101</span>  -&gt;a=<span class="hljs-number">7</span><br>   -  <span class="hljs-number">1100</span> <br>    ------<br>        <span class="hljs-number">1</span><br>æ­¥éª¤<span class="hljs-number">3</span><br>         <span class="hljs-number">0</span><br>    ------<br> <span class="hljs-number">110</span>|   <span class="hljs-number">1</span> <br>   -    <span class="hljs-number">0</span> <br>    ------<br>        <span class="hljs-number">1</span><br>å•†: <span class="hljs-number">1</span>*<span class="hljs-number">2</span>^<span class="hljs-number">3</span> + <span class="hljs-number">1</span>*<span class="hljs-number">2</span>^<span class="hljs-number">2</span> + <span class="hljs-number">0</span> <br>  = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">3</span> + <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">2</span> + <span class="hljs-number">0</span><br>  = <span class="hljs-number">8</span>+<span class="hljs-number">4</span>+<span class="hljs-number">0</span>=<span class="hljs-number">12</span><br>æœ€åä½™ä¸‹<span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><p>åœ¨ä¸Šé¢ä¾‹å­ä¸­ï¼Œé™¤æ•°3<strong>å·¦ç§»3ä½</strong>å˜ä¸º 11000ï¼Œæ¥ç€é™¤æ•°3<strong>å·¦ç§»2ä½</strong>å˜ä¸º 1100ï¼Œæœ€å<strong>å·¦ç§»1ä½</strong>å˜ä¸º 110ã€‚<br />æ­¤æ—¶å‘ç° <strong>è¢«é™¤æ•°1</strong> å°äº <strong>é™¤æ•°110</strong>ï¼Œå› æ­¤å•†ä¸º0ï¼ˆC++è¯­è¨€ä¸­é™¤æ³•è¿ç®—å¯¼è‡´è¿”å›ä¸€ä¸ª<strong>æ•´æ•°</strong>ï¼‰ã€‚<br />å› æ­¤å¦‚æœå‘ç°è¢«é™¤æ•°å°äºé™¤æ•°ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›0å³å¯ã€‚</p><p>äºæ˜¯è¦å…ˆæ‰¾åˆ°é™¤æ•°åº”è¯¥å·¦ç§»çš„ä½æ•°ï¼Œä¸”ä½¿å¾—é™¤æ•°æ˜¯&lt;=é™¤æ•°<br />ç„¶ååˆ©ç”¨å‡æ³• :a=subtract(a,b&lt;&lt;nMove)</p><p>åˆ©ç”¨åŠ æ³• :å½“å‰ç´¯åŠ å€¼r=add(å‰ä¸€ä¸ªå€¼ç´¯åŠ å€¼r,1&lt;&lt;nMove)</p><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">divide</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> nMove=<span class="hljs-number">0</span>; <br>    <span class="hljs-keyword">bool</span> negative_mask=<span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">if</span>(a&lt;<span class="hljs-number">0</span>)&#123;<br>        a=~(a<span class="hljs-number">-1</span>); <span class="hljs-comment">// åŒ–æ­£</span><br>        negative_mask=<span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(b&lt;<span class="hljs-number">0</span>)&#123;<br>        b=~(b<span class="hljs-number">-1</span>); <span class="hljs-comment">// åŒ–æ­£</span><br>        <span class="hljs-comment">// åŒå·å¾—æ­£ï¼Œå¼‚å·çš„è´Ÿ</span><br>        negative_mask=negative_mask==<span class="hljs-literal">false</span>?<span class="hljs-literal">true</span>:<span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(a&lt;b)&#123;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;<br>    <span class="hljs-comment">// æ‰¾åˆ°é™¤æ•°åº”è¯¥å·¦ç§»çš„ä½æ•°ï¼Œä¸”ä½¿å¾—é™¤æ•°æ˜¯&lt;=é™¤æ•°</span><br>    <span class="hljs-keyword">for</span> ( nMove = <span class="hljs-number">0</span>; nMove&lt;<span class="hljs-number">32</span>;nMove++)&#123;<br>        <span class="hljs-keyword">if</span>((b&lt;&lt;nMove)&gt;=a)&#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">int</span> r=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = nMove; i &gt;=<span class="hljs-number">0</span>; i--)&#123;<br>        <span class="hljs-keyword">int</span> t=b&lt;&lt;i;<br>        <span class="hljs-keyword">if</span>(a&lt;t) <span class="hljs-comment">// è¢«é™¤æ•°å°äºé™¤æ•°</span><br>            <span class="hljs-keyword">continue</span>;<br>        a=<span class="hljs-built_in">subtract</span>(a,t);<br>        r=<span class="hljs-built_in">add</span>(r,<span class="hljs-number">1</span>&lt;&lt;i);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(negative_mask)&#123;<br>        r=~(r<span class="hljs-number">-1</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> r;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="è¾“å‡ºäºŒè¿›åˆ¶"><a class="markdownIt-Anchor" href="#è¾“å‡ºäºŒè¿›åˆ¶"></a> è¾“å‡ºäºŒè¿›åˆ¶</h2><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">printBinary</span><span class="hljs-params">(<span class="hljs-keyword">int</span> number)</span></span>&#123;<br><span class="hljs-keyword">char</span> strBinary[<span class="hljs-number">33</span>]&#123; <span class="hljs-number">0</span> &#125;;<br><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> bitmask = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">31</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++)<br>&#123;<br><span class="hljs-keyword">char</span> k = ((number &amp; bitmask)&gt;&gt;<span class="hljs-number">31</span>)?<span class="hljs-string">&#x27;1&#x27;</span>:<span class="hljs-string">&#x27;0&#x27;</span>;<br>strBinary[i] = k;<br>number &lt;&lt;= <span class="hljs-number">1</span>;<br>&#125;<br>cout &lt;&lt; strBinary &lt;&lt; endl;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ç®€å•æ•°æ®äº¤æ¢"><a class="markdownIt-Anchor" href="#ç®€å•æ•°æ®äº¤æ¢"></a> ç®€å•æ•°æ®äº¤æ¢</h2><p>åˆ©ç”¨xorä½å¼‚æˆ–æ¥å®ç°å€¼äº¤æ¢</p><p>åŸç†:</p><blockquote><p>a ^ a = 0<br />a ^ 0 = a<br />0 ^ a = a</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs cpp"><span class="hljs-keyword">int</span> a=<span class="hljs-number">10</span>,b=<span class="hljs-number">20</span>;<br>a=a^b; <span class="hljs-comment">// a=a^b;</span><br>b=a^b; <span class="hljs-comment">// b=(a^b)^b=a^(b^b)=a^0=a;</span><br>a=a^b; <span class="hljs-comment">// a=(a^b)^a=(a^a)^b=0^b=b;</span><br></code></pre></div></td></tr></table></figure><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux Vim YCMé…ç½®</title>
    <link href="/linux-ycm-vim/"/>
    <url>/linux-ycm-vim/</url>
    
    <content type="html"><![CDATA[<p>ç”±äºä¹‹å‰ä¸å°å¿ƒæŠŠvimçš„é…ç½®åˆ äº†ï¼Œè‡´ä½¿ä¹‹å‰çš„é‚£ç¯‡æ–‡ç« æ— æ³•è®¿é—®ï¼Œä½†ä¸ºäº†å›åº”æœ‰å…³ç½‘å‹çš„å›å¤ï¼Œç‰¹æ­¤é‡æ–°ç¼–è¾‘äº†vimçš„ycmé…ç½®ã€‚ğŸ˜ƒ</p><p>YCMå…¨ç§° YouCompleteMeï¼Œæ˜¯ä¸€ä¸ªvimæ’ä»¶ï¼Œä½†æ˜¯å´æ˜¯ä¸€ä¸ªèƒ½å¤Ÿä½¿ä»£ç è‡ªåŠ¨è¡¥å…¨çš„å·¥å…·ã€‚è™½ç„¶å¦‚æ­¤ï¼Œä½†ä¹Ÿè¿˜æ˜¯æ— æ³•ä¸ä¸“ç”¨IDEç›¸åª²ç¾ï¼Œä¸è¿‡å¯¹äºvimå…šæ¥è¯´å´æ˜¯ä¸€ä¸ªååˆ†æœ‰è¶£çš„æ’ä»¶ã€‚</p><span id="more"></span><h2 id="å®‰è£…å‰"><a class="markdownIt-Anchor" href="#å®‰è£…å‰"></a> å®‰è£…å‰</h2><p>è¦ä½¿VIMé…ç½®YCMï¼Œåˆ™å¿…é¡»ç¡®ä¿Vimæ”¯æŒPython2å’ŒPython3ï¼Œå¯ä»¥ç”¨ <code>vim --version</code> æŸ¥çœ‹æ˜¯å¦æ”¯æŒã€‚å¦åˆ™è¯·è‡ªè¡Œä»æºä»£ç å®‰è£…vimã€‚</p><p>æˆ‘çš„ç³»ç»Ÿæ˜¯archlinuxï¼Œvimç‰ˆæœ¬ä¸º8.2</p><h2 id="å®‰è£…ycmvundle"><a class="markdownIt-Anchor" href="#å®‰è£…ycmvundle"></a> å®‰è£…YCM(Vundle)</h2><p>YCM githubï¼š <a href="https://github.com/ycm-core/YouCompleteMe">https://github.com/ycm-core/YouCompleteMe</a></p><p>æ¨èé€šè¿‡ <strong>Vundle</strong> å®‰è£… YCMï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œéœ€è¦å®‰è£… Vundleï¼š <a href="https://github.com/VundleVim/Vundle.vim">https://github.com/VundleVim/Vundle.vim</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">git clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim<br></code></pre></div></td></tr></table></figure><p>ä¹‹åå¯ä»¥ç¼–è¾‘ ~/.vimrc æ–‡ä»¶</p><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh"><span class="hljs-built_in">set</span> nocompatible<br>filetype off <br><br><span class="hljs-built_in">set</span> rtp+=~/.vim/bundle/Vundle.vim<br>call vundle<span class="hljs-comment">#begin()</span><br>...<br>Plugin <span class="hljs-string">&#x27;VundleVim/Vundle.vim&#x27;</span><br>...<br>call vundle<span class="hljs-comment">#end()</span><br>filetype plugin indent on<br></code></pre></div></td></tr></table></figure><p>ä¸€èˆ¬æ¥è¯´ï¼Œvundleå¸¸ç”¨ç”¨æ³•å¦‚ä¸‹</p><figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir"><span class="hljs-symbol">:PluginList</span>       - åˆ—ä¸¾é…ç½®æ’ä»¶<br><span class="hljs-symbol">:PluginInstall</span>    - å®‰è£… â€˜Pluginâ€™ ä¹‹åçš„æ’ä»¶<br><span class="hljs-symbol">:PluginUpdate</span>  - æ›´æ–°æ’ä»¶<br><span class="hljs-symbol">:PluginSearch</span> foo - å¯»æ‰¾æ’ä»¶ fooå¹¶æ·»åŠ çš„æœ¬åœ°é…ç½®<br><span class="hljs-symbol">:PluginClean</span>      - åˆ é™¤æœªè¢«ä½¿ç”¨çš„æ’ä»¶<br></code></pre></div></td></tr></table></figure><h2 id="æ”¯æŒcc"><a class="markdownIt-Anchor" href="#æ”¯æŒcc"></a> æ”¯æŒC/C++</h2><p>è¦ä½¿YCMæ”¯æŒCè¯­è¨€çš„è‡ªåŠ¨è¡¥å…¨ï¼Œè¿˜éœ€è¦é…ç½®YCMï¼Œé¦–å…ˆåœ¨ .vimrc æ·»åŠ ä¸€è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">call vundle<span class="hljs-comment">#begin()</span><br>. . . <br>Plugin <span class="hljs-string">&#x27;Valloric/YouCompleteMeâ€™</span><br><span class="hljs-string">. . .</span><br><span class="hljs-string">call vundle#end()</span><br></code></pre></div></td></tr></table></figure><p>è¿›å…¥vimå <code>:PluginInstall</code> ï¼Œç„¶ååœ¨è¿›è¡Œç¼–è¯‘YCMï¼Œå½“ç„¶è¿˜æœ‰ ./install.sh --all ï¼Œä¸è¿‡æˆ‘å°±ä¸æ€ä¹ˆé…ç½®äº†ã€‚ æ³¨æ„è¿˜è¦å®‰è£… <code>cmake</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ~/.vim/bundle/YouCompleteMe<br>./install.sh --clang-completer<br></code></pre></div></td></tr></table></figure><p>å¦‚æœæ˜¯Git YCMçš„ï¼Œé‚£ä¹ˆè¿˜éœ€è¦åœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œ</p><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">git <span class="hljs-built_in">clone</span> https://github.com/ycm-core/YouCompleteMe.git<br>git submodule update --init --recursive<br></code></pre></div></td></tr></table></figure><h2 id="ä¸‹è½½å®‰è£…libclang"><a class="markdownIt-Anchor" href="#ä¸‹è½½å®‰è£…libclang"></a> ä¸‹è½½å®‰è£…libclang</h2><p>ç”±äºæˆ‘çš„ç³»ç»Ÿæ˜¯archlinuxï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo pacman -S clang boost llvm-libs<br></code></pre></div></td></tr></table></figure><p>å…¶ä»–linuxç³»ç»Ÿæ¯”å¦‚Ubuntuï¼Œéœ€è¦å®‰è£… llvmï¼Œclangï¼Œlibclangï¼Œlibboostã€‚</p><h2 id="ç¼–è¯‘æ„å»º-ycm_core-åº“"><a class="markdownIt-Anchor" href="#ç¼–è¯‘æ„å»º-ycm_core-åº“"></a> ç¼–è¯‘æ„å»º ycm_core åº“</h2><p>ç¼–è¯‘æ„å»ºycm_coreåº“éœ€è¦å®‰è£… cmakeå’Œpython3-dev<br />åˆ›å»ºä¸€ä¸ªç”¨äºå­˜æ”¾ç¼–è¯‘è¿‡ç¨‹çš„äº§ç”Ÿçš„æ–‡ä»¶</p><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh"><span class="hljs-comment"># mkdir ~/ycm_build</span><br><span class="hljs-comment"># cd ~/ycm_build</span><br><span class="hljs-comment"># cmake -G &quot;Unix Makefiles&quot; -DUSE_SYSTEM_BOOST=ON -DUSE_SYSTEM_LIBCLANG=ON . ~/.vim/bundle/YouCompleteMe/third_party/ycmd/cpp</span><br><br>è¾“å‡ºï¼š<br>-- The C compiler identification is GNU 9.1.0<br>-- The CXX compiler identification is GNU 9.1.0<br>-- Check <span class="hljs-keyword">for</span> working C compiler: /usr/bin/cc<br>-- Check <span class="hljs-keyword">for</span> working C compiler: /usr/bin/cc -- works<br>-- Detecting C compiler ABI info<br>-- Detecting C compiler ABI info - <span class="hljs-keyword">done</span><br>-- Detecting C compile features<br>-- Detecting C compile features - <span class="hljs-keyword">done</span><br>-- Check <span class="hljs-keyword">for</span> working CXX compiler: /usr/bin/c++<br>-- Check <span class="hljs-keyword">for</span> working CXX compiler: /usr/bin/c++ -- works<br>-- Detecting CXX compiler ABI info<br>-- Detecting CXX compiler ABI info - <span class="hljs-keyword">done</span><br>-- Detecting CXX compile features<br>-- Detecting CXX compile features - <span class="hljs-keyword">done</span><br>-- Found PythonLibs: /usr/lib/libpython2.7.so (found suitable version <span class="hljs-string">&quot;2.7.16&quot;</span>, minimum required is <span class="hljs-string">&quot;2.7&quot;</span>) <br>-- Using libclang to provide semantic completion <span class="hljs-keyword">for</span> C/C++/ObjC<br>-- Found Boost: /usr/include (found version <span class="hljs-string">&quot;1.69.0&quot;</span>) found components:  filesystem regex <br>-- Using external libclang: /usr/lib/libclang.so.8<br>-- NOT using clang-tidy <span class="hljs-keyword">for</span> static analysis.<br>-- Configuring <span class="hljs-keyword">done</span><br>-- Generating <span class="hljs-keyword">done</span><br>-- Build files have been written to: /home/joxrays/ycm_build<br><br><span class="hljs-comment"># cmake --build . --target ycm_core --config Release</span><br>--config Release é’ˆå¯¹ Windowsï¼Œå¯¹äºLinux/Unixå¿½ç•¥<br>è‹¥æ— é”™è¯¯ä¹‹åå¯çœ‹åˆ° `Linking CXX shared library /home/joxrays/.vim/bundle/YouCompleteMe/third_party/ycmd/ycm_core.so`<br></code></pre></div></td></tr></table></figure><p>è‡³æ­¤YCM_COREç¼–è¯‘å®Œæˆï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">cp ~/.vim/bundle/YouCompleteMe/third_party/ycmd/examples/.ycm_extra_conf.py ~/.vim/<br></code></pre></div></td></tr></table></figure><h2 id="vimé…ç½®æ–‡ä»¶æ’ä»¶"><a class="markdownIt-Anchor" href="#vimé…ç½®æ–‡ä»¶æ’ä»¶"></a> vimé…ç½®æ–‡ä»¶+æ’ä»¶</h2><p>æˆ‘å…ˆæŠŠæˆ‘çš„vimrcé…ç½®æ–‡ä»¶è´´å‡ºäº†</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><br><span class="hljs-built_in">set</span> nocp<br><span class="hljs-built_in">set</span> modelines=0<br><span class="hljs-built_in">set</span> backspace=2<br>syntax on <br>autocmd InsertLeave * se nocul<br>autocmd InsertEnter * se cul<br><span class="hljs-built_in">set</span> smartindent <br><span class="hljs-built_in">set</span> autoindent<br><span class="hljs-built_in">set</span> confirm <br><span class="hljs-built_in">set</span> tabstop=4 <br><span class="hljs-built_in">set</span> softtabstop=4<br><span class="hljs-built_in">set</span> shiftwidth=4 <br><span class="hljs-built_in">set</span> expandtab <br><span class="hljs-built_in">set</span> number<br><span class="hljs-built_in">set</span> <span class="hljs-built_in">history</span>=50  <br><span class="hljs-built_in">set</span> hlsearch<br><span class="hljs-built_in">set</span> incsearch<br><span class="hljs-built_in">set</span> gdefault<br><span class="hljs-built_in">set</span> encoding=utf-8<br><span class="hljs-built_in">set</span> fileencodings=utf-8,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936,utf-16,big5,euc-jp,latin1<br><span class="hljs-built_in">set</span> guifont=Menlo:h16:cANSI <br><span class="hljs-built_in">set</span> langmenu=zn_CN.UTF-8<br><span class="hljs-built_in">set</span> helplang=cn <br><span class="hljs-built_in">set</span> ruler <br><span class="hljs-built_in">set</span> laststatus=1 <br><span class="hljs-built_in">set</span> showcmd <br><span class="hljs-built_in">set</span> scrolloff=3<br><span class="hljs-built_in">set</span> showmatch <br><span class="hljs-built_in">set</span> matchtime=5<br><span class="hljs-built_in">set</span> autowrite <br><span class="hljs-built_in">set</span> wildmenu  <br><span class="hljs-built_in">set</span> linespace=2 <br><span class="hljs-built_in">set</span> whichwrap=b,s,&lt;,&gt;,[,] <br><span class="hljs-built_in">set</span> foldenable  <br><span class="hljs-built_in">set</span> cursorline <br><span class="hljs-built_in">set</span> magic  <br><span class="hljs-built_in">set</span> ignorecase<br><span class="hljs-built_in">set</span> background=dark<br><span class="hljs-built_in">set</span> t_Co=256   <br><span class="hljs-built_in">set</span> mouse=i <br><span class="hljs-built_in">set</span> backspace=indent,eol,start<br><span class="hljs-built_in">set</span> nocompatible<br><br><span class="hljs-built_in">set</span> rtp+=~/.vim/bundle/Vundle.vim<br>call vundle<span class="hljs-comment">#begin()</span><br>Plugin <span class="hljs-string">&#x27;VundleVim/Vundle.vim&#x27;</span><br>Plugin <span class="hljs-string">&#x27;Valloric/YouCompleteMe&#x27;</span><br>Plugin <span class="hljs-string">&#x27;altercation/vim-colors-solarized&#x27;</span><br>Plugin <span class="hljs-string">&#x27;scrooloose/nerdtree&#x27;</span><br>Plugin <span class="hljs-string">&#x27;scrooloose/nerdcommenter&#x27;</span><br>Plugin <span class="hljs-string">&#x27;majutsushi/tagbar&#x27;</span><br>Plugin <span class="hljs-string">&#x27;whatyouhide/vim-gotham&#x27;</span><br>Plugin <span class="hljs-string">&#x27;vim-airline/vim-airline&#x27;</span><br>Plugin <span class="hljs-string">&#x27;vim-airline/vim-airline-themes&#x27;</span><br><br>call vundle<span class="hljs-comment">#end()</span><br><br>filetype plugin indent on<br><br>autocmd CursorMovedI,InsertLeave * <span class="hljs-keyword">if</span> pumvisible() == 0|silent! pclose|endif<br>autocmd InsertLeave * <span class="hljs-keyword">if</span> pumvisible() == 0|pclose|endif<br><span class="hljs-built_in">set</span> completeopt=longest,menu<br>highlight Pmenu    guibg=darkgrey  guifg=black<br>highlight PmenuSel guibg=lightgrey guifg=black<br>inoremap &lt;expr&gt; &lt;Down&gt;     pumvisible() ? <span class="hljs-string">&quot;\&lt;C-n&gt;&quot;</span> : <span class="hljs-string">&quot;\&lt;Down&gt;&quot;</span><br>inoremap &lt;expr&gt; &lt;Up&gt;       pumvisible() ? <span class="hljs-string">&quot;\&lt;C-p&gt;&quot;</span> : <span class="hljs-string">&quot;\&lt;Up&gt;&quot;</span><br>inoremap &lt;expr&gt; &lt;PageDown&gt; pumvisible() ? <span class="hljs-string">&quot;\&lt;PageDown&gt;\&lt;C-p&gt;\&lt;C-n&gt;&quot;</span> : <span class="hljs-string">&quot;\&lt;PageDown&gt;&quot;</span><br>inoremap &lt;expr&gt; &lt;PageUp&gt;   pumvisible() ? <span class="hljs-string">&quot;\&lt;PageUp&gt;\&lt;C-p&gt;\&lt;C-n&gt;&quot;</span> : <span class="hljs-string">&quot;\&lt;PageUp&gt;&quot;</span><br>inoremap &lt;expr&gt; &lt;CR&gt;       pumvisible() ? <span class="hljs-string">&quot;\&lt;C-y&gt;&quot;</span> : <span class="hljs-string">&quot;\&lt;CR&gt;&quot;</span><br><br><span class="hljs-built_in">let</span> g:ycm_key_list_select_completion = [<span class="hljs-string">&#x27;&lt;Down&gt;&#x27;</span>]<br><span class="hljs-built_in">let</span> g:ycm_key_list_previous_completion = [<span class="hljs-string">&#x27;&lt;Up&gt;&#x27;</span>]<br><br><span class="hljs-built_in">let</span> g:ycm_goto_buffer_command = <span class="hljs-string">&#x27;horizontal-split&#x27;</span><br><span class="hljs-built_in">let</span> g:ycm_server_python_interpreter=<span class="hljs-string">&#x27;/usr/bin/python2&#x27;</span><br><span class="hljs-built_in">let</span> g:ycm_global_ycm_extra_conf = <span class="hljs-string">&#x27;~/.vim/.ycm_extra_conf.py&#x27;</span><br><span class="hljs-built_in">let</span> g:airline<span class="hljs-comment">#extensions#tabline#enabled = 1</span><br><span class="hljs-built_in">let</span> g:ycm_seed_identifiers_with_syntax = 1<br><span class="hljs-built_in">let</span> g:ycm_complete_in_strings = 1<br><span class="hljs-built_in">let</span> g:ycm_collect_identifiers_from_tags_files = 1<br><span class="hljs-built_in">let</span> g:ycm_complete_in_comments = 1<br><span class="hljs-built_in">let</span> g:ycm_min_num_of_chars_for_completion = 2<br><span class="hljs-built_in">let</span> g:ycm_cache_omnifunc=0<br><span class="hljs-built_in">let</span> g:ycm_confirm_extra_conf=0<br><br><br>syntax <span class="hljs-built_in">enable</span><br><span class="hljs-string">&quot;colorscheme solarized</span><br><span class="hljs-string">&quot;</span>colorscheme gotham<br>colorscheme jellybeans<br><span class="hljs-built_in">let</span> g:solarized_termcolors=256<br><br><br><span class="hljs-built_in">let</span> g:NERDTreeDirArrowExpandable = <span class="hljs-string">&#x27;â–¸&#x27;</span><br><span class="hljs-built_in">let</span> g:NERDTreeDirArrowCollapsible = <span class="hljs-string">&#x27;â–¾&#x27;</span><br>map &lt;C-b&gt; :NERDTreeToggle&lt;CR&gt;<br><br><br>map &lt;C-m&gt; :Tagbar&lt;CR&gt;<br><span class="hljs-built_in">let</span> g:tagbar_ctags_bin=<span class="hljs-string">&#x27;ctags&#x27;</span><br><span class="hljs-built_in">let</span> g:tagbar_width=30<br><br></code></pre></div></td></tr></table></figure><p>ä¹‹ååªéœ€åœ¨ vim ä¸­  <strong>:PluginInstall</strong> å®‰è£…æ’ä»¶ï¼Œå¯èƒ½éœ€è¦ç‚¹æ—¶é—´â€¦</p><p>taglistæ˜¯ä¸€ä¸ªç”¨äºæ˜¾ç¤ºå®šä½ç¨‹åºä¸­å„ç§ç¬¦å·çš„æ’ä»¶ã€‚è¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯tagbarï¼Œå®ƒæ˜¯ä¸€ä¸ªtaglistçš„æ›¿ä»£å“ï¼Œè¦æ˜¯æœ‰tagbarè¿˜éœ€è¦ç”Ÿæˆ tags æ–‡ä»¶ï¼Œç”Ÿæˆæ–¹æ³•å¯ä»¥å‚è€ƒ <a href="https://www.vim.org/scripts/script.php?script_id=2358">https://www.vim.org/scripts/script.php?script_id=2358</a> ã€‚</p><p>é¦–å…ˆè¦ä»è¯¥ç½‘ç«™ä¸‹è½½  <code>cpp_src.tar.bz2</code> ï¼Œè§£å‹åæ˜¯ä¸€ä¸ª cpp_srcç›®å½•ï¼Œç„¶åæ‰§è¡Œä¸€ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">ctags -R --c++-kinds=+p --fields=+iaS --extra=+q --language-force=C++ cpp_src<br>mv tags ~/.vim<br></code></pre></div></td></tr></table></figure><p>è€Œå¯¹äºVimé¢œè‰²é…ç½®ï¼Œæ¯”å¦‚æœ¬ä¾‹ä¸­ jellybeansï¼Œåˆ™</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">mkdir -p ~/.vim/colors<br><span class="hljs-built_in">cd</span> ~/.vim/colors<br>curl -O https://raw.githubusercontent.com/nanotech/jellybeans.vim/master/colors/jellybeans.vim<br>ç„¶ååœ¨ .vimrc ä¸­è®¾ç½® colorscheme jellybeans<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ï¼Œå¦‚æœ <code>let g:ycm_global_ycm_extra_conf = '~/.vim/.ycm_extra_conf.py'</code> ä¸­ é»˜è®¤çš„ .ycm_extra_conf.py ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€äº›è«åå…¶å¦™çš„é”™è¯¯ï¼Œé‚£ä¹ˆå¯ä»¥ä¸‹è½½è¯¥æ–‡ä»¶æ›¿æ¢åŸæœ‰çš„ **.ycm_extra_conf.py **<br /><a href="https://raw.githubusercontent.com/theodelrieu/dotfiles/master/.ycm_extra_conf.py">https://raw.githubusercontent.com/theodelrieu/dotfiles/master/.ycm_extra_conf.py</a></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ~/.vim/<br>curl -O  https://raw.githubusercontent.com/theodelrieu/dotfiles/master/.ycm_extra_conf.py<br></code></pre></div></td></tr></table></figure><h2 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h2><p>åŸºæœ¬ä¸ŠYCMé…ç½®åˆ°æ­¤ç»“æŸäº†ï¼Œä¹Ÿæ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆéš¾å•¦ï½<br />ç°åœ¨vimæ”¯æŒPythonå’ŒC/C++ä»£ç è¡¥å…¨äº†<br />æœ€åè´´ä¸€å¼ æµ‹è¯•å›¾ï¼š</p><p><img src="/uploads/images/ycm_vim/ycm_vim.png" alt="YCM VIM" /></p><p>æœ‰å•¥é—®é¢˜å¯è”ç³»æˆ‘å“ˆ~</p><p>bye</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Vim</tag>
      
      <tag>YCM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CentOSæœåŠ¡å™¨Shadowsocks</title>
    <link href="/centos-shadowsocks/"/>
    <url>/centos-shadowsocks/</url>
    
    <content type="html"><![CDATA[<p>åœ¨å¾ˆä¹…ä¹‹å‰æˆ‘ç”¨Windowsæ—¶ä¸€ç›´ä½¿ç”¨ <strong>SoftEther VPN</strong> æ¥è®¿é—®å¤–ç½‘ï¼Œä½†ç°åœ¨å·²ç»è½¬å‘äº†SSï¼Œè€Œä¸”ä»…æ˜¯é€šè¿‡è½¬å‘æµé‡æ¥ç§‘å­¦ä¸Šç½‘çš„è¯ï¼Œæ— ç–‘SSæ˜¯æœ€åˆé€‚çš„ï¼Œå› æ­¤åœ¨ hostwinds ä¸Šä¹Ÿä¹°äº†ä¸€å°centos7æœåŠ¡å™¨å‡†å¤‡æ­å»ºshadowsocksã€‚</p><span id="more"></span><p>Shadowsockså®˜ç½‘ï¼š <a href="https://shadowsocks.org/en/index.html">https://shadowsocks.org/en/index.html</a><br />Shadowsocksé…ç½®ä»‹ç»ï¼š <a href="https://shadowsocks.org/en/config/quick-guide.html">https://shadowsocks.org/en/config/quick-guide.html</a><br />Githubï¼š<a href="https://github.com/shadowsocks/">https://github.com/shadowsocks/</a></p><h2 id="ssé…ç½®æœåŠ¡å™¨"><a class="markdownIt-Anchor" href="#ssé…ç½®æœåŠ¡å™¨"></a> SSé…ç½®æœåŠ¡å™¨</h2><p>æŸ¥çœ‹pythonç‰ˆæœ¬</p><figure class="highlight autoit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@hwsrv</span><span class="hljs-number">-548851</span> ~]<span class="hljs-meta"># python --version</span><br>Python <span class="hljs-number">2.7</span><span class="hljs-number">.5</span><br></code></pre></div></td></tr></table></figure><p>æˆ‘çš„centosæœåŠ¡å™¨é»˜è®¤æ²¡æœ‰å®‰è£…Python Pipï¼ŒåŒæ—¶å¯èƒ½è¿˜éœ€è¦æ›´æ–°pip</p><figure class="highlight autoit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@hwsrv</span><span class="hljs-number">-548851</span> ~]<span class="hljs-meta"># yum install python-pip</span><br>[root<span class="hljs-symbol">@hwsrv</span><span class="hljs-number">-548851</span> ~]<span class="hljs-meta"># pip install --upgrade pip</span><br></code></pre></div></td></tr></table></figure><p>ä¹‹åå°±å¯ä»¥é€šè¿‡pipå®‰è£…shadowsocks</p><figure class="highlight autoit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@hwsrv</span><span class="hljs-number">-548851</span> ~]<span class="hljs-meta"># pip install shadowsocks</span><br></code></pre></div></td></tr></table></figure><p>åˆ°æ­¤SSæœåŠ¡ç«¯å®‰è£…å®Œæˆï¼Œæ¥ä¸‹æ¥è¿˜éœ€è¦jsonæ ¼å¼çš„é…ç½®æ–‡ä»¶</p><figure class="highlight avrasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs avrasm">&#123;<br>    <span class="hljs-string">&quot;server&quot;</span>:<span class="hljs-string">&quot;my_server_ip&quot;</span>,<br>    <span class="hljs-string">&quot;server_port&quot;</span>:<span class="hljs-number">8388</span>,<br>    <span class="hljs-string">&quot;local_address&quot;</span>: <span class="hljs-string">&quot;127.0.0.1&quot;</span>,<br>    <span class="hljs-string">&quot;local_port&quot;</span>:<span class="hljs-number">1080</span>,<br>    <span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;barfoo!&quot;</span>,<br>    <span class="hljs-string">&quot;timeout&quot;</span>:<span class="hljs-number">600</span>,<br>    <span class="hljs-string">&quot;method&quot;</span>:<span class="hljs-string">&quot;chacha20-ietf-poly1305&quot;</span><br>&#125;<br><span class="hljs-symbol">server:</span> æœåŠ¡å™¨ä¸»æœºIPï¼Œé»˜è®¤ <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br><span class="hljs-symbol">server_port:</span> æœåŠ¡å™¨ç«¯å£ ï¼Œé»˜è®¤ <span class="hljs-number">8388</span><br><span class="hljs-symbol">local_address:</span> ä¸€èˆ¬ä¸º <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><br><span class="hljs-symbol">local_port:</span> æœ¬åœ°ç«¯å£ï¼Œä¸€èˆ¬ <span class="hljs-number">1080</span><br><span class="hljs-symbol">password:</span> è¿æ¥SSæœåŠ¡å™¨çš„å¯†ç <br><span class="hljs-symbol">timeout:</span> è¿æ¥è¶…æ—¶æ—¶é—´/s ï¼Œé»˜è®¤ <span class="hljs-number">300</span><br><span class="hljs-symbol">method:</span> åŠ å¯†æ–¹å¼ï¼Œé»˜è®¤ aes<span class="hljs-number">-256</span>-cfb<br></code></pre></div></td></tr></table></figure><p>å¦‚æœè¦ä»å‘½ä»¤è¡Œæ¥å¯åŠ¨æœåŠ¡ç«¯ï¼Œåˆ™å¯ä»¥</p><figure class="highlight autoit"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@hwsrv</span><span class="hljs-number">-548851</span> ~]<span class="hljs-meta"># ssserver -p 8998 -k mypassword</span><br></code></pre></div></td></tr></table></figure><p>ä¸€èˆ¬éƒ½æ˜¯ä»é…ç½®æ–‡ä»¶æ¥å¯åŠ¨ssæœåŠ¡ç«¯<br />ç±»ä¼¼å¦‚ä¸‹ config.json</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;server&quot;</span>: <span class="hljs-string">&quot;104.168.xxx,xxx&quot;</span>,<br>    <span class="hljs-attr">&quot;server_port&quot;</span>: <span class="hljs-number">8998</span>,<br>    <span class="hljs-attr">&quot;local_address&quot;</span>: <span class="hljs-string">&quot;127.0.0.1&quot;</span>,<br>    <span class="hljs-attr">&quot;local_port&quot;</span>: <span class="hljs-string">&quot;1080&quot;</span>,<br>    <span class="hljs-attr">&quot;password&quot;</span>: <span class="hljs-string">&quot;mypassword&quot;</span>,<br>    <span class="hljs-attr">&quot;timeout&quot;</span>: <span class="hljs-number">60</span>,<br>    <span class="hljs-attr">&quot;method&quot;</span>: <span class="hljs-string">&quot;aes-256-cfb&quot;</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨æœåŠ¡ç«¯å¹¶åœ¨åå°è¿è¡Œï¼š <code>ssserver -c config.json -d start</code> ï¼Œæ£€æµ‹æ˜¯å¦æˆåŠŸå¯åŠ¨</p><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">[root@hwsrv-548851 ~]<span class="hljs-comment"># netstat -anp|grep -i 8998</span><br>tcp       <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>104.168.xxx,xxx:8998    0.0.0.0:*               LISTEN      27701/python2       <br>udp       <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>104.168.xxx,xxx:8998    0.0.0.0:*                           27701/python2       <br></code></pre></div></td></tr></table></figure><h2 id="ssé…ç½®å®¢æˆ·ç«¯"><a class="markdownIt-Anchor" href="#ssé…ç½®å®¢æˆ·ç«¯"></a> SSé…ç½®å®¢æˆ·ç«¯</h2><p>SSçš„å®¢æˆ·ç«¯åˆ†ä¸ºWindowsï¼ŒMacOSï¼ŒLinuxï¼ŒAndroidï¼ŒiOSå’ŒOpenWRT<br />è¿™é‡Œä»‹ç»Windowsï¼ŒLinux</p><h3 id="linux"><a class="markdownIt-Anchor" href="#linux"></a> Linux</h3><p>å¯¹äºarchlinuxæœ€ç›´æ¥çš„æ–¹æ³•ï¼š <code>sudo pacman -S shadowsocks-qt5</code> ä»GUIè¿æ¥ssæœåŠ¡å™¨<br />ä¹Ÿå¯ä»¥ä»pipä¸‹è½½shadowsocksï¼š <code>pip install shadowsocks</code>ï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ªåŒæœåŠ¡ç«¯çš„config.jsoné…ç½®æ–‡ä»¶å¦‚ <code>sslocal -c config.json -d start</code></p><h3 id="windows"><a class="markdownIt-Anchor" href="#windows"></a> WIndows</h3><p>Windowsä¸‹çš„ sså®¢æˆ·ç«¯ ä¹Ÿå¯ä»¥ä»Python pipå®‰è£… <code>shadowsocks</code> ã€‚ä¹Ÿå¯ä»¥ä» <a href="https://github.com/shadowsocks/shadowsocks-windows/releases">https://github.com/shadowsocks/shadowsocks-windows/releases</a> ä¸‹è½½</p><p>ä¸è¿‡å¦‚æœä»pipä¸‹è½½ shadowsocksï¼Œé‚£ä¹ˆæ˜¯æ— æ³•ç›´æ¥å¯åŠ¨çš„ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š<br />åˆ° <a href="https://slproweb.com/products/Win32OpenSSL.html">https://slproweb.com/products/Win32OpenSSL.html</a> ä¸‹è½½æœ€æ–°ç‰ˆWindows opensslå®‰è£…ï¼Œç„¶åå»opensslå®‰è£…ç›®å½• C:\Program Files\OpenSSL-Win64 æ‰¾åˆ° <code>libcrypto-1_1-x64.dll</code> å¤åˆ¶åˆ° Python <code>Scripts</code>ç›®å½•å¹¶é‡å‘½åä¸º<code>libcrypto.dll</code> ã€‚å¦åˆ™æç¤º <code>libcrypto(OpenSSL) not found</code> é”™è¯¯ã€‚</p><p>å®Œæˆä»¥ä¸Šæ—¶è¿è¡Œ <code>sslocal -c config.json</code> ä¼šæç¤ºé”™è¯¯ <code>AttributeError: function 'EVP_CIPHER_CTX_cleanup' not found</code></p><p>åŸå› æ˜¯ openssl1.1.0ç‰ˆæœ¬ä¸­ï¼ŒåºŸå¼ƒäº†<code>EVP_CIPHER_CTX_cleanup</code> å‡½æ•°ï¼Œå¯ä»¥ç”¨ <code>EVP_CIPHER_CTX_reset</code> å‡½æ•°æ›¿ä»£<code>EVP_CIPHER_CTX_cleanup</code> å‡½æ•°ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€æ‰“å¼€ C:\Users\Administrator\AppData\Local\Programs\Python\Python37\Lib\site-packages\shadowsocks\crypto\<a href="http://openssl.py">openssl.py</a> æ–‡ä»¶(è·¯å¾„å¯èƒ½ä¸åŒ)ï¼Œå°† <code>EVP_CIPHER_CTX_cleanup</code> å…¨éƒ¨æ›¿æ¢ä¸º <code>EVP_CIPHER_CTX_reset</code>ï¼Œæ€»å…±ä¸¤å¤„éœ€è¦ä¿®æ”¹ï¼Œä¹‹åä¿å­˜å³å¯ã€‚</p><p>æ‰§è¡Œ <code>sslocal -c config.json</code> æˆåŠŸï¼</p><h2 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h2><ul><li><a href="https://shadowsocks.org/en/download/servers.html">Shadowsocks Server</a></li><li><a href="https://shadowsocks.org/en/download/clients.html">Shadowsocks Client</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CentOS</tag>
      
      <tag>Shadowsocks</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>VirtualBoxæ·»åŠ raw diskæ—¶å‡ºç°VERR_ACCESS_DENIED</title>
    <link href="/virtualbox-addrawdisk-err/"/>
    <url>/virtualbox-addrawdisk-err/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ¥æƒ³åœ¨virtualboxé‡ŒUç›˜å¯åŠ¨ï¼Œç”¨ vboxmanage åˆ›å»ºå°±å¯ä»¥å®Œæˆçš„ç„¶è€Œå´åœ¨å¯åŠ¨æ—¶å‘ç”Ÿäº†é”™è¯¯ï¼Œè¿™é‡ŒæŠŠé”™è¯¯è¿‡ç¨‹è®°å½•ä¸‹æ¥</p><span id="more"></span><h2 id="è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#è¿‡ç¨‹"></a> è¿‡ç¨‹</h2><p>æ’ä¸ŠUç›˜å lsblk åå³å¯æ‰¾åˆ°Uç›˜çš„è®¾å¤‡åç§°å¦‚ /dev/sdaï¼Œå¦‚æœç›´æ¥ <code>vboxmanage internalcommands createrawvmdk -filename usb.vmdk -rawdisk /dev/sda</code> æç¤ºæ²¡æœ‰æƒé™åªéœ€ï¼Œé‚£ä¹ˆå¯ä»¥rootæƒé™æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œçš„ç¡®æˆåŠŸäº†ï¼ŒOKã€‚</p><p>ä½†æ˜¯å½“æˆ‘å°è¯•åœ¨virtualboxå­˜å‚¨ä»‹è´¨ä¸­è½½å…¥è™šæ‹Ÿç›˜æ—¶ï¼Œå´å‘ç”Ÿäº†ä¸€ä¸ªå¥‡æ€ªçš„é”™è¯¯ï¼š<strong>virtualboxæ²¡æœ‰æƒé™è®¿é—®usb.vmdk</strong></p><figure class="highlight ldif"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ldif"><span class="hljs-attribute">Permission problem accessing the file for the medium &#x27;/home/joxrays/usb.vmdk&#x27; (VERR_ACCESS_DENIED).</span><br><span class="hljs-attribute"></span><br><span class="hljs-attribute">è¿”å› ä»£ç </span>: <br><span class="hljs-attribute">VBOX_E_FILE_ERROR (0x80BB0004)</span><br><span class="hljs-attribute">ç»„ä»¶</span>: <br><span class="hljs-attribute">MediumWrap</span><br><span class="hljs-attribute">ç•Œé¢</span>: <br><span class="hljs-attribute">IMedium &#123;ad47ad09-787b-44ab-b343-a082a3f2dfb1&#125;</span><br><span class="hljs-attribute">è¢«å¬è€…</span>: <br><span class="hljs-attribute">IVirtualBox &#123;d0a0163f-e254-4e5b-a1f2-011cf991c38d&#125;</span><br><span class="hljs-attribute">è¢«å¬è€… RC</span>: <br><span class="hljs-attribute">VBOX_E_OBJECT_NOT_FOUND (0x80BB0001)</span><br></code></pre></div></td></tr></table></figure><p>æ— è®ºæˆ‘chownè¿˜æ˜¯chmodå¹¶æ²¡æœ‰è§£å†³è¯¥é—®é¢˜ã€‚ç»è¿‡Googleååœ¨ stackexchange æ‰¾åˆ°äº†é—®é¢˜çš„è§£å†³æ–¹æ³•</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo usermod -aG disk <span class="hljs-variable">$USER</span><br>æˆ–è€… sudo gpasswd -a <span class="hljs-variable">$USER</span> disk<br></code></pre></div></td></tr></table></figure><p>å¾ˆç®€å•ï¼Œä»…æ˜¯è®²å½“å‰ç”¨æˆ·æ·»åŠ åˆ° <strong>diskç»„</strong>ï¼Œä¹‹åæ³¨é”€é‡æ–°ç™»å½•å°±å¥½äº†ã€‚</p><p>ä¹‹ååœ¨æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å°±çœ‹åˆ›å»ºä¸€ä¸ª**.vmdk**è™šæ‹Ÿç›˜æ–‡ä»¶äº†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">vboxmanage internalcommands createrawvmdk  -filename usb.vmdk -rawdisk /dev/sda<br></code></pre></div></td></tr></table></figure><p>å…³äºdiskç»„ï¼Œåœ¨archlinux wikiä¸Šæ˜¯è¿™æ ·è§£é‡Šï¼š Access to block devices not affected by other groups such as <code>optical</code>, <code>floppy</code>, and <code>storage</code> ã€‚ä¹Ÿå°±æ˜¯è¯´åŠ å…¥äº†diskç»„çš„ç”¨æˆ·èƒ½å¤Ÿè®¿é—®é‚£äº›ä¸å— optical ï¼Œfloppy å’Œ storageç»„æ§åˆ¶çš„å—è®¾å¤‡ã€‚</p><p>å¦‚æœæƒ³è¦æŠŠç”¨æˆ·ä»diskç»„ä¸­åˆ é™¤ï¼Œåˆ™</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo gpasswd -d <span class="hljs-variable">$USER</span> disk<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h2><ul><li><a href="https://unix.stackexchange.com/questions/284704/verr-access-denied-when-trying-to-add-a-raw-disk-to-virtual-box">VERR_ACCESS_DENIED when trying to add a raw disk to virtual box</a></li><li><a href="https://wiki.archlinux.org/index.php/Users_and_groups_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#systemd_%E4%B9%8B%E5%89%8D%E7%9A%84%E7%BE%A4%E7%BB%84">Users_and_groups</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>VirtualBox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux Terminal æ˜¾ç¤ºå›¾åƒ</title>
    <link href="/linux-tiv/"/>
    <url>/linux-tiv/</url>
    
    <content type="html"><![CDATA[<p>å…¶å®å¾ˆä¹…ä¹‹å‰æˆ‘å°±åœ¨æƒ³linuxç»ˆç«¯é‡Œèƒ½å¦æ˜¾ç¤ºå›¾åƒå‘¢ï¼Ÿç„¶è€Œè¿™ä¸ªé—®é¢˜ä¸€ç›´æ‹–å»¶è‡³ä»Šï¼Œç›´åˆ°googleè¿‡ç¨‹ä¸­å‘ç°äº†Tiv(<strong>TerminalImageViewer</strong>)</p><span id="more"></span><h2 id="tiv"><a class="markdownIt-Anchor" href="#tiv"></a> Tiv</h2><p>æœ¬æ–‡æˆ‘è¦ä»‹ç»çš„æ˜¯tivè¿™ä¸ªå°å·§çš„å·¥å…·ï¼Œå®ƒæ˜¯ç”±C++å†™æˆçš„<br />Github: <a href="https://github.com/stefanhaustein/TerminalImageViewer">https://github.com/stefanhaustein/TerminalImageViewer</a></p><p><strong>tiv</strong>ä½¿ç”¨<strong>RGB ANSIä»£ç </strong>å’Œ<strong>unicodeå—å›¾å½¢å­—ç¬¦</strong>åœ¨ï¼ˆç°ä»£ï¼‰ç»ˆç«¯ä¸­æ˜¾ç¤ºå›¾åƒï¼Œè¿™ä¹Ÿå°±æ˜¯è¯´tivåªèƒ½ <strong>åƒç´ åŒ–</strong> çš„æ˜¾ç¤ºå›¾åƒã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/stefanhaustein/TerminalImageViewer.git<br><span class="hljs-built_in">cd</span> TerminalImageViewer/src/main/cpp<br>make<br></code></pre></div></td></tr></table></figure><p>ä¹‹åå³å¯è¿è¡Œtiv</p><p><code>./tiv -help</code> æŸ¥çœ‹å¸®åŠ©</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">Terminal Image Viewer<br><br>usage: tiv [<span class="hljs-keyword">options</span>] <span class="hljs-symbol">&lt;image&gt;</span> [<span class="hljs-symbol">&lt;image&gt;</span>...]<br><br>  -<span class="hljs-number">0</span>        : No block character adjustment, always use top half block char.<br>  -<span class="hljs-number">256</span>      : Use <span class="hljs-number">256</span> color <span class="hljs-keyword">mode</span>.<br>  -<span class="hljs-keyword">c</span> <span class="hljs-symbol">&lt;num&gt;</span>  : Number of thumbnail columns in <span class="hljs-string">&#x27;dir&#x27;</span> <span class="hljs-keyword">mode</span> (<span class="hljs-number">3</span>).<br>  -d        : Force <span class="hljs-string">&#x27;dir&#x27;</span> <span class="hljs-keyword">mode</span>. Automatially selected <span class="hljs-keyword">for</span> more than one <span class="hljs-built_in">input</span>.<br>  -<span class="hljs-keyword">f</span>        : Force <span class="hljs-string">&#x27;full&#x27;</span> <span class="hljs-keyword">mode</span>. Automatically selected <span class="hljs-keyword">for</span> one <span class="hljs-built_in">input</span>.<br>  -<span class="hljs-keyword">help</span>     : Display this <span class="hljs-keyword">help</span> text.<br>  -h <span class="hljs-symbol">&lt;num&gt;</span>  : Set the maximum height <span class="hljs-keyword">to</span> <span class="hljs-symbol">&lt;num&gt;</span> lines.<br>  -<span class="hljs-keyword">w</span> <span class="hljs-symbol">&lt;num&gt;</span>  : Set the maximum width <span class="hljs-keyword">to</span> <span class="hljs-symbol">&lt;num&gt;</span> characters.<br></code></pre></div></td></tr></table></figure><p><code>./tiv ~/1.png</code><br /><img src="/uploads/images/terminal_image/tiv_1.png" alt="img" /></p><p>å½“ç„¶è¿˜å¯ä»¥ <code>./tiv ~/1.png -0</code><br /><img src="/uploads/images/terminal_image/tiv_2.png" alt="img" /></p><p>å½“ç„¶æˆ‘ä¹Ÿè¯•è¿‡ <a href="http://www.namesdir.com/mirrors/nongnu/fbi-improved/">fim</a> ä½†è§‰å¾—æ€»æœ‰ç‚¹å·®å¼ºäººæ„ï¼Œæœ€åè¿˜æ˜¯é€‰æ‹©tivï¼Œå°½ç®¡å®ƒåªèƒ½åƒç´ åŒ–çš„æ˜¾ç¤ºå›¾åƒã€‚ã€‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>VirtualBoxå®‰è£…manjaroåå®‰è£…å¢å¼ºåŠŸèƒ½</title>
    <link href="/virtual-manjaro-guest-iso/"/>
    <url>/virtual-manjaro-guest-iso/</url>
    
    <content type="html"><![CDATA[<p>ä¸€èˆ¬æ¥è¯´ï¼ŒVirtualBoxæˆåŠŸå®‰è£…manjaroåå¯ä»¥åœ¨ [è®¾å¤‡] -&gt; [å®‰è£…å¢å¼ºåŠŸèƒ½]ã€‚ç„¶è€Œæœ‰æ—¶å´äº‹ä¸æ„¿è¿çš„æ€ä¹ˆä¹Ÿæ— æ³•å®‰è£…ï¼Œé‚£ä¹ˆè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥åœ¨manjaroé‡Œè‡ªè¡Œå®‰è£… VBoxGuestAdditionsï¼Œletâ€™s go!</p><span id="more"></span><h2 id="virtualbox-guest-iso"><a class="markdownIt-Anchor" href="#virtualbox-guest-iso"></a> virtualbox-guest-iso</h2><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo pacman -S virtualbox-guest-iso<br></code></pre></div></td></tr></table></figure><p>è¿™æ˜¯å¿…é¡»çš„ï¼Œå¦‚æ­¤ä¹‹å¤–è¿˜å¯ä»¥è®¿é—®å®˜ç½‘ <a href="https://download.virtualbox.org/virtualbox/6.0.10/">https://download.virtualbox.org/virtualbox/6.0.10/</a> ä¸‹è½½ã€‚<br />ç›®å‰æˆ‘çš„ç‰ˆæœ¬æ˜¯6.0.10ã€‚ä¸‹è½½åçš„isoæ–‡ä»¶å­˜æ”¾è·¯å¾„ä¸º <strong>/usr/lib/virtualbox/additions/VBoxGuestAdditions.iso</strong></p><h2 id="linux-header"><a class="markdownIt-Anchor" href="#linux-header"></a> linux header</h2><p>è¿™æ—¶å°±èƒ½å¤ŸæŒ‚è½½isoé•œåƒæ–‡ä»¶(rootæƒé™)</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo mount /usr/lib/virtualbox/additions/VBoxGuestAdditions.iso /mnt<br><span class="hljs-built_in">cd</span> /mnt<br></code></pre></div></td></tr></table></figure><p>æˆ‘ä»¬åªéœ€å…³å¿ƒ <strong>VBoxLinuxAdditions.run</strong> ï¼Œè‹¥ç›´æ¥ <code>sudo sh VBoxLinuxAdditions.run</code> ï¼Œå¯èƒ½ä¼šå¯¼è‡´å®‰è£…ä¸æˆåŠŸï¼Œå¦‚ä¸‹æ¶ˆæ¯</p><blockquote><p>ifying archive integrityâ€¦ All good.<br />Uncompressing VirtualBox 6.0.10 Guest Additions for Linuxâ€¦<br />VirtualBox Guest Additions installer<br />Removing installed version 6.0.10 of VirtualBox Guest Additionsâ€¦<br />Copying additional installer modules â€¦<br />Installing additional modules â€¦<br />VirtualBox Guest Additions: Starting.<br />VirtualBox Guest Additions: Building the VirtualBox Guest Additions kernel<br />modules.  This may take a while.<br />VirtualBox Guest Additions: To build modules for other installed kernels, run<br />VirtualBox Guest Additions:   /sbin/rcvboxadd quicksetup <version><br />VirtualBox Guest Additions: or<br />VirtualBox Guest Additions:   /sbin/rcvboxadd quicksetup all<br />VirtualBox Guest Additions: Building the modules for kernel 4.19.62-1-MANJARO.</p><p><font color=red>This system is currently not set up to build kernel modules.<br />Please install the Linux kernel â€œheaderâ€ files matching the current kernel<br />for adding new hardware support to the system.</font><br />VirtualBox Guest Additions: Running kernel modules will not be replaced until<br />the system is restarted</p></blockquote><p>è¿™è¡¨æ˜ç›®å‰ç³»ç»Ÿæ²¡æœ‰å®‰è£… linux header æ–‡ä»¶ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹(<strong>æ³¨æ„å†…æ ¸ç‰ˆæœ¬</strong>)ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">uname -r<br>4.19.62-1-MANJARO<br>sudo pacman -S linux419-headers<br>sudo pacman -S linux419-virtualbox-guest-modules <br></code></pre></div></td></tr></table></figure><p>PSï¼š è‹¥ <code>sudo pacman -S linux-headers</code> ï¼Œæˆ‘è¿™manjaroé»˜è®¤å®‰è£…ä¸º <code>linux316-headers-3.16.71-1</code>ã€‚ç›¸å archlinuxå®‰è£…çš„æ˜¯æœ€æ–°ç‰ˆæœ¬â€¦</p><p>æ¥ç€å°±å¯ä»¥æ‰§è¡Œ <code>sudo sh VBoxLinuxAdditions.run</code> æ¥å®‰è£… VirtualBox Guest Additionsï¼Œè¯¥è¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´æ¥æ„å»ºå†…æ ¸æ¨¡å—ã€‚è‹¥æ²¡æœ‰å‡ºç°<font color=red>çº¢å­—</font>éƒ¨åˆ†ï¼Œåˆ™è¡¨æ˜å®‰è£…æˆåŠŸï¼Œé‡å¯å³å¯ä½¿ç”¨è¯¥åŠŸèƒ½</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Archlinux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Archlinuxä»å®‰è£…åˆ°åŸºæœ¬é…ç½®</title>
    <link href="/archlinux-configure/"/>
    <url>/archlinux-configure/</url>
    
    <content type="html"><![CDATA[<p>è¿™é‡Œä»‹ç»ä»å®‰è£…archlinuxç³»ç»Ÿåˆ°åŸºæœ¬é…ç½®è¿‡ç¨‹ï¼ŒåŸºæœ¬æœé›†äº†ç½‘ä¸Šå’Œå®˜æ–¹wikiæ•´ç†è€Œæ¥çš„ï¼ŒæŠŠé”™è¯¯æœ€ä½åŒ–ã€‚å½“ç„¶ï¼Œæœ¬æ–‡ä¹Ÿæ˜¯ä½œä¸ºæˆ‘çš„ä¸€ä»½æ‰‹å†Œå§â€¦</p><span id="more"></span><p>PS: æœ€è¿‘æ›´æ–°æ—¶é—´ 2020-02-27</p><h2 id="å®‰è£…archlinux"><a class="markdownIt-Anchor" href="#å®‰è£…archlinux"></a> å®‰è£…Archlinux</h2><h3 id="ä¸‹è½½archlinux-iso"><a class="markdownIt-Anchor" href="#ä¸‹è½½archlinux-iso"></a> ä¸‹è½½Archlinux ISO</h3><p>åˆ°å®˜ç½‘ä¸‹è½½ <a href="https://www.archlinux.org/download/">https://www.archlinux.org/download/</a> å¹¶åšæˆUç›˜å¯åŠ¨ç›˜</p><h3 id="ä¸€ç³»åˆ—çš„å‘½ä»¤bios"><a class="markdownIt-Anchor" href="#ä¸€ç³»åˆ—çš„å‘½ä»¤bios"></a> ä¸€ç³»åˆ—çš„å‘½ä»¤â€¦(BIOS)</h3><p>ç”±äºæˆ‘æ˜¯æœ‰çº¿è¿æ¥ç½‘ç»œçš„ï¼Œæ‰€ä»¥â€¦ åæ­£ä¹Ÿå¯ä»¥åœ¨è™šæ‹Ÿæœºé‡Œè¯•ä¸‹å‘—</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">dhcpcd(å¯é€‰)<br>ping www.baidu.com<br>timedatectl set-ntp <span class="hljs-literal">true</span><br>fdisk /dev/sda<span class="hljs-comment"># åˆ†åŒºè¿™é‡Œåº”äººè€Œå¼‚ã€‚æˆ‘å°±ä¸å¤šè¯´äº†</span><br>    ...<br>    ...<br>mkfs.ext4 /dev/sdaX<br>    ...<br>    ...<br>mkswap /dev/sdaY     <span class="hljs-comment"># äº¤æ¢åˆ†åŒº</span><br>swapon /dev/sdaY<br>mount /dev/sda1 /mnt<br>nano /etc/pacman.d/mirrorlist  <br> <span class="hljs-comment"># æ·»åŠ  Server = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch</span><br>pacstrap /mnt base base-devel<br>genfstab -U /mnt &gt;&gt; /mnt/etc/fstab<br>arch-chroot /mnt<br>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<br>hwclock --systohc --localtime<br>nano /etc/locale.gen<br>    en_US.UTF-8 UTF-8<br>    zh_CN.UTF-8 UTF-8<br>    ...<br>locale-gen<br><span class="hljs-built_in">echo</span> LANG=en_US.UTF-8 &gt; /etc/locale.conf<br><span class="hljs-built_in">echo</span> myhostname &gt; /etc/hostname<br>nano  /etc/hosts<br>127.0.0.1localhost<br>    ::1localhost<br>    127.0.1.1myhostnamemyhostname<br>passwd<br>pacman -S grub<br>grub-install --target=i386-pc /dev/sda<span class="hljs-comment">#BIOSç³»ç»Ÿ ï¼Œé»˜è®¤ i386-pc</span><br>grub-mkconfig -o /boot/grub/grub.cfg<br><span class="hljs-built_in">exit</span><br>umount -R /mnt<br>reboot<br>pacman -S sudo net-tools wireless_tools<br>useradd -m -G wheel  whoami<br>passwd whoami<br>nano /etc/sudoers<br><span class="hljs-comment"># %wheel ALL=(ALL)ALL å–æ¶ˆæ³¨é‡Š</span><br>reboot<br>sudo dhcpcd<br>ifconfig <br><span class="hljs-comment"># å®‰è£…æ˜¾å¡é©±åŠ¨</span><br>sudo pacman -S xf86-video-intel <br><span class="hljs-comment"># å®‰è£…Xorgå¼€æºå›¾å½¢æœåŠ¡</span><br>sudo pacman -S xorg<br></code></pre></div></td></tr></table></figure><h3 id="uefi"><a class="markdownIt-Anchor" href="#uefi"></a> UEFI</h3><p>å¦‚æœæ˜¯UEFIï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ <code>fdisk</code> æˆ– <code>parted</code> åˆ†åŒºï¼Œgrubå¼•å¯¼</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">parted /dev/sda mklabel gpt<br>parted /dev/sda mkpart  ESP fat32 1M 513M<br>parted /dev/sda <span class="hljs-built_in">set</span> 1 boot on<br>parted /dev/sda mkpart primary ext4 513M 20.5G  <span class="hljs-comment"># 20.5G ä¸ºç»å¯¹å¤§å°</span><br>parted /dev/sda mkpart primary ext4 20.5G 100%<br><br>mkdir /mnt/boot<br>mkfs.fat -F32 /dev/sda1<br>mkfs.ext4 /dev/sda2<br>mount /dev/sda1 /mnt/boot<br>mount /dev/sda2 /mnt<br><br>pacstrap /mnt base base-devel<br>genfstab -L /mnt &gt;&gt; /mnt/etc/fstab<br>......<br><br>pacman -S grub efibootmgr<br>grub-install --target=x86_64-efi --efi-directory=esp --bootloader-id=GRUB <br>grub-mkconfig -o /boot/grub/grub.cfg<br></code></pre></div></td></tr></table></figure><h2 id="å¯é€‰æ¡Œé¢ç¯å¢ƒå®‰è£…"><a class="markdownIt-Anchor" href="#å¯é€‰æ¡Œé¢ç¯å¢ƒå®‰è£…"></a> å¯é€‰æ¡Œé¢ç¯å¢ƒå®‰è£…</h2><p>æ¥ç€è¿˜éœ€è¦æŒ‰ç…§æ¡Œé¢ç¯å¢ƒ</p><h3 id="gnome"><a class="markdownIt-Anchor" href="#gnome"></a> GNOME</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S gnome gnome-extra<br>gnome-session<br></code></pre></div></td></tr></table></figure><h3 id="kde"><a class="markdownIt-Anchor" href="#kde"></a> KDE</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S plasma   kde-applications<br>startkde<br></code></pre></div></td></tr></table></figure><h3 id="deepin"><a class="markdownIt-Anchor" href="#deepin"></a> Deepin</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S deepin deepin-extra<br>1. lightdm<br>nano /etc/lightdm/lightdm.conf<br>[Seat:*]<br>    ...<br>    greeter-session=lightdm-deepin-greeter<br>   <br>2. Xinit<br>nano ~/.xinitrc<br>exec startdde<br>startx<br></code></pre></div></td></tr></table></figure><h3 id="xfce"><a class="markdownIt-Anchor" href="#xfce"></a> Xfce</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S xfce4 xfce4-goodies<br>startxfce4ï¼ˆæ‰‹åŠ¨è¿›å…¥æ¡Œé¢ï¼‰<br></code></pre></div></td></tr></table></figure><h2 id="å®‰è£…æ¡Œé¢ç™»å½•ç®¡ç†å™¨è‡ªè¡Œé€‰æ‹©"><a class="markdownIt-Anchor" href="#å®‰è£…æ¡Œé¢ç™»å½•ç®¡ç†å™¨è‡ªè¡Œé€‰æ‹©"></a> å®‰è£…æ¡Œé¢ç™»å½•ç®¡ç†å™¨(è‡ªè¡Œé€‰æ‹©)</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S sddm<br>sudo systemctl enable sddm<br><br>sudo pacman -S gdm<br>sudo systemctl enable gdm<br><br>sudo pacman -S lightdm lightdm-gtk-greeter<br>sudo systemctl enable lightdm<br></code></pre></div></td></tr></table></figure><h2 id="é…ç½®ç½‘ç»œ"><a class="markdownIt-Anchor" href="#é…ç½®ç½‘ç»œ"></a> é…ç½®ç½‘ç»œ</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S network-manager-applet<br>sudo systemctl disable netctl<br>sudo systemctl enable NetworkManager<br></code></pre></div></td></tr></table></figure><h2 id="å¯åŠ¨è“ç‰™"><a class="markdownIt-Anchor" href="#å¯åŠ¨è“ç‰™"></a> å¯åŠ¨è“ç‰™</h2><p>å®‰è£…äº†KDEè¯ï¼Œé»˜è®¤æ˜¯æœªæ‰¾åˆ°è“ç‰™é€‚é…å™¨çš„ã€‚è‹¥è¦è¿æ¥åˆ°è“ç‰™è€³éº¦ï¼Œé‚£ä¹ˆå¯ä»¥è¿™æ ·åš</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo pacman -S bluez bluez-utils pulseaudio-bluetooth pavucontrol pulseaudio-alsa<br>sudo systemctl <span class="hljs-built_in">enable</span> bluetooth<br>usermod -aG lp <span class="hljs-variable">$USER</span><br><br>sudo systemctl start bluetooth<br>pulseaudio -k<br>pulseaudio --start<br></code></pre></div></td></tr></table></figure><h2 id="è½¯ä»¶ä»“åº“é•œåƒ"><a class="markdownIt-Anchor" href="#è½¯ä»¶ä»“åº“é•œåƒ"></a> è½¯ä»¶ä»“åº“é•œåƒ</h2><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">nano /etc/pacman.d/mirrorlist<br>Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://mirrors.ustc.edu.cn/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://mirrors.aliyun.com/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://mirrors.163.com/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://mirrors.hust.edu.cn/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://run.hit.edu.cn/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://ftp.kaist.ac.kr/ArchLinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://mirrors.hustunique.com/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://ftp.jaist.ac.jp/pub/Linux/ArchLinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://mirror.premi.st/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://mirror.its.dal.ca/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://mirror.de.leaseweb.net/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    Server = http://mirror.clibre.uqam.ca/archlinux/<span class="hljs-variable">$repo</span>/os/<span class="hljs-variable">$arch</span><br>    <br>nano /etc/pacman.conf<br>[multilib]<br>Include = /etc/pacman.d/mirrorlist<br><br>[archlinuxcn]<br>    Server = https://mirrors.ustc.edu.cn/archlinuxcn/<span class="hljs-variable">$arch</span><br>    <br>   æˆ–è€…ï¼š<br>   <br>   [archlinuxcn]<br>    Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/<span class="hljs-variable">$arch</span><br><br>å®‰è£… archlinuxcn-keyring å¯¼å…¥ GPG key<br>sudo pacman -S archlinuxcn-keyring ç›´æ¥è¿™æ ·ä¼šå‡ºé”™<br>sudo pacman -Syu haveged<br>sudo systemctl start haveged<br>sudo systemctl <span class="hljs-built_in">enable</span> haveged<br><br>sudo rm -fr /etc/pacman.d/gnupg<br>sudo pacman-key --init<br>sudo pacman-key --populate archlinux<br>sudo pacman-key --populate archlinuxcn<br>sudo pacman -S archlinuxcn-keyring<br>sudo pacman -Syu<br></code></pre></div></td></tr></table></figure><p>è§£å†³ï¼š</p><blockquote><p><em>é”™è¯¯ï¼šæ— æ³•æäº¤å¤„ç† (æ— æ•ˆæˆ–å·²æŸåçš„è½¯ä»¶åŒ… (PGP ç­¾å))</em></p></blockquote><p>æ­¤å¤„å‚è€ƒï¼š</p><ul><li><a href="https://www.archlinuxcn.org/gnupg-2-1-and-the-pacman-keyring/">GnuPG-2.1 ä¸ pacman å¯†é’¥ç¯</a></li><li><a href="https://www.archlinuxcn.org/archlinux-cn-repo-and-mirror/">Arch Linux ä¸­æ–‡ç¤¾åŒºä»“åº“ / é•œåƒåŠ é€Ÿæº</a></li></ul><h2 id="å®‰è£…å­—ä½“ä¸­æ–‡"><a class="markdownIt-Anchor" href="#å®‰è£…å­—ä½“ä¸­æ–‡"></a> å®‰è£…å­—ä½“(ä¸­æ–‡)</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">1. sudo pacman -S adobe-source-han-sans-cn-fonts (æ€æºé»‘ä½“)<br>2. sudo pacman -S ttf-dejavu<br>3. sudo pacman -S wqy-zenhei<br>4. sudo pacman -S wqy-microhei<br><br>nano /etc/locale.conf<br>    LANG=zh_CN.UTF-8<br>reboot<br></code></pre></div></td></tr></table></figure><p>æ¨èå®‰è£… FireCode è‡ªä½“ <a href="https://github.com/tonsky/FiraCode">https://github.com/tonsky/FiraCode</a></p><h2 id="ä¸­æ–‡è¾“å…¥æ³•"><a class="markdownIt-Anchor" href="#ä¸­æ–‡è¾“å…¥æ³•"></a> ä¸­æ–‡è¾“å…¥æ³•</h2><p>å»ºè®®å¸è½½fcitx4ï¼Œæ”¹ç”¨fcitx5</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">pacman -S fcitx5-git  fcitx5-qt5-git fcitx5-gtk-git fcitx5-chinese-addons-git fcitx5-configtool-git fcitx5-rime-git<br></code></pre></div></td></tr></table></figure><p>ç¯å¢ƒå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">vim ~/.xprofile<br><span class="hljs-built_in">export</span> GTK_IM_MODULE=fcitx5<br><span class="hljs-built_in">export</span> QT_IM_MODULE=fcitx5<br><span class="hljs-built_in">export</span> XMODIFIERS=<span class="hljs-string">&quot;@im=fcitx&quot;</span><br>fcitx5 &amp;<br></code></pre></div></td></tr></table></figure><h2 id="å®‰è£…iconä¸»é¢˜å¯é€‰"><a class="markdownIt-Anchor" href="#å®‰è£…iconä¸»é¢˜å¯é€‰"></a> å®‰è£…Iconä¸»é¢˜(å¯é€‰)</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">pacman -S numix-circle-icon-theme-git<br></code></pre></div></td></tr></table></figure><h2 id="pacmanå½©è‰²è¾“å‡º"><a class="markdownIt-Anchor" href="#pacmanå½©è‰²è¾“å‡º"></a> pacmanå½©è‰²è¾“å‡º</h2><p>ç¼–è¾‘ <code>/etc/pacman.conf</code>ï¼Œå–æ¶ˆ <code>Color</code> æ³¨é‡Š</p><h2 id="nano-æ”¯æŒä»£ç é«˜äº®"><a class="markdownIt-Anchor" href="#nano-æ”¯æŒä»£ç é«˜äº®"></a> Nano æ”¯æŒä»£ç é«˜äº®</h2><p>nanoæ˜¯linuxä¸‹è½»é‡çº§çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œä¹Ÿæ˜¯å¤§å¤šæ•°linuxå‘è¡Œç‰ˆéƒ½é»˜è®¤å®‰è£…çš„ã€‚ä½†é»˜è®¤å®‰è£…archlinuxå nanoå¯¹äºç‰¹æ®Šæ–‡æœ¬çš„ä»£ç é«˜äº®æ”¯æŒå¹¶æ²¡æœ‰å¼€å¯ï¼Œå› æ­¤è¦æƒ³è®©ä»£ç é«˜äº®æ˜¾ç¤ºï¼Œå°±è¦æ‰‹åŠ¨å¼€å¯è¯¥åŠŸèƒ½ã€‚</p><p>é¦–å…ˆnanoæ‰€æ”¯æŒçš„ä¸€äº›ä»£ç æ ¼å¼æ–‡ä»¶å­˜æ”¾åœ¨  <strong>/usr/share/nano/</strong> ç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ ls /usr/share/nano/<br>asm.nanorc        elisp.nanorc       json.nanorc      objc.nanorc        ruby.nanorc<br>autoconf.nanorc   fortran.nanorc     lua.nanorc       ocaml.nanorc       rust.nanorc<br>awk.nanorc        gentoo.nanorc      makefile.nanorc  patch.nanorc       sh.nanorc<br>changelog.nanorc  go.nanorc          man.nanorc       perl.nanorc        spec.nanorc<br>cmake.nanorc      groff.nanorc       mgp.nanorc       php.nanorc         tcl.nanorc<br>c.nanorc          guile.nanorc       mutt.nanorc      po.nanorc          texinfo.nanorc<br>css.nanorc        html.nanorc        nanohelp.nanorc  postgresql.nanorc  tex.nanorc<br>debian.nanorc     java.nanorc        nanorc.nanorc    pov.nanorc         xml.nanorc<br>default.nanorc    javascript.nanorc  nftables.nanorc  python.nanorc<br><br></code></pre></div></td></tr></table></figure><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å½“å‰ç”¨æˆ·ä¸»ç›®å½•ä¸‹æ–°å»º <strong>.nanorc</strong> æ–‡ä»¶ï¼Œå¹¶æ·»åŠ  <code>/usr/share/nano/*.nanorc</code>  è¡¨ç¤ºnanoæ”¯æŒ /usr/share/nano ä¸‹çš„æ‰€æœ‰ä»£ç æ ¼å¼ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ cat ~/.nanorc <br>include /usr/share/nano/*.nanorc<br></code></pre></div></td></tr></table></figure><h2 id="ä¿®æ”¹yay-aurå›½å†…æº"><a class="markdownIt-Anchor" href="#ä¿®æ”¹yay-aurå›½å†…æº"></a> ä¿®æ”¹yay aurå›½å†…æº</h2><p>å»ºè®®ç”¨ <strong>yay</strong> è€Œä¸æ˜¯ <strong>yaourt</strong></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo pacman -S yay<br>nano ~/.config/yay/config.json<br>        <span class="hljs-string">&quot;aururl&quot;</span>: <span class="hljs-string">&quot;https://aur.archlinux.org&quot;</span><br>æ›¿æ¢ä¸º <br><span class="hljs-string">&quot;aururl&quot;</span>: <span class="hljs-string">&quot;https://aur.tuna.tsinghua.edu.cn&quot;</span><br></code></pre></div></td></tr></table></figure><p>æˆ–è€…ç›´æ¥ï¼š</p><p><code>yay --aururl &quot;https://aur.tuna.tsinghua.edu.cn&quot; --save</code></p><h2 id="ä»£ç†"><a class="markdownIt-Anchor" href="#ä»£ç†"></a> ä»£ç†</h2><h3 id="proxychains"><a class="markdownIt-Anchor" href="#proxychains"></a> ProxyChains</h3><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo pacman -S proxychains-ng<br>nano /etc/proxychains.conf<br>æ·»åŠ  <span class="hljs-string">&quot; socks5  127.0.0.1 1080 &quot;</span><br></code></pre></div></td></tr></table></figure><p>æ¯”å¦‚ <code>proxychains curl https://ip.cn</code></p><h3 id="shadowsocks"><a class="markdownIt-Anchor" href="#shadowsocks"></a> Shadowsocks</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">pacman -S shadowsocks-qt5<br>google-chrome-stable --proxy-server=&quot;socks5://127.0.0.1:1080&quot; (æš‚æ—¶ä»£ç†)<br></code></pre></div></td></tr></table></figure><h3 id="lantern"><a class="markdownIt-Anchor" href="#lantern"></a> Lantern</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">pacman -S lantern-bin<br></code></pre></div></td></tr></table></figure><h3 id="v2ray"><a class="markdownIt-Anchor" href="#v2ray"></a> v2ray</h3><p>v2rayçš„å®‰è£…æ–¹æ³•å®˜ç½‘æœ‰è¯¦ç»†ä¿¡æ¯ï¼Œ<code>qv2ray</code>æ˜¯Qtå¼€å‘çš„åŸºäºv2ray coreçš„GUIç¨‹åºï¼Œæ”¯æŒWindowsã€Linuxã€macOSã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">pacman -S v2ray qv2ray<br></code></pre></div></td></tr></table></figure><p>ä¹‹åå°±å¯ä»¥æ·»åŠ ä¸€äº›è®¢é˜…åœ°å€æˆ–è€…è‡ªå·±ä¹°VPSæ­å»ºæœåŠ¡å™¨</p><h3 id="xx-net-proxy-switchyomega-chrome"><a class="markdownIt-Anchor" href="#xx-net-proxy-switchyomega-chrome"></a> XX-Net + Proxy SwitchyOmega + Chrome</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">pacman -S xx-net<br>æˆ–è€…åˆ° Github clone<br>git clone https://github.com/XX-net/XX-Net.git<br>...<br></code></pre></div></td></tr></table></figure><h2 id="éŸ³ä¹ç½‘æ˜“äº‘"><a class="markdownIt-Anchor" href="#éŸ³ä¹ç½‘æ˜“äº‘"></a> éŸ³ä¹(ç½‘æ˜“äº‘)</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yaourt -S netease-cloud-music<br></code></pre></div></td></tr></table></figure><h2 id="office"><a class="markdownIt-Anchor" href="#office"></a> Office</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">wps-office,ttf-wps-fonts<br>libreoffice<br>æ°¸ä¸­Office https://www.yozosoft.com/home.htm<br></code></pre></div></td></tr></table></figure><h2 id="è§£å‹ç¼©æ–‡ä»¶"><a class="markdownIt-Anchor" href="#è§£å‹ç¼©æ–‡ä»¶"></a> è§£å‹ç¼©æ–‡ä»¶</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S file-roller  xarchiver unzip unrar<br></code></pre></div></td></tr></table></figure><h2 id="æ•°æ®åº“å®¢æˆ·ç«¯ç®¡ç†"><a class="markdownIt-Anchor" href="#æ•°æ®åº“å®¢æˆ·ç«¯ç®¡ç†"></a> æ•°æ®åº“å®¢æˆ·ç«¯ç®¡ç†</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sqlitebrowser,dbeaver...<br></code></pre></div></td></tr></table></figure><h2 id="é‡å‘½åç½‘å¡ä¸ºeth0"><a class="markdownIt-Anchor" href="#é‡å‘½åç½‘å¡ä¸ºeth0"></a> é‡å‘½åç½‘å¡ä¸ºeth0â€¦</h2><p>ä¹‹å‰: ifconfig</p><blockquote><p>enp12s0<br />lo<br />wlp3s0b1</p></blockquote><p>å…³é”®æ˜¯ <code>net.ifnames=0</code></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">1. ArchLinux<br><span class="hljs-meta">-&gt;</span><span class="bash"> /etc/default/grub</span><br>    GRUB_CMDLINE_LINUX=&quot;&quot;<br>    GRUB_CMDLINE_LINUX_DEFAULT=&quot;audit=0 loglevel=3 quiet net.ifnames=0&quot;<br>grub-mkconfig -o /boot/grub/grub.cfg<br><br>2. CentOS<br><span class="hljs-meta">-&gt;</span><span class="bash"> net.ifnames=0 biosdevname=0</span><br><span class="hljs-meta">-&gt;</span><span class="bash"> /etc/sysconfig/grub &lt;=&gt; /etc/default/grub</span><br>    GRUB_CMDLINE_LINUX=... net.ifnames=0 biosdevname=0  ...<br>grub2-mkconfig -o /boot/grub2/grub.cfg<br></code></pre></div></td></tr></table></figure><h2 id="vimé…ç½®æ¨¡æ¿"><a class="markdownIt-Anchor" href="#vimé…ç½®æ¨¡æ¿"></a> Vimé…ç½®(æ¨¡æ¿)</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">set nocp<br>set modelines=0<br>set backspace=2<br>syntax on <br>autocmd InsertLeave * se nocul<br>autocmd InsertEnter * se cul<br>set smartindent <br>set autoindent<br>set confirm <br>set tabstop=4 <br>set softtabstop=4<br>set shiftwidth=4 <br>set expandtab <br>set number<br>set history=50  <br>set hlsearch<br>set incsearch<br>set gdefault<br>set encoding=utf-8<br>set fileencodings=utf-8,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936,utf-16,big5,euc-jp,latin1<br>set guifont=Menlo:h16:cANSI <br>set langmenu=zn_CN.UTF-8<br>set helplang=cn <br>set ruler <br>set laststatus=1 <br>set showcmd <br>set scrolloff=3<br>set showmatch <br>set matchtime=5<br>set autowrite <br>set wildmenu  <br>set linespace=2 <br>set whichwrap=b,s,&lt;,&gt;,[,] <br>filetype plugin indent on <br>set foldenable  <br>set cursorline <br>set magic  <br>set ignorecase<br>filetype on <br>set background=dark<br>set t_Co=256   <br>set mouse=i <br>set backspace=indent,eol,start<br></code></pre></div></td></tr></table></figure><h2 id="zsh"><a class="markdownIt-Anchor" href="#zsh"></a> Zsh</h2><p><a href="https://wiki.archlinux.org/index.php/Zsh_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">https://wiki.archlinux.org/index.php/Zsh_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)</a><br /><a href="https://github.com/robbyrussell/oh-my-zsh/">https://github.com/robbyrussell/oh-my-zsh/</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S zsh<br>1. sudo pacman -S oh-my-zsh-git<br>2. sh -c &quot;$(wget -O- https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;<br>3. sh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;<br>4. curl -Lo install.sh https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh<br>sh install.sh<br><br>sudo chsh -s /bin/zsh <br>nano .zshrc<br>    ZSH_THEME=&quot;jtriley&quot;<br>    plugin: zsh-syntax-highlighting<br>git clone https://github.com/zsh-users/zsh-syntax-highlighting  ~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting<br></code></pre></div></td></tr></table></figure><h2 id="è™šæ‹Ÿæœºvirtualbox"><a class="markdownIt-Anchor" href="#è™šæ‹Ÿæœºvirtualbox"></a> <a href="https://wiki.archlinux.org/index.php/VirtualBox_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">è™šæ‹ŸæœºVirtualbox</a></h2><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">pacman -S virtualbox virtualbox-host-modules-arch</span><br><span class="hljs-attribute">pacman -S linux-headers linux</span><br></code></pre></div></td></tr></table></figure><h3 id="åŠ è½½-virtualbox-å†…æ ¸æ¨¡å—"><a class="markdownIt-Anchor" href="#åŠ è½½-virtualbox-å†…æ ¸æ¨¡å—"></a> åŠ è½½ VirtualBox å†…æ ¸æ¨¡å—</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">æ‰‹åŠ¨åŠ è½½æ¨¡å—<br><span class="hljs-meta">#</span><span class="bash"> modprobe -a vboxguest vboxsf vboxvideo</span><br><span class="hljs-meta">#</span><span class="bash"> -&gt; modprobe vboxdrv</span><br><span class="hljs-meta">#</span><span class="bash"> lsmod|grep vb</span> <br>    vboxnetflt             32768  0<br>    vboxnetadp             28672  0<br>    vboxpci                28672  0<br>    vboxdrv               503808  3 vboxpci,vboxnetadp,vboxnetflt<br><br>å¼€æœºè‡ªåŠ¨åŠ è½½æ¨¡å—,å¯ç”¨ vboxservice.service æœåŠ¡<br></code></pre></div></td></tr></table></figure><h3 id="å¢å¼ºåŠŸèƒ½"><a class="markdownIt-Anchor" href="#å¢å¼ºåŠŸèƒ½"></a> å¢å¼ºåŠŸèƒ½</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">1. USBä½¿ç”¨:<br>sudo usermod -aG vboxusers whos æˆ– sudo gpasswd -a whos vboxusers<br><br>2. å¢å¼ºåŠŸèƒ½(è½½å…¥ISOåŠŸèƒ½åŒ…)<br>sudo pacman -S  virtualbox-guest-iso<br><span class="hljs-meta">--&gt;</span><span class="bash"> /usr/lib/virtualbox/additions/VBoxGuestAdditions.iso</span><br></code></pre></div></td></tr></table></figure><p>æˆ–è€…è‡ªå·±å»ä¸‹è½½ <strong>VBoxGuestAdditions.iso</strong> ï¼Œå¹¶åœ¨ä½¿ç”¨virtualboxæ—¶è½½å…¥iso</p><p><a href="https://download.virtualbox.org/virtualbox/6.0.10/">https://download.virtualbox.org/virtualbox/6.0.10/</a></p><h3 id="ä¸‹è½½æ‹“å±•åŒ…"><a class="markdownIt-Anchor" href="#ä¸‹è½½æ‹“å±•åŒ…"></a> ä¸‹è½½æ‹“å±•åŒ…</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">wget https://download.virtualbox.org/virtualbox/6.0.10/Oracle_VM_VirtualBox_Extension_Pack-6.0.10.vbox-extpack<br></code></pre></div></td></tr></table></figure><h3 id="æ‰‹åŠ¨æŒ‚è½½"><a class="markdownIt-Anchor" href="#æ‰‹åŠ¨æŒ‚è½½"></a> æ‰‹åŠ¨æŒ‚è½½</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">åœ¨virtualboxè™šæ‹Ÿæœºè¿è¡Œï¼š<br>mount -t vboxsf &lt;å…±äº«ç›®å½•çš„åå­—&gt; &lt;å®¢æˆ·æœºç³»ç»Ÿçš„æŒ‚è½½ç‚¹&gt;<br><br>æŸ¥çœ‹ vboxsf çš„æŒ‚è½½å‚æ•°<br>mount.vboxsf<br><br>å‡å¦‚ç”¨æˆ·ä¸åœ¨ vboxsf ç»„é‡Œï¼Œç”¨è¿™ä¸ªå‘½ä»¤å¯ä»¥æŠŠæŒ‚è½½ç‚¹çš„è¯»å†™æƒé™æˆæƒç»™ä»–ï¼š<br><span class="hljs-meta">#</span><span class="bash"> mount -t vboxsf -o uid=1000,gid=1000 home /mnt/</span><br><span class="hljs-meta">#</span><span class="bash"> usermod -aG vboxsf guest</span> <br></code></pre></div></td></tr></table></figure><h2 id="ç™¾åº¦äº‘ç›˜"><a class="markdownIt-Anchor" href="#ç™¾åº¦äº‘ç›˜"></a> ç™¾åº¦äº‘ç›˜</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S baidunetdisk-bin<br></code></pre></div></td></tr></table></figure><h2 id="mariadbæ•°æ®åº“"><a class="markdownIt-Anchor" href="#mariadbæ•°æ®åº“"></a> MariaDBæ•°æ®åº“</h2><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">sudo pacman -S mariadb mariadb-libs mariadb-clients</span><br></code></pre></div></td></tr></table></figure><p>å®‰è£… <a href="https://www.archlinux.org/packages/?name=mariadb">mariadb</a> è½¯ä»¶åŒ…ä¹‹åï¼Œä½ å¿…é¡»åœ¨å¯åŠ¨ <code>mariadb.service</code> <strong>ä¹‹å‰</strong>è¿è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle"># mysql_install_db --user=mysql --basedir=<span class="hljs-regexp">/usr --datadir=/</span>var<span class="hljs-regexp">/lib/my</span>sql<br></code></pre></div></td></tr></table></figure><p>ç”¨ä¸‹é¢è¿™ä¸ªå‘½ä»¤å¯åŠ¨æ•°æ®åº“çº§åˆ«çš„å®‰å…¨é…ç½®åŠ©æ‰‹ï¼Œæ¥é…ç½®ä¸€äº›å¿…è¦çš„<strong>å®‰å…¨é€‰é¡¹</strong></p><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">mysql_secure_installation</span><br></code></pre></div></td></tr></table></figure><p>å…³äºMariadb10.4èº«ä»½éªŒè¯å‘ç”Ÿçš„ä¸€äº›å˜åŒ–åŠå…¶é…ç½®ï¼Œå¯å‚è€ƒï¼š</p><p><a href="https://mariadb.org/authentication-in-mariadb-10-4/">Authentication in MariaDB 10.4 â€” Understanding the Changes</a><br />æˆ–è€…<br /><a href="https://mariadb.com/kb/en/library/set-password/">SET PASSWORD</a></p><p>ä¿®æ”¹ root å¯†ç ï¼ˆèº«ä»½éªŒè¯è¡¨åœ¨ **mysql.global_priv **å¯ä»¥ <code>select *from mysql.global_priv;</code> æŸ¥çœ‹ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mysql">set password for &#x27;root&#x27;@&#x27;%&#x27; =password(&#x27;xxxxxxxxx&#x27;)<br></code></pre></div></td></tr></table></figure><p>å¦‚æœè¯•å›¾è¿™æ ·åš</p><figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs mysql">UPDATE mysql.user SET Password=PASSWORD(&#x27;xxxx&#x27;) WHERE User=&#x27;root&#x27;;<br></code></pre></div></td></tr></table></figure><p>é‚£ä¹ˆå¾—åˆ°çš„é”™è¯¯æ˜¯<br /><font color=red>ERROR 1348 (HY000): Column â€˜Passwordâ€™ is not updatable</font></p><h2 id="qt5"><a class="markdownIt-Anchor" href="#qt5"></a> Qt5</h2><p>Wiki : <a href="https://wiki.archlinux.org/index.php/Qt_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">https://wiki.archlinux.org/index.php/Qt_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S qt5-base qt5-doc qtcreator<br></code></pre></div></td></tr></table></figure><p>åæ­£ä¹Ÿå¯ä»¥ä»å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…è‡ªè¡Œå®‰è£…ï¼Œä¸è¿‡é€Ÿåº¦å°±ã€‚ã€‚ã€‚</p><h2 id="pythonnpmæ¢å›½å†…æº"><a class="markdownIt-Anchor" href="#pythonnpmæ¢å›½å†…æº"></a> Python,Npmæ¢å›½å†…æº</h2><h3 id="python"><a class="markdownIt-Anchor" href="#python"></a> Python</h3><p>ä¿®æ”¹pip.confæ–‡ä»¶ï¼Œè‹¥ä¸å­˜åœ¨åˆ™æ–°å»ºä¸€ä¸ªå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ã€‚<br /><code>nano ~/.pip/pip.conf</code></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">[global]<br>index-url = https://pypi.tuna.tsinghua.edu.cn/simple<br></code></pre></div></td></tr></table></figure><h3 id="npm"><a class="markdownIt-Anchor" href="#npm"></a> Npm</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">npm config get registry<br>npm config set registry https://registry.npm.taobao.org/<br></code></pre></div></td></tr></table></figure><h2 id="github-ssh-key"><a class="markdownIt-Anchor" href="#github-ssh-key"></a> Github SSH Key</h2><p>é¦–å…ˆæ£€æŸ¥æœ¬æœºæ˜¯å¦å­˜åœ¨ SSH keys</p><ul><li>id_rsa</li><li>id_rsa.pub</li></ul><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">ls ~/.ssh<br>id_rsa  id_rsa.pub<br></code></pre></div></td></tr></table></figure><p>æ¥ç€</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">ssh-keygen -t rsa -C <span class="hljs-string">&quot;my_email@example.com&quot;</span><br><span class="hljs-built_in">eval</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(ssh-agent -s)</span>&quot;</span><br>ssh-add ~/.ssh/id_rsa<br>cat ~/.ssh/id_rsa.pub<br></code></pre></div></td></tr></table></figure><p>å¤åˆ¶ <code>id_rsa.pub</code> å†…å®¹åˆ°ï¼š<br />â€“&gt; <strong><a href="https://github.com/settings/keys">Settings</a></strong> --&gt; <strong>SSH and GPG keys</strong> --&gt; <strong>New SSH key</strong></p><p>æµ‹è¯•æ˜¯å¦æˆåŠŸ</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">ssh -T git@github.com<br>    The authenticity of host <span class="hljs-string">&#x27;github.com (13.250.177.223)&#x27;</span> can<span class="hljs-string">&#x27;t be established.</span><br><span class="hljs-string">    RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.</span><br><span class="hljs-string">    Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span><br><span class="hljs-string">    Warning: Permanently added &#x27;</span>github.com,13.250.177.223<span class="hljs-string">&#x27; (RSA) to the list of known hosts.</span><br><span class="hljs-string">    Hi josexy! You&#x27;</span>ve successfully authenticated, but GitHub does not provide shell access.<br></code></pre></div></td></tr></table></figure><p>å¦‚æ­¤å¦‚æ­¤å³okï¼Œå¦åˆ™no</p><p>é…ç½®Gitï¼Œæ¯”å¦‚æˆ‘çš„è¿™æ ·å­</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">git config --global user.name <span class="hljs-string">&quot;josexy&quot;</span><br>git config --global user.email <span class="hljs-string">&quot;josephxrays@163.com&quot;</span><br>git config --global color.ui <span class="hljs-literal">true</span> <span class="hljs-comment"># å¯é€‰</span><br>git config --global credential.helper store  <span class="hljs-comment"># å¯é€‰</span><br></code></pre></div></td></tr></table></figure><h2 id="è¿ç§»github-page-hexo"><a class="markdownIt-Anchor" href="#è¿ç§»github-page-hexo"></a> è¿ç§»Github Page hexo</h2><p>å‡å¦‚è¦åœ¨å¦ä¸€å°ç”µè„‘ä¸Šæ›´æ–°ä¿®æ”¹hexoæ­å»ºçš„åšå®¢ï¼Œé‚£ä¹ˆå°±è¦é‡æ–°éƒ¨ç½²hexoã€‚ç„¶è€Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸å¿…å¦‚æ­¤ï¼Œåªéœ€ç®€å•å‡ æ­¥å³å¯ã€‚</p><p>é¦–å…ˆåˆ°åšå®¢æ ¹ç›®å½•æŸ¥çœ‹å“ªäº›æ–‡ä»¶/æ–‡ä»¶å¤¹éœ€è¦å¤åˆ¶è¿‡å»</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">ls -la<br>æ€»ç”¨é‡ 216<br>drwxr-xr-x   8 josexy josexy   4096  8æœˆ  5 08:18 .<br>drwxr-xr-x   6 josexy josexy   4096  8æœˆ  6 13:42 ..<br>-rw-r--r--   1 josexy josexy   2591  7æœˆ 21 00:22 _config.yml<br>-rw-r--r--   1 josexy josexy    174  8æœˆ  5 08:20 db.json<br>drwxr-xr-x  62 josexy josexy   4096  8æœˆ  5 08:19 .deploy_git<br>-rw-r--r--   1 josexy josexy     65  7æœˆ 20 10:24 .gitignore<br>drwxr-xr-x 345 josexy josexy  20480  7æœˆ 20 20:57 node_modules<br>-rw-r--r--   1 josexy josexy    676  7æœˆ 20 20:57 package.json<br>-rw-r--r--   1 josexy josexy 148885  7æœˆ 20 20:57 package-lock.json<br>drwxr-xr-x  61 josexy josexy   4096  8æœˆ  5 08:18 public<br>drwxr-xr-x   2 josexy josexy   4096  7æœˆ 20 10:24 scaffolds<br>drwxr-xr-x   7 josexy josexy   4096  7æœˆ 21 11:56 <span class="hljs-built_in">source</span><br>drwxr-xr-x   4 josexy josexy   4096  7æœˆ 20 11:39 themes<br></code></pre></div></td></tr></table></figure><p>ä»¥ä¸‹è¡¨æ ¼åˆ—å‡ºéœ€è¦å’Œä¸éœ€è¦å¤åˆ¶åˆ°å…¶ä»–ä¸»æœºçš„æ–‡ä»¶/æ–‡ä»¶å¤¹</p><table><thead><tr><th>éœ€è¦</th><th>ä¸éœ€è¦</th></tr></thead><tbody><tr><td>themes</td><td>themes/.git</td></tr><tr><td>source</td><td>public</td></tr><tr><td>_config.yml</td><td>db.json</td></tr><tr><td>.gitignore</td><td>.deploy_git</td></tr><tr><td>package.json</td><td>package-lock.json</td></tr><tr><td>scaffolds</td><td>node_modules</td></tr></tbody></table><p>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠ éœ€è¦ çš„æ–‡ä»¶/æ–‡ä»¶å¤¹å¤åˆ¶è¿‡å»äº†ï¼Œä¸ºäº†èƒ½å¤Ÿåœ¨å¦ä¸€å°ä¸»æœºä¸Šä½¿ç”¨ï¼Œè¿˜éœ€è¦å®‰è£…å¿…è¦çš„application</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo pacman -S nodejs<br>sudo pacman -S npm<br>sudo pacman -S git<br>npm config <span class="hljs-built_in">set</span> registry https://registry.npm.taobao.org<br>sudo npm i hexo-cli -g<br></code></pre></div></td></tr></table></figure><p><font color=red>æ¥ç€åœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œ <code>npm install</code> å³å¯å®‰è£…hexoæ‰€éœ€åŸæ¥çš„æ¨¡å—ï¼Œä¿å­˜åœ¨node_modulesã€‚ </font><br /><em><strong>æ²¡æœ‰å¿…è¦ <code>hexo init</code>ï¼æ²¡æœ‰å¿…è¦ <code>hexo init</code>ï¼æ²¡æœ‰å¿…è¦ <code>hexo init</code>ï¼</strong></em>****</p><p>è‹¥å‡ºç°ç±»ä¼¼</p><blockquote><p>run <code>npm audit fix</code> to fix them, or <code>npm audit</code> for details</p><p>npm WARN babel-eslint@10.0.2 requires a peer of eslint@&gt;= 4.12.1 but none is installed. You must install peer depen<br />dencies yourself.</p></blockquote><p>æŒ‰æç¤ºæ“ä½œå³å¯</p><p>å¦‚æœä¸æƒ³æ¯æ¬¡éƒ½è¦è¾“å…¥githubå¸å·å¯†ç ï¼Œåˆ™éœ€è¦é…ç½® github ssh key ï¼Œæ–¹æ³•è¯·å‚è§ä¸Šæ–‡ã€‚<br />ç„¶å <code>hexo g</code>å³å¯ç”Ÿæˆ publicæ–‡ä»¶å¤¹ï¼Œ<code>hexo s</code>æœ¬åœ°è¿è¡Œï¼Œ<code>hexo d</code>å³å¯éƒ¨ç½²github</p><p>è‹¥å‡ºç°ç±»ä¼¼<code>Error: ENOSPC: System limit for number of file watchers reached</code>ï¼Œè§£å†³æ–¹æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &amp;&amp; sudo sysctl -p<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://wiki.archlinux.org/index.php/Installation_guide_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E5%AE%89%E8%A3%85%E5%90%8E%E7%9A%84%E5%B7%A5%E4%BD%9C">å‚è€ƒArchlinuxå®˜ç½‘Wiki</a></li><li><a href="https://www.viseator.com/2017/05/17/arch_install/">ä»¥å®˜æ–¹Wikiçš„æ–¹å¼å®‰è£…ArchLinux</a></li><li><a href="https://blog.fc4soda.moe/posts/arch-linux-config-note/">arch linux å®‰è£…é…ç½®ç¬”è®°</a></li><li><a href="https://starrycat.me/archlinux-install-gnome-desktop.html">ArchLinuxå®‰è£…GNOMEå›¾å½¢æ¡Œé¢ç¯å¢ƒ</a></li><li><a href="https://github.com/archlinuxcn/mirrorlist-repo">Arch Linux CN Community repo mirrors list</a></li><li><a href="https://help.github.com/en/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Generating a new SSH key and adding it to the ssh-agent</a></li><li><a href="https://www.zhihu.com/question/21193762">ä½¿ç”¨hexoï¼Œå¦‚æœæ¢äº†ç”µè„‘æ€ä¹ˆæ›´æ–°åšå®¢</a></li><li><a href="https://zhuanlan.zhihu.com/p/74931620">Arch Linuxä¸Šå®‰è£…æœç‹—è¾“å…¥æ³•</a></li><li><a href="https://wiki.archlinux.org/index.php/Parted_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Parted (ç®€ä½“ä¸­æ–‡)</a></li><li><a href="https://wiki.archlinux.org/index.php/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Fcitx5_(ç®€ä½“ä¸­æ–‡)</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Archlinux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é…ç½®Vsftpdé‡åˆ°çš„é—®é¢˜</title>
    <link href="/vsftp-configure/"/>
    <url>/vsftp-configure/</url>
    
    <content type="html"><![CDATA[<p>ç›®å‰æˆ‘ç”¨çš„ç³»ç»Ÿæ˜¯archlinuxï¼Œæ‰€ä»¥åœ¨é…ç½®vsftpdæ˜¯ä¸æ˜¯ä¸€å¸†é£é¡ºçš„ï¼Œè¿™é‡Œå°†å®‰è£…é…ç½®è¿‡ç¨‹è®°å½•ä¸‹æ¥ï¼Œä¹Ÿæ— æ³•ç¡®ä¿æ˜¯å¦è¿˜æœ‰å…¶ä»–é”™è¯¯ã€‚</p><span id="more"></span><p>å®‰è£…å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo pacman -S vsftpd<br></code></pre></div></td></tr></table></figure><h2 id="é…ç½®"><a class="markdownIt-Anchor" href="#é…ç½®"></a> é…ç½®</h2><p>è¿™æ˜¯æˆ‘ç°åœ¨çš„é…ç½®ï¼ˆæ³¨é‡Šå·²å»ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">anonymous_enable=NO<br>local_enable=YES<br>write_enable=YES<br>xferlog_enable=YES<br>connect_from_port_20=YES<br><br>listen=YES<br><br>pam_service_name=vsftpd<br>allow_writeable_chroot=YES<br>local_root=/home/ftp_dir<br>chroot_local_user=YES<br>use_localtime=YES<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> user_list_deny=NO</span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-keyword">do</span> not allow to login ftp</span><br>userlist_enable=YES<br>userlist_deny=NO<br>userlist_file=/etc/vsftpd.user_list<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> user free timeout</span><br><span class="hljs-meta">#</span><span class="bash"> idle_session_timeout=30</span><br>data_connection_timeout=10<br>accept_timeout=120<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> <span class="hljs-built_in">local</span> user transfer rate</span><br>local_max_rate=50000<br>max_clients=10<br>max_per_ip=2<br><br>pasv_enable=yes<br>pasv_min_port=5000<br>pasv_max_port=6000<br><br>seccomp_sandbox=NO<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> welcome message</span><br>ftpd_banner=&gt;&gt;&gt;&gt;&gt; Welcome to MineFTP &lt;&lt;&lt;&lt;&lt;<br>dirmessage_enable=YES<br></code></pre></div></td></tr></table></figure><h2 id="vsftpç”¨æˆ·å’Œæ–‡ä»¶ç›®å½•è®¾ç½®"><a class="markdownIt-Anchor" href="#vsftpç”¨æˆ·å’Œæ–‡ä»¶ç›®å½•è®¾ç½®"></a> VSFTPç”¨æˆ·å’Œæ–‡ä»¶ç›®å½•è®¾ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">mkdir /home/ftp_dir<br>useradd -d /home/ftp_dir mineftp<br>passwd mineftp<br>usermod -aG mineftp whos<br>usermod -s /sbin/nologin mineftp<br>chown mineftp:mineftp /home/ftp_dir<br><span class="hljs-built_in">echo</span> mineftp &gt;&gt; /etc/vsftpd.user_list <br></code></pre></div></td></tr></table></figure><h2 id="é—®é¢˜"><a class="markdownIt-Anchor" href="#é—®é¢˜"></a> é—®é¢˜</h2><h3 id="1-500-oops-vsftpd-refusing-to-run-with-writable-root-inside-chroot"><a class="markdownIt-Anchor" href="#1-500-oops-vsftpd-refusing-to-run-with-writable-root-inside-chroot"></a> 1. 500 OOPS: vsftpd: refusing to run with writable root inside chroot()</h3><p>æŠŠ <strong>chroot_local_user</strong>  å’Œ <strong>allow_writeable_chroot</strong> æ”¹ä¸º YESï¼Œæˆ–è€…ç”¨ wikiä¸Šçš„ <a href="https://wiki.archlinux.org/index.php/Very_Secure_FTP_Daemon_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#vsftpd:_refusing_to_run_with_writable_root_inside_chroot()">æ–¹æ³•</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">chroot_local_user=YES<br>allow_writeable_chroot=YES<br>systemctl restart vsftpd<br></code></pre></div></td></tr></table></figure><h3 id="2-530-login-incorrect"><a class="markdownIt-Anchor" href="#2-530-login-incorrect"></a> 2.  530 Login incorrect</h3><p>ä¿®æ”¹/etc/pam.d/vsftpd<br />å°† <strong>auth required pam_shells.so</strong> ä¿®æ”¹ä¸º <strong>auth required pam_nologin.so</strong> å³å¯<br />é‡å¯vsftpd</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ nano /etc/pam.d/vsftpd <br><br><span class="hljs-comment">#%PAM-1.0</span><br>auth       required     /lib/security/pam_listfile.so item=user sense=deny file=/etc/ftpusers onerr=succeed<br>auth       required     /lib/security/pam_unix.so shadow nullok<br>auth       required     /lib/security/pam_nologin.so<br>account    required     /lib/security/pam_unix.so<br>session    required     /lib/security/pam_unix.so<br></code></pre></div></td></tr></table></figure><h3 id="3-vsftpdservice-main-process-exited-codeexited"><a class="markdownIt-Anchor" href="#3-vsftpdservice-main-process-exited-codeexited"></a> 3. vsftpd.service: Main process exited, code=exited</h3><p>ä¸€å®šè¦æŠŠ vsftpd.conf æ–‡ä»¶æ‰€æœ‰è€…(owner) æ”¹ä¸º rootï¼Œå¦åˆ™vsftpdæ— æ³•å¯åŠ¨</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">sudo chown root:root /etc/vsftpd.conf<br></code></pre></div></td></tr></table></figure><p>é”™è¯¯ä¿¡æ¯ï¼š</p><blockquote><p>vsftpd.service - vsftpd daemon<br />Loaded: loaded (/usr/lib/systemd/system/vsftpd.service; disabled; vendor preset: disabled)<br />Active: failed (Result: exit-code) since Sun 2019-07-28 18:57:07 CST; 40s ago<br />Process: 6607 ExecStart=/usr/bin/vsftpd (code=exited, status=2)<br />Main PID: 6607 (code=exited, status=2)</p><p>7æœˆ 28 18:57:07 goo systemd[1]: Started vsftpd daemon.<br />7æœˆ 28 18:57:07 goo systemd[1]: vsftpd.service: Main process exited, code=exited, status=2/INVALIDARGUMENT<br />7æœˆ 28 18:57:07 goo systemd[1]: vsftpd.service: Failed with result â€˜exit-codeâ€™.</p></blockquote><p>å‚è€ƒï¼š</p><ul><li><a href="https://wiki.archlinux.org/index.php/Very_Secure_FTP_Daemon_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Vsftpd Wiki</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>vsftpd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ‘è“æ´¾æ­å»ºç®€ç•¥WiFiæ— çº¿è·¯ç”±å™¨</title>
    <link href="/raspberry-wifi-router/"/>
    <url>/raspberry-wifi-router/</url>
    
    <content type="html"><![CDATA[<p>ç›®å‰æˆ‘å®¶æœ‰è£…æœ‰å€†è·¯ç”±å™¨ï¼Œæ‰€ä»¥åœ¨æä¸€ä¸ªè§‰å¾—æœ‰ç‚¹â€¦â€¦<br />ç„¶è€Œæœ¬æ–‡ä»‹ç»ç”¨æ ‘è“æ´¾æ¥æ­å»ºä¸€ä¸ªç®€ç•¥çš„WiFiæ— çº¿è·¯ç”±å™¨ï¼Œæ¥ä½“éªŒæ ‘è“æ´¾çš„å¼ºå¤§åŠŸèƒ½ã€‚</p><span id="more"></span><p>PSï¼š æ›´æ–°æ—¶é—´: 2019-08-13 21:13</p><h3 id="å®‰è£…ç¯å¢ƒ"><a class="markdownIt-Anchor" href="#å®‰è£…ç¯å¢ƒ"></a> å®‰è£…ç¯å¢ƒ</h3><p>ç”¨ä¸€æ ¹ç½‘çº¿è¿æ¥è·¯ç”±å™¨å’Œæ ‘è“æ´¾ï¼Œç”¨äºæä¾›ç½‘ç»œ<br />æ— çº¿ç½‘å¡ï¼Œè¿™é‡Œæˆ‘ç”¨å¾ˆä¹…ä»¥å‰ä¹°çš„é‚£ä¸ª360éšèº«WiFi(æ‚²å‚¬)<br />ä¸»æœºï¼šArchlinuxï¼Œæ ‘è“æ´¾<br />å·¥å…·ï¼šhostapdï¼Œdnsmasqï¼Œiptables</p><h3 id="æ ‘è“æ´¾é…ç½®ä¿¡æ¯"><a class="markdownIt-Anchor" href="#æ ‘è“æ´¾é…ç½®ä¿¡æ¯"></a> æ ‘è“æ´¾é…ç½®ä¿¡æ¯</h3><p>æ’å…¥ç½‘çº¿ç½‘å¡ç”¨ç½‘çº¿è¿æ¥å¥½æ ‘è“æ´¾åå¼€æœºï¼Œå¹¶åœ¨æœ¬æœºä¸Šsshè¿œç¨‹è¿æ¥æ ‘è“æ´¾ã€‚<br />ä»¥ä¸‹æ˜¯æ ‘è“æ´¾çš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œå…¶ä¸­wlan1å°±æ˜¯å¤–ç½®æ— çº¿æ¥å£ã€‚</p><p>// æˆ‘æœ¬æ¥æ˜¯æƒ³å°†æ— çº¿æ¥å£wlan1çš„IPé…ç½®æˆé™æ€åœ°å€ï¼Œè€Œwlan0æ¥å…¥å› ç‰¹ç½‘ã€‚ä½†ç°åœ¨æˆ‘ç”¨ç½‘çº¿è¿æ¥åˆ°æ ‘è“æ´¾æ‰€ä»¥å¹²è„†æŠŠæ ‘è“æ´¾ä½œä¸ºç¬¬äºŒä¸ªè·¯ç”±å™¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">pi@raspberrypi:~ $ uname -a<br>Linux raspberrypi 4.9.80-v7+ <span class="hljs-comment">#1098 SMP Fri Mar 9 19:11:42 GMT 2018 armv7l GNU/Linux</span><br>pi@raspberrypi:~ $ ifconfig <br>eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        inet 192.168.2.110  netmask 255.255.255.0  broadcast 192.168.2.255<br>        inet6 fe80::ba27:ebff:fe51:c2cd  prefixlen 64  scopeid 0x20&lt;link&gt;<br>        ether b8:27:eb:51:c2:<span class="hljs-built_in">cd</span>  txqueuelen 1000  (Ethernet)<br>        RX packets 286  bytes 19770 (19.3 KiB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 257  bytes 33091 (32.3 KiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536<br>        inet 127.0.0.1  netmask 255.0.0.0<br>        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;<br>        loop  txqueuelen 1  (Local Loopback)<br>        RX packets 6  bytes 522 (522.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 6  bytes 522 (522.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>wlan0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500<br>        inet 192.168.3.1  netmask 255.255.255.0  broadcast 192.168.3.255<br>        ether b8:27:eb:04:97:98  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>pi@raspberrypi:~ $ iwconfig <br>wlan1     IEEE 802.11  ESSID:off/any  <br>          Mode:Managed  Access Point: Not-Associated   Tx-Power=0 dBm   <br>          Retry short <span class="hljs-built_in">limit</span>:7   RTS thr:off   Fragment thr:off<br>          Power Management:on<br>          <br>lo        no wireless extensions.<br><br>wlan0     IEEE 802.11  ESSID:off/any  <br>          Mode:Managed  Access Point: Not-Associated   Tx-Power=31 dBm   <br>          Retry short <span class="hljs-built_in">limit</span>:7   RTS thr:off   Fragment thr:off<br>          Power Management:on<br>          <br>eth0      no wireless extensions.<br><br>pi@raspberrypi:~ $ lsusb <br>Bus 001 Device 005: ID 0c45:800a Microdia Vivitar Vivicam3350B<br>Bus 001 Device 004: ID 148f:760b Ralink Technology, Corp. MT7601U Wireless Adapter<br>Bus 001 Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet Adapter<br>Bus 001 Device 002: ID 0424:9514 Standard Microsystems Corp. SMC9514 Hub<br>Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub<br></code></pre></div></td></tr></table></figure><h3 id="é…ç½®æ— çº¿ç½‘å¡"><a class="markdownIt-Anchor" href="#é…ç½®æ— çº¿ç½‘å¡"></a> é…ç½®æ— çº¿ç½‘å¡</h3><p>è¿™ä¸€æ­¥éª¤æ˜¯ä¿®æ”¹æ ‘è“æ´¾çš„IPåœ°å€ä¸ºè·¯ç”±å™¨åœ°å€</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ nano /etc/network/interfaces<br>auto lo<br>iface lo inet loopback<br><br>auto eth0<br>iface eth0 inet static<br>address 192.168.2.110<br>netmask255.255.255.0<br>gateway192.168.2.1<br><br><span class="hljs-comment">#è¿™é‡Œçš„IPåœ°å€å…¶å®ç›¸å½“äº &quot;è·¯ç”±å™¨&quot; ipåœ°å€</span><br>allow-hotplug wlan0<br>iface wlan0 inet static<br>address 192.168.3.1<br>netmask 255.255.255.0<br></code></pre></div></td></tr></table></figure><h3 id="é…ç½®hostapd"><a class="markdownIt-Anchor" href="#é…ç½®hostapd"></a> é…ç½®hostapd</h3><p>hostapdèƒ½å¤Ÿâ€œæ¨¡æ‹Ÿâ€å‡ºä¸€ä¸ªAPï¼Œä½œä¸ºä¸€ä¸ªè®¤è¯æœåŠ¡å™¨ï¼Œå¹¶å¯¹è¿æ¥çš„è®¾å¤‡æ§åˆ¶ç®¡ç†ã€‚<br />ç®€å•è¯´hostapdèƒ½å¤Ÿè®©æˆ‘ä»¬è®¾ç½®WiFiçš„åç§°ï¼Œå¯†ç å’ŒåŠ å¯†æ–¹å¼ç­‰ç­‰</p><blockquote><p>hostapd is a user space daemon for <strong>access point</strong> and <strong>authentication servers</strong>. It implements IEEE 802.11 access point management, IEEE 802.1X/WPA/WPA2/EAP Authenticators, RADIUS client, EAP server, and RADIUS authentication server. The current version supports Linux (Host AP, madwifi, mac80211-based drivers) and FreeBSD (net80211).</p></blockquote><p>å®‰è£… hostapd</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">sudo apt-<span class="hljs-builtin-name">get</span> install hostapd<br></code></pre></div></td></tr></table></figure><p>æ–°å»ºæ–‡ä»¶ <strong>/etc/hostapd/hostapd.conf</strong> ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">æ— çº¿ç½‘å¡æ¥å£</span><br>interface=wlan0<br><span class="hljs-meta">#</span><span class="bash">é©±åŠ¨ç¨‹åº</span><br>driver=nl80211<br>hw_mode=g<br>ssid=WIFI-001<br><span class="hljs-meta">#</span><span class="bash">é€šé“</span><br>channel=6<br><span class="hljs-meta">#</span><span class="bash">åŠ å¯†æ¨¡å¼ WPA2</span><br>wpa=2<br>wpa_passphrase=12345678<br>wpa_key_mgmt=WPA-PSK<br>wpa_pairwise=CCMP<br>rsn_pairwise=CCMP<br>auth_algs=3<br>wmm_enabled=1<br><span class="hljs-meta">#</span><span class="bash"> è¿æ¥apçš„æœ€å¤§æ•°é‡</span><br>max_num_sta=10<br>logger_stdout=-1<br>logger_stdout_level=2<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­ <strong>ssid</strong> å’Œ <strong>wpa_passphrase</strong> åˆ†åˆ«ä¸ºWiFiçƒ­ç‚¹çš„åç§°å’Œå¯†ç ã€‚</p><p>æ¥ç€ï¼Œè¿˜éœ€ä¿®æ”¹ <strong>/etc/default/hostapd</strong></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> Defaults <span class="hljs-keyword">for</span> hostapd initscript</span><br><span class="hljs-meta">#</span><span class="bash"></span><br><span class="bash"><span class="hljs-comment"># See /usr/share/doc/hostapd/README.Debian for information about alternative</span></span><br><span class="hljs-meta">#</span><span class="bash"> methods of managing hostapd.</span><br><span class="hljs-meta">#</span><span class="bash"></span><br><span class="bash"><span class="hljs-comment"># Uncomment and set DAEMON_CONF to the absolute path of a hostapd configuration</span></span><br><span class="hljs-meta">#</span><span class="bash"> file and hostapd will be started during system boot. An example configuration</span><br><span class="hljs-meta">#</span><span class="bash"> file can be found at /usr/share/doc/hostapd/examples/hostapd.conf.gz</span><br><span class="hljs-meta">#</span><span class="bash"></span><br><span class="bash">DAEMON_CONF=<span class="hljs-string">&quot;/etc/hostapd/hostapd.conf&quot;</span></span><br><span class="hljs-meta">#</span><span class="bash"> Additional daemon options to be appended to hostapd <span class="hljs-built_in">command</span>:-</span><br><span class="hljs-meta">#</span><span class="bash"> -d   show more debug messages (-dd <span class="hljs-keyword">for</span> even more)</span><br><span class="hljs-meta">#</span><span class="bash"> -K   include key data <span class="hljs-keyword">in</span> debug messages</span><br><span class="hljs-meta">#</span><span class="bash"> -t   include timestamps <span class="hljs-keyword">in</span> some debug messages</span><br><span class="hljs-meta">#</span><span class="bash"></span><br><span class="bash"><span class="hljs-comment"># Note that -B (daemon mode) and -P (pidfile) options are automatically</span></span><br><span class="hljs-meta">#</span><span class="bash"> configured by the init.d script and must not be added to DAEMON_OPTS.</span><br><span class="hljs-meta">#</span><span class="bash"></span><br><span class="bash"><span class="hljs-comment">#DAEMON_OPTS=&quot;&quot;</span></span><br></code></pre></div></td></tr></table></figure><p>å–æ¶ˆ <strong>DAEMON_CONF=&quot;/etc/hostapd/hostapd.conf&quot;</strong> æ³¨é‡Šï¼Œå¹¶æ·»åŠ  hostapd.conf çš„è·¯å¾„ã€‚è¿™æ˜¯hostapdå®ˆæŠ¤è¿›ç¨‹é»˜è®¤è¦åŠ è½½çš„é…ç½®æ–‡ä»¶ï¼Œè¿™æ ·æ ‘è“æ´¾æ¯æ¬¡é‡å¯éƒ½ä¼šåŠ è½½è¿™ä¸ªé…ç½®æ–‡ä»¶</p><h4 id="æµ‹è¯•"><a class="markdownIt-Anchor" href="#æµ‹è¯•"></a> æµ‹è¯•</h4><p>å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­¤ä¹‹å‰ä¸´æ—¶æµ‹è¯•é…ç½®æ–‡ä»¶æ˜¯å¦ç”Ÿæ•ˆ</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> sudo hostapd /etc/hostapd/hostapd.conf</span><br>Configuration file: /etc/hostapd/hostapd.conf<br>Failed to create interface mon.wlan0: -95 (Operation not supported)<br>wlan0: Could not connect to kernel driver<br>Using interface wlan0 with hwaddr b8:27:eb:04:97:98 and ssid &quot;Wifi&quot;<br>wlan0: interface state UNINITIALIZED-&gt;ENABLED<br>wlan0: AP-ENABLED<br></code></pre></div></td></tr></table></figure><p>çœ‹åˆ°</p><blockquote><p>wlan0: interface state UNINITIALIZED-&gt;ENABLED<br />wlan0: AP-ENABLED</p></blockquote><p>å°±è¡¨ç¤ºæˆåŠŸåˆ›å»ºäº†ä¸€ä¸ªAPï¼Œä½†æ— æ³•è¿æ¥åˆ°ç½‘ç»œã€‚</p><h3 id="é…ç½®-dnsmasq"><a class="markdownIt-Anchor" href="#é…ç½®-dnsmasq"></a> é…ç½® dnsmasq</h3><blockquote><p><a href="http://www.thekelleys.org.uk/dnsmasq/doc.html">Dnsmasq</a> æä¾› DNS ç¼“å­˜å’Œ DHCP æœåŠ¡åŠŸèƒ½ã€‚ä½œä¸ºåŸŸåè§£ææœåŠ¡å™¨(DNS)ï¼Œdnsmasqå¯ä»¥é€šè¿‡ç¼“å­˜ DNS è¯·æ±‚æ¥æé«˜å¯¹è®¿é—®è¿‡çš„ç½‘å€çš„è¿æ¥é€Ÿåº¦ã€‚ä½œä¸ºDHCP æœåŠ¡å™¨ï¼Œ<a href="https://www.archlinux.org/packages/?name=dnsmasq">dnsmasq</a> å¯ä»¥ç”¨äºä¸ºå±€åŸŸç½‘ç”µè„‘åˆ†é…å†…ç½‘ipåœ°å€å’Œæä¾›è·¯ç”±ã€‚DNSå’ŒDHCPä¸¤ä¸ªåŠŸèƒ½å¯ä»¥åŒæ—¶æˆ–åˆ†åˆ«å•ç‹¬å®ç°ã€‚dnsmasqè½»é‡ä¸”æ˜“é…ç½®ï¼Œé€‚ç”¨äºä¸ªäººç”¨æˆ·æˆ–å°‘äº50å°ä¸»æœºçš„ç½‘ç»œã€‚</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ©ç”¨dnsmasqçš„DNSç¼“å­˜åŠŸèƒ½èƒ½å¤Ÿè®©è¿æ¥APçš„è®¾å¤‡è¯·æ±‚ç¼“å­˜ä¸‹æ¥ï¼Œè¿™æ ·ä¸‹æ¬¡å†è¿æ¥å°±æ— æ³•å†éœ€è¦è¾“å…¥å¯†ç ï¼Œå½“ç„¶è¿™åªæ˜¯æš‚æ—¶çš„ã€‚è€Œé€šè¿‡DHCPå°±å¯ä»¥åŠ¨æ€çš„ä¸ºå·²ç»è¿æ¥çš„è®¾å¤‡åˆ†é…ç½‘ipåœ°å€ç­‰ä¿¡æ¯ã€‚</p><p>å®‰è£… dnsmasq</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">$ sudo apt-<span class="hljs-builtin-name">get</span> install dnsmasq<br></code></pre></div></td></tr></table></figure><p>ç¼–è¾‘ <strong>/etc/dnsmasq.conf</strong>ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯æ³¨é‡Šã€‚<br />åœ¨æœ€åæ·»åŠ å¦‚ä¸‹å†…å®¹</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">interface=wlan0<br>listen-address=127.0.0.1,192.168.3.1<br>dhcp-range=192.168.3.50,192.168.3.150,12h<br><span class="hljs-meta">#</span><span class="bash"> DNS</span><br>resolv-file=/etc/resolv.conf<br></code></pre></div></td></tr></table></figure><p><strong>dhcp-range</strong> è¡¨ç¤ºè¦åŠ¨æ€åˆ†é…ç»™è¿æ¥è®¾å¤‡IPåœ°å€åœ¨æ‰€å±IPç½‘æ®µèŒƒå›´ä¹‹å†…ï¼Œè¿™é‡Œä¸º50~150</p><p><strong>/etc/resolv.conf</strong> é…ç½®å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">nameserver 8.8.8.8<br></code></pre></div></td></tr></table></figure><h3 id="å¼€å¯ipè½¬å‘åŠŸèƒ½"><a class="markdownIt-Anchor" href="#å¼€å¯ipè½¬å‘åŠŸèƒ½"></a> å¼€å¯IPè½¬å‘åŠŸèƒ½</h3><p>æ³¨æ„ï¼Œè¿™ä¸€æ­¥æ˜¯å¿…é¡»çš„ï¼Œä¸ç„¶å°±ç®—è®¾å¤‡è¿æ¥æˆåŠŸWiFiï¼Œé‚£ä¹Ÿæ— æ³•è¿æ¥åˆ°ç½‘ç»œï¼ï¼ï¼</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">1. sudo sh -c &quot;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&quot;<br>2. sudo sysctl net.ipv4.ip_forward=1 <br>sudo sysctl -p /etc/sysctl.conf<br><br>cat /proc/sys/net/ipv4/ip_forward<br></code></pre></div></td></tr></table></figure><p>å»ºè®®ä¿®æ”¹ <strong>/etc/sysctl.conf</strong> æ–‡ä»¶ï¼Œåªéœ€å°† <code>#net.ipv4.ip_forward=1</code> å–æ¶ˆæ³¨é‡Šå³å¯ã€‚</p><h3 id="iptablesé˜²ç«å¢™è·¯ç”±è½¬å‘"><a class="markdownIt-Anchor" href="#iptablesé˜²ç«å¢™è·¯ç”±è½¬å‘"></a> iptablesé˜²ç«å¢™è·¯ç”±è½¬å‘</h3><p>è¿™ä¸€æ­¥åŒä¸Šä¸€æ­¥ä¸€æ ·é‡è¦ï¼Œè¿™é‡Œä¸»è¦æ˜¯è®¾ç½®natè·¯ç”±è½¬å‘ï¼Œä¸ç„¶è¿˜æ˜¯æ— æ³•ä¸Šç½‘çš„</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">pi@raspberrypi:~ $ sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE<br>pi@raspberrypi:~ $ sudo iptables -t nat --line-numbers -L -n<br>Chain PREROUTING (policy ACCEPT)<br>num  target     prot opt <span class="hljs-built_in">source</span>               destination         <br>Chain INPUT (policy ACCEPT)<br>num  target     prot opt <span class="hljs-built_in">source</span>               destination         <br>Chain OUTPUT (policy ACCEPT)<br>num  target     prot opt <span class="hljs-built_in">source</span>               destination         <br>Chain POSTROUTING (policy ACCEPT)<br>num  target     prot opt <span class="hljs-built_in">source</span>               destination         <br>1    MASQUERADE  all  --  0.0.0.0/0            0.0.0.0/0<br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œçš„æ„æ€æ˜¯ï¼Œè·¯ç”±å™¨æºåœ°å€ï¼ˆ<strong>MASQUERADE</strong>è‡ªåŠ¨è·å–å½“å‰æ ‘è“æ´¾IPåœ°å€[ æ¯”å¦‚æˆ‘è¿™é‡Œä¸ºé™æ€192.168.2.110 ])ï¼Œå¹¶ä¸”å·²æ¥å…¥ç½‘ç»œï¼‰å°†æ•°æ®é€šè¿‡eth0æ¥å£è½¬å‘åˆ°å·²è¿æ¥çš„IPåœ°å€ï¼ˆ0.0.0.0/0ï¼‰</p><p>åœ¨è¿™é‡Œ -j MASQUERADE ç›¸å½“äº -j SNAT --to-source 192.168.2.110<br />è¿™ä¸ªæ—¶å€™è®¾å¤‡æ—¢å¯ä»¥è¿æ¥åˆ°äº’è”ç½‘äº†ï¼</p><h3 id="å¼€å¯å¯åŠ¨æœåŠ¡"><a class="markdownIt-Anchor" href="#å¼€å¯å¯åŠ¨æœåŠ¡"></a> å¼€å¯å¯åŠ¨æœåŠ¡</h3><p>1.å¼€æœºè‡ªå¯åŠ¨æœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo systemctl <span class="hljs-built_in">enable</span> hostapd<br>sudo systemctl <span class="hljs-built_in">enable</span> dnsmasq<br></code></pre></div></td></tr></table></figure><p>2.è‡ªåŠ¨è®¾ç½®iptables</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">sudo iptables-save &gt; /home/pi/iptables_forward<br></code></pre></div></td></tr></table></figure><p>æ·»åŠ å¦‚ä¸‹å†…å®¹åˆ° <strong>/etc/rc.local</strong> (exit 0 ä¹‹å‰)</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">iptables-restore &lt; /home/pi/iptables_forward<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„è¿˜è¦å¼€å¯äº†IPè½¬å‘åŠŸèƒ½</p><p>ä¹‹å <code>sudo reboot</code> é‡å¯ï¼Œç­‰å¾…</p><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>å¦‚æœåœ¨ <code>sudo systemctl enable hostapd</code> æ—¶å‡ºç°ä¸€ä¸‹ä¿¡æ¯</p><blockquote><p>Synchronizing state of hostapd.service with SysV service script with /lib/systemd/systemd-sysv-install.<br />Executing: /lib/systemd/systemd-sysv-install enable hostapd<br />Failed to enable unit: Unit file /etc/systemd/system/hostapd.service is masked.</p></blockquote><p>è§£å†³æ–¹æ³• <code>sudo systemctl unmask hostapd</code> åå† <code>sudo systemctl enable hostapd</code></p><p>æœ€åçš„æœ€åè¡¥æˆæœå›¾<br /><img src="/uploads/images/rasppi/file_004.png" alt="img" /></p><p><img src="/uploads/images/rasppi/phone.jpg" alt="img" /></p><p><img src="/uploads/images/rasppi/file_005.png" alt="img" /></p><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>RaspberryPi</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>æ ‘è“æ´¾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux Pingå·¥å…·æ±‡æ€»</title>
    <link href="/linux-ping-tools/"/>
    <url>/linux-ping-tools/</url>
    
    <content type="html"><![CDATA[<p>å¤§å®¶éƒ½åº”è¯¥ç†Ÿæ‚‰pingè¿™ä¸ªç½‘ç»œè¯Šæ–­å·¥å…·ï¼Œå®ƒç”¨æ¥æ£€æµ‹ç½‘ç»œæ˜¯å¦è¿é€šä»¥åŠç›®çš„ä¸»æœºæ˜¯å¦åœ¨çº¿ã€‚ç„¶è€Œå”¯ä¸€ç¼ºç‚¹æ˜¯å®ƒåªæ”¯æŒICMPåè®®ã€‚å› æ­¤ï¼Œå¤§å¤šæ•°ä¸»æœºéƒ½ä¼šé˜²ç«å¢™è¿‡æ»¤ICMPæ•°æ®åŒ…ï¼Œä¸è¿‡ï¼ŒLinuxä¸‹ä¹Ÿæœ‰è·Ÿä»–ç±»ä¼¼çš„pingå·¥å…·ï¼Œæœ¬æ–‡å°†ä¼šä»‹ç»ä¸€äº›å¸¸è§çš„å·¥å…·ã€‚</p><p><img src="/uploads/images/imgs/command-87198_640.jpg" alt="" /></p><span id="more"></span><h3 id="ping"><a class="markdownIt-Anchor" href="#ping"></a> ping</h3><p>ä¸€èˆ¬ä½œä¸ºæ‰€æœ‰ç³»ç»Ÿé»˜è®¤è‡ªå¸¦çš„ <code>ping</code> ï¼Œå®ƒåŒæ ·ä¹Ÿå¾ˆé‡è¦ã€‚é€šè¿‡ <code>man ping</code> æ¥æŸ¥çœ‹pingçš„å¸®åŠ©æ‰‹å†Œ</p><figure class="highlight inform7"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs inform7">ping  <span class="hljs-comment">[-aAbBdDfhLnOqrRUvV46]</span> <span class="hljs-comment">[-c count]</span> <span class="hljs-comment">[-F flowlabel]</span> <span class="hljs-comment">[-i interval]</span> <span class="hljs-comment">[-I interface]</span><br>       <span class="hljs-comment">[-l preload]</span> <span class="hljs-comment">[-m mark]</span> <span class="hljs-comment">[-M pmtudisc_option]</span> <span class="hljs-comment">[-N nodeinfo_option]</span> <span class="hljs-comment">[-w deadline]</span>  <span class="hljs-comment">[-W</span><br><span class="hljs-comment">       timeout]</span>  <span class="hljs-comment">[-p  pattern]</span> <span class="hljs-comment">[-Q tos]</span> <span class="hljs-comment">[-s packetsize]</span> <span class="hljs-comment">[-S sndbuf]</span> <span class="hljs-comment">[-t ttl]</span> <span class="hljs-comment">[-T timestamp</span><br><span class="hljs-comment">       option]</span> <span class="hljs-comment">[hop ...]</span> destination<br></code></pre></div></td></tr></table></figure><p>å¸¸ç”¨çš„ä¹Ÿå°±æ˜¯ -c(å‘é€æ•°æ®åŒ…çš„æ•°é‡)ï¼Œ-s(å‘é€æ•°æ®çš„å­—èŠ‚å¤§å°)ï¼Œ-I(ç½‘ç»œæ¥å£)</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">&gt;<span class="hljs-built_in"> ping </span>baidu.com -c 2 -s 64<span class="hljs-built_in"></span><br><span class="hljs-built_in">PING </span>baidu.com (111.13.101.208) 64(92) bytes of data.<br>72 bytes <span class="hljs-keyword">from</span> 111.13.101.208 (111.13.101.208): <span class="hljs-attribute">icmp_seq</span>=1 <span class="hljs-attribute">ttl</span>=55 <span class="hljs-attribute">time</span>=44.2 ms<br>72 bytes <span class="hljs-keyword">from</span> 111.13.101.208 (111.13.101.208): <span class="hljs-attribute">icmp_seq</span>=2 <span class="hljs-attribute">ttl</span>=55 <span class="hljs-attribute">time</span>=43.4 ms<br>--- baidu.com<span class="hljs-built_in"> ping </span>statistics ---<br>2 packets transmitted, 2 received, 0% packet loss, time 1017ms<br>rtt min/avg/max/mdev = 43.490/43.873/44.257/0.436 ms<br></code></pre></div></td></tr></table></figure><p>å‡å¦‚æˆ‘è¦pingä¸€ä¸ªä¸»æœºçš„IPv6åœ°å€ï¼Œé‚£ä¹ˆå¯ä»¥è¿™æ ·åš(å¿…é¡»æŒ‡å®š -I eth0)</p><figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir">&gt; ping -I eth0 fe80::<span class="hljs-number">2605</span><span class="hljs-symbol">:fff</span><span class="hljs-symbol">:fe41</span><span class="hljs-symbol">:e387</span> -c <span class="hljs-number">2</span><br>PING fe80::<span class="hljs-number">2605</span><span class="hljs-symbol">:fff</span><span class="hljs-symbol">:fe41</span><span class="hljs-symbol">:e387</span>(fe80::<span class="hljs-number">2605</span><span class="hljs-symbol">:fff</span><span class="hljs-symbol">:fe41</span><span class="hljs-symbol">:e387</span>) from fe80::<span class="hljs-number">2</span><span class="hljs-symbol">cca:</span><span class="hljs-symbol">ff77:</span><span class="hljs-number">78</span><span class="hljs-symbol">dc:</span><span class="hljs-number">1025</span>%eth0 <span class="hljs-symbol">eth0:</span> <span class="hljs-number">56</span> data bytes<br><span class="hljs-number">64</span> bytes from fe80::<span class="hljs-number">2605</span><span class="hljs-symbol">:fff</span><span class="hljs-symbol">:fe41</span><span class="hljs-symbol">:e387%eth0</span>: icmp_seq=<span class="hljs-number">1</span> ttl=<span class="hljs-number">255</span> time=<span class="hljs-number">1.67</span> ms<br><span class="hljs-number">64</span> bytes from fe80::<span class="hljs-number">2605</span><span class="hljs-symbol">:fff</span><span class="hljs-symbol">:fe41</span><span class="hljs-symbol">:e387%eth0</span>: icmp_seq=<span class="hljs-number">2</span> ttl=<span class="hljs-number">255</span> time=<span class="hljs-number">4.43</span> ms<br>--- fe80::<span class="hljs-number">2605</span><span class="hljs-symbol">:fff</span><span class="hljs-symbol">:fe41</span><span class="hljs-symbol">:e387</span> ping statistics ---<br><span class="hljs-number">2</span> packets transmitted, <span class="hljs-number">2</span> received, 0% packet loss, time <span class="hljs-number">1001</span>ms<br>rtt min/avg/max/mdev = <span class="hljs-number">1.671</span>/<span class="hljs-number">3.054</span>/<span class="hljs-number">4.438</span>/<span class="hljs-number">1.384</span> ms<br></code></pre></div></td></tr></table></figure><p>æˆ–è€… <strong>ping6 -I eth0 fe80::2605:fff:fe41:e387 -c 2</strong></p><h3 id="fping"><a class="markdownIt-Anchor" href="#fping"></a> fping</h3><p>ç›¸å¯¹æ¥è¯´fpingæ¯”pingè¦é«˜çº§ç‚¹(<strong>ä¹Ÿæ˜¯é€šè¿‡ICMPåè®®æ¥å‘é€æ•°æ®åŒ…çš„</strong>)ï¼Œä»–å¯ä»¥å‘å¤šä¸ªç›®æ ‡ä¸»æœºå‘é€pingï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªä¸»æœºåˆ—è¡¨æ–‡ä»¶ã€‚å…¶ä¸­ï¼Œfpingçš„ <strong>-g</strong> é€‰é¡¹æ¯”è¾ƒé‡è¦</p><blockquote><p><strong>-g, â€“generate</strong> generate target list (only if no -f specified)<br />(give start and end IP in the target list, or a <strong>CIDR address</strong>)<br />(ex. fping -g 192.168.1.0 192.168.1.255 or fping -g 192.168.1.0/24)</p></blockquote><figure class="highlight vhdl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vhdl">fping <span class="hljs-comment">--help</span><br>Usage: fping [options] [targets...]<br>Probing options:<br>   -<span class="hljs-number">4</span>, <span class="hljs-comment">--ipv4         only ping IPv4 addresses</span><br>   -<span class="hljs-number">6</span>, <span class="hljs-comment">--ipv6         only ping IPv6 addresses</span><br>   -b, <span class="hljs-comment">--size=BYTES   amount of ping data to send, in bytes (default: 56)</span><br>   -B, <span class="hljs-comment">--backoff=N    set exponential backoff factor to N (default: 1.5)</span><br>   -c, <span class="hljs-comment">--count=N      count mode: send N pings to each target</span><br>   -f, <span class="hljs-comment">--file=FILE    read list of targets from a file ( - means stdin)</span><br>   -g, <span class="hljs-comment">--generate     generate target list (only if no -f specified)</span><br>                      (give start <span class="hljs-keyword">and</span> <span class="hljs-keyword">end</span> IP <span class="hljs-keyword">in</span> the target list, <span class="hljs-keyword">or</span> a CIDR address)<br>                      (ex. fping -g <span class="hljs-number">192.168</span>.<span class="hljs-number">1.0</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">1.255</span> <span class="hljs-keyword">or</span> fping -g <span class="hljs-number">192.168</span>.<span class="hljs-number">1.0</span>/<span class="hljs-number">24</span>)<br>   -H, <span class="hljs-comment">--ttl=N        set the IP TTL value (Time To Live hops)</span><br>   -I, <span class="hljs-comment">--iface=IFACE  bind to a particular interface</span><br>   -l, <span class="hljs-comment">--loop         loop mode: send pings forever</span><br>   -m, <span class="hljs-comment">--all          use all IPs of provided hostnames (e.g. IPv4 and IPv6), use with -A</span><br>   -M, <span class="hljs-comment">--dontfrag     set the Don&#x27;t Fragment flag</span><br>   -O, <span class="hljs-comment">--tos=N        set the type of service (tos) flag on the ICMP packets</span><br>   -p, <span class="hljs-comment">--period=MSEC  interval between ping packets to one target (in ms)</span><br>                      (<span class="hljs-keyword">in</span> <span class="hljs-keyword">loop</span> <span class="hljs-keyword">and</span> count modes, <span class="hljs-keyword">default</span>: <span class="hljs-number">1000</span> ms)<br>   -r, <span class="hljs-comment">--retry=N      number of retries (default: 3)</span><br>   -R, <span class="hljs-comment">--random       random packet data (to foil link data compression)</span><br>   -S, <span class="hljs-comment">--src=IP       set source address</span><br>   -t, <span class="hljs-comment">--timeout=MSEC individual target initial timeout (default: 500 ms,</span><br>                      except <span class="hljs-keyword">with</span> -l/-c/-C, where it<span class="hljs-symbol">&#x27;s</span> the -p period up <span class="hljs-keyword">to</span> <span class="hljs-number">2000</span> ms)<br>Output options:<br>   -a, <span class="hljs-comment">--alive        show targets that are alive</span><br>   -A, <span class="hljs-comment">--addr         show targets by address</span><br>   -C, <span class="hljs-comment">--vcount=N     same as -c, report results in verbose format</span><br>   -D, <span class="hljs-comment">--timestamp    print timestamp before each output line</span><br>   -e, <span class="hljs-comment">--elapsed      show elapsed time on return packets</span><br>   -i, <span class="hljs-comment">--interval=MSEC  interval between sending ping packets (default: 10 ms)</span><br>   -n, <span class="hljs-comment">--name         show targets by name (-d is equivalent)</span><br>   -N, <span class="hljs-comment">--netdata      output compatible for netdata (-l -Q are required)</span><br>   -o, <span class="hljs-comment">--outage       show the accumulated outage time (lost packets * packet interval)</span><br>   -q, <span class="hljs-comment">--quiet        quiet (don&#x27;t show per-target/per-ping results)</span><br>   -Q, <span class="hljs-comment">--squiet=SECS  same as -q, but show summary every n seconds</span><br>   -s, <span class="hljs-comment">--stats        print final stats</span><br>   -u, <span class="hljs-comment">--unreach      show targets that are unreachable</span><br>   -v, <span class="hljs-comment">--version      show version</span><br></code></pre></div></td></tr></table></figure><p>ç”¨æ³•å¦‚ä¸‹</p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">&gt; fping -I eth0 -b <span class="hljs-number">64</span> -f list_targets -a -q -s<br><span class="hljs-number">192.168</span>.<span class="hljs-number">1.16</span>  : xmt<span class="hljs-regexp">/rcv/</span>%loss = <span class="hljs-number">2</span><span class="hljs-regexp">/2/</span><span class="hljs-number">0</span>%, min<span class="hljs-regexp">/avg/m</span>ax = <span class="hljs-number">58.0</span><span class="hljs-regexp">/74.1/</span><span class="hljs-number">90.1</span><br><span class="hljs-number">192.168</span>.<span class="hljs-number">1.15</span>  : xmt<span class="hljs-regexp">/rcv/</span>%loss = <span class="hljs-number">2</span><span class="hljs-regexp">/0/</span><span class="hljs-number">100</span>%<br><span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span> : xmt<span class="hljs-regexp">/rcv/</span>%loss = <span class="hljs-number">2</span><span class="hljs-regexp">/2/</span><span class="hljs-number">0</span>%, min<span class="hljs-regexp">/avg/m</span>ax = <span class="hljs-number">1.48</span><span class="hljs-regexp">/3.39/</span><span class="hljs-number">5.31</span><br>       <span class="hljs-number">3</span> targets<br>       <span class="hljs-number">2</span> alive<br>       <span class="hljs-number">1</span> unreachable<br>       <span class="hljs-number">0</span> unknown addresses<br>       <span class="hljs-number">1</span> timeouts (waiting <span class="hljs-keyword">for</span> response)<br>       <span class="hljs-number">6</span> ICMP Echos sent<br>       <span class="hljs-number">4</span> ICMP Echo Replies received<br>       <span class="hljs-number">0</span> other ICMP received<br> <span class="hljs-number">1.48</span> ms (min <span class="hljs-keyword">round</span> trip time)<br> <span class="hljs-number">38.7</span> ms (avg <span class="hljs-keyword">round</span> trip time)<br> <span class="hljs-number">90.1</span> ms (max <span class="hljs-keyword">round</span> trip time)<br>        <span class="hljs-number">2.022</span> sec (elapsed real time)<br><br></code></pre></div></td></tr></table></figure><p>-b æŒ‡å®šå‘é€æ•°æ®å­—èŠ‚å¤§å°<br />-f æŒ‡å®šä¸€ä¸ªç›®æ ‡ä¸»æœºåˆ—è¡¨æ–‡ä»¶ï¼Œæ¯è¡Œä¸€ä¸ªåœ°å€<br />-a åªæ˜¾ç¤ºå¯ä»¥pingé€šçš„ç›®æ ‡ä¸»æœº<br />-q å®‰é™æ¨¡å¼ï¼Œä¸æ˜¾ç¤ºåœ¨pingæ—¶çš„æ¯ä¸ªä¸»æœºçš„ç»“æœ<br />-s æœ€åæ˜¾ç¤ºæ€»è®¡ç»“æœ<br />-r é‡è¯•æ¬¡æ•°ï¼Œé»˜è®¤:3<br />è¿˜å¯ä»¥æŒ‡å®š -g æ¥æ‰«æå±€åŸŸç½‘ä¸‹æ‰€æœ‰ä¸»æœº</p><figure class="highlight accesslog"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs accesslog">&gt; fping -asgq <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">1</span>.<span class="hljs-number">0</span>/<span class="hljs-number">24</span><br><span class="hljs-number">192.168.1.1</span><br><span class="hljs-number">192.168.1.11</span><br><span class="hljs-number">192.168.1.6</span><br><span class="hljs-number">192.168.1.16</span><br><span class="hljs-number">192.168.1.3</span><br><span class="hljs-number">192.168.1.5</span><br><span class="hljs-number">192.168.1.12</span><br><span class="hljs-number">192.168.1.9</span><br><span class="hljs-number">192.168.1.105</span><br><span class="hljs-number">192.168.1.108</span><br><span class="hljs-number">192.168.1.110</span><br>     <span class="hljs-number">254</span> targets<br>      <span class="hljs-number">11</span> alive<br>     <span class="hljs-number">243</span> unreachable<br>       <span class="hljs-number">0</span> unknown addresses<br>     <span class="hljs-number">243</span> timeouts (waiting for response)<br>     <span class="hljs-number">983</span> ICMP Echos sent<br>      <span class="hljs-number">11</span> ICMP Echo Replies received<br>     <span class="hljs-number">964</span> other ICMP received<br> <span class="hljs-number">0</span>.<span class="hljs-number">04</span> ms (min round trip time)<br> <span class="hljs-number">88</span>.<span class="hljs-number">2</span> ms (avg round trip time)<br> <span class="hljs-number">268</span> ms (max round trip time)<br>       <span class="hljs-number">11</span>.<span class="hljs-number">633</span> sec (elapsed real time)<br></code></pre></div></td></tr></table></figure><p>é€šè¿‡ -u å¯ä»¥æ˜¾ç¤ºä¸»æœºä¸å¯è¾¾çš„åœ°å€ï¼Œå¦‚: <code>fping -usgq 192.168.1.0/24</code></p><h3 id="hping3"><a class="markdownIt-Anchor" href="#hping3"></a> hping3</h3><p>è¿™ä¸ªhping3å°±æ¯”è¾ƒå¼ºå¤§çš„ï¼Œå®ƒæ”¯æŒçš„åè®®æœ‰TCPï¼ŒUDPï¼ŒICMPï¼Œæ”¯æŒä½¿ç”¨tclè„šæœ¬ã€‚<br />ä¸»è¦ç”¨é€”ï¼š</p><ul><li><strong>æµ‹è¯•é˜²ç«å¢™è§„åˆ™</strong></li><li>æµ‹è¯•å…¥ä¾µæ£€æµ‹ç³»ç»Ÿ(IDS)</li><li>æµ‹è¯•TCP/IPæ¨¡å¼çš„å®‰å…¨æ¼æ´</li></ul><p>å¯¹äºä¸€äº›ä¸»æœºçš„é˜²ç«å¢™è¿‡æ»¤äº†ICMPæ•°æ®åŒ…ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨hping3å‘é€TCPæ•°æ®åŒ…æ¥åˆ¤æ–­ä¸»æœºæ˜¯å¦å­˜æ´»</p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli">&gt; hping3 -h<br>usage: hping3 host [options]<br>  -h  <span class="hljs-params">--help</span>      show this <span class="hljs-keyword">help</span><br>  -v  <span class="hljs-params">--version</span>   show <span class="hljs-keyword">version</span><br>  -c  <span class="hljs-params">--count</span>     packet count<br>  -i  <span class="hljs-params">--interval</span>  wait <span class="hljs-params">(uX for X microseconds, for example -i u1000)</span><br>      <span class="hljs-params">--fast</span>      <span class="hljs-keyword">alias</span> for -i u10000 <span class="hljs-params">(10 packets for second)</span><br>      <span class="hljs-params">--faster</span>    <span class="hljs-keyword">alias</span> for -i u1000 <span class="hljs-params">(100 packets for second)</span><br>      <span class="hljs-params">--flood</span>   sent packets as fast as possible. Don&#x27;t show replies.<br>  -n  <span class="hljs-params">--numeric</span>   numeric output<br>  -q  <span class="hljs-params">--quiet</span>     quiet<br>  -I  <span class="hljs-params">--interface</span> interface name <span class="hljs-params">(otherwise default routing interface)</span><br>  -V  <span class="hljs-params">--verbose</span>   verbose mode<br>  -D  <span class="hljs-params">--debug</span>     debugging info<br>  -z  <span class="hljs-params">--bind</span>      bind ctrl+z to ttl           <span class="hljs-params">(default to dst port)</span><br>  -Z  <span class="hljs-params">--unbind</span>    unbind ctrl+z<br>      <span class="hljs-params">--beep</span>      beep for every matching packet received<br>Mode<br>  default mode     TCP<br>  -0  <span class="hljs-params">--rawip</span>      RAW IP mode<br>  -1  <span class="hljs-params">--icmp</span>       ICMP mode<br>  -2  <span class="hljs-params">--udp</span>        UDP mode<br>  -8  <span class="hljs-params">--scan</span>       SCAN mode.<br>                   Example: hping <span class="hljs-params">--scan</span> 1-30,70-90 -S www.target.host<br>  -9  <span class="hljs-params">--listen</span>     listen mode<br>IP<br>  -a  <span class="hljs-params">--spoof</span>      spoof source address<br>  <span class="hljs-params">--rand-dest</span>      random destionation address mode. see the man.<br>  <span class="hljs-params">--rand-source</span>    random source address mode. see the man.<br>  -t  <span class="hljs-params">--ttl</span>        ttl <span class="hljs-params">(default 64)</span><br>  -N  <span class="hljs-params">--id</span>         id <span class="hljs-params">(default random)</span><br>  -W  <span class="hljs-params">--winid</span>      use win* id byte ordering<br>  -r  <span class="hljs-params">--rel</span>        relativize id field          <span class="hljs-params">(to estimate host traffic)</span><br>  -f  <span class="hljs-params">--frag</span>       split packets in more frag.  <span class="hljs-params">(may pass weak acl)</span><br>  -x  <span class="hljs-params">--morefrag</span>   <span class="hljs-keyword">set</span> more fragments flag<br>  -y  <span class="hljs-params">--dontfrag</span>   <span class="hljs-keyword">set</span> don&#x27;t fragment flag<br>  -g  <span class="hljs-params">--fragoff</span>    <span class="hljs-keyword">set</span> the fragment offset<br>  -m  <span class="hljs-params">--mtu</span>        <span class="hljs-keyword">set</span> virtual mtu, implies <span class="hljs-params">--frag</span> <span class="hljs-keyword">if</span> packet size &gt; mtu<br>  -o  <span class="hljs-params">--tos</span>        type of service <span class="hljs-params">(default 0x00)</span>, <span class="hljs-keyword">try</span> <span class="hljs-params">--tos</span> <span class="hljs-keyword">help</span><br>  -G  <span class="hljs-params">--rroute</span>     includes RECORD_ROUTE option and display the route buffer<br>  <span class="hljs-params">--lsrr</span>           loose source routing and record route<br>  <span class="hljs-params">--ssrr</span>           strict source routing and record route<br>  -H  <span class="hljs-params">--ipproto</span>    <span class="hljs-keyword">set</span> the IP protocol field, only in RAW IP mode<br>ICMP<br>  -C  <span class="hljs-params">--icmptype</span>   icmp type <span class="hljs-params">(default echo request)</span><br>  -K  <span class="hljs-params">--icmpcode</span>   icmp code <span class="hljs-params">(default 0)</span><br>      <span class="hljs-params">--force-icmp</span> send all icmp types <span class="hljs-params">(default send only supported types)</span><br>      <span class="hljs-params">--icmp-gw</span>    <span class="hljs-keyword">set</span> gateway address for ICMP redirect <span class="hljs-params">(default 0.0.0.0)</span><br>      <span class="hljs-params">--icmp-ts</span>    Alias for <span class="hljs-params">--icmp</span> <span class="hljs-params">--icmptype</span> 13 <span class="hljs-params">(ICMP timestamp)</span><br>      <span class="hljs-params">--icmp-addr</span>  Alias for <span class="hljs-params">--icmp</span> <span class="hljs-params">--icmptype</span> 17 <span class="hljs-params">(ICMP address subnet mask)</span><br>      <span class="hljs-params">--icmp-help</span>  display <span class="hljs-keyword">help</span> for others icmp options<br>UDP/TCP<br>  -s  <span class="hljs-params">--baseport</span>   base source port             <span class="hljs-params">(default random)</span><br>  -p  <span class="hljs-params">--destport</span>   [+][+]&lt;port&gt; destination port<span class="hljs-params">(default 0)</span> ctrl+z inc/dec<br>  -k  <span class="hljs-params">--keep</span>       keep still source port<br>  -w  <span class="hljs-params">--win</span>        winsize <span class="hljs-params">(default 64)</span><br>  -O  <span class="hljs-params">--tcpoff</span>     <span class="hljs-keyword">set</span> fake tcp data offset     <span class="hljs-params">(instead of tcphdrlen / 4)</span><br>  -Q  <span class="hljs-params">--seqnum</span>     shows only tcp sequence number<br>  -b  <span class="hljs-params">--badcksum</span>   <span class="hljs-params">(try to)</span> send packets with a bad IP checksum<br>                   many systems will fix the IP checksum sending the packet<br>                   so you&#x27;ll get bad UDP/TCP checksum instead.<br>  -M  <span class="hljs-params">--setseq</span>     <span class="hljs-keyword">set</span> TCP sequence number<br>  -L  <span class="hljs-params">--setack</span>     <span class="hljs-keyword">set</span> TCP ack<br>  -F  <span class="hljs-params">--fin</span>        <span class="hljs-keyword">set</span> FIN flag<br>  -S  <span class="hljs-params">--syn</span>        <span class="hljs-keyword">set</span> SYN flag<br>  -R  <span class="hljs-params">--rst</span>        <span class="hljs-keyword">set</span> RST flag<br>  -P  <span class="hljs-params">--push</span>       <span class="hljs-keyword">set</span> PUSH flag<br>  -A  <span class="hljs-params">--ack</span>        <span class="hljs-keyword">set</span> ACK flag<br>  -U  <span class="hljs-params">--urg</span>        <span class="hljs-keyword">set</span> URG flag<br>  -X  <span class="hljs-params">--xmas</span>       <span class="hljs-keyword">set</span> X unused flag <span class="hljs-params">(0x40)</span><br>  -Y  <span class="hljs-params">--ymas</span>       <span class="hljs-keyword">set</span> Y unused flag <span class="hljs-params">(0x80)</span><br>  <span class="hljs-params">--tcpexitcode</span>    use last tcp-&gt;th_flags as exit code<br>  <span class="hljs-params">--tcp-mss</span>        enable the TCP MSS option with the given value<br>  <span class="hljs-params">--tcp-timestamp</span>  enable the TCP timestamp option to guess the HZ/uptime<br>Common<br>  -d  <span class="hljs-params">--data</span>       data size                    <span class="hljs-params">(default is 0)</span><br>  -E  <span class="hljs-params">--file</span>       data from file<br>  -e  <span class="hljs-params">--sign</span>       add &#x27;signature&#x27;<br>  -j  <span class="hljs-params">--dump</span>       dump packets in hex<br>  -J  <span class="hljs-params">--print</span>      dump printable characters<br>  -B  <span class="hljs-params">--safe</span>       enable &#x27;safe&#x27; protocol<br>  -u  <span class="hljs-params">--end</span>        tell you when <span class="hljs-params">--file</span> reached EOF and prevent rewind<br>  -T  <span class="hljs-params">--traceroute</span> traceroute mode              <span class="hljs-params">(implies --bind and --ttl 1)</span><br>  <span class="hljs-params">--tr-stop</span>        Exit when receive the first not ICMP in traceroute mode<br>  <span class="hljs-params">--tr-keep-ttl</span>    Keep the source TTL fixed, useful to monitor just one hop<br>  <span class="hljs-params">--tr-no-rtt</span>    Don&#x27;t calculate/show RTT information in traceroute mode<br>ARS packet description <span class="hljs-params">(new, unstable)</span><br>  <span class="hljs-params">--apd-send</span>       Send the packet described with APD <span class="hljs-params">(see docs/APD.txt)</span><br></code></pre></div></td></tr></table></figure><p>å¯ä»¥é€šè¿‡ä¸€ä¸‹é€‰é¡¹æŒ‡å®šå‘é€æ•°æ®åŒ…çš„åè®®</p><table><thead><tr><th>é€‰é¡¹</th><th>é€‰é¡¹å…¨ç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>-0</td><td>â€“rawip</td><td>å‘é€åŸå§‹IPæ•°æ®åŒ…</td></tr><tr><td>-1</td><td>â€“icmp</td><td>å‘é€ICMPæ•°æ®åŒ…</td></tr><tr><td>-2</td><td>â€“udp</td><td>å‘é€UDPæ•°æ®åŒ…</td></tr><tr><td>-8</td><td>â€“scan</td><td>æ‰«ææ¨¡å¼</td></tr><tr><td>-9</td><td>â€“listen</td><td>ç›‘å¬æ¨¡å¼</td></tr></tbody></table><p>æ³¨æ„ï¼Œé»˜è®¤æ˜¯å‘é€TCPæ•°æ®åŒ…</p><table><thead><tr><th>é€‰é¡¹</th><th>æè¿°</th></tr></thead><tbody><tr><td>-S</td><td>SYN</td></tr><tr><td>-F</td><td>FIN</td></tr><tr><td>-R</td><td>RST</td></tr><tr><td>-P</td><td>PUSH</td></tr><tr><td>-A</td><td>ACK</td></tr><tr><td>-U</td><td>URG</td></tr><tr><td>-X</td><td>XMAS</td></tr><tr><td>-Y</td><td>YMAS</td></tr></tbody></table><h4 id="å‘é€tcpæ•°æ®åŒ…"><a class="markdownIt-Anchor" href="#å‘é€tcpæ•°æ®åŒ…"></a> å‘é€TCPæ•°æ®åŒ…</h4><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">&gt; hping3 -I eth0 -V --syn 192.168.1.110 -c 2<br>using eth0, addr: 192.168.1.108, MTU: 1500<br>HPING 192.168.1.110 (eth0 192.168.1.110): S set, 40 headers + 0 data bytes<br><span class="hljs-attribute">len</span>=46 <span class="hljs-attribute">ip</span>=192.168.1.110 <span class="hljs-attribute">ttl</span>=64 DF <span class="hljs-attribute">id</span>=10106 <span class="hljs-attribute">tos</span>=0 <span class="hljs-attribute">iplen</span>=40<br><span class="hljs-attribute">sport</span>=0 <span class="hljs-attribute">flags</span>=RA <span class="hljs-attribute">seq</span>=0 <span class="hljs-attribute">win</span>=0 <span class="hljs-attribute">rtt</span>=7.7 ms<br><span class="hljs-attribute">seq</span>=0 <span class="hljs-attribute">ack</span>=1839333390 <span class="hljs-attribute">sum</span>=88b4 <span class="hljs-attribute">urp</span>=0<br><span class="hljs-attribute">len</span>=46 <span class="hljs-attribute">ip</span>=192.168.1.110 <span class="hljs-attribute">ttl</span>=64 DF <span class="hljs-attribute">id</span>=10157 <span class="hljs-attribute">tos</span>=0 <span class="hljs-attribute">iplen</span>=40<br><span class="hljs-attribute">sport</span>=0 <span class="hljs-attribute">flags</span>=RA <span class="hljs-attribute">seq</span>=1 <span class="hljs-attribute">win</span>=0 <span class="hljs-attribute">rtt</span>=7.6 ms<br><span class="hljs-attribute">seq</span>=0 <span class="hljs-attribute">ack</span>=439379179 <span class="hljs-attribute">sum</span>=1ca3 <span class="hljs-attribute">urp</span>=0<br>--- 192.168.1.110 hping statistic ---<br>2 packets transmitted, 2 packets received, 0% packet loss<br>round-trip min/avg/max = 7.6/7.7/7.7 ms<br></code></pre></div></td></tr></table></figure><h4 id="ç«¯å£æ£€æµ‹"><a class="markdownIt-Anchor" href="#ç«¯å£æ£€æµ‹"></a> ç«¯å£æ£€æµ‹</h4><p>-p æŒ‡å®šç›®çš„ç«¯å£</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">&gt; hping3  -I eth0 -S -p 3306 192.168.1.110 -c 2<br>HPING 192.168.1.110 (eth0 192.168.1.110): S set, 40 headers + 0 data bytes<br><span class="hljs-attribute">len</span>=46 <span class="hljs-attribute">ip</span>=192.168.1.110 <span class="hljs-attribute">ttl</span>=64 DF <span class="hljs-attribute">id</span>=0 <span class="hljs-attribute">sport</span>=3306 <span class="hljs-attribute">flags</span>=SA <span class="hljs-attribute">seq</span>=0 <span class="hljs-attribute">win</span>=29200 <span class="hljs-attribute">rtt</span>=31.8 ms<br><span class="hljs-attribute">len</span>=46 <span class="hljs-attribute">ip</span>=192.168.1.110 <span class="hljs-attribute">ttl</span>=64 DF <span class="hljs-attribute">id</span>=0 <span class="hljs-attribute">sport</span>=3306 <span class="hljs-attribute">flags</span>=SA <span class="hljs-attribute">seq</span>=1 <span class="hljs-attribute">win</span>=29200 <span class="hljs-attribute">rtt</span>=7.7 ms<br>--- 192.168.1.110 hping statistic ---<br>2 packets transmitted, 2 packets received, 0% packet loss<br>round-trip min/avg/max = 7.7/19.7/31.8 ms<br><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„å…¶ä¸­çš„ <strong>win=29200</strong> è¡¨ç¤ºå¼€æ”¾è¯¥ç«¯å£</p><h4 id="scanæ¨¡å¼"><a class="markdownIt-Anchor" href="#scanæ¨¡å¼"></a> Scanæ¨¡å¼</h4><p>é€šè¿‡ -8/â€“scan æ¥å¼€å¯æ‰«ææ¨¡å¼ã€‚<br />æ‰€è°“æ‰«ææ¨¡å¼ï¼Œé€šè¿‡ä¸€ä¸ªç«¯å£ç»„ï¼Œå¯¹ä¸»æœºè¿›è¡Œç«¯å£æ‰«æã€‚<br />hping3 ç»™å‡ºäº†ä¸¤ä¸ªå…³é”®å­—ä»£è¡¨å¤šä¸ªç«¯å£ã€‚</p><table><thead><tr><th>å…³é”®å­—</th><th>æè¿°</th></tr></thead><tbody><tr><td>all</td><td>è¡¨ç¤º 0-65535 çš„ç«¯å£</td></tr><tr><td>known</td><td>è¡¨ç¤ºå·²çŸ¥æœ¬åœ°ç«¯å£ï¼Œè¿™äº›ç«¯å£ä½äº/etc/servicesæ–‡ä»¶</td></tr></tbody></table><p>ä¾‹1ï¼Œæ‰«æ 0-65535 çš„ç«¯å£</p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc">&gt; hping3 --scan <span class="hljs-emphasis">&#x27;all&#x27;</span> -S 192.168.1.110<br>Scanning 192.168.1.110 (192.168.1.110), port all<br><span class="hljs-section">65536 ports to scan, use -V to see all the replies</span><br><span class="hljs-section">+----+-----------+---------+---+-----+-----+-----+</span><br><span class="hljs-section">|port| serv name |  flags  |ttl| id  | win | len |</span><br><span class="hljs-section">+----+-----------+---------+---+-----+-----+-----+</span><br><span class="hljs-code"> 3306 mysql      : .S..A...  64     0 29200    46</span><br><span class="hljs-code">   80 http       : .S..A...  64     0 29200    46</span><br>All replies received. Done.<br>Not responding ports: (1 tcpmux) (2 nbp) (3 ) (4 echo) (6 zip) (8 ) (9 discard) (10 ) (11 systat) (13 daytime) (14 ) <br><span class="hljs-code">......</span><br><span class="hljs-code">......</span><br></code></pre></div></td></tr></table></figure><p>ä¾‹2ï¼Œæ‰«æ 1-5555çš„ç«¯å£å’Œå·²çŸ¥ç«¯å£</p><figure class="highlight tap"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tap">&gt; hping3 -8 &#x27;1-5555,known&#x27; -S 192.168.1.17<br>Scanning 192.168.1.17 (192.168.1.17), port 1-5555,known<br>5641 ports to scan, use -V to see all the replies<br>+----+-----------+---------+---+-----+-----+-----+<br>|port| serv name |  flags  |ttl| id  | win | len |<br>+----+-----------+---------+---+-----+-----+-----+<br>  <span class="hljs-number"> 21 </span>ftp        : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br>  <span class="hljs-number"> 22 </span>ssh        : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br>  <span class="hljs-number"> 23 </span>telnet     : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br>  <span class="hljs-number"> 25 </span>smtp       : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br>  <span class="hljs-number"> 53 </span>domain     : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br>  <span class="hljs-number"> 80 </span>http       : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br> <span class="hljs-number"> 111 </span>sunrpc     : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br> <span class="hljs-number"> 139 </span>netbios-ssn: .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br> <span class="hljs-number"> 445 </span>microsoft-d: .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br> <span class="hljs-number"> 512 </span>exec       : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br> <span class="hljs-number"> 513 </span>login      : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br> <span class="hljs-number"> 514 </span>shell      : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br><span class="hljs-number"> 1099 </span>rmiregistry: .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br><span class="hljs-number"> 1524 </span>ingreslock : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br><span class="hljs-number"> 2049 </span>nfs        : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br><span class="hljs-number"> 2121 </span>iprop      : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br><span class="hljs-number"> 3306 </span>mysql      : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br><span class="hljs-number"> 3632 </span>distcc     : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br><span class="hljs-number"> 5432 </span>postgresql : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br><span class="hljs-number"> 6000 </span>x11        : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br><span class="hljs-number"> 6667 </span>ircd       : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br><span class="hljs-number"> 6697 </span>ircs-u     : .S..A... <span class="hljs-number"> 64 </span>   <span class="hljs-number"> 0 </span><span class="hljs-number"> 5840 </span>   44<br>All replies received. Done.<br>Not responding ports:<br></code></pre></div></td></tr></table></figure><h4 id="å‘é€éšæœºåŸipåœ°å€çš„æ•°æ®åŒ…"><a class="markdownIt-Anchor" href="#å‘é€éšæœºåŸipåœ°å€çš„æ•°æ®åŒ…"></a> å‘é€éšæœºåŸIPåœ°å€çš„æ•°æ®åŒ…</h4><p>â€“rand-source/â€“rand-dest ç”¨äºä¼ªé€ åŸ/ç›®çš„IPåœ°å€ï¼Œè¿™å¯ä»¥åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¸è®©æˆ‘ä»¬è‡ªå·±çš„IPåœ°å€è¢«å¯¹æ–¹æ£€æµ‹åˆ°</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">&gt; hping3 --udp -S 192.168.1.17 -c 5 --rand-source<br>HPING 192.168.1.17 (eth0 192.168.1.17): udp mode set, 28 headers + 0 data bytes<br>ICMP<span class="hljs-built_in"> Port </span>Unreachable <span class="hljs-keyword">from</span> <span class="hljs-attribute">ip</span>=192.168.1.17 <span class="hljs-attribute">name</span>=192.168.1.17<br><span class="hljs-attribute">status</span>=0 <span class="hljs-attribute">port</span>=2475 <span class="hljs-attribute">seq</span>=0<br>ICMP<span class="hljs-built_in"> Port </span>Unreachable <span class="hljs-keyword">from</span> <span class="hljs-attribute">ip</span>=192.168.1.17 <span class="hljs-attribute">name</span>=192.168.1.17<br><span class="hljs-attribute">status</span>=0 <span class="hljs-attribute">port</span>=2476 <span class="hljs-attribute">seq</span>=1<br>ICMP<span class="hljs-built_in"> Port </span>Unreachable <span class="hljs-keyword">from</span> <span class="hljs-attribute">ip</span>=192.168.1.17 <span class="hljs-attribute">name</span>=192.168.1.17<br><span class="hljs-attribute">status</span>=0 <span class="hljs-attribute">port</span>=2477 <span class="hljs-attribute">seq</span>=2<br>ICMP<span class="hljs-built_in"> Port </span>Unreachable <span class="hljs-keyword">from</span> <span class="hljs-attribute">ip</span>=192.168.1.17 <span class="hljs-attribute">name</span>=192.168.1.17<br><span class="hljs-attribute">status</span>=0 <span class="hljs-attribute">port</span>=2478 <span class="hljs-attribute">seq</span>=3<br>--- 192.168.1.17 hping statistic ---<br>5 packets transmitted, 4 packets received, 20% packet loss<br>round-trip min/avg/max = 3.5/4.1/5.8 ms<br></code></pre></div></td></tr></table></figure><p>ç„¶è€Œè¿™ä¸ªçš„é—®é¢˜æ˜¯ä¸¢åŒ…ç‡å¢å¤§ã€‚</p><p>å¯ä»¥åœ¨ç›®ä¸»æœºä¸Šæ‰§è¡Œ <code>tcpdump -nn -v -t udp</code> æ¥æŸ¥çœ‹æ”¶å‘åŒ…æƒ…å†µã€‚</p><h3 id="nping"><a class="markdownIt-Anchor" href="#nping"></a> nping</h3><p>npingæ˜¯ <a href="https://nmap.org">Nmap</a> çš„ä¸€ä¸ª ç½‘ç»œæ•°æ®åŒ…ç”Ÿæˆå·¥å…·ã€‚æ”¯æŒ <strong>TCPã€UDPã€ICMPã€ARP</strong> åè®®ï¼Œå¤šä¸ªä¸»æœºçš„å¤šä¸ªç«¯å£ã€‚åŠŸèƒ½ç±»ä¼¼ä¸hping3</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata">Nping 0.7.60 ( https:<span class="hljs-comment">//nmap.org/nping )</span><br>Usage: nping [Probe mode] [Options] &#123;target specification&#125;<br>TARGET SPECIFICATION:<br>  Targets may be specified <span class="hljs-keyword">as</span> hostnames, IP addresses, networks, etc.<br>  <span class="hljs-keyword">Ex</span>: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.*.1-24<br>PROBE MODES:<br>  --tcp-connect                    : Unprivileged TCP connect probe mode.<br>  --tcp                            : TCP probe mode.<br>  --udp                            : UDP probe mode.<br>  --icmp                           : ICMP probe mode.<br>  --arp                            : ARP/RARP probe mode.<br>  --tr, --traceroute               : Traceroute mode (can only be used with <br>                                     TCP/UDP/ICMP modes).<br>TCP CONNECT MODE:<br>   -p, --dest-port &lt;port spec&gt;     : <span class="hljs-keyword">Set</span> destination port(s).<br>   -<span class="hljs-keyword">g</span>, --source-port &lt;portnumber&gt;  : Try to <span class="hljs-keyword">use</span> a custom source port.<br>TCP PROBE MODE:<br>   -<span class="hljs-keyword">g</span>, --source-port &lt;portnumber&gt;  : <span class="hljs-keyword">Set</span> source port.<br>   -p, --dest-port &lt;port spec&gt;     : <span class="hljs-keyword">Set</span> destination port(s).<br>   --seq &lt;seqnumber&gt;               : <span class="hljs-keyword">Set</span> sequence number.<br>   --flags &lt;flag <span class="hljs-keyword">list</span>&gt;             : <span class="hljs-keyword">Set</span> TCP flags (ACK,PSH,RST,SYN,FIN...)<br>   --ack &lt;acknumber&gt;               : <span class="hljs-keyword">Set</span> ACK number.<br>   --<span class="hljs-keyword">win</span> &lt;size&gt;                    : <span class="hljs-keyword">Set</span> <span class="hljs-keyword">window</span> size.<br>   --badsum                        : <span class="hljs-keyword">Use</span> a random invalid <span class="hljs-keyword">checksum</span>. <br>UDP PROBE MODE:<br>   -<span class="hljs-keyword">g</span>, --source-port &lt;portnumber&gt;  : <span class="hljs-keyword">Set</span> source port.<br>   -p, --dest-port &lt;port spec&gt;     : <span class="hljs-keyword">Set</span> destination port(s).<br>   --badsum                        : <span class="hljs-keyword">Use</span> a random invalid <span class="hljs-keyword">checksum</span>. <br>ICMP PROBE MODE:<br>  --icmp-<span class="hljs-keyword">type</span> &lt;<span class="hljs-keyword">type</span>&gt;               : ICMP <span class="hljs-keyword">type</span>.<br>  --icmp-code &lt;code&gt;               : ICMP code.<br>  --icmp-id &lt;id&gt;                   : <span class="hljs-keyword">Set</span> identifier.<br>  --icmp-seq &lt;<span class="hljs-keyword">n</span>&gt;                   : <span class="hljs-keyword">Set</span> sequence number.<br>  --icmp-redirect-addr &lt;addr&gt;      : <span class="hljs-keyword">Set</span> redirect address.<br>  --icmp-param-pointer &lt;pnt&gt;       : <span class="hljs-keyword">Set</span> parameter problem pointer.<br>  --icmp-advert-lifetime &lt;time&gt;    : <span class="hljs-keyword">Set</span> router advertisement lifetime.<br>  --icmp-advert-entry &lt;IP,pref&gt;    : Add router advertisement entry.<br>  --icmp-orig-time  &lt;timestamp&gt;    : <span class="hljs-keyword">Set</span> originate timestamp.<br>  --icmp-recv-time  &lt;timestamp&gt;    : <span class="hljs-keyword">Set</span> receive timestamp.<br>  --icmp-trans-time &lt;timestamp&gt;    : <span class="hljs-keyword">Set</span> transmit timestamp.<br>ARP/RARP PROBE MODE:<br>  --arp-<span class="hljs-keyword">type</span> &lt;<span class="hljs-keyword">type</span>&gt;                : <span class="hljs-keyword">Type</span>: ARP, ARP-reply, RARP, RARP-reply.<br>  --arp-sender-<span class="hljs-keyword">mac</span> &lt;<span class="hljs-keyword">mac</span>&gt;           : <span class="hljs-keyword">Set</span> sender <span class="hljs-keyword">MAC</span> address.<br>  --arp-sender-ip  &lt;addr&gt;          : <span class="hljs-keyword">Set</span> sender IP address.<br>  --arp-target-<span class="hljs-keyword">mac</span> &lt;<span class="hljs-keyword">mac</span>&gt;           : <span class="hljs-keyword">Set</span> target <span class="hljs-keyword">MAC</span> address.<br>  --arp-target-ip  &lt;addr&gt;          : <span class="hljs-keyword">Set</span> target IP address.<br>IPv4 OPTIONS:<br>  -S, --source-ip                  : <span class="hljs-keyword">Set</span> source IP address.<br>  --dest-ip &lt;addr&gt;                 : <span class="hljs-keyword">Set</span> destination IP address (used <span class="hljs-keyword">as</span> <span class="hljs-keyword">an</span> <br>                                     alternative to &#123;target specification&#125; ). <br>  --tos &lt;tos&gt;                      : <span class="hljs-keyword">Set</span> <span class="hljs-keyword">type</span> of service field (8bits).<br>  --id  &lt;id&gt;                       : <span class="hljs-keyword">Set</span> identification field (16 bits).<br>  --df                             : <span class="hljs-keyword">Set</span> Don&#x27;t Fragment flag.<br>  --mf                             : <span class="hljs-keyword">Set</span> <span class="hljs-keyword">More</span> Fragments flag.<br>  --ttl &lt;hops&gt;                     : <span class="hljs-keyword">Set</span> time to live [0-255].<br>  --badsum-ip                      : <span class="hljs-keyword">Use</span> a random invalid <span class="hljs-keyword">checksum</span>. <br>  --ip-options &lt;S|R [route]|<span class="hljs-keyword">L</span> [route]|T|<span class="hljs-keyword">U</span> ...&gt; : <span class="hljs-keyword">Set</span> IP options<br>  --ip-options &lt;hex string&gt;                    : <span class="hljs-keyword">Set</span> IP options<br>  --mtu &lt;size&gt;                     : <span class="hljs-keyword">Set</span> MTU. Packets get fragmented <span class="hljs-keyword">if</span> MTU is<br>                                     small enough.<br>IPv6 OPTIONS:<br>  -6, --IPv6                       : <span class="hljs-keyword">Use</span> IP <span class="hljs-keyword">version</span> 6.<br>  --dest-ip                        : <span class="hljs-keyword">Set</span> destination IP address (used <span class="hljs-keyword">as</span> <span class="hljs-keyword">an</span><br>                                     alternative to &#123;target specification&#125;).<br>  --hop-limit                      : <span class="hljs-keyword">Set</span> hop limit (same <span class="hljs-keyword">as</span> IPv4 TTL).<br>  --traffic-<span class="hljs-keyword">class</span> &lt;<span class="hljs-keyword">class</span>&gt; :        : <span class="hljs-keyword">Set</span> traffic <span class="hljs-keyword">class</span>.<br>  --flow &lt;<span class="hljs-keyword">label</span>&gt;                   : <span class="hljs-keyword">Set</span> flow <span class="hljs-keyword">label</span>.<br>ETHERNET OPTIONS:<br>  --dest-<span class="hljs-keyword">mac</span> &lt;<span class="hljs-keyword">mac</span>&gt;                 : <span class="hljs-keyword">Set</span> destination <span class="hljs-keyword">mac</span> address. (Disables<br>                                     ARP resolution)<br>  --source-<span class="hljs-keyword">mac</span> &lt;<span class="hljs-keyword">mac</span>&gt;               : <span class="hljs-keyword">Set</span> source <span class="hljs-keyword">MAC</span> address.<br>  --ether-<span class="hljs-keyword">type</span> &lt;<span class="hljs-keyword">type</span>&gt;              : <span class="hljs-keyword">Set</span> EtherType value.<br>PAYLOAD OPTIONS:<br>  --data &lt;hex string&gt;              : <span class="hljs-keyword">Include</span> a custom payload.<br>  --data-string &lt;text&gt;             : <span class="hljs-keyword">Include</span> a custom ASCII text.<br>  --data-length &lt;len&gt;              : <span class="hljs-keyword">Include</span> len random bytes <span class="hljs-keyword">as</span> payload.<br>ECHO CLIENT/SERVER:<br>  --echo-client &lt;passphrase&gt;       : <span class="hljs-keyword">Run</span> Nping <span class="hljs-keyword">in</span> client mode.<br>  --echo-server &lt;passphrase&gt;       : <span class="hljs-keyword">Run</span> Nping <span class="hljs-keyword">in</span> server mode.<br>  --echo-port &lt;port&gt;               : <span class="hljs-keyword">Use</span> custom &lt;port&gt; to listen or connect.<br>  --<span class="hljs-keyword">no</span>-crypto                      : Disable encryption and authentication.<br>  --once                           : Stop the server after <span class="hljs-keyword">one</span> connection.<br>  --safe-payloads                  : <span class="hljs-keyword">Erase</span> application data <span class="hljs-keyword">in</span> echoed packets.<br>TIMING AND PERFORMANCE:<br>  Options <span class="hljs-keyword">which</span> take &lt;time&gt; are <span class="hljs-keyword">in</span> seconds, or <span class="hljs-keyword">append</span> &#x27;ms&#x27; (milliseconds),<br>  &#x27;s&#x27; (seconds), &#x27;<span class="hljs-keyword">m</span>&#x27; (minutes), or &#x27;<span class="hljs-keyword">h</span>&#x27; (hours) to the value (<span class="hljs-keyword">e</span>.<span class="hljs-keyword">g</span>. 30m, 0.25h).<br>  --delay &lt;time&gt;                   : <span class="hljs-keyword">Adjust</span> delay between probes.<br>  --rate  &lt;rate&gt;                   : Send num packets per second.<br>MISC:<br>  -<span class="hljs-keyword">h</span>, --<span class="hljs-keyword">help</span>                       : <span class="hljs-keyword">Display</span> <span class="hljs-keyword">help</span> information.<br>  -V, --<span class="hljs-keyword">version</span>                    : <span class="hljs-keyword">Display</span> current <span class="hljs-keyword">version</span> number. <br>  -c, --<span class="hljs-keyword">count</span> &lt;<span class="hljs-keyword">n</span>&gt;                  : Stop after &lt;<span class="hljs-keyword">n</span>&gt; rounds.<br>  -<span class="hljs-keyword">e</span>, --interface &lt;name&gt;           : <span class="hljs-keyword">Use</span> supplied network interface.<br>  -<span class="hljs-keyword">H</span>, --hide-sent                  : <span class="hljs-keyword">Do</span> not <span class="hljs-keyword">display</span> sent packets.<br>  -<span class="hljs-keyword">N</span>, --<span class="hljs-keyword">no</span>-<span class="hljs-keyword">capture</span>                 : <span class="hljs-keyword">Do</span> not try to <span class="hljs-keyword">capture</span> replies.<br>  --privileged                     : Assume user is fully privileged.<br>  --unprivileged                   : Assume user lacks raw socket privileges.<br>  --send-eth                       : Send packets at the raw Ethernet layer.<br>  --send-ip                        : Send packets using raw IP sockets.<br>  --bpf-filter &lt;filter spec&gt;       : Specify custom BPF filter.<br>OUTPUT:<br>  -v                               : Increment verbosity level <span class="hljs-keyword">by</span> <span class="hljs-keyword">one</span>.<br>  -v[level]                        : <span class="hljs-keyword">Set</span> verbosity level. <span class="hljs-keyword">E</span>.<span class="hljs-keyword">g</span>: -v4<br>  -<span class="hljs-keyword">d</span>                               : Increment debugging level <span class="hljs-keyword">by</span> <span class="hljs-keyword">one</span>.<br>  -<span class="hljs-keyword">d</span>[level]                        : <span class="hljs-keyword">Set</span> debugging level. <span class="hljs-keyword">E</span>.<span class="hljs-keyword">g</span>: -d3<br>  -q                               : Decrease verbosity level <span class="hljs-keyword">by</span> <span class="hljs-keyword">one</span>.<br>  -q[<span class="hljs-keyword">N</span>]                            : Decrease verbosity level <span class="hljs-keyword">N</span> times<br>  --quiet                          : <span class="hljs-keyword">Set</span> verbosity and debug level to minimum.<br>  --debug                          : <span class="hljs-keyword">Set</span> verbosity and debug to the max level.<br>EXAMPLES:<br>  nping scanme.nmap.org<br>  nping --tcp -p 80 --flags rst --ttl 2 192.168.1.1<br>  nping --icmp --icmp-<span class="hljs-keyword">type</span> time --delay 500ms 192.168.254.254<br>  nping --echo-server <span class="hljs-string">&quot;public&quot;</span> -<span class="hljs-keyword">e</span> wlan0 -vvv <br>  nping --echo-client <span class="hljs-string">&quot;public&quot;</span> echo.nmap.org --tcp -p1-1024 --flags ack<br>SEE THE <span class="hljs-keyword">MAN</span> PAGE <span class="hljs-keyword">FOR</span> MANY <span class="hljs-keyword">MORE</span> OPTIONS, DESCRIPTIONS, AND EXAMPLES<br></code></pre></div></td></tr></table></figure><h4 id="tcpæ‰«æ"><a class="markdownIt-Anchor" href="#tcpæ‰«æ"></a> TCPæ‰«æ</h4><figure class="highlight nix"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nix">&gt; nping  --tcp -c <span class="hljs-number">1</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span> -p <span class="hljs-number">22</span>,<span class="hljs-number">3306</span> <span class="hljs-attr">--flags=syn</span><br>Starting Nping <span class="hljs-number">0.7</span>.<span class="hljs-number">60</span> ( https://nmap.org/nping ) at <span class="hljs-number">2018</span>-<span class="hljs-number">04</span>-<span class="hljs-number">05</span> <span class="hljs-number">11</span>:<span class="hljs-number">08</span> CST<br>SENT (<span class="hljs-number">0.0428</span>s) TCP <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span>:<span class="hljs-number">39046</span> &gt; <span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span>:<span class="hljs-number">22</span> S <span class="hljs-attr">ttl=64</span> <span class="hljs-attr">id=19287</span> <span class="hljs-attr">iplen=40</span>  <span class="hljs-attr">seq=1799430370</span> <span class="hljs-attr">win=1480</span> <br>RCVD (<span class="hljs-number">0.0465</span>s) TCP <span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span>:<span class="hljs-number">22</span> &gt; <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span>:<span class="hljs-number">39046</span> SA <span class="hljs-attr">ttl=64</span> <span class="hljs-attr">id=0</span> <span class="hljs-attr">iplen=44</span>  <span class="hljs-attr">seq=2225990095</span> <span class="hljs-attr">win=29200</span> &lt;mss <span class="hljs-number">1460</span>&gt;<br>SENT (<span class="hljs-number">1.0437</span>s) TCP <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span>:<span class="hljs-number">39046</span> &gt; <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span>:<span class="hljs-number">22</span> S <span class="hljs-attr">ttl=64</span> <span class="hljs-attr">id=19287</span> <span class="hljs-attr">iplen=40</span>  <span class="hljs-attr">seq=1799430370</span> <span class="hljs-attr">win=1480</span> <br>SENT (<span class="hljs-number">2.0449</span>s) TCP <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span>:<span class="hljs-number">39046</span> &gt; <span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span>:<span class="hljs-number">3306</span> S <span class="hljs-attr">ttl=64</span> <span class="hljs-attr">id=19287</span> <span class="hljs-attr">iplen=40</span>  <span class="hljs-attr">seq=1799430370</span> <span class="hljs-attr">win=1480</span> <br>RCVD (<span class="hljs-number">2.0897</span>s) TCP <span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span>:<span class="hljs-number">3306</span> &gt; <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span>:<span class="hljs-number">39046</span> SA <span class="hljs-attr">ttl=64</span> <span class="hljs-attr">id=0</span> <span class="hljs-attr">iplen=44</span>  <span class="hljs-attr">seq=3017639874</span> <span class="hljs-attr">win=29200</span> &lt;mss <span class="hljs-number">1460</span>&gt;<br>SENT (<span class="hljs-number">3.0468</span>s) TCP <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span>:<span class="hljs-number">39046</span> &gt; <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span>:<span class="hljs-number">3306</span> S <span class="hljs-attr">ttl=64</span> <span class="hljs-attr">id=19287</span> <span class="hljs-attr">iplen=40</span>  <span class="hljs-attr">seq=1799430370</span> <span class="hljs-attr">win=1480</span> <br> <br>Statistics for host <span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span>:<br> |  Probes Sent: <span class="hljs-number">2</span> | Rcvd: <span class="hljs-number">2</span> | Lost: <span class="hljs-number">0</span>  (<span class="hljs-number">0.00</span>%)<br> |_ Max rtt: <span class="hljs-number">44.817</span>ms | Min rtt: <span class="hljs-number">3.653</span>ms | Avg rtt: <span class="hljs-number">24.235</span>ms<br>Statistics for host <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span>:<br> |  Probes Sent: <span class="hljs-number">2</span> | Rcvd: <span class="hljs-number">0</span> | Lost: <span class="hljs-number">2</span>  (<span class="hljs-number">100.00</span>%)<br> |_ Max rtt: N/A | Min rtt: N/A | Avg rtt: N/A<br>Raw packets sent: <span class="hljs-number">4</span> (<span class="hljs-number">160</span>B) | Rcvd: <span class="hljs-number">2</span> (<span class="hljs-number">92</span>B) | Lost: <span class="hljs-number">2</span> (<span class="hljs-number">50.00</span>%)<br>Nping done: <span class="hljs-number">2</span> IP addresses pinged <span class="hljs-keyword">in</span> <span class="hljs-number">4.09</span> seconds<br></code></pre></div></td></tr></table></figure><h3 id="arping"><a class="markdownIt-Anchor" href="#arping"></a> arping</h3><p>arpingç”¨åœ¨æœ¬åœ°å±€åŸŸç½‘ä¸­ï¼Œåˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦åœ¨çº¿</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">Usage: arping [-fqbDUAV] [-c count] [-w timeout] [-I device] [-s source] destination<br>  -f : <span class="hljs-type">quit</span> on first reply<br>  -q : <span class="hljs-type">be</span> quiet<br>  -b : <span class="hljs-type">keep</span> broadcasting, don<span class="hljs-symbol">&#x27;t</span> go unicast<br>  -D : <span class="hljs-type">duplicate</span> address detection mode<br>  -U : <span class="hljs-type">Unsolicited</span> ARP mode, update your neighbours<br>  -A : <span class="hljs-type">ARP</span> answer mode, update your neighbours<br>  -V : <span class="hljs-type">print</span> version <span class="hljs-keyword">and</span> <span class="hljs-keyword">exit</span><br>  -c count : <span class="hljs-type">how</span> many packets to send<br>  -w timeout : <span class="hljs-type">how</span> long to wait <span class="hljs-keyword">for</span> a reply<br>  -I device : <span class="hljs-type">which</span> ethernet device to <span class="hljs-keyword">use</span><br>  -s source : <span class="hljs-type">source</span> ip address<br>  destination : <span class="hljs-type">ask</span> <span class="hljs-keyword">for</span> what ip address<br></code></pre></div></td></tr></table></figure><p>å¦‚ä¸‹åˆ¤æ–­ 192.168.1.110 ä¸»æœºæ˜¯å¦åœ¨çº¿</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">&gt; arping -c <span class="hljs-number">2</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span>  -w <span class="hljs-number">1</span><br>ARPING <span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span> <span class="hljs-selector-tag">from</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">1.108</span> eth0<br>Unicast reply <span class="hljs-selector-tag">from</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span> <span class="hljs-selector-attr">[24:05:0F:41:E3:87]</span>  <span class="hljs-number">61.513ms</span><br>Unicast reply <span class="hljs-selector-tag">from</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">1.110</span> <span class="hljs-selector-attr">[24:05:0F:41:E3:87]</span>  <span class="hljs-number">1.864ms</span><br>Sent <span class="hljs-number">2</span> probes (<span class="hljs-number">1</span> broadcast(s))<br>Received <span class="hljs-number">2</span> response(s)<br></code></pre></div></td></tr></table></figure><h3 id="netcat"><a class="markdownIt-Anchor" href="#netcat"></a> netcat</h3><p>å¯¹äºnetcat(nc)ï¼Œæˆ‘åªæƒ³ä»‹ç»å…¶ä¸­ä¸€ä¸ªåŠŸèƒ½â€”â€”æ‰«æä¸»æœºç«¯å£</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less">&gt; <span class="hljs-selector-tag">nc</span> <span class="hljs-selector-tag">-zvn</span> <span class="hljs-selector-tag">-w</span> <span class="hljs-selector-tag">1</span> <span class="hljs-selector-tag">192</span><span class="hljs-selector-class">.168</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.110</span>  <span class="hljs-selector-tag">1-5555</span><br>(UNKNOWN) <span class="hljs-selector-attr">[192.168.1.110]</span> <span class="hljs-selector-tag">3306</span> (mysql) <span class="hljs-selector-tag">open</span><br>(UNKNOWN) <span class="hljs-selector-attr">[192.168.1.110]</span> <span class="hljs-selector-tag">80</span> (http) <span class="hljs-selector-tag">open</span><br>(UNKNOWN) <span class="hljs-selector-attr">[192.168.1.110]</span> <span class="hljs-selector-tag">22</span> (ssh) <span class="hljs-selector-tag">open</span><br></code></pre></div></td></tr></table></figure><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>ä»¥ä¸Šæ˜¯ä¸€äº›æ¯”è¾ƒå¸¸ç”¨pingå·¥å…·äº†ï¼Œå½“ç„¶è¿˜æœ‰æ›´å¼ºçš„çš„å¦‚nmap ğŸ˜ƒ</p><p>bye</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Ping</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TinyXML2è§£æXMLæ–‡ä»¶</title>
    <link href="/linux-tinyxml2/"/>
    <url>/linux-tinyxml2/</url>
    
    <content type="html"><![CDATA[<p>ä¸Šæ¬¡ä»‹ç»äº†ç”¨ <strong>libxml2</strong> è§£æXMLæ–‡æ¡£ï¼Œç”¨èµ·æ¥ä¹ŸæŒºâ€œç—›è‹¦â€çš„ï¼Œä¸è¿‡è¿™æ¬¡å³å°†ä»‹ç»çš„åŒä¸ºå¼€æº <strong>tinyxml2</strong> å¯å†ç®€å•ä¸å¤Ÿäº†ã€‚ã€‚ã€‚</p><span id="more"></span><h3 id="tinyxml2"><a class="markdownIt-Anchor" href="#tinyxml2"></a> TinyXML2</h3><p>TinyXML2æ˜¯ä»€ä¹ˆï¼Ÿ</p><blockquote><p>TinyXML-2 is a simple, small, efficient, C++ XML parser that can be easily integrated into other programs.</p></blockquote><p>ä¸ <strong>é¢å‘è¿‡ç¨‹</strong> çš„libxml2ç›¸æ¯”ï¼ŒTinyXML2æ˜¯ <strong>é¢å‘å¯¹è±¡</strong> çš„ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½è¢«å°è£…åœ¨ <strong>ç±»</strong> é‡Œé¢ï¼Œå› æ­¤å˜å¾—æå…¶ç®€å•ã€‚<br />è€Œä¸” tinyxml2 å®ç°çš„ä»£ç æ–‡ä»¶ä¸º tinyxml2.h tinyxml2.cppï¼Œè€Œ tinyxml2.cpp ä»…å¤§çº¦2800è¡Œä»£ç å®ç°äº†xmlè§£æï¼Œå®åœ¨ä»¤äººä½©æœã€‚</p><blockquote><p>Simply compile and run. There is a visual studio 2015 project included, a simple Makefile, an Xcode project, a Code::Blocks project, and a cmake CMakeLists.txt included to help you.</p></blockquote><p>å¯ä»Githubä¸Šè·å–å…¶æºæ–‡ä»¶ï¼š <a href="https://github.com/leethomason/tinyxml2">https://github.com/leethomason/tinyxml2</a></p><p>tinyxml2ä¸»è¦åŒ…æ‹¬äº†ä¸€ä¸‹å‡ ä¸ªç±»</p><table><thead><tr><th>Class</th><th>Class</th></tr></thead><tbody><tr><td>XMLAttribute</td><td>XMLComment</td></tr><tr><td>XMLConstHandle</td><td>XMLDeclaration</td></tr><tr><td>XMLDocument</td><td>XMLElement</td></tr><tr><td>XMLHandle</td><td>XMLNode</td></tr><tr><td>XMLPrinter</td><td>XMLText</td></tr><tr><td>XMLUnknown</td><td>XMLVisitor</td></tr></tbody></table><p>é¡¾åæ€ä¹‰ï¼Œè¿™äº›ç±»çš„åŠŸèƒ½ç›´æ¥ä»åå­—å°±çŸ¥é“äº†ã€‚å…¶ä¸­ <strong>XMLNode</strong> ä¸ºå¤§å¤šæ•°ç±»çš„åŸºç±»ï¼Œå³ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ã€‚ <code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</code> ä¹Ÿæ˜¯ä¸€ä¸ªèŠ‚ç‚¹<br />æ³¨é‡Šï¼ˆCommentï¼‰ä¹Ÿæ˜¯ä¸€ä¸ªèŠ‚ç‚¹å¯¹è±¡ï¼Œä½†å±æ€§ï¼ˆAttributeï¼‰å´ä¸æ˜¯ï¼Œå› ä¸ºå®ƒæ²¡æœ‰ä» XMLNodeç±» æ´¾ç”Ÿå‡ºæ¥</p><p>è¦è§£æä¸€ä¸ªXMLæ–‡æ¡£ï¼Œä¸€èˆ¬å¯é€šè¿‡ <strong>XMLDocument</strong> åŠ è½½XMLæ–‡æ¡£</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">XMLError tinyxml2::XMLDocument::<span class="hljs-built_in">LoadFile</span>(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> * filename)<br>XMLError tinyxml2::XMLDocument::<span class="hljs-built_in">LoadFile</span>(FILE * )<br></code></pre></div></td></tr></table></figure><p>ç›¸åï¼Œtinyxml2::XMLDocument::SaveFile å¯ä¿å­˜XMLæ–‡æ¡£</p><p>ä¸‹é¢çš„ä¾‹å­ä»¥è§£æXMLæ–‡æ¡£æ‰€ä»¥èŠ‚ç‚¹ä¿¡æ¯</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;tinyxml2.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> tinyxml2; <br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ParserXMLFile</span><span class="hljs-params">(<span class="hljs-keyword">int</span> &amp;depth,XMLNode *pNode)</span></span>&#123;<br>    <span class="hljs-keyword">int</span> index=<span class="hljs-number">0</span>;<br>    <span class="hljs-comment">// æ ¹èŠ‚ç‚¹</span><br>    XMLNode *node=pNode;<br>    <span class="hljs-keyword">do</span>&#123;<br>        <span class="hljs-comment">// å¦‚æœæ˜¯èŠ‚ç‚¹æ˜¯å…ƒç´ </span><br>        <span class="hljs-keyword">if</span>(node-&gt;<span class="hljs-built_in">ToElement</span>())&#123;<br>            index++;<br>            XMLElement *element=node-&gt;<span class="hljs-built_in">ToElement</span>();<br>            cout.<span class="hljs-built_in">width</span>(depth);<br>            cout&lt;&lt;index&lt;&lt;<span class="hljs-string">&quot;.&quot;</span>&lt;&lt;element-&gt;<span class="hljs-built_in">Name</span>();<br>            <span class="hljs-comment">// è·å–å…ƒç´ çš„æ–‡æœ¬</span><br>            <span class="hljs-keyword">if</span>(element-&gt;<span class="hljs-built_in">GetText</span>())&#123;<br>                cout&lt;&lt;<span class="hljs-string">&quot;--&gt;&quot;</span>&lt;&lt;element-&gt;<span class="hljs-built_in">GetText</span>();<br>            &#125;<br>            cout&lt;&lt;endl;<br>            <span class="hljs-comment">// è§£æå±æ€§</span><br>            <span class="hljs-keyword">const</span> XMLAttribute *attribute=element-&gt;<span class="hljs-built_in">FirstAttribute</span>();<br>            <span class="hljs-keyword">bool</span> ishas_attr=<span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">if</span>(attribute) &#123;<br>                ishas_attr=<span class="hljs-literal">true</span>;<br>                cout.<span class="hljs-built_in">width</span>(depth);<br>                cout&lt;&lt;<span class="hljs-string">&quot;=&gt; &quot;</span>;<br>                <span class="hljs-keyword">while</span> (attribute)&#123;<br>                    cout&lt;&lt;attribute-&gt;<span class="hljs-built_in">Name</span>()&lt;&lt;<span class="hljs-string">&quot;:&quot;</span>&lt;&lt;attribute-&gt;<span class="hljs-built_in">Value</span>()&lt;&lt;<span class="hljs-string">&quot; | &quot;</span>;<br>                    attribute=attribute-&gt;<span class="hljs-built_in">Next</span>();<br>                &#125;<br>                <span class="hljs-keyword">if</span>(ishas_attr)cout&lt;&lt;endl;<br>            &#125;<br>            <span class="hljs-comment">// å½“å‰èŠ‚ç‚¹nodeçš„ä¸‹ä¸€ä¸ªå­èŠ‚ç‚¹</span><br>            <span class="hljs-keyword">if</span>(node-&gt;<span class="hljs-built_in">FirstChild</span>())&#123;<br>                depth+=<span class="hljs-number">10</span>;<br>                <span class="hljs-built_in">ParserXMLFile</span>(depth,node-&gt;<span class="hljs-built_in">FirstChild</span>());<br>            &#125;<br>        &#125;<br>        node=node-&gt;<span class="hljs-built_in">NextSibling</span>();<br>    &#125;<span class="hljs-keyword">while</span>(node);<br>    <span class="hljs-keyword">if</span>(depth&gt;<span class="hljs-number">0</span>)&#123;<br>        depth-=<span class="hljs-number">10</span>;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">testParserXML</span><span class="hljs-params">()</span></span>&#123;<br>    XMLDocument document;<br>    XMLError xmlError;<br>    <span class="hljs-keyword">if</span>((xmlError= document.<span class="hljs-built_in">LoadFile</span>(<span class="hljs-string">&quot;test1.xml&quot;</span>))==XML_SUCCESS)&#123;<br>        cout&lt;&lt;<span class="hljs-string">&quot;Load xml file ok!&quot;</span>&lt;&lt;endl;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        cout&lt;&lt;document.<span class="hljs-built_in">ErrorStr</span>()&lt;&lt;endl;<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br>    &#125;<br>    <span class="hljs-comment">// &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br>    <span class="hljs-keyword">if</span>(document.<span class="hljs-built_in">FirstChild</span>()-&gt;<span class="hljs-built_in">ToDeclaration</span>())&#123;<br>        cout&lt;&lt;document.<span class="hljs-built_in">FirstChild</span>()-&gt;<span class="hljs-built_in">ToDeclaration</span>()-&gt;<span class="hljs-built_in">Value</span>()&lt;&lt;endl;<br>    &#125;<br>    <span class="hljs-comment">// &lt;!--This is a comment...--&gt;</span><br>    <span class="hljs-keyword">if</span>(document.<span class="hljs-built_in">FirstChild</span>()-&gt;<span class="hljs-built_in">NextSibling</span>()-&gt;<span class="hljs-built_in">ToComment</span>())&#123;<br>        cout&lt;&lt;document.<span class="hljs-built_in">FirstChild</span>()-&gt;<span class="hljs-built_in">NextSibling</span>()-&gt;<span class="hljs-built_in">ToComment</span>()-&gt;<span class="hljs-built_in">Value</span>()&lt;&lt;endl;<br>    &#125;<br>    cout&lt;&lt;<span class="hljs-string">&quot;Root Element: &quot;</span>&lt;&lt; document.<span class="hljs-built_in">RootElement</span>()-&gt;<span class="hljs-built_in">Name</span>()&lt;&lt;endl;<br>    <span class="hljs-keyword">int</span> depth=<span class="hljs-number">0</span>;<br>    <span class="hljs-comment">// æ ¹èŠ‚ç‚¹ä¸‹çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹</span><br>    <span class="hljs-built_in">ParserXMLFile</span>(depth,document.<span class="hljs-built_in">RootElement</span>()-&gt;<span class="hljs-built_in">FirstChild</span>());<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc,<span class="hljs-keyword">char</span> **argv)</span> </span>&#123;<br>    <span class="hljs-built_in">testParserXML</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Ÿ</p><p>test.xml</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-comment">&lt;!--This is a comment...--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Theme</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;2.0&quot;</span> <span class="hljs-attr">magnet</span>=<span class="hljs-string">&quot;9&quot;</span> <span class="hljs-attr">alpha</span>=<span class="hljs-string">&quot;255&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Bitmap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;main&quot;</span> <span class="hljs-attr">file</span>=<span class="hljs-string">&quot;main.bmp&quot;</span> <span class="hljs-attr">alphacolor</span>=<span class="hljs-string">&quot;#FF0001&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Font</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;playlist_font&quot;</span> <span class="hljs-attr">file</span>=<span class="hljs-string">&quot;FreeSansBold.ttf&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;11&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">BitmapFont</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;digits_font&quot;</span> <span class="hljs-attr">file</span>=<span class="hljs-string">&quot;nums_ex.bmp&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;digits&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Window</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;playlist_window&quot;</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">y</span>=<span class="hljs-string">&quot;332&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Layout</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pl_small_layout&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;275&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;116&quot;</span> <span class="hljs-attr">minwidth</span>=<span class="hljs-string">&quot;275&quot;</span> <span class="hljs-attr">minheight</span>=<span class="hljs-string">&quot;116&quot;</span> <span class="hljs-attr">maxwidth</span>=<span class="hljs-string">&quot;1000&quot;</span> <span class="hljs-attr">maxheight</span>=<span class="hljs-string">&quot;800&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Group</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Text</span> <span class="hljs-attr">font</span>=<span class="hljs-string">&quot;text_font&quot;</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;4&quot;</span> <span class="hljs-attr">y</span>=<span class="hljs-string">&quot;4&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;239&quot;</span> <span class="hljs-attr">text</span>=<span class="hljs-string">&quot;$N&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">Group</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Layout</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Layout</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pl_big_layout&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;275&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;116&quot;</span> <span class="hljs-attr">minwidth</span>=<span class="hljs-string">&quot;275&quot;</span> <span class="hljs-attr">minheight</span>=<span class="hljs-string">&quot;116&quot;</span> <span class="hljs-attr">maxwidth</span>=<span class="hljs-string">&quot;1000&quot;</span> <span class="hljs-attr">maxheight</span>=<span class="hljs-string">&quot;800&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Group</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">y</span>=<span class="hljs-string">&quot;0&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Anchor</span> <span class="hljs-attr">x</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">y</span>=<span class="hljs-string">&quot;116&quot;</span> <span class="hljs-attr">priority</span>=<span class="hljs-string">&quot;30&quot;</span> <span class="hljs-attr">range</span>=<span class="hljs-string">&quot;15&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">Group</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Layout</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Window</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Theme</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>æœ€åçš„ç»“æœå°±ä¸æ˜¾ç¤ºå‡ºæ¥äº†ã€‚ã€‚ã€‚æ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œé€šè¿‡é€’å½’è·å–æ¯ä¸ªå­èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚å®˜ç½‘ä¹Ÿæœ‰ç±»æ–‡æ¡£å¯å‚è€ƒï¼Œè¿™é‡Œå°±ä¸åœ¨è¯¦ç»†ä»‹ç»äº†ã€‚ä¸è¿‡æœ‰ä¸ªåœ°æ–¹çš„ç¡®è¦æ³¨æ„</p><p>const char* tinyxml2::XMLNode::Value()const</p><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">Document:   <span class="hljs-literal">empty</span> (<span class="hljs-literal">NULL</span> is returned,<span class="hljs-keyword">not</span> <span class="hljs-keyword">an</span> <span class="hljs-literal">empty</span> <span class="hljs-keyword">string</span>)<br>Element:    name <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">element</span><br>Comment:    <span class="hljs-keyword">the</span> comment <span class="hljs-keyword">text</span><br>Unknown:    <span class="hljs-keyword">the</span> tag contents<br>Text:       <span class="hljs-keyword">the</span> <span class="hljs-keyword">text</span> <span class="hljs-keyword">string</span><br></code></pre></div></td></tr></table></figure><p>è¿™æ˜¯åŸºç±»XMLNodeçš„Valueæˆå‘˜å‡½æ•°ï¼Œè€Œæ–‡æ¡£ï¼ˆDocumentï¼‰å¯¹è±¡ï¼Œè¿”å›ç¡®å®ä¸€ä¸ª <strong>NULL</strong>ï¼Œä¸æ˜¯ç©ºå­—ç¬¦ä¸²ï¼æ–‡æ¡£å¯¹è±¡æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„èŠ‚ç‚¹å¯¹è±¡ã€‚</p><p>è€Œç”ŸæˆXMLåˆ™æ—¶æ›´åŠ ç®€å•äº†</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">GenerateXMLFile</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename)</span></span>&#123;<br>    XMLDocument document;<br>    <span class="hljs-comment">// æ·»åŠ  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br>    document.<span class="hljs-built_in">InsertFirstChild</span>(document.<span class="hljs-built_in">NewDeclaration</span>());<br>    <span class="hljs-comment">// æ·»åŠ æ³¨é‡Š</span><br>    document.<span class="hljs-built_in">InsertEndChild</span>(document.<span class="hljs-built_in">NewComment</span>(<span class="hljs-string">&quot;Hello World!&quot;</span>));<br>    <span class="hljs-comment">// æ·»åŠ æ ¹èŠ‚ç‚¹</span><br>    XMLElement *root= document.<span class="hljs-built_in">NewElement</span>(<span class="hljs-string">&quot;People&quot;</span>);<br>    document.<span class="hljs-built_in">InsertEndChild</span>(root);<br>    <span class="hljs-comment">// æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ </span><br>    XMLElement *student=document.<span class="hljs-built_in">NewElement</span>(<span class="hljs-string">&quot;Student&quot;</span>);<br>    <span class="hljs-comment">// è®¾ç½®å…ƒç´ å±æ€§</span><br>    student-&gt;<span class="hljs-built_in">SetAttribute</span>(<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;XiaoMing&quot;</span>);<br>    student-&gt;<span class="hljs-built_in">SetAttribute</span>(<span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-number">16</span>);<br>    XMLElement *stu_0=document.<span class="hljs-built_in">NewElement</span>(<span class="hljs-string">&quot;Hobby&quot;</span>);<br>    stu_0-&gt;<span class="hljs-built_in">SetText</span>(<span class="hljs-string">&quot;Play Football&quot;</span>);<br>    <span class="hljs-comment">// æ’å…¥å­èŠ‚ç‚¹</span><br>    student-&gt;<span class="hljs-built_in">InsertFirstChild</span>(stu_0);<br>    XMLElement *teacher=document.<span class="hljs-built_in">NewElement</span>(<span class="hljs-string">&quot;Teacher&quot;</span>);<br>    teacher-&gt;<span class="hljs-built_in">SetText</span>(<span class="hljs-string">&quot;I am a teacher&quot;</span>);<br>    <span class="hljs-comment">// åˆ é™¤å±æ€§</span><br>    student-&gt;<span class="hljs-built_in">DeleteAttribute</span>(<span class="hljs-string">&quot;age&quot;</span>);<br>    root-&gt;<span class="hljs-built_in">InsertFirstChild</span>(student);<br>    root-&gt;<span class="hljs-built_in">InsertEndChild</span>(teacher);<br>    <span class="hljs-comment">// ä¿å­˜æ–‡ä»¶</span><br>    document.<span class="hljs-built_in">SaveFile</span>(filename);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¦æ‰“å°XMLæ–‡æ¡£çš„å†…å®¹åˆ°æ ‡å‡†è¾“å‡ºï¼Œå¯ä»¥ç”¨ <strong>XMLPrinter</strong> ç±»ï¼Œå…¶æ„é€ å‡½æ•°ä¸º</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">/** Construct the printer. If the FILE* is specified,</span><br><span class="hljs-comment">    this will print to the FILE. Else it will print</span><br><span class="hljs-comment">    to memory, and the result is available in CStr().</span><br><span class="hljs-comment">    If &#x27;compact&#x27; is set to true, then output is created</span><br><span class="hljs-comment">    with only required whitespace and newlines.</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-built_in">XMLPrinter</span>( FILE* file=<span class="hljs-number">0</span>, <span class="hljs-keyword">bool</span> compact = <span class="hljs-literal">false</span>, <span class="hljs-keyword">int</span> depth = <span class="hljs-number">0</span> );<br><br></code></pre></div></td></tr></table></figure><p>è°ƒç”¨å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">XMLPrinter printer;<br>document.<span class="hljs-built_in">Print</span>( &amp;printer );<br>cout&lt;&lt;printer.<span class="hljs-built_in">CStr</span>()&lt;&lt;endl;<br></code></pre></div></td></tr></table></figure><p>å…³äº XMLHandle çš„ä½œç”¨ï¼Œå®˜ç½‘ä¹Ÿè¯´å¾—å¾ˆæ¸…æ¥šï¼Œå‡å¦‚æœ‰ä¸€ä¸‹xml</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">Document</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Element</span> <span class="hljs-attr">attributeA</span> = <span class="hljs-string">&quot;valueA&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">attributeB</span> = <span class="hljs-string">&quot;value1&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">attributeB</span> = <span class="hljs-string">&quot;value2&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Element</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Document</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>å¦‚æœè¦è·å– attributeB å±æ€§çš„å€¼ â€œvalue2â€ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé€šè¿‡å¦‚ä¸‹æ–¹æ³•è·å–æœ€ç»ˆçš„å€¼</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">XMLElement* root = document.<span class="hljs-built_in">FirstChildElement</span>( <span class="hljs-string">&quot;Document&quot;</span> );<br><span class="hljs-keyword">if</span> ( root )<br>&#123;<br>    XMLElement* element = root-&gt;<span class="hljs-built_in">FirstChildElement</span>( <span class="hljs-string">&quot;Element&quot;</span> );<br>    <span class="hljs-keyword">if</span> ( element )<br>    &#123;<br>        XMLElement* child = element-&gt;<span class="hljs-built_in">FirstChildElement</span>( <span class="hljs-string">&quot;Child&quot;</span> );<br>        <span class="hljs-keyword">if</span> ( child )<br>        &#123;<br>            XMLElement* child2 = child-&gt;<span class="hljs-built_in">NextSiblingElement</span>( <span class="hljs-string">&quot;Child&quot;</span> );<br>            <span class="hljs-keyword">if</span> ( child2 )<br>            &#123;<br>                <span class="hljs-comment">// Finally do something useful.</span><br></code></pre></div></td></tr></table></figure><p>æ¯ä¸€æ­¥éƒ½å¿…é¡»åˆ¤æ–­æ˜¯å¦ä¸ºç©ºæŒ‡é’ˆï¼Œè¿™æ ·çš„è¯ä»£ç å°±æ˜¾å¾—ååˆ†ç¹çï¼Œ<br />äºæ˜¯ XMLHandle æä¾›äº†è¿™æ ·ä¸€ç§æ–¹æ³•</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">XMLHandle <span class="hljs-title">docHandle</span><span class="hljs-params">( &amp;document )</span></span>;<br>XMLElement* child2 = docHandle.<span class="hljs-built_in">FirstChildElement</span>( <span class="hljs-string">&quot;Document&quot;</span> ).<span class="hljs-built_in">FirstChildElement</span>( <span class="hljs-string">&quot;Element&quot;</span> ).<span class="hljs-built_in">FirstChildElement</span>().<span class="hljs-built_in">NextSiblingElement</span>();<br><span class="hljs-keyword">if</span> ( child2 )<br>&#123;<br>    <span class="hljs-comment">// do something useful</span><br></code></pre></div></td></tr></table></figure><p>è¿™æ ·çš„è¯ï¼Œå°±ä¸ç”¨æ¯æ­¥éƒ½è¿›è¡Œä¸€æ¬¡åˆ¤æ–­äº†ã€‚å¦‚æœåœ¨è¿™ä¸­é—´è¿‡ç¨‹ä¸­è¿”å›äº†ç©ºæŒ‡é’ˆï¼Œé‚£ä¹ˆç»“æœå°±æ˜¯ç©ºæŒ‡é’ˆï¼Œåªæœ‰æ¯ä¸€æ­¥éƒ½æ­£ç¡®ï¼Œç»“æœæ‰æ­£ç¡®ã€‚</p><p>æ€è€ƒä»¥ä¸‹ä»£ç ï¼Œçœ‹çœ‹é‚£ä¸ªä»£ç å†™æ³•æ­£ç¡®ï¼Ÿ</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">if</span>(document.<span class="hljs-built_in">FirstChildElement</span>(<span class="hljs-string">&quot;notPeople&quot;</span>)-&gt;<span class="hljs-built_in">FirstChildElement</span>(<span class="hljs-string">&quot;Student&quot;</span>))&#123;<br>    cout&lt;&lt;document.<span class="hljs-built_in">FirstChildElement</span>(<span class="hljs-string">&quot;People&quot;</span>)-&gt;<span class="hljs-built_in">FirstChildElement</span>(<span class="hljs-string">&quot;Student&quot;</span>)-&gt;<span class="hljs-built_in">Value</span>()&lt;&lt;endl;<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">XMLHandle <span class="hljs-title">handle</span><span class="hljs-params">(&amp;document)</span></span>; <br> <span class="hljs-keyword">if</span>(handle.<span class="hljs-built_in">FirstChildElement</span>(<span class="hljs-string">&quot;notPeople&quot;</span>).<span class="hljs-built_in">FirstChildElement</span>(<span class="hljs-string">&quot;Student&quot;</span>).<span class="hljs-built_in">ToElement</span>())&#123;<br>    cout&lt;&lt;document.<span class="hljs-built_in">FirstChildElement</span>(<span class="hljs-string">&quot;People&quot;</span>)-&gt;<span class="hljs-built_in">FirstChildElement</span>(<span class="hljs-string">&quot;Student&quot;</span>)-&gt;<span class="hljs-built_in">Value</span>()&lt;&lt;endl;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>Bye~</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Libxml2è§£æXMLæ–‡ä»¶</title>
    <link href="/linux-libxml2/"/>
    <url>/linux-libxml2/</url>
    
    <content type="html"><![CDATA[<p>Libxml2æ˜¯ç”±Cè¯­è¨€å¼€å‘çš„ä¸€ä¸ªåº“ï¼Œé™¤äº†è§£æXMLæ–‡æ¡£å¤–ï¼Œè¿˜å¯ä»¥è§£æHTMLæ–‡æ¡£ï¼ˆä¸è¿‡è¿™æˆ‘æ²¡æœ‰ç ”ç©¶ï¼‰ã€‚åŒæ—¶ï¼Œlibxml2åº“å¯ç§»æ¤äºå¤šä¸ªå¹³å°<br />å¤§è‡´å¯ä¸è¿è¡Œåœ¨å¦‚ä¸‹å¹³å°ï¼š Linux, Unix, Windows, CygWin, MacOS, MacOS X, RISC Os, OS/2, VMS, QNX, MVS, VxWorks</p><span id="more"></span><p>å¯ä»¥ä»å®˜ç½‘ï¼š <a href="http://xmlsoft.org">http://xmlsoft.org</a> è·å–æœ€æ–°ç‰ˆæœ¬ï¼ˆ2.9.8ï¼‰çš„libxml2åº“ã€‚Linuxä¸‹ç¼–è¯‘ä¹Ÿå¾ˆç®€å•<br />./configure<br />make<br />make install</p><p>å®˜ç½‘ä¸Šä¹Ÿæœ‰ä¸€äº›ä¾‹å­ï¼Œä»¥åŠAPIæ¥å£æ–‡æ¡£ï¼Œå¸¸è§é—®é¢˜ï¼ŒTutorialï¼Œå»ºè®®å»çœ‹çœ‹ã€‚ä¹Ÿå¯ä»¥ä»ä¸‹è½½çš„æºæ–‡ä»¶ç›®å½•docä¸­ç¦»çº¿æµè§ˆ</p><p>libxml2åº“å›Šæ‹¬äº†ä»¥ä¸‹çš„æ¨¡å—ï¼Œ</p><h4 id="table-of-contents"><a class="markdownIt-Anchor" href="#table-of-contents"></a> Table of Contents</h4><p><strong>DOCBparser</strong>: old DocBook SGML parser<br /><strong>HTMLparser</strong>: interface for an HTML 4.0 non-verifying parser<br /><strong>HTMLtree</strong>: specific APIs to process HTML tree, especially serialization<br /><strong>SAX</strong>: Old SAX version 1 handler, deprecated<br /><strong>SAX2</strong>: SAX2 parser interface used to build the DOM tree<br /><strong>c14n</strong>: Provide Canonical XML and Exclusive XML Canonicalization<br /><strong>catalog</strong>: interfaces to the Catalog handling system<br /><strong>chvalid</strong>: Unicode character range checking<br /><strong>debugXML</strong>: Tree debugging APIs<br /><strong>dict</strong>: string dictionary<br /><strong>encoding</strong>: interface for the encoding conversion functions<br /><strong>entities</strong>: interface for the XML entities handling<br /><strong>globals</strong>: interface for all global variables of the library<br /><strong>hash</strong>: Chained hash tables<br /><strong>list</strong>: lists interfaces<br /><strong>nanoftp</strong>: minimal FTP implementation<br /><strong>nanohttp</strong>: minimal HTTP implementation<br /><strong>parser</strong>: the core parser module<br /><strong>parserInternals</strong>: internals routines and limits exported by the parser.<br /><strong>pattern</strong>: pattern expression handling<br /><strong>relaxng</strong>: implementation of the Relax-NG validation<br /><strong>schemasInternals</strong>: internal interfaces for XML Schemas<br /><strong>schematron</strong>: XML Schemastron implementation<br /><strong>threads</strong>: interfaces for thread handling<br /><strong>tree</strong>: interfaces for tree manipulation<br /><strong>uri</strong>: library of generic URI related routines<br /><strong>valid</strong>: The DTD validation<br /><strong>xinclude</strong>: implementation of XInclude<br /><strong>xlink</strong>: unfinished XLink detection module<br /><strong>xmlIO</strong>: interface for the I/O interfaces used by the parser<br /><strong>xmlautomata</strong>: API to build regexp automata<br /><strong>xmlerror</strong>: error handling<br /><strong>xmlexports</strong>: macros for marking symbols as exportable/importable.<br /><strong>xmlmemory</strong>: interface for the memory allocator<br /><strong>xmlmodule</strong>: dynamic module loading<br /><strong>xmlreader</strong>: the XMLReader implementation<br /><strong>xmlregexp</strong>: regular expressions handling<br /><strong>xmlsave</strong>: the XML document serializer<br /><strong>xmlschemas</strong>: incomplete XML Schemas structure implementation<br /><strong>xmlschemastypes</strong>: implementation of XML Schema Datatypes<br /><strong>xmlstring</strong>: set of routines to process strings<br /><strong>xmlunicode</strong>: Unicode character APIs<br /><strong>xmlversion</strong>: compile-time version informations<br /><strong>xmlwriter</strong>: text writing API for XML<br /><strong>xpath</strong>: XML Path Language implementation<br /><strong>xpathInternals</strong>: internal interfaces for XML Path Language implementation<br /><strong>xpointer</strong>: API to handle XML Pointers</p><p>å› ä¸ºlibxml2åŒ…å«å¤§é‡å‡½æ•°ï¼Œå®ç°æœ‰ä¸åŒçš„æ–¹å¼ã€‚è¿™é‡Œä»‹ç»ä¸€äº›å¸¸ç”¨çš„ã€‚è‡³äºå…¶ä»–çš„åŠŸèƒ½æœ‰å…´è¶£è‡ªå·±ç ”ç©¶å§â€¦â€¦<br />è€Œè¿™é‡Œä¸»è¦ç”¨åˆ°çš„ä¸º parserï¼Œtreeï¼Œxmlreaderï¼Œxmlwriter è¿™å‡ ä¸ªæ¨¡å—</p><h3 id="parsertree"><a class="markdownIt-Anchor" href="#parsertree"></a> parser/tree</h3><h4 id="è¯»å–xmlæ–‡æ¡£"><a class="markdownIt-Anchor" href="#è¯»å–xmlæ–‡æ¡£"></a> è¯»å–XMLæ–‡æ¡£</h4><p>é¦–å…ˆä»‹ç»xmlæ–‡æ¡£çš„è§£æå§ï¼Œå¤§è‡´è°ƒç”¨å‡½æ•°å¦‚ä¸‹</p><ul><li>xmlReadFile/xmlParseFile æ‰“å¼€ä¸€ä¸ªXMLæ–‡æ¡£å¹¶è¿”å›ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡æŒ‡é’ˆxmlDocPtr</li><li>xmlDocGetRootElement è·å–XMLæ–‡æ¡£çš„æ ¹èŠ‚ç‚¹xmlNodePtr</li><li>è·å–æ ¹èŠ‚ç‚¹ï¼Œä»¥åŠchildNodeçš„åç§°ã€å±æ€§å/å€¼ã€‚è€Œè¿™ä¸€æ­¥éª¤å¯ä»¥é€šè¿‡é€’å½’å®ç°ã€‚</li><li>æœ€åç”± xmlFreeDocã€xmlCleanupParser é‡Šæ”¾æ‰€æœ‰åˆ†é…çš„å†…å­˜</li></ul><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªä¾‹å­ï¼ˆC++ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;libxml/parser.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;libxml/tree.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \param depth  é€’å½’æ·±åº¦</span><br><span class="hljs-comment">/// \param _xmlNodePtr èŠ‚ç‚¹å¯¹è±¡æŒ‡é’ˆ</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ParserXML</span><span class="hljs-params">(<span class="hljs-keyword">int</span> &amp;depth,xmlNodePtr _xmlNodePtr)</span></span>&#123;<br>    <span class="hljs-keyword">bool</span> ishas_child=<span class="hljs-literal">false</span>;<br>    <span class="hljs-comment">// æ‰€æœ‰å­èŠ‚ç‚¹</span><br>    xmlNodePtr xmlNodePtr1= _xmlNodePtr-&gt;children;<br>    <span class="hljs-keyword">int</span> count=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (xmlNodePtr1)&#123;<br>        <span class="hljs-comment">// åˆ¤æ–­èŠ‚ç‚¹ç±»å‹</span><br>        <span class="hljs-keyword">if</span>(xmlNodePtr1-&gt;type!=XML_TEXT_NODE)&#123;<br>        <span class="hljs-comment">// xmlStrcmp(xmlNodePtr1-&gt;name,BAD_CAST &quot;text&quot;)</span><br>            count++;<br>            <span class="hljs-comment">// å­èŠ‚ç‚¹ä¸ªæ•°</span><br>            <span class="hljs-keyword">int</span> childEleCount= <span class="hljs-built_in">xmlChildElementCount</span>(xmlNodePtr1);<br>            cout.<span class="hljs-built_in">width</span>(depth);<br>            <span class="hljs-keyword">if</span>(childEleCount==<span class="hljs-number">0</span>)&#123;<br>                ishas_child=<span class="hljs-literal">false</span>;<br>                <span class="hljs-comment">// è¡¨æ˜æ— å­èŠ‚ç‚¹</span><br>                cout&lt;&lt;count&lt;&lt;<span class="hljs-string">&quot;.&quot;</span>&lt;&lt;xmlNodePtr1-&gt;name&lt;&lt;<span class="hljs-string">&quot; --&gt; &quot;</span>&lt;&lt;<span class="hljs-built_in">xmlNodeGetContent</span>(xmlNodePtr1)&lt;&lt;endl;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                ishas_child=<span class="hljs-literal">true</span>;<br>                <span class="hljs-comment">// è¡¨æ˜æœ‰å­èŠ‚ç‚¹</span><br>                cout&lt;&lt;count&lt;&lt;<span class="hljs-string">&quot;.&quot;</span>&lt;&lt;xmlNodePtr1-&gt;name&lt;&lt;endl;<br>            &#125;<br>            <span class="hljs-comment">// éå†èŠ‚ç‚¹å±æ€§</span><br>            xmlAttr* xmlAttr1=xmlNodePtr1-&gt;properties;<br>            <span class="hljs-keyword">if</span>(xmlAttr1)&#123;<br>                cout.<span class="hljs-built_in">width</span>(depth+<span class="hljs-number">1</span>);<br>                cout&lt;&lt;<span class="hljs-string">&quot;=&gt;&quot;</span>;<br>                <span class="hljs-keyword">while</span> (xmlAttr1!=<span class="hljs-literal">NULL</span>)&#123;<br>                    <span class="hljs-comment">// åˆ¤æ–­ä½¿ç”¨å­˜åœ¨å±æ€§ ï¼Œ xmlGetPropè·å–å±æ€§å€¼</span><br>                    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">xmlHasProp</span>(xmlNodePtr1,xmlAttr1-&gt;name))&#123;<br>                        cout&lt;&lt;<span class="hljs-string">&quot; &quot;</span>&lt;&lt;xmlAttr1-&gt;name&lt;&lt;<span class="hljs-string">&quot;:&quot;</span>&lt;&lt;<br>                            <span class="hljs-built_in">xmlGetProp</span>(xmlNodePtr1,xmlAttr1-&gt;name);<br>                    &#125;<br>                    xmlAttr1=xmlAttr1-&gt;next;<br>                &#125;<br>                cout&lt;&lt;endl;<br>            &#125;<br>            <span class="hljs-comment">// é€’å½’è°ƒç”¨</span><br>            <span class="hljs-keyword">if</span>(ishas_child)&#123;<br>                depth+=<span class="hljs-number">10</span>;<br>                <span class="hljs-built_in">ParserXML</span>(depth,xmlNodePtr1);<br>            &#125;<br>        &#125;<br>        xmlNodePtr1=xmlNodePtr1-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(depth&gt;<span class="hljs-number">0</span>)&#123;<br>        depth-=<span class="hljs-number">10</span>;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc,<span class="hljs-keyword">char</span>** argv)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span>(argc!=<span class="hljs-number">2</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    xmlDocPtr xmlDocPtr1=<span class="hljs-literal">NULL</span>;<br>    <span class="hljs-comment">//xmlDocPtr1=xmlParseFile(argv[1]);</span><br>    <span class="hljs-built_in">xmlInitParser</span>();<br>    <span class="hljs-comment">// è¯»å–æ–‡ä»¶</span><br>    xmlDocPtr1=<span class="hljs-built_in">xmlReadFile</span>(argv[<span class="hljs-number">1</span>],<span class="hljs-string">&quot;UTF-8&quot;</span>,<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span>(xmlDocPtr1==<span class="hljs-literal">NULL</span>) &#123;<br>        xmlErrorPtr xmlErrorPtr1 =<span class="hljs-built_in">xmlGetLastError</span>();<br>        cout &lt;&lt; xmlErrorPtr1-&gt;message &lt;&lt; endl;<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br>    &#125;<br>    cout&lt;&lt;<span class="hljs-string">&quot;Version: &quot;</span>&lt;&lt;xmlDocPtr1-&gt;version&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;Encoding: &quot;</span>&lt;&lt;xmlDocPtr1-&gt;encoding&lt;&lt;endl;<br>    <span class="hljs-comment">// è·å–æ ¹èŠ‚ç‚¹</span><br>    xmlNodePtr xmlNodePtr1= <span class="hljs-built_in">xmlDocGetRootElement</span>(xmlDocPtr1);<br>    cout&lt;&lt;<span class="hljs-string">&quot;Root Element: &quot;</span>&lt;&lt;xmlNodePtr1-&gt;name&lt;&lt;endl&lt;&lt;endl;<br>    <span class="hljs-comment">// éå†æ‰€æœ‰ä¿¡æ¯</span><br>    <span class="hljs-keyword">int</span> depth=<span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">ParserXML</span>(depth,xmlNodePtr1);<br>    <span class="hljs-comment">// é‡Šæ”¾å†…å­˜</span><br>    <span class="hljs-built_in">xmlFreeDoc</span>(xmlDocPtr1);<br>    <span class="hljs-built_in">xmlCleanupParser</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æœ‰å¦‚ä¸‹ test.xml æ–‡æ¡£</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">People</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Student</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;0x00000000&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Jack<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">age</span>&gt;</span>14<span class="hljs-tag">&lt;/<span class="hljs-name">age</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">sex</span>&gt;</span>Man<span class="hljs-tag">&lt;/<span class="hljs-name">sex</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">hobby</span>&gt;</span>Computer Programming<span class="hljs-tag">&lt;/<span class="hljs-name">hobby</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Student</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Student</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;0x11111111&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Tony<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">age</span>&gt;</span>17<span class="hljs-tag">&lt;/<span class="hljs-name">age</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">sex</span>&gt;</span>Man<span class="hljs-tag">&lt;/<span class="hljs-name">sex</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">hobby</span>&gt;</span>Play Basketball<span class="hljs-tag">&lt;/<span class="hljs-name">hobby</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Student</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Student</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;0x22222222&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Job<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">age</span>&gt;</span>20<span class="hljs-tag">&lt;/<span class="hljs-name">age</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">sex</span>&gt;</span>Man<span class="hljs-tag">&lt;/<span class="hljs-name">sex</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">hobby</span>&gt;</span>Play Football<span class="hljs-tag">&lt;/<span class="hljs-name">hobby</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Student</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">People</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>ç¼–è¯‘è¿è¡Œ g++ main.cpp -o main <code>xml2-config â€“libs â€“cflags</code>&amp;&amp; ./main test.xml</p><p>è¾“å‡ºä¿¡æ¯</p><figure class="highlight excel"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs excel">Versi<span class="hljs-symbol">on:</span> <span class="hljs-number">1.0</span><br>Encodi<span class="hljs-symbol">ng:</span> UTF-<span class="hljs-number">8</span><br>ROOT Eleme<span class="hljs-symbol">nt:</span> People<br><span class="hljs-number">1</span>.Student<br>=&gt; <span class="hljs-symbol">id:0</span>x00000000<br>         <span class="hljs-number">1</span>.name --&gt; Jack<br>         <span class="hljs-number">2</span>.age --&gt; <span class="hljs-number">14</span><br>         <span class="hljs-number">3</span>.sex --&gt; Man<br>         <span class="hljs-number">4</span>.hobby --&gt; Computer Programming<br><span class="hljs-number">2</span>.Student<br>=&gt; <span class="hljs-symbol">id:0</span>x11111111<br>         <span class="hljs-number">1</span>.name --&gt; Tony<br>         <span class="hljs-number">2</span>.age --&gt; <span class="hljs-number">17</span><br>         <span class="hljs-number">3</span>.sex --&gt; Man<br>         <span class="hljs-number">4</span>.hobby --&gt; Play Basketball<br><span class="hljs-number">3</span>.Student<br>=&gt; <span class="hljs-symbol">id:0</span>x22222222<br>         <span class="hljs-number">1</span>.name --&gt; Job<br>         <span class="hljs-number">2</span>.age --&gt; <span class="hljs-number">20</span><br>         <span class="hljs-number">3</span>.sex --&gt; Man<br>         <span class="hljs-number">4</span>.hobby --&gt; Play Football<br><br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒæˆåŠŸçš„è§£æxmlæ–‡æ¡£å¹¶æ ¼å¼åŒ–çš„è¾“å‡ºä¿¡æ¯ã€‚è¿™ä¸ªä¾‹å­çš„æ ¸å¿ƒä»£ç å°±æ˜¯é‚£ä¸ªé€’å½’å‡½æ•°ã€‚ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒåˆ°åº•å¹²äº†äº›ä»€ä¹ˆã€‚<br />ä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œå…ˆè°ˆè°ˆ <strong>xmlParseFile</strong> å’Œ <strong>xmlReadFile</strong> çš„åŒºåˆ«ã€‚å®ƒä»¬éƒ½æ˜¯æ‰“å¼€ä¸€ä¸ªXMLæ–‡æ¡£å¹¶è¿”å›ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡æŒ‡é’ˆ <strong>xmlDocPtr</strong> ï¼Œä¸åŒä¹‹å¤„å°±åœ¨äºå®ƒä»¬æä¾›çš„å‚æ•°ä¸åŒ</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">xmlDocPtr <span class="hljs-title">xmlParseFile</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename)</span></span>;<br><span class="hljs-function">xmlDocPtr <span class="hljs-title">xmlReadFile</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *URL,**<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *encoding**,<span class="hljs-keyword">int</span> options)</span></span>;<br></code></pre></div></td></tr></table></figure><p>xmlReadFile ä»¥æŒ‡å®šçš„ç¼–ç æ ¼å¼æ‰“å¼€xmlæ–‡æ¡£ï¼Œè€Œ xmlParseFile é»˜è®¤ä»¥UTF-8ç¼–ç æ ¼å¼æ‰“å¼€æ–‡æ¡£ã€‚<br />æ¯”å¦‚ï¼Œåˆšæ‰çš„test.xml <strong><?xml version=â€1.0â€ encoding=â€UTF-8â€?></strong> ä¸­é€šè¿‡encodingæŒ‡å®šäº†UTF-8ç¼–ç æ ¼å¼ï¼Œé‚£ä¹ˆç”¨ xmlParseFile èƒ½æˆåŠŸè§£æï¼Œç”¨ xmlReadFile å‡½æ•°æ— è®º<br /><strong>const char *encoding</strong> å‚æ•°ä¸ºNULLè¿˜æ˜¯â€œUTF-8â€ ä¹Ÿèƒ½æˆåŠŸè§£æã€‚<br />ä½†æ˜¯ test.xml åªæœ‰ <strong><?xml version=â€1.0?></strong> é‚£ä¹ˆ xmlParseFile ä¼šè§£æå¤±è´¥ï¼Œè€Œ xmlReadFile åªæœ‰ ç¬¬äºŒä¸ªå‚æ•°ä¸º â€œUTF-8â€æ—¶æ‰èƒ½è§£ææˆåŠŸã€‚</p><p>å¥½äº†ï¼Œç»§ç»­çœ‹é‚£ä¸ªé€’å½’å‡½æ•°å§ã€‚ã€‚ã€‚<br />é¦–å…ˆç”¨ <strong>xmlNodePtr xmlNodePtr1= _xmlNodePtr-&gt;children;</strong> è·å–çš„ _xmlNodePtr èŠ‚ç‚¹çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œç„¶ååœ¨whileå¾ªç¯ä¸­åˆ¤æ–­æ¯ä¸ªå­èŠ‚ç‚¹çš„ç±»å‹ï¼Œ<strong>xmlNodePtr1-&gt;type!=XML_TEXT_NODE</strong> å¦‚æœä¸æ˜¯ XML_TEXT_NODE é‚£å°±ç»§ç»­ã€‚æ¥ç€ ç”¨ <strong>xmlChildElementCount</strong> è·å– xmlNodePtr1 èŠ‚ç‚¹æŒ‡é’ˆçš„æ‰€æœ‰å­èŠ‚ç‚¹ä¸ªæ•°ï¼Œå¹¶ç”¨ä¸€ä¸ª <strong>ishas_child</strong> æ ‡è¯†æ˜¯å¦å­˜åœ¨å­èŠ‚ç‚¹ï¼Œå¯¹äºå­˜åœ¨å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼Œå°±è¿›è¡Œ<strong>é€’å½’</strong>ã€‚ç„¶åæ˜¾ç¤ºäº†èŠ‚ç‚¹çš„å±æ€§ï¼Œé€šè¿‡ <strong>xmlHasProp</strong> åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŒ‡å®šåå­—çš„å±æ€§ï¼Œå­˜åœ¨ç”¨ <strong>xmlGetProp</strong> è·å–å…¶å€¼ã€‚æ³¨æ„ï¼Œæˆ‘è·å–äº† ä¸€ä¸ªå±æ€§å¯¹è±¡ï¼ˆé“¾è¡¨ï¼‰ <code>xmlAttr* xmlAttr1=xmlNodePtr1-&gt;properties</code> ä¹‹åè¿›è¡Œéå†ã€‚åœ¨libxml2ä¸­ï¼ŒxmlNodeã€xmlDocã€xmlAttr éƒ½æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚<br />ä¹‹åè¿›å…¥é€’å½’ï¼Œdepth åªæ˜¯è¡¨ç¤ºæ·±åº¦ï¼Œç”¨äºæ ¼å¼åŒ–è¾“å‡º<br />if(ishas_child){<br />depth+=10;<br />ParserXML(depth,xmlNodePtr1);<br />}<br />åœ¨è¿›å…¥çš„æ¯ä¸ªé€’å½’å‡½æ•°æ‰§è¡Œç»“æŸä¹‹å‰å‡å»åˆšæ‰è¿›å…¥çš„æ·±åº¦<br />if(depth&gt;0){<br />depth-=10;<br />}</p><p>æ¥ä¸‹æ¥å°±æ˜¯ç”ŸæˆXMLæ–‡æ¡£ã€‚ã€‚ã€‚</p><h4 id="ç”Ÿæˆxmlæ–‡æ¡£"><a class="markdownIt-Anchor" href="#ç”Ÿæˆxmlæ–‡æ¡£"></a> ç”ŸæˆXMLæ–‡æ¡£</h4><p>ç”Ÿæˆå°±ç®€å•ä¸€äº›äº†ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;libxml/parser.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;libxml/tree.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">GenerateXML</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename)</span></span>&#123;<br>    xmlDocPtr xmlDocPtr1= <span class="hljs-built_in">xmlNewDoc</span>(BAD_CAST XML_DEFAULT_VERSION);<br>    <span class="hljs-keyword">if</span>(!xmlDocPtr1)&#123;<br>        cout&lt;&lt;<span class="hljs-string">&quot;ERROR: &quot;</span>&lt;&lt;<span class="hljs-built_in">xmlGetLastError</span>()-&gt;message&lt;&lt;endl;<br>    &#125;<br>    <span class="hljs-comment">// åˆ›å»ºæ ¹èŠ‚ç‚¹</span><br>    xmlNodePtr xmlRootPtr=<span class="hljs-built_in">xmlNewNode</span>(<span class="hljs-literal">NULL</span>,BAD_CAST<span class="hljs-string">&quot;Root&quot;</span>);<br>    <span class="hljs-built_in">xmlDocSetRootElement</span>(xmlDocPtr1,xmlRootPtr);<br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–‡æœ¬å­èŠ‚ç‚¹ï¼Œçˆ¶èŠ‚ç‚¹ä¸º xmlRootPtr</span><br>    xmlNodePtr  xmlNodePtr1= <span class="hljs-built_in">xmlNewTextChild</span>(xmlRootPtr,<span class="hljs-literal">NULL</span>,BAD_CAST<span class="hljs-string">&quot;Management&quot;</span>,BAD_CAST<span class="hljs-string">&quot;None&quot;</span>);<br>    <span class="hljs-comment">// æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹ï¼Œçˆ¶èŠ‚ç‚¹ä¸º xmlNodePtr1</span><br>    <span class="hljs-built_in">xmlNewTextChild</span>(xmlNodePtr1,<span class="hljs-literal">NULL</span>,BAD_CAST<span class="hljs-string">&quot;Score&quot;</span>,BAD_CAST<span class="hljs-string">&quot;None&quot;</span>);<br>    <br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹</span><br>    xmlNodePtr xmlAnimalPtr= <span class="hljs-built_in">xmlNewNode</span>(<span class="hljs-literal">NULL</span>,BAD_CAST<span class="hljs-string">&quot;Animals&quot;</span>);<br>    <span class="hljs-built_in">xmlAddChild</span>(xmlRootPtr,xmlAnimalPtr);<br>    <span class="hljs-comment">// åˆ›å»ºå…ƒç´ </span><br>    xmlAttrPtr xmlAttrPtr1= <span class="hljs-built_in">xmlNewProp</span>(xmlAnimalPtr,BAD_CAST<span class="hljs-string">&quot;Number&quot;</span>,BAD_CAST<span class="hljs-string">&quot;888&quot;</span>);<br>    <span class="hljs-built_in">xmlSetProp</span>(xmlAnimalPtr,BAD_CAST<span class="hljs-string">&quot;Number&quot;</span>,BAD_CAST<span class="hljs-string">&quot;9999&quot;</span>);<br><span class="hljs-comment">//    xmlNodeSetName(xmlAnimalPtr,BAD_CAST&quot;The_Animal&quot;);</span><br><span class="hljs-comment">//    xmlRemoveProp(xmlAttrPtr1);</span><br>    <span class="hljs-comment">// ä¿å­˜æ–‡ä»¶</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">xmlSaveFileEnc</span>(filename,xmlDocPtr1,<span class="hljs-string">&quot;UTF-8&quot;</span>))&#123;<br>        cout&lt;&lt;<span class="hljs-string">&quot;ç”Ÿæˆ XML æ–‡ä»¶æˆåŠŸï¼&quot;</span>&lt;&lt;endl;<br>    &#125;<br>    <span class="hljs-comment">// é‡Šæ”¾å†…å­˜</span><br>    <span class="hljs-built_in">xmlFreeDoc</span>(xmlDocPtr1);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">GenerateXML</span>(<span class="hljs-string">&quot;test.xml&quot;</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œé€šç”¨çš„åšæ³•ä¸º <strong>xmlNewDoc</strong> åˆ›å»ºä¸€ä¸ªæ–°çš„XMLæ–‡æ¡£å¹¶è¿”å›ä¸€ä¸ª xmlDocPtr ï¼Œåˆ›å»ºä¸€ä¸ªæ ¹èŠ‚ç‚¹å°±æ˜¯åˆ›å»ºä¸€ä¸ª xmlNodePtr å¹¶é€šè¿‡ <strong>xmlDocSetRootElement</strong> è®¾ç½® xmlDocPtr çš„æ ¹èŠ‚ç‚¹ä¸º xmlNodePtr ã€‚ä¹‹ååœ¨ç»§ç»­æ·»åŠ å­èŠ‚ç‚¹æ—¶ï¼Œåªéœ€åœ¨ xmlNodePtr çš„åŸºç¡€ä¸Šåˆ›å»ºæ–°èŠ‚ç‚¹å¹¶æ·»åŠ å³å¯ã€‚</p><p><strong>xmlNewTextChild</strong> å‡½æ•°ç”¨äºæ–‡ä»¶ä¸€ä¸ªæ–‡æœ¬å­èŠ‚ç‚¹ã€‚å¦‚ <code>&lt;node&gt;Hello&lt;/node&gt;</code></p><p>åˆ›å»ºæ–°èŠ‚ç‚¹çš„æ–¹æ³•ä¸º <strong>xmlNewNode</strong> å®ƒè¿”å›ä¸€ä¸ª xmlNodePtr ï¼Œä¹‹å <strong>xmlAddChild</strong> æŠŠä¸€ä¸ªèŠ‚ç‚¹æ·»åŠ åˆ°çˆ¶èŠ‚ç‚¹ä¸Šã€‚</p><p>é€šè¿‡ <strong>xmlNewProp</strong> åˆ›å»ºä¸€ä¸ªå±æ€§ xmlAttrPtr ï¼Œä¹‹åå¯é€šè¿‡<br /><strong>xmlSetPropæˆ–xmlNodeSetName</strong> è®¾ç½®å±æ€§çš„å€¼ã€‚åˆ é™¤å±æ€§ <strong>xmlRemoveProp</strong></p><p>æœ€åï¼Œå…¨éƒ¨OKäº†ï¼Œ <strong>xmlSaveFileEnc</strong> æ¥ä¿å­˜XMLæ–‡æ¡£</p><p>ç¼–è¯‘è¿è¡Œç”Ÿæˆtest.xmlï¼Œå¯èƒ½æ ¼å¼æœ‰ç‚¹æ··ä¹±ï¼Œæˆ‘ä¿®æ”¹äº†ä¸€ä¸‹</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Root</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Management</span>&gt;</span>None<br>        <span class="hljs-tag">&lt;<span class="hljs-name">Score</span>&gt;</span>None<span class="hljs-tag">&lt;/<span class="hljs-name">Score</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Management</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Animals</span> <span class="hljs-attr">Number</span>=<span class="hljs-string">&quot;9999&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Root</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>OKï¼ŒåŸºæœ¬ä¸Šè§£æXMLä¹Ÿä¸ç®—å¤ªéš¾ã€‚é™¤äº†libxml2åº“å¤–ï¼Œè¿˜æœ‰å…¶ä»–çš„åº“ä¹Ÿå¯ä»¥è§£æXMLã€‚çœ‹ä¸ªäººçˆ±å¥½äº† ğŸ˜ƒ</p><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++ è°ƒç”¨MongoDB C Driver</title>
    <link href="/cpp-call-mongodb-c-driver/"/>
    <url>/cpp-call-mongodb-c-driver/</url>
    
    <content type="html"><![CDATA[<p>å—¯â€¦â€¦ç¯å¢ƒéƒ½å‡†å¤‡å¥½äº†ï¼Œé‚£ä¹ˆç°åœ¨å¯ä»¥å¼€å§‹ç”¨æˆ‘ä»¬æ•¬çˆ±çš„C++é€šè¿‡æ¥å£æ¥é—´æ¥æ“æ§MongoDBæ•°æ®åº“ã€‚<br />æ³¨æ„ï¼Œè¦æœ‰ä¸€å®šçš„MongoDBæ•°æ®åº“åŸºç¡€çŸ¥è¯†å“¦ï½</p><span id="more"></span><h3 id="å¯åŠ¨mongodbæœåŠ¡å™¨"><a class="markdownIt-Anchor" href="#å¯åŠ¨mongodbæœåŠ¡å™¨"></a> å¯åŠ¨MongoDBæœåŠ¡å™¨</h3><p>é¦–å…ˆè¦åšçš„ï¼Œå°±æ˜¯å¯åŠ¨æœåŠ¡å™¨</p><blockquote><p>mongod --config ${MONGODB}/conf.d/mongo.conf</p></blockquote><p>è¦åœæ­¢æœåŠ¡å™¨ï¼Œä¸å»ºè®®ç›´æ¥<strong>kill</strong>æ‰ï¼Œè€Œæ˜¯åŠ ä¸Šä¸€ä¸ª <strong>â€“shutdown</strong> å‚æ•°</p><p>æˆ‘ä»¬è¿˜è¦åˆ›å»ºä¸€ä¸ªå¯è¯»å†™æŒ‡å®šæ•°æ®åº“çš„ç”¨æˆ·ï¼Œæ¯”å¦‚</p><blockquote><p>use admin<br />db.createUser({user:â€™user_testâ€™,pwd:â€™12345â€™,roles:[{role:â€™readWriteâ€™,db:â€™db_testâ€™}]}</p></blockquote><p>è¿™é‡Œåˆ›å»ºäº†ç”¨æˆ· user_testï¼Œå¯†ç  12345ï¼Œåªèƒ½è¯»å†™æ•°æ®åº“ db_test</p><h3 id="mongoc"><a class="markdownIt-Anchor" href="#mongoc"></a> mongoc</h3><p>æˆ‘ä»¬åªéœ€å¼•ç”¨å¤´æ–‡ä»¶ libmongoc-1.0/mongoc.h<br />åœ¨ <strong>main</strong> å‡½æ•°è¦è°ƒç”¨ <strong>mongoc_init()</strong> æ¥åˆå§‹åŒ–åº“ä»¥åŠç»“å°¾ <strong>mongoc_cleanup()</strong> æ¥é‡Šæ”¾</p><p>è¦è¿æ¥åˆ°MongoDBæ•°æ®åº“ï¼Œå°±å¾—æä¾›ä¸€ä¸ªè¿æ¥å­—ç¬¦ä¸²ï¼Œç±»ä¼¼äº</p><p>mongodb://username:password@host:port/db<br />ä¾‹å¦‚ï¼š mongodb://localhost:27017è¡¨ç¤ºè¿æ¥åˆ°æœ¬åœ°å›ç¯åœ°å€127.0.0.1ï¼Œä»¥åŠç«¯å£27017çš„æœåŠ¡å™¨ï¼Œè¿™ä¸ªè¿æ¥æ–¹å¼æ— éœ€éªŒè¯èº«ä»½(æ²¡æœ‰å¼€å¯ <strong>auth</strong>)ã€‚<br />ç„¶è€Œï¼Œè¿™ä¸ªä¾‹å­çš„è¿æ¥å­—ç¬¦ä¸²ä¸ºï¼š <strong>mongodb://user_test:12345@127.0.0.1:27017/db_test</strong></p><p>æœ‰äº†è¿æ¥å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆè¿æ¥åˆ°æœåŠ¡å™¨ï¼Ÿå¯ä»¥é€šè¿‡ mongoc_client_get_database() æ¥å»ºç«‹ä¸€ä¸ªclient</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">mongoc_client_t</span> * <span class="hljs-title">mongoc_client_new</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *uri_string)</span></span>;<br></code></pre></div></td></tr></table></figure><p>è¯¥å‡½æ•°è¿”å›ä¸€ä¸ª mongoc_client_t* ç»“æ„æŒ‡é’ˆï¼Œä¹‹åçš„æ“ä½œå°±æ˜¯é€šè¿‡è¯¥æŒ‡é’ˆæ¥è®¿é—® databaseã€collectionâ€¦â€¦</p><blockquote><p>é™¤äº†ç›´æ¥é€šè¿‡ä¸€ä¸ªè¿æ¥å­—ç¬¦ä¸²æ¥å»ºç«‹clientï¼Œè¿˜å¯ä»¥â€˜æ„é€ â€™ä¸€ä¸ª <strong>uri</strong> å»ºç«‹clientã€‚è¿™ä¸€æ­¥ä¹Ÿå¾ˆç®€å•ï¼Œå¯ä»¥è°ƒç”¨ <strong>mongoc_uri*</strong> ç³»åˆ—å‡½æ•°ï¼Œå†<br />mongoc_client_new_from_uri()ï¼Œå¦‚ï¼š<br />mongoc_uri_t <em>uri=mongoc_uri_new(â€œmongodb://127.0.0.1:27017â€);<br />mongoc_uri_set_database(uri,â€xxxxâ€);<br />mongoc_uri_set_username(uri,â€xxxxâ€);<br />mongoc_uri_set_password(uri,â€xxxxâ€);<br />mongoc_client_t</em> client= mongoc_client_new_from_uri(uri);</p></blockquote><p>è¿æ¥æˆåŠŸåï¼Œå¯ä»¥é€šè¿‡æ¥è·å– <strong>mongoc_client_get_default_database</strong> æ¥è·å–é»˜è®¤çš„æ•°æ®åº“ï¼ˆå‰ææ˜¯åˆšæ‰è¿æ¥å­—ç¬¦ä¸²æä¾›äº†ä¸€ä¸ªæ•°æ®åº“ï¼‰ï¼Œæˆ–è€… <strong>mongoc_client_get_database</strong> æ¥è·å–æŒ‡å®šåç§°çš„æ•°æ®åº“</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">mongoc_database_t</span> * <span class="hljs-title">mongoc_client_get_database</span> <span class="hljs-params">(<span class="hljs-keyword">mongoc_client_t</span> *client, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *name)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">mongoc_database_t</span> * <span class="hljs-title">mongoc_client_get_default_database</span> <span class="hljs-params">(<span class="hljs-keyword">mongoc_client_t</span> *client)</span></span>;<br></code></pre></div></td></tr></table></figure><p>é€šè¿‡ mongoc_database_has_collection() åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸€ä¸ª collection</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">mongoc_database_has_collection</span> <span class="hljs-params">(<span class="hljs-keyword">mongoc_database_t</span> *database,<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *name,<span class="hljs-keyword">bson_error_t</span> *error)</span></span>;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">bson_error_t</span> &#123;</span><br>   <span class="hljs-keyword">uint32_t</span> domain;<br>   <span class="hljs-keyword">uint32_t</span> code;<br>   <span class="hljs-keyword">char</span> message[BSON_ERROR_BUFFER_SIZE];<br>&#125; <span class="hljs-keyword">bson_error_t</span>;<br></code></pre></div></td></tr></table></figure><p>æœ‰äº†databaseï¼Œé‚£ä¹ˆå°±å¯ä»¥è·å–æŸä¸ªcollectionï¼Œæ–¹æ³•æœ‰ä¸¤ä¸ª</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">mongoc_collection_t</span> * <span class="hljs-title">mongoc_client_get_collection</span> <span class="hljs-params">(<span class="hljs-keyword">mongoc_client_t</span> *client,<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *db,<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *collection)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">mongoc_collection_t</span> *</span><br><span class="hljs-function"><span class="hljs-title">mongoc_database_get_collection</span> <span class="hljs-params">(<span class="hljs-keyword">mongoc_database_t</span> *database, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *name)</span></span>;<br></code></pre></div></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œå°±æ˜¯é‡å¤´æˆäº†</p><h4 id="creating-bson-documents"><a class="markdownIt-Anchor" href="#creating-bson-documents"></a> Creating BSON Documents</h4><p>BSONï¼Œç±»ä¼¼ä¸JSONï¼Œä½†åˆæœ‰ç‚¹ä¸åŒã€‚é€šè¿‡åˆ›å»ºBSON Documentæ¥å®ç°ä¸MongoDBçš„äº¤äº’ã€‚å¦‚ï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&gt; db.test.insert(&#123;&#x27;name&#x27;:&#x27;xiaoming&#x27;,&#x27;age&#x27;:<span class="hljs-number">10</span>,info:[&#x27;shy&#x27;,&#x27;helpful&#x27;]&#125;)<br>&gt; db.test.find().pretty()<br>&#123;<br><span class="hljs-attr">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5a8e1dced077dc147db71f81&quot;</span>),<br><span class="hljs-attr">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaoming&quot;</span>,<br><span class="hljs-attr">&quot;age&quot;</span> : <span class="hljs-number">10</span>,<br><span class="hljs-attr">&quot;info&quot;</span> : [<br><span class="hljs-string">&quot;shy&quot;</span>,<br><span class="hljs-string">&quot;helpful&quot;</span><br>]<br>&#125;<br></code></pre></div></td></tr></table></figure><p>BSONæ–‡æ¡£å°±æœ‰ç‚¹ç±»ä¼¼ä¸ {â€˜nameâ€™:â€™xiaomingâ€™,â€™ageâ€™:10,info:[â€˜shyâ€™,â€™helpfulâ€™]}</p><p>mongocæœ‰å‡ ç§æ–¹å¼åˆ›å»ºBSONæ–‡æ¡£ï¼š <strong>appending key-value pairs, using BCON, or parsing JSON</strong><br />å…¶ä¸­ï¼Œæœ€ç®€å•çš„å°±æ˜¯BCONï¼Œä¸è¿‡å†æ¬¡ä¹‹å‰å…ˆäº†è§£ä¸‹ä½¿ç”¨ bson**ï¼Œåªéœ€å¼•ç”¨ bson.h å³å¯</p><h5 id="bson"><a class="markdownIt-Anchor" href="#bson"></a> bson</h5><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªBSONæ–‡æ¡£</span><br><span class="hljs-keyword">bson_t</span> *doc=<span class="hljs-built_in">bson_new</span>();<br><span class="hljs-comment">// æ·»åŠ ä¸€ä¸ª UTF-8 å­—ç¬¦ä¸²ï¼Œ-1 è¡¨ç¤ºè¯¥å­—ç¬¦ä¸²é•¿åº¦</span><br><span class="hljs-built_in">bson_append_utf8</span>(doc,<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-number">-1</span>,<span class="hljs-string">&quot;xiaodong&quot;</span>,<span class="hljs-number">-1</span>);<br><span class="hljs-comment">// æ·»åŠ ä¸€ä¸ª int32 æ•´æ•°</span><br><span class="hljs-built_in">bson_append_int32</span>(doc,<span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">10</span>);<br><span class="hljs-built_in">BSON_APPEND_UTF8</span>(doc,<span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-string">&quot;xiaoqiang&quot;</span>);<br><span class="hljs-built_in">BSON_APPEND_INT32</span>(doc,<span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-number">11</span>);<br><span class="hljs-comment">// è¿”å›ä¸€ä¸ª JSON å­—ç¬¦ä¸²</span><br><span class="hljs-keyword">char</span> *jsonstr= <span class="hljs-built_in">bson_as_canonical_extended_json</span>(doc,<span class="hljs-literal">NULL</span>);<br><span class="hljs-built_in">printf</span>(jsonstr)<br><span class="hljs-comment">// é‡Šæ”¾ç”± bson_as_canonical_extended_json è¿”å›char *</span><br><span class="hljs-built_in">bson_free</span>(jsonstr);<br><span class="hljs-comment">// é‡Šæ”¾ bson_new åˆ†é…çš„å†…å­˜</span><br><span class="hljs-built_in">bson_destroy</span>(doc);<br></code></pre></div></td></tr></table></figure><p>ç»“æœ<br />{ â€œnameâ€ : â€œxiaodongâ€, â€œageâ€ : { â€œ<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;}&#039; at position 19: â€¦berIntâ€ : â€œ10â€ }Ì², â€œnameâ€ : â€œxiaâ€¦'>numberIntâ€ : â€œ10â€ }, â€œnameâ€ : â€œxiaoqiangâ€, â€œageâ€ : { â€œ</span>numberIntâ€ : â€œ11â€ } }</p><p>å¯é€šè¿‡ bson** ç³»åˆ—å‡½æ•° æˆ–è€… BSON**å® æ¥æ·»åŠ BSONæ–‡æ¡£<br />é€šè¿‡ bson_t è·å– JSON å­—ç¬¦ä¸²ï¼Œå¯ä»¥è°ƒç”¨ä»¥ä¸‹å‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">char</span> * <span class="hljs-title">bson_as_canonical_extended_json</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *bson, <span class="hljs-keyword">size_t</span> *length)</span></span><br><span class="hljs-function"><span class="hljs-keyword">char</span> * <span class="hljs-title">bson_as_json</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *bson, <span class="hljs-keyword">size_t</span> *length)</span></span><br><span class="hljs-function"><span class="hljs-keyword">char</span> * <span class="hljs-title">bson_as_relaxed_extended_json</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *bson, <span class="hljs-keyword">size_t</span> *length)</span></span><br></code></pre></div></td></tr></table></figure><p>å¿…é¡»è¦æœ‰å¯¹åº”çš„ <strong>bson_free()</strong> æ¥é‡Šæ”¾è¯¥åˆ†é…çš„å†…å­˜ï¼›<strong>bson_destroy()</strong> æ¥é‡Šæ”¾ä¸€ä¸ªBSONæ–‡æ¡£</p><h5 id="bcon"><a class="markdownIt-Anchor" href="#bcon"></a> BCON</h5><p>ç”¨ BCON_* å®æ¥æ“æ§BSON Documentæˆ‘è®¤ä¸ºæ›´ç®€å•äº›ï¼Œè€Œä¸”å†™æ³•ä¹Ÿæ›´é«˜çº§ã€‚</p><blockquote><p>BSON C Object Notation, BCON for short, is an alternative way of constructing BSON documents in a manner closer to the intended format. <strong>It has less type-safety than BSONâ€™s append functions but results in less code</strong></p></blockquote><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">bson_t</span> *bson=<span class="hljs-built_in">BCON_NEW</span>(<br>            <span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-built_in">BCON_UTF8</span>(<span class="hljs-string">&quot;xiaoHong&quot;</span>),<br>            <span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-built_in">BCON_INT32</span>(<span class="hljs-number">15</span>),<br>            <span class="hljs-string">&quot;info&quot;</span>,<br>            <span class="hljs-string">&quot;[&quot;</span>,<br>               <span class="hljs-string">&quot;&#123;&quot;</span>,<span class="hljs-string">&quot;country&quot;</span>,<span class="hljs-built_in">BCON_UTF8</span>(<span class="hljs-string">&quot;China&quot;</span>), <span class="hljs-string">&quot;&#125;&quot;</span>,<br>               <span class="hljs-string">&quot;&#123;&quot;</span>,<span class="hljs-string">&quot;phone&quot;</span>,<span class="hljs-built_in">BCON_UTF8</span>(<span class="hljs-string">&quot;110&quot;</span>), <span class="hljs-string">&quot;&#125;&quot;</span>,<br>            <span class="hljs-string">&quot;]&quot;</span><br>);<br></code></pre></div></td></tr></table></figure><p>{ â€œnameâ€ : â€œxiaoHongâ€, â€œageâ€ : { â€œ$numberIntâ€ : â€œ15â€ }, â€œinfoâ€ : [ { â€œcountryâ€ : â€œChinaâ€ }, { â€œphoneâ€ : â€œ110â€ } ] }</p><p>é€šè¿‡ä½¿ç”¨ BCON_* å‡½æ•°æ›´ç›´è§‚ã€æ–¹ä¾¿ç®€å•çš„åˆ›å»ºBSONæ–‡æ¡£ã€‚</p><h4 id="creating-bson-from-json"><a class="markdownIt-Anchor" href="#creating-bson-from-json"></a> Creating BSON from JSON</h4><p>ä¸Šé¢ä»‹ç»äº†åˆ›å»ºä¸€ä¸ªBSONæ–‡æ¡£ä»¥åŠä»BSONæ–‡æ¡£è·å–ä¸€ä¸ªJSONå­—ç¬¦ä¸²ã€‚<br />é‚£ä¹ˆï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥é€šè¿‡JSONå­—ç¬¦ä¸²åå‘è§£æä¸€ä¸ªBSONæ–‡æ¡£å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚ä¸è¿‡ï¼Œè¿™å¥½åƒæ˜¯å¯¹äºå•æ–‡æ¡£è€Œè¨€ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">bson_t</span> * <span class="hljs-title">bson_new_from_json</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span> *data, <span class="hljs-keyword">ssize_t</span> len, <span class="hljs-keyword">bson_error_t</span> *error)</span></span>;<br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *json = <span class="hljs-string">&quot;&#123;\&quot;name\&quot;:\&quot;xiaoJun\&quot;,\&quot;age\&quot;:15&#125;&quot;</span>;<br><span class="hljs-keyword">bson_t</span> *newbs= <span class="hljs-built_in">bson_new_from_json</span>((<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint8_t</span>*)json,<span class="hljs-number">-1</span>,<span class="hljs-literal">NULL</span>);<br>jsonstr=<span class="hljs-built_in">bson_as_canonical_extended_json</span>(newbs,<span class="hljs-literal">NULL</span>);<br><span class="hljs-built_in">printf</span>(json);<br><span class="hljs-built_in">bson_free</span>(jsonstr);<br><span class="hljs-built_in">bson_destroy</span>(newbs);<br></code></pre></div></td></tr></table></figure><p>æœ‰äº†è¿™äº›åŸºç¡€åï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±ä¸ä¼šé‚£ä¹ˆåƒåŠ›äº†</p><h4 id="éå†-collections"><a class="markdownIt-Anchor" href="#éå†-collections"></a> éå† collections</h4><p>åœ¨MongoDBäº¤äº’shellä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ <code>db.test.find().pretty()</code> æ¥åˆ—å‡ºæ‰€æœ‰çš„æ•°æ®ã€‚æ³¨æ„ find() æ˜¯å¯ä»¥æä¾›å‚æ•°çš„</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">&gt;</span><span class="bash"> db.test.find</span><br>function (query, fields, limit, skip, batchSize, options) &#123;<br>    var cursor = new DBQuery(this._mongo,<br>                             this._db,<br>                             this,<br>                             this._fullName,<br>                             this._massageObject(query),<br>                             fields,<br>                             limit,<br>                             skip,<br>                             batchSize,<br>                             options || this.getQueryOptions());<br>    &#123;<br>        const session = this.getDB().getSession();<br>        const readPreference = session._serverSession.client.getReadPreference(session);<br>        if (readPreference !== null) &#123;<br>            cursor.readPref(readPreference.mode, readPreference.tags);<br>        &#125;<br>        const readConcern = session._serverSession.client.getReadConcern(session);<br>        if (readConcern !== null) &#123;<br>            cursor.readConcern(readConcern.level);<br>        &#125;<br>    &#125;<br>    return cursor;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>mongocæä¾›äº† <strong>mongoc_collection_find_with_opts</strong> å‡½æ•°æ¥è·å–ä¸€ä¸ª æ¸¸æ ‡(<strong>Cursor</strong>) ï¼Œæ³¨æ„ <strong>mongoc_collection_find</strong> è¢«å¼ƒç”¨äº†ã€‚</p><figure class="highlight c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">mongoc_cursor_t</span> * <span class="hljs-title">mongoc_collection_find_with_opts</span> <span class="hljs-params">(<span class="hljs-keyword">mongoc_collection_t</span> *collection,<span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *filter,<span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *opts,<span class="hljs-keyword">const</span> <span class="hljs-keyword">mongoc_read_prefs_t</span> *read_prefs)</span></span><br></code></pre></div></td></tr></table></figure><p><strong>mongoc_collection_find_with_opts</strong> è¦æ±‚4ä¸ªå‚æ•°ï¼Œå‚æ•°æˆ‘ä»¬åªå…³æ³¨å‰ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­ <strong>bson_t *filter</strong> è‡³å…³é‡è¦ï¼Œç±»ä¼¼äº MYSQL select <em>from tb_xxx *where id = 5</em></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">// ç©ºBSONæ–‡æ¡£ &#123;&#125;</span><br><span class="hljs-keyword">bson_t</span> *bson=<span class="hljs-built_in">BCON_NEW</span>(<span class="hljs-literal">NULL</span>);<br><span class="hljs-keyword">mongoc_cursor_t</span> *cursor= <span class="hljs-built_in">mongoc_collection_find_with_opts</span>(coll,bson,<span class="hljs-literal">NULL</span>,<span class="hljs-literal">NULL</span>);<br><span class="hljs-comment">// è·å–å½“å‰æ–‡æ¡£ï¼Œæ³¨æ„æ˜¯ä¸€ä¸ª const bson_t *ï¼Œå¹¶ä¼ å…¥ mongoc_cursor_next ç¬¬äºŒä¸ªå‚æ•°</span><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *ps=<span class="hljs-built_in">mongoc_cursor_current</span>(cursor);<br><span class="hljs-keyword">while</span> (<span class="hljs-built_in">mongoc_cursor_next</span>(cursor,&amp;ps))<br>&#123;<br>       <span class="hljs-keyword">char</span> *json=<span class="hljs-built_in">bson_as_canonical_extended_json</span>(ps,&amp;size);<br>       <span class="hljs-built_in">printf</span>(json);<br>       <span class="hljs-built_in">bson_free</span>(json);<br>&#125;<br><span class="hljs-comment">// é‡Šæ”¾ cursor</span><br><span class="hljs-built_in">mongoc_cursor_destroy</span>(cursor);<br></code></pre></div></td></tr></table></figure><p>bson_t <em>bson=BCON_NEW(NULL); ç­‰ä»·äº db.test.find({}) æˆ–è€… db.test.find()å½“ç„¶ï¼Œä¹Ÿå¯ä»¥è¿™ä¹ˆæ¥å†™bson_t</em> bson=BCON_NEW(â€œageâ€,â€{â€œ,â€<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;}&#039; at position 21: â€¦CON_INT32(13),â€}Ì²â€);è¿™å°±ç±»ä¼¼äº db.teâ€¦'>gtâ€,BCON_INT32(13),â€}â€);è¿™å°±ç±»ä¼¼äº db.test.find({â€˜ageâ€™:{â€˜</span>gtâ€™:13}})</p><h4 id="å¢åˆ æŸ¥æ”¹"><a class="markdownIt-Anchor" href="#å¢åˆ æŸ¥æ”¹"></a> å¢åˆ æŸ¥æ”¹</h4><p>åƒå¤§å¤šæ•°æ•°æ®åº“ä¸€æ ·ï¼Œå¢åˆ æŸ¥æ”¹æ˜¯å¿…ä¸å¯å°‘çš„åŸºæœ¬æ­¥éª¤ã€‚</p><h5 id="insert"><a class="markdownIt-Anchor" href="#insert"></a> insert</h5><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">MONGOC_EXPORT</span> (<span class="hljs-keyword">bool</span>)<br><span class="hljs-built_in">mongoc_collection_insert</span> (<span class="hljs-keyword">mongoc_collection_t</span> *collection,<br>                          <span class="hljs-keyword">mongoc_insert_flags_t</span> flags,<br>                          <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *document,<br>                          <span class="hljs-keyword">const</span> <span class="hljs-keyword">mongoc_write_concern_t</span> *write_concern,<br>                          <span class="hljs-keyword">bson_error_t</span> *error);<br><span class="hljs-built_in">MONGOC_EXPORT</span> (<span class="hljs-keyword">bool</span>)<br><span class="hljs-built_in">mongoc_collection_insert_one</span> (<span class="hljs-keyword">mongoc_collection_t</span> *collection,<br>                              <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *document,<br>                              <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *opts,<br>                              <span class="hljs-keyword">bson_t</span> *reply,<br>                              <span class="hljs-keyword">bson_error_t</span> *error);<br><span class="hljs-built_in">MONGOC_EXPORT</span> (<span class="hljs-keyword">bool</span>)<br><span class="hljs-built_in">mongoc_collection_insert_many</span> (<span class="hljs-keyword">mongoc_collection_t</span> *collection,<br>                               <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> **documents,<br>                               <span class="hljs-keyword">size_t</span> n_documents,<br>                               <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *opts,<br>                               <span class="hljs-keyword">bson_t</span> *reply,<br>                               <span class="hljs-keyword">bson_error_t</span> *error);<br></code></pre></div></td></tr></table></figure><p>åƒä¸‡åˆ«è¢«è¿™ä¹ˆå¤šå‚æ•°ç»™å“å€’äº†ã€‚è¿™é‡Œæˆ‘ä»¬åªéœ€å…³æ³¨</p><blockquote><p>mongoc_collection_t *collectionconst bson_t *document<br />bson_error_t *error(å¯é€‰ï¼Œè¡¨ç¤ºé”™è¯¯ä¿¡æ¯)</p></blockquote><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œçœç•¥äº†å¤§éƒ¨åˆ†ä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">bson_t</span> *bson=<span class="hljs-built_in">BCON_NEW</span>(<br>            <span class="hljs-string">&quot;name&quot;</span>,<span class="hljs-built_in">BCON_UTF8</span>(<span class="hljs-string">&quot;xiaoDong&quot;</span>),<br>            <span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-built_in">BCON_INT32</span>(<span class="hljs-number">18</span>),<br>            <span class="hljs-string">&quot;info&quot;</span>,<br>            <span class="hljs-string">&quot;[&quot;</span>,<br>               <span class="hljs-string">&quot;&#123;&quot;</span>,<span class="hljs-string">&quot;country&quot;</span>,<span class="hljs-built_in">BCON_UTF8</span>(<span class="hljs-string">&quot;China&quot;</span>), <span class="hljs-string">&quot;&#125;&quot;</span>,<br>               <span class="hljs-string">&quot;&#123;&quot;</span>,<span class="hljs-string">&quot;phone&quot;</span>,<span class="hljs-built_in">BCON_UTF8</span>(<span class="hljs-string">&quot;150&quot;</span>), <span class="hljs-string">&quot;&#125;&quot;</span>,<br>            <span class="hljs-string">&quot;]&quot;</span><br>        );<br><span class="hljs-comment">// æ’å…¥æ•°æ®</span><br>retr=<span class="hljs-built_in">mongoc_collection_insert_one</span>(coll,,<span class="hljs-literal">NULL</span>,<span class="hljs-literal">NULL</span>,&amp;error);<br><span class="hljs-keyword">if</span>(!retr)&#123;<br>     <span class="hljs-built_in">printf</span>(error.message);<br>&#125;<br><span class="hljs-built_in">bson_destroy</span>(bson);<br></code></pre></div></td></tr></table></figure><h5 id="delete"><a class="markdownIt-Anchor" href="#delete"></a> delete</h5><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">MONGOC_EXPORT</span> (<span class="hljs-keyword">bool</span>)<br><span class="hljs-built_in">mongoc_collection_delete_one</span> (<span class="hljs-keyword">mongoc_collection_t</span> *collection,<br>                              <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *selector,<br>                              <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *opts,<br>                              <span class="hljs-keyword">bson_t</span> *reply,<br>                              <span class="hljs-keyword">bson_error_t</span> *error);<br><span class="hljs-built_in">MONGOC_EXPORT</span> (<span class="hljs-keyword">bool</span>)<br><span class="hljs-built_in">mongoc_collection_delete_many</span> (<span class="hljs-keyword">mongoc_collection_t</span> *collection,<br>                               <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *selector,<br>                               <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *opts,<br>                               <span class="hljs-keyword">bson_t</span> *reply,<br>                               <span class="hljs-keyword">bson_error_t</span> *error);<br></code></pre></div></td></tr></table></figure><p><strong>mongoc_collection_delete</strong> å·²è¢«å¼ƒç”¨ï¼Œè¿™é‡Œæ²¡æœ‰åˆ—å‡º<br />è¿™ä¸ªç±»ä¼¼Insertï¼Œä¾‹å­å°±æ²¡æœ‰äº†å“ˆ ğŸ˜ƒ</p><h5 id="find"><a class="markdownIt-Anchor" href="#find"></a> find</h5><p>è¿™ä¸ªå‰é¢å°±æ˜¯å‰é¢çš„ <strong>éå†collections</strong> â€¦â€¦</p><h5 id="update"><a class="markdownIt-Anchor" href="#update"></a> update</h5><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">MONGOC_EXPORT</span> (<span class="hljs-keyword">bool</span>)<br><span class="hljs-built_in">mongoc_collection_update</span> (<span class="hljs-keyword">mongoc_collection_t</span> *collection,<br>                          <span class="hljs-keyword">mongoc_update_flags_t</span> flags,<br>                          <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *selector,<br>                          <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *update,<br>                          <span class="hljs-keyword">const</span> <span class="hljs-keyword">mongoc_write_concern_t</span> *write_concern,<br>                          <span class="hljs-keyword">bson_error_t</span> *error);<br><span class="hljs-built_in">MONGOC_EXPORT</span> (<span class="hljs-keyword">bool</span>)<br><span class="hljs-built_in">mongoc_collection_update_one</span> (<span class="hljs-keyword">mongoc_collection_t</span> *collection,<br>                              <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *selector,<br>                              <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *update,<br>                              <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *opts,<br>                              <span class="hljs-keyword">bson_t</span> *reply,<br>                              <span class="hljs-keyword">bson_error_t</span> *error);<br><span class="hljs-built_in">MONGOC_EXPORT</span> (<span class="hljs-keyword">bool</span>)<br><span class="hljs-built_in">mongoc_collection_update_many</span> (<span class="hljs-keyword">mongoc_collection_t</span> *collection,<br>                               <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *selector,<br>                               <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *update,<br>                               <span class="hljs-keyword">const</span> <span class="hljs-keyword">bson_t</span> *opts,<br>                               <span class="hljs-keyword">bson_t</span> *reply,<br>                               <span class="hljs-keyword">bson_error_t</span> *error);<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„é‚£ä¸ª <strong>mongoc_update_flags_t</strong>ï¼Œè¿™ä¸ªç»å¸¸ç”¨åˆ°ã€‚</p><figure class="highlight c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c"><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> &#123;</span><br>   MONGOC_UPDATE_NONE = <span class="hljs-number">0</span>,<br>   MONGOC_UPDATE_UPSERT = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">0</span>,<br>   MONGOC_UPDATE_MULTI_UPDATE = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">1</span>,<br>&#125; <span class="hljs-keyword">mongoc_update_flags_t</span>;<br></code></pre></div></td></tr></table></figure><p>ç°åœ¨å°± <strong>mongoc_collection_update</strong> è¿™ä¸ªå‡½æ•°ä¸ºä¾‹ï¼Œé™¤äº†é‚£ä¸ª const mongoc_write_concern_t *write_concern å‚æ•°ä»¥å¤–ï¼Œå…¶ä»–çš„ä¼¼ä¹éƒ½æŒºå¸¸ç”¨ã€‚ã€‚ã€‚ä¸è¿‡å†æ¬¡ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹Mongoä¸‹updateæ•°æ®ã€‚</p><p>å½“å‰ db_test å­˜åœ¨å¦‚ä¸‹æ•°æ®</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">db<span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.find</span>()<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5a8e30c0d077dc147db71f83&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaolong&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">14</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5a8e3102d077dc147db71f84&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaoqiang&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">10</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5a8e3108d077dc147db71f85&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaofeng&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">12</span> &#125;<br>&#123; &quot;_id&quot; : <span class="hljs-built_in">ObjectId</span>(<span class="hljs-string">&quot;5a8e38ba53d6700f027556c2&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaoHong&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">15</span>, <span class="hljs-string">&quot;info&quot;</span> : [ &#123; <span class="hljs-string">&quot;country&quot;</span> : <span class="hljs-string">&quot;China&quot;</span> &#125;, &#123; &quot;phone&quot; : <span class="hljs-string">&quot;110&quot;</span><br></code></pre></div></td></tr></table></figure><p>æˆ‘è¦æŸ¥çœ‹ age å¤§æˆ–ç­‰äº 12 çš„è®°å½•ï¼Œé‚£ä¹ˆæˆ‘å¯ä»¥è¿™æ ·åš</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">db<span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.find</span>(&#123;<span class="hljs-string">&#x27;age&#x27;</span>:&#123;<span class="hljs-string">&#x27;$gte&#x27;</span>:<span class="hljs-number">12</span>&#125;&#125;)<br>&gt;&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5a8e30c0d077dc147db71f83&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaolong&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">14</span> &#125;<br><span class="hljs-string">&quot;xiaofeng&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">12</span> &#125;<br>&#123; <span class="hljs-string">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;5a8e38ba53d6700f027556c2&quot;</span>), <span class="hljs-string">&quot;name&quot;</span> : <span class="hljs-string">&quot;xiaoHong&quot;</span>, <span class="hljs-string">&quot;age&quot;</span> : <span class="hljs-number">15</span>, <span class="hljs-string">&quot;info&quot;</span> : <span class="hljs-selector-attr">[ &#123; <span class="hljs-string">&quot;country&quot;</span> : <span class="hljs-string">&quot;China&quot;</span> &#125;, &#123; <span class="hljs-string">&quot;phone&quot;</span> : <span class="hljs-string">&quot;110&quot;</span> &#125; ]</span> &#125;<br><br></code></pre></div></td></tr></table></figure><p>è¦ä¿®æ”¹ age å¤§æˆ–ç­‰äº 12 çš„ name çš„<strong>æ‰€æœ‰</strong>è®°å½•ï¼Œé‚£ä¹ˆæˆ‘ä¹ˆå¯ä»¥è¿™æ ·åš<br />db.test.update({â€˜ageâ€™:{â€˜<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;}&#039; at position 8: gteâ€™:12}Ì²},{â€˜'>gteâ€™:12}},{â€˜</span>setâ€™:{â€˜nameâ€™:â€™XXXXXâ€™}},false,<strong>true</strong>)</p><p>ç±»ä¼¼ä¸MySQLï¼šupdate tb_xxx set name=â€™xxxxxâ€™ where age &gt;=12</p><p>è¿™æ—¶å€™å›è¿‡å¤´æ¥çœ‹çœ‹</p><figure class="highlight dart"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dart"><span class="hljs-keyword">const</span> bson_t *selector =&gt; &#123;<span class="hljs-string">&#x27;age&#x27;</span>:&#123;<span class="hljs-string">&#x27;<span class="hljs-subst">$gte</span>&#x27;</span>:<span class="hljs-number">12</span>&#125; &#125;<br><span class="hljs-keyword">const</span> bson_t *update =&gt; &#123;<span class="hljs-string">&#x27;<span class="hljs-subst">$set</span>&#x27;</span>:&#123;<span class="hljs-string">&#x27;name&#x27;</span>:<span class="hljs-string">&#x27;XXXXX&#x27;</span>&#125;&#125;<br>mongoc_update_flags_t flags =&gt; MONGOC_UPDATE_MULTI_UPDATE<br></code></pre></div></td></tr></table></figure><p>äºæ˜¯å¯ä»¥è¿™æ ·å†™</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">bson_t</span> *query=<span class="hljs-built_in">BCON_NEW</span>(<span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-string">&quot;&#123;&quot;</span>,<br>                      <span class="hljs-string">&quot;$gte&quot;</span>,<span class="hljs-built_in">BCON_INT32</span>(<span class="hljs-number">12</span>),<br>                             <span class="hljs-string">&quot;&#125;&quot;</span>);<br><span class="hljs-keyword">bson_t</span> *update=<span class="hljs-built_in">BCON_NEW</span>(<span class="hljs-string">&quot;$set&quot;</span>,<span class="hljs-string">&quot;&#123;&quot;</span>,<br>                       <span class="hljs-string">&quot;age&quot;</span>,<span class="hljs-built_in">BCON_INT32</span>(<span class="hljs-number">888</span>),<br>                              <span class="hljs-string">&quot;&#125;&quot;</span>);<br><span class="hljs-keyword">bool</span> retr= <span class="hljs-built_in">mongoc_collection_update</span>(coll,MONGOC_UPDATE_MULTI_UPDATE,query,update,<span class="hljs-literal">NULL</span>,&amp;error);<br><span class="hljs-keyword">if</span>(!retr)&#123;<br>     cout&lt;&lt;error.message&lt;&lt;endl;<br>&#125;<br><span class="hljs-built_in">bson_destroy</span>(query);<br><span class="hljs-built_in">bson_destroy</span>(update);<br><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ï¼Œ<strong>â€œageâ€,â€{â€œ</strong> è¦å•ç‹¬å†™ï¼Œä¸èƒ½å†™æˆ <strong>â€œage{â€œ</strong>ï¼Œå¦åˆ™ <strong>src/bson/bcon.c:784 bcon_append_ctx_va(): precondition failed: type == BCON_TYPE_UTF8</strong> è¿™æ˜¯æœ€å‘çˆ¹çš„åœ°æ–¹</p><h4 id="å†…å­˜é‡Šæ”¾"><a class="markdownIt-Anchor" href="#å†…å­˜é‡Šæ”¾"></a> å†…å­˜é‡Šæ”¾</h4><p>åˆ«ä»¥ä¸ºè¿™æ ·å°±ç»“æŸäº†å“¦ï¼Œè¿˜è¦è®°å¾—è¦é‡Šæ”¾æ‰€æœ‰çš„å†…å­˜</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">// é‡Šæ”¾char*æŒ‡é’ˆ</span><br><span class="hljs-built_in">bson_free</span>(<span class="hljs-keyword">void</span> *mem);<br><span class="hljs-comment">// é‡Šæ”¾ bson_t *bsonæ–‡æ¡£</span><br><span class="hljs-built_in">bson_destroy</span>(<span class="hljs-keyword">bson_t</span> *bson);<br><span class="hljs-built_in">mongoc_cursor_destroy</span>(cursor);<br><span class="hljs-built_in">mongoc_collection_destroy</span>(coll);<br><span class="hljs-built_in">mongoc_database_destroy</span>(database);<br><span class="hljs-built_in">mongoc_client_destroy</span>(client);<br><span class="hljs-built_in">mongoc_cleanup</span>();<br></code></pre></div></td></tr></table></figure><h3 id="ç¼–è¯‘"><a class="markdownIt-Anchor" href="#ç¼–è¯‘"></a> ç¼–è¯‘</h3><p>ç¼–è¯‘æ–¹æ³•ä¹Ÿå¾ˆç®€å•</p><blockquote><p>g++ main.cpp -o main <code>pkg-config â€“libs â€“cflags libmongoc-1.0</code></p></blockquote><p>æˆ–è€…</p><blockquote><p>g++ main.cpp -o main -lbson-1.0 -lmongoc-1.0</p></blockquote><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>ä¸å¾—ä¸è¯´ï¼Œç”¨mongocæ¥æ“æ§mongoDBæ•°æ®åº“è¿˜æŒºå¤æ‚çš„ã€‚å› æ­¤å»ºè®®è‡ªå·±æŠŠè¿™äº›å‡½æ•°å°è£…æˆç±»å¯¹è±¡ã€‚å…¶å®ï¼Œå…³äºmongocå°è£…æˆç±»ï¼Œ<strong>Mongoc</strong>ç›®å‰å·²ç»å‘å±•åˆ°äº†<strong>MongoCXX</strong>ï¼Œä»¥Mongocä¸ºåŸºç¡€ï¼Œæ‰€æœ‰æ“ä½œéƒ½è¢«å°è£…åˆ°ç±»é‡Œé¢ã€‚å¼•å…¥äº†å‡ ä¸ªç‰¹æ®Šçš„å¯¹è±¡ <strong>viewã€valueã€view_or_value</strong>ã€‚åŒæ—¶ï¼Œæ„å»º(<strong>Build</strong>)ä¸€ä¸ªBSONæ–‡æ¡£æœ‰ä¸¤ç§æ–¹æ³•ï¼š<strong>basicã€stream</strong>ã€‚å¯ <a href="https://mongodb.github.io/mongo-cxx-driver/mongocxx-v3/installation/">å‚é˜…è¿™é‡Œ</a></p><p>ä»¥åæœ‰ç©ºå†ä»‹ç»***mongocxx***å§ï½</p><p>å‚è€ƒ <a href="http://mongoc.org/libmongoc/current/tutorial.html">http://mongoc.org/libmongoc/current/tutorial.html</a></p>]]></content>
    
    
    <categories>
      
      <category>MongoDB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C++</tag>
      
      <tag>C</tag>
      
      <tag>MongoDB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Chromeæµè§ˆå™¨ç½‘é¡µå˜æˆé»‘è‰²(Dark Reader)</title>
    <link href="/chrome-dark/"/>
    <url>/chrome-dark/</url>
    
    <content type="html"><![CDATA[<p>Dark Reader å°±æ˜¯ä¸€ä¸ªå¼€æºchromeæµè§ˆå™¨çš„æ‰©å±•ç¨‹åºï¼Œå®ƒå¯ä»¥è®©å¤§éƒ¨åˆ†ç½‘é¡µåœ¨å¤œé—´å’Œæ—¥é—´æµè§ˆã€‚å¯¹äºä½¿ç”¨Chromeçš„ç”¨æˆ·æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŠ¤çœ¼æ’ä»¶ã€‚ç›®å‰Dark Readeræ”¯æŒçš„æµè§ˆå™¨æœ‰Chromeï¼ŒFirefoxï¼ŒSafari</p><span id="more"></span><h3 id="duckduckgoå’Œdark-reader"><a class="markdownIt-Anchor" href="#duckduckgoå’Œdark-reader"></a> DuckduckGoå’ŒDark Reader</h3><p>æ€»æ‰€å‘¨çŸ¥ï¼ŒDuckduckGoæ˜¯ä¸€ä¸ªä¿æŠ¤ç”¨æˆ·éšç§çš„æœç´¢å¼•æ“ï¼Œä½†å®ƒæœ‰ä¸€ä¸ªå¥½å¤„æ˜¯èƒ½å¤Ÿè®¾ç½®é¡µé¢çš„ä¸»é¢˜</p><p><img src="/uploads/images/darkreader/file_001.png" alt="img" /></p><p>é€šè¿‡Dark Readeræ’ä»¶åçš„chromeæµè§ˆå™¨</p><p><img src="/uploads/images/darkreader/file_002.png" alt="img" /></p><h3 id="è·å–dark-reader"><a class="markdownIt-Anchor" href="#è·å–dark-reader"></a> è·å–Dark Reader</h3><blockquote><p><a href="https://chrome.google.com/webstore/detail/dark-reader/eimadpbcbfnmbkopoojfekhnkhdbieeh?utm_source=chrome-app-launcher-info-dialog">1. chromeç½‘ä¸Šåº”ç”¨åº—</a></p><p><a href="https://github.com/darkreader/darkreader">2. Github</a></p></blockquote><h3 id="å®‰è£…æ–¹å¼"><a class="markdownIt-Anchor" href="#å®‰è£…æ–¹å¼"></a> å®‰è£…æ–¹å¼</h3><p>å¯¹äºç¬¬ä¸€ç§å®‰è£…æ–¹å¼ï¼Œè¿™é‡Œä¸åœ¨å¤šè¯´ï¼Œå¾ˆç®€å•ã€‚è¿™é‡Œä»‹ç»ä¸‹ç¬¬äºŒç§å®‰è£…æ–¹æ³•ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/darkreader/</span>darkreader.git<br>cd darkreader<br>npm install<br>npm run release<br></code></pre></div></td></tr></table></figure><p>è¿™æ˜¯å°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ <strong>build.zip</strong>ï¼Œ<strong>build-firefox.xpi</strong>ï¼Œ<strong>buildæ–‡ä»¶å¤¹</strong>ã€‚</p><p>å…¶ä¸­ build-firefox.xpi ç”¨äºFirefoxï¼Œè€Œbuildåˆ™ç”¨äºchromeï¼Œå¯èƒ½æœ‰äººä¼šé—®ï¼Œchromeçš„æ’ä»¶åç¼€ä¸æ˜¯ <strong>.crx</strong> å—ï¼Ÿ</p><p>ä¸æ€¥ï¼Œæˆ‘ä»¬æ‰“å¼€chrome-&gt;æ‰©å±•ç¨‹åºï¼Œå¼€å¯ã€å¼€å‘è€…æ¨¡å¼ã€‘åï¼Œã€åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åºâ€¦ã€‘åæ‰¾åˆ°é‚£ä¸ª buildæ–‡ä»¶å¤¹ åå‘ç°æ’ä»¶åŠ è½½æˆåŠŸï¼</p><p><img src="/uploads/images/darkreader/file_005.png" alt="img" /></p><h3 id="ä½¿ç”¨"><a class="markdownIt-Anchor" href="#ä½¿ç”¨"></a> ä½¿ç”¨</h3><p>åŠŸèƒ½å¦‚ä¸‹</p><ul><li>é€šè¿‡ç½‘ç«™åˆ—è¡¨è¿‡æ»¤è®¾ç½®é»‘æš—/æ˜äº®ä¸»é¢˜</li><li>äº®åº¦ï¼Œå¯¹æ¯”åº¦ï¼Œæ£•è¤è‰²æ»¤é•œï¼Œç°åº¦</li><li>å­—ä½“ï¼Œæ–‡å­—æè¾¹</li></ul><p><img src="/uploads/images/darkreader/file_004.png" alt="img" /></p><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>æ€»ä¹‹ï¼ŒDark Readeræ˜¯ä¸€ä¸ªéå¸¸æœ‰å®ç”¨ä»·å€¼çš„å¼€æºchromeæ’ä»¶ã€‚ä½†æ˜¯Android Chromeæ²¡æœ‰å®‰è£…æ’ä»¶è¿™ä¸€åŠŸèƒ½ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡ <strong>chrome://flags</strong> æ¥è®¾ç½®chromeä¸»é¢˜ï¼</p><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>Others</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Chrome</tag>
      
      <tag>Google</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Fork bombå‘½ä»¤</title>
    <link href="/fork-bomb-commands/"/>
    <url>/fork-bomb-commands/</url>
    
    <content type="html"><![CDATA[<p><strong>Fork bomb</strong> æ˜¯ä¸€ç§æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œæ— é™ <strong>fork</strong> å­è¿›ç¨‹ä»¥è€—å°½å¯ç”¨ç³»ç»Ÿèµ„æº(CPUå ç”¨ç‡é«˜è¾¾100%)ï¼Œç”±äºèµ„æºåŒ®ä¹è€Œå¯¼è‡´ç³»ç»Ÿé€Ÿåº¦æ”¾æ…¢æˆ–å´©æºƒã€‚</p><span id="more"></span><h3 id="linux-bash"><a class="markdownIt-Anchor" href="#linux-bash"></a> Linux Bash</h3><p>ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ (è¯·åœ¨è™šæ‹Ÿæœºä¸Šæ‰§è¡Œï¼)</p><figure class="highlight elixir"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs elixir"><span class="hljs-variable">$ </span><span class="hljs-symbol">:</span>()&#123; <span class="hljs-symbol">:|</span><span class="hljs-symbol">:&amp;</span> &#125;;<span class="hljs-symbol">:</span><br></code></pre></div></td></tr></table></figure><ul><li>ğŸ˜¦) å®šä¹‰ä¸€ä¸ªåä¸º <strong>:</strong> çš„å‡½æ•°</li><li>{ â€¦ } å‡½æ•°ä½“</li><li>ğŸ˜: é€’å½’è°ƒç”¨è¯¥å‘½ä»¤</li><li>&amp; åå°è¿è¡Œï¼Œå‰å°è¿è¡Œç›´æ¥ä¸º <strong>;</strong></li><li>; åˆ†å‰²ç¬¦</li><li>: æ‰§è¡Œåä¸º <strong>:</strong> çš„å‡½æ•°</li></ul><p>æ‰§è¡Œè¯¥å‘½ä»¤ä¼šåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶ååœ¨æ— é™å¾ªç¯ä¸­é‡å¤è‡ªå·±ï¼Œä¸æ–­äº§ç”Ÿè¿›ç¨‹ï¼Œç»“æœæ˜¯ä¸€ä¸ªæ— æ³•å“åº”çš„ç³»ç»Ÿ(æ­»æœº)ã€‚</p><h3 id="windows-batch"><a class="markdownIt-Anchor" href="#windows-batch"></a> Windows Batch</h3><p>Windows æ‰¹å¤„ç†åŒæ ·ä¹Ÿå¯ä»¥å‘ç”Ÿfork bombã€‚æ–°å»ºä¸€ä¸ª.batæ‰¹å¤„ç†æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä¸€ä¸‹ç®€çŸ­çš„å†…å®¹</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">%</span><span class="bash">0 | %0</span><br></code></pre></div></td></tr></table></figure><h3 id="python"><a class="markdownIt-Anchor" href="#python"></a> Python</h3><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs PYTHON"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>os.fork()<br></code></pre></div></td></tr></table></figure><h3 id="java"><a class="markdownIt-Anchor" href="#java"></a> Java</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs JAVA"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ForkBomb</span></span><br><span class="hljs-class"></span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span><br><span class="hljs-function">  </span>&#123;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-keyword">true</span>)<br>    &#123;<br>      Runtime.getRuntime().exec(<span class="hljs-keyword">new</span> String[]&#123;<span class="hljs-string">&quot;javaw&quot;</span>, <span class="hljs-string">&quot;-cp&quot;</span>, System.getProperty(<span class="hljs-string">&quot;java.class.path&quot;</span>), <span class="hljs-string">&quot;ForkBomb&quot;</span>&#125;);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="c"><a class="markdownIt-Anchor" href="#c"></a> C</h3><figure class="highlight c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>) &#123;<br>      fork();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="powershell"><a class="markdownIt-Anchor" href="#powershell"></a> PowerShell</h3><figure class="highlight powershell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs powershell"><span class="hljs-keyword">while</span>(<span class="hljs-variable">$true</span>) &#123; <br>    <span class="hljs-built_in">Start-Process</span> powershell.exe <span class="hljs-literal">-ArgumentList</span> <span class="hljs-string">&quot;-NoExit&quot;</span>, <span class="hljs-string">&quot;Get-ChildItem -Recurse C:&quot;</span>;<br>    <span class="hljs-built_in">Invoke-Expression</span> <span class="hljs-literal">-Command</span> <span class="hljs-string">&#x27;while($true) &#123;Start-Process powershell.exe -ArgumentList &quot;-NoExit&quot;, &quot;Get-ChildItem -Recurse C:&quot;&#125;&#x27;</span>;&#125;<br><br></code></pre></div></td></tr></table></figure><h3 id="é¿å…"><a class="markdownIt-Anchor" href="#é¿å…"></a> é¿å…</h3><p>åœ¨Linuxä¸‹ï¼Œå¯ä»¥é€šè¿‡ <strong>ulimit</strong> è®¾ç½®çš„æœ€å¤§è¿›ç¨‹æ•°(max user processes)</p><figure class="highlight scss"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs scss">$ ulimit -<span class="hljs-selector-tag">a</span><br>core file size          (blocks, -c) 0<br>data seg size           (kbytes, -d) unlimited<br>scheduling priority             (-e) 0<br>file size               (blocks, -f) unlimited<br>pending signals                 (-i) 30195<br>max locked memory       (kbytes, -l) 16384<br>max memory size         (kbytes, -m) unlimited<br>open files                      (-n) 1024<br>pipe size            (<span class="hljs-number">512</span> bytes, -p) 8<br>POSIX message queues     (bytes, -q) 819200<br>real-<span class="hljs-selector-tag">time</span> priority              (-r) 0<br>stack size              (kbytes, -s) 8192<br>cpu <span class="hljs-selector-tag">time</span>               (seconds, -t) unlimited<br>max user processes              (-u) 30195<br>virtual memory          (kbytes, -v) unlimited<br>file locks                      (-x) unlimited<br><br></code></pre></div></td></tr></table></figure><p>ä½†æ˜¯è¿™åªèƒ½åœ¨å½“å‰ç»ˆç«¯ç”Ÿæ•ˆã€‚å› æ­¤ï¼Œè¿˜å¯ä»¥ä¿®æ”¹ <strong>/etc/security/limits.conf</strong> é…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml">#<span class="hljs-tag">&lt;<span class="hljs-name">domain</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">item</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span><br>*               soft    nproc            4096<br></code></pre></div></td></tr></table></figure><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>å‚è€ƒèµ„æ–™</p><ul><li><a href="https://www.incapsula.com/ddos/attack-glossary/fork-bomb.html">https://www.incapsula.com/ddos/attack-glossary/fork-bomb.html</a></li><li><a href="https://en.wikipedia.org/wiki/Fork_bomb">https://en.wikipedia.org/wiki/Fork_bomb</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Others</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MongoDB C Driverå®‰è£…</title>
    <link href="/mongodb-driver-install/"/>
    <url>/mongodb-driver-install/</url>
    
    <content type="html"><![CDATA[<p>è¿™æ¬¡å°±MongoDBæ¥è®°å½•ä¸‹å®‰è£…C Driverè¿‡ç¨‹ã€‚</p><span id="more"></span><h3 id="install-mongodb-c-driver"><a class="markdownIt-Anchor" href="#install-mongodb-c-driver"></a> Install MongoDB C Driver</h3><p>æˆ‘ç™¾åº¦äº†ä¸€ä¸‹ï¼Œæœ‰å…³ç”¨C/C++è°ƒç”¨MongoDBæä¾›çš„æ¥å£çš„æ•™ç¨‹ï¼Œè²Œä¼¼å¾ˆå°‘ï¼Œæˆ‘ä¹Ÿæ²¡æ€ä¹ˆGoogleï¼Œç´¢æ€§å°±çœ‹å®˜ç½‘æä¾›çš„æ–‡æ¡£ç®—äº†ï¼Œåæ­£å¤§éƒ¨åˆ†éƒ½æ˜¯ä»£ç ã€‚ã€‚ã€‚</p><p>MongoDB C Driveræ”¯æŒçš„å¹³å°å¦‚ä¸‹</p><table><thead><tr><th>Supported Platforms</th></tr></thead><tbody><tr><td>Archlinux</td></tr><tr><td>Debian 8.1</td></tr><tr><td>macOS 10.10</td></tr><tr><td>Microsoft Windows Server 2008</td></tr><tr><td>RHEL 7.0, 7.1, 7.2</td></tr><tr><td>SUSE 12</td></tr><tr><td>Ubuntu 12.04, 14.04, 16.04</td></tr><tr><td>Clang 3.4, 3.5, 3.7, 3.8</td></tr><tr><td>GCC 4.6, 4.8, 4.9, 5.3</td></tr><tr><td>MinGW-W64</td></tr><tr><td>Visual Studio 2010, 2013, 2015</td></tr><tr><td>x86, x86_64, ARM (aarch64), Power8 (ppc64le), zSeries (s390x)</td></tr></tbody></table><h4 id="ä»åŒ…ç®¡ç†å·¥å…·å®‰è£…"><a class="markdownIt-Anchor" href="#ä»åŒ…ç®¡ç†å·¥å…·å®‰è£…"></a> ä»åŒ…ç®¡ç†å·¥å…·å®‰è£…</h4><p>å¯¹äºDebianæˆ–Ubuntuï¼Œå¯ä»¥ç›´æ¥ä»ä»¥ä¸‹å‘½ä»¤å®‰è£…</p><blockquote><p>apt-get install libmongoc-1.0-0</p></blockquote><p>å¯¹äºå…¶ä»–Linuxç³»ç»Ÿï¼Œä¹Ÿæ˜¯å¤§åŒå°å¼‚çš„ã€‚ç„¶è€Œï¼Œæˆ‘è¿˜æ˜¯æ¯”è¾ƒå–œæ¬¢ç¼–è¯‘å®‰è£…ï¼Œæ„Ÿè§‰å¯æ§æ€§æ›´é«˜äº›ã€‚</p><h4 id="ç¼–è¯‘å®‰è£…"><a class="markdownIt-Anchor" href="#ç¼–è¯‘å®‰è£…"></a> ç¼–è¯‘å®‰è£…</h4><blockquote><p>OpenSSL is required for authentication or for SSL connections to MongoDB. Kerberos or LDAP support requires Cyrus SASL.</p></blockquote><p>è¿™ä¸€æ­¥æˆ‘ç›´æ¥è·³è¿‡ã€‚</p><p>æ³¨æ„ ï¼Œç¼–è¯‘mongo-c-driverè¿˜éœ€è¦ <strong>libbson</strong> ä¸è¿‡mongo-c-driverå·²ç»åŒ…å«äº†è¯¥åº“æºç </p><p>æ³¨æ„ï¼Œ<a href="http://mongoc.org/libmongoc/current/init-cleanup.html">â€“disable-automatic-init-and-cleanup</a> æ˜¯å®˜ç½‘æ¨èçš„å‚æ•°ï¼Œæ„æ€å¤§æ¦‚å°±æ˜¯ ç¦æ­¢è‡ªåŠ¨åˆå§‹åŒ–å’Œé‡Šæ”¾ï¼Œè¿™åº”è¯¥è·Ÿè°ƒç”¨åº“æœ‰å…³ï¼Œä¸è¿‡æˆ‘æ²¡æœ‰åŠ ä¸Š</p><p>é»˜è®¤å®‰è£…åˆ° /usr/local</p><p>ä¹‹åå°±å¯ä»¥ make + make install</p><h4 id="building-from-git"><a class="markdownIt-Anchor" href="#building-from-git"></a> Building from git</h4><blockquote><p>git clone <a href="https://github.com/mongodb/mongo-c-driver.git">https://github.com/mongodb/mongo-c-driver.git</a></p></blockquote><p>è¿™ä¸ªæ–¹æ³•æˆ‘æ²¡æ€ä¹ˆæ³¨æ„ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±å°è¯•ä¸‹</p><h4 id="å…¶ä»–å¹³å°çš„æ„å»º"><a class="markdownIt-Anchor" href="#å…¶ä»–å¹³å°çš„æ„å»º"></a> å…¶ä»–å¹³å°çš„æ„å»º</h4><p>é™¤äº†Linuxï¼Œå¸¸ç”¨çš„Mac OSï¼ŒWindowsçš„å®‰è£…æ–¹æ³•è¿™é‡Œå°±ä¸åœ¨èµ˜è¿°äº†</p><h3 id="æ³¨æ„"><a class="markdownIt-Anchor" href="#æ³¨æ„"></a> æ³¨æ„</h3><p>å› ä¸ºæˆ‘æ˜¯ä»æºç ç¼–è¯‘å®‰è£…çš„ï¼Œåœ¨è¿™è¿‡ç¨‹ä¸­ï¼Œä¹Ÿé‡åˆ°äº†ä¸€äº›å¥‡è‘©é—®é¢˜ã€‚<br />configureé»˜è®¤prefixä¸º /usr/localï¼Œlibmongoc-1.0ï¼Œlibbson-1.0å¤´æ–‡ä»¶å®‰è£…åˆ°/usr/local/includeï¼Œä»¥åŠç›¸åº”çš„é“¾æ¥åº“åœ¨/usr/local/libã€‚è¿™ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆé”™è¯¯ã€‚ä½†æ˜¯å½“æˆ‘ç”¨ç¼–å†™ä»£ç æ—¶å‘ç°æˆ‘å¼•ç”¨å¤´æ–‡ä»¶</p><blockquote><p>#include</p></blockquote><p>æ—¶çœ‹åˆ°å®ƒé‡Œé¢å…¶å®åŒ…å«</p><blockquote><p>#include</p></blockquote><p>è€Œç»è¿‡ <code>locate bson.h</code>ï¼Œç»“æœå‘ç°åªå­˜åœ¨ /usr/local/include/libbson-1.0/bson.hã€‚ã€‚ã€‚è¿™å°±æ˜¯é—®é¢˜äº†</p><p>äºæ˜¯æˆ‘å¯ä»¥cp /usr/local/include/libbson-1.0 ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶åˆ° /usr/include</p><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>ç¼–è¯‘å®‰è£…MongoDB C Driverç®—æ˜¯ç®€å•äº†å§ï¼Œä¸ MongoCXX çš„å®‰è£…æ–¹æ³•ç›¸æ¯”ï¼Œè¿™çš„ç¡®ç®—æ˜¯ç®€å•äº† ğŸ˜ƒ</p><p>è¯¦ç»†è¿‡ç¨‹å‚é˜… <strong>Installing the MongoDB C Driver</strong></p><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>MongoDB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C</tag>
      
      <tag>MongoDB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¼ºå¤§çš„Crunchå­—å…¸ç”Ÿæˆå·¥å…·</title>
    <link href="/linux-crunch/"/>
    <url>/linux-crunch/</url>
    
    <content type="html"><![CDATA[<p>è®¡ç®—æœºé‡Œçš„å­—å…¸è¿™ä¸œè¥¿,è¯´ç™½äº†å°±æ˜¯ä¿å­˜ç€å¤§é‡çš„å¯çŸ¥æ•°æ®,ä¸€èˆ¬æ˜¯ç”¨æ¥<strong>æš´åŠ›ç ´è§£</strong>çš„â€¦â€¦è€Œè¦æƒ³è¦çˆ†ç ´æˆåŠŸ,å°±å¾—æœ‰ä¸€ä¸ªå¼ºå¤§è€Œåˆæœ‰ç”¨çš„å­—å…¸.<br />è€ŒLinuxä¸‹çš„ä¸€ä¸ªå¼€æºç¨‹åº <strong>crunch</strong> å°±æ˜¯ä¸ºäº†å¯¹å­—å…¸çš„ç”Ÿæˆè€Œè¢«åˆ›é€ å‡ºæ¥çš„.</p><span id="more"></span><h3 id="crunch"><a class="markdownIt-Anchor" href="#crunch"></a> crunch</h3><p>å®‰è£…å¾ˆç®€å•:<code>apt-get install crunch</code><br />crunchçš„ä½¿ç”¨æ–¹æ³•å»ºè®® <code>man crunch</code> æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£,å¹¶ä¸”å…¶ä¸­ä¹Ÿæœ‰ä¸€äº›ä¾‹å­.</p><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">CRUNCH(<span class="hljs-number">1</span>)                        General Commands Manual                        CRUNCH(<span class="hljs-number">1</span>)<br>NAME<br>       crunch - generate wordlists <span class="hljs-keyword">from</span> a <span class="hljs-built_in">character</span> <span class="hljs-keyword">set</span><br>SYNOPSIS<br>       crunch &lt;min-len&gt; &lt;max-len&gt; [&lt;charset <span class="hljs-built_in">string</span>&gt;] [options]<br>DESCRIPTION<br>       Crunch  can  create  a  wordlist  based  <span class="hljs-keyword">on</span> criteria you specify.  The output <span class="hljs-keyword">from</span><br>       crunch can be sent <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> screen, <span class="hljs-built_in">file</span>,  <span class="hljs-keyword">or</span>  <span class="hljs-keyword">to</span>  another  program.   The  required<br>       parameters are:<br>       min-len<br>              The  minimum  <span class="hljs-built_in">length</span>  <span class="hljs-built_in">string</span>  you  want crunch <span class="hljs-keyword">to</span> start <span class="hljs-keyword">at</span>.  This option <span class="hljs-keyword">is</span><br>              required even <span class="hljs-keyword">for</span> parameters <span class="hljs-keyword">that</span> won&#x27;t use <span class="hljs-keyword">the</span> value.<br>       max-len<br>              The maximum <span class="hljs-built_in">length</span> <span class="hljs-built_in">string</span> you want  crunch  <span class="hljs-keyword">to</span>  <span class="hljs-keyword">end</span>  <span class="hljs-keyword">at</span>.   This  option  <span class="hljs-keyword">is</span><br>              required even <span class="hljs-keyword">for</span> parameters <span class="hljs-keyword">that</span> won&#x27;t use <span class="hljs-keyword">the</span> value.<br>       charset <span class="hljs-built_in">string</span><br>              You  may specify <span class="hljs-built_in">character</span> sets <span class="hljs-keyword">for</span> crunch <span class="hljs-keyword">to</span> use <span class="hljs-keyword">on</span> <span class="hljs-keyword">the</span> command line <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span><br>              you leave <span class="hljs-keyword">it</span> blank crunch will use <span class="hljs-keyword">the</span> default <span class="hljs-built_in">character</span> sets.   The  order<br>              MUST  BE  lower  case  <span class="hljs-built_in">characters</span>, upper case <span class="hljs-built_in">characters</span>, numbers, <span class="hljs-keyword">and</span> <span class="hljs-keyword">then</span><br>              symbols.  If you don&#x27;t follow this order you will <span class="hljs-keyword">not</span> <span class="hljs-keyword">get</span> <span class="hljs-keyword">the</span>  results  you<br>              want.   You  MUST  specify  either  values <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">character</span> type <span class="hljs-keyword">or</span> a plus<br>              sign.  NOTE: If you want <span class="hljs-keyword">to</span> include <span class="hljs-keyword">the</span> <span class="hljs-literal">space</span> <span class="hljs-built_in">character</span> <span class="hljs-keyword">in</span>  your  <span class="hljs-built_in">character</span><br>              <span class="hljs-keyword">set</span>  you must escape <span class="hljs-keyword">it</span> using <span class="hljs-keyword">the</span> \ <span class="hljs-built_in">character</span> <span class="hljs-keyword">or</span> enclose your <span class="hljs-built_in">character</span> <span class="hljs-keyword">set</span><br>              <span class="hljs-keyword">in</span> quotes i.e. <span class="hljs-string">&quot;abc &quot;</span>.  See <span class="hljs-keyword">the</span> examples <span class="hljs-number">3</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-keyword">and</span> <span class="hljs-number">13</span> <span class="hljs-keyword">for</span> examples.<br>OPTIONS<br>       -b <span class="hljs-built_in">number</span>[type]<br>              Specifies <span class="hljs-keyword">the</span> size <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> output <span class="hljs-built_in">file</span>, only works  <span class="hljs-keyword">if</span>  -o  START  <span class="hljs-keyword">is</span>  used,<br>              i.e.:  <span class="hljs-number">60</span>MB  The output files will be <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> format <span class="hljs-keyword">of</span> starting letter-<span class="hljs-keyword">end</span>â€<br>              ing letter <span class="hljs-keyword">for</span> example: ./crunch <span class="hljs-number">4</span> <span class="hljs-number">5</span> -b <span class="hljs-number">20</span>mib  -o  START  will  generate  <span class="hljs-number">4</span><br>              files:  aaaa-gvfed.txt,  gvfee-ombqy.txt,  ombqz-wcydt.txt, wcydu-zzzzz.txt<br>              valid values <span class="hljs-keyword">for</span> type are kb, mb, gb, kib, mib, <span class="hljs-keyword">and</span> gib.  The  <span class="hljs-keyword">first</span>  three<br>              types are based <span class="hljs-keyword">on</span> <span class="hljs-number">1000</span> <span class="hljs-keyword">while</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">last</span> three types are based <span class="hljs-keyword">on</span> <span class="hljs-number">1024.</span>  NOTE<br>              There <span class="hljs-keyword">is</span> no <span class="hljs-literal">space</span> <span class="hljs-keyword">between</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">and</span> type.  For example <span class="hljs-number">500</span>mb  <span class="hljs-keyword">is</span>  corâ€<br>              rect <span class="hljs-number">500</span> mb <span class="hljs-keyword">is</span> NOT correct.<br>       -c <span class="hljs-built_in">number</span><br>              Specifies  <span class="hljs-keyword">the</span>  <span class="hljs-built_in">number</span>  <span class="hljs-keyword">of</span>  lines <span class="hljs-keyword">to</span> <span class="hljs-built_in">write</span> <span class="hljs-keyword">to</span> output <span class="hljs-built_in">file</span>, only works <span class="hljs-keyword">if</span> -o<br>              START <span class="hljs-keyword">is</span> used, i.e.: <span class="hljs-number">60</span>  The output files will be <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> format <span class="hljs-keyword">of</span> starting<br>              letter-ending   letter   <span class="hljs-keyword">for</span>   example:  ./crunch  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  -f  /pentest/passâ€<br>              <span class="hljs-built_in">word</span>/crunch/charset.lst mixalpha-numeric-all-<span class="hljs-literal">space</span>  -o  START  -c  <span class="hljs-number">60</span>  will<br>              <span class="hljs-literal">result</span>  <span class="hljs-keyword">in</span>  <span class="hljs-number">2</span> files: a<span class="hljs-number">-7.</span>txt <span class="hljs-keyword">and</span> <span class="hljs-number">8</span>-\ .txt  The reason <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> slash <span class="hljs-keyword">in</span>  <span class="hljs-keyword">the</span><br>              <span class="hljs-keyword">second</span> filename <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> ending <span class="hljs-built_in">character</span> <span class="hljs-keyword">is</span> <span class="hljs-literal">space</span> <span class="hljs-keyword">and</span> ls has <span class="hljs-keyword">to</span> escape <span class="hljs-keyword">it</span> <span class="hljs-keyword">to</span><br>              print  <span class="hljs-keyword">it</span>.   Yes you will need <span class="hljs-keyword">to</span> <span class="hljs-keyword">put</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> \ when specifying <span class="hljs-keyword">the</span> filename<br>              because <span class="hljs-keyword">the</span> <span class="hljs-keyword">last</span> <span class="hljs-built_in">character</span> <span class="hljs-keyword">is</span> a <span class="hljs-literal">space</span>.<br>       -d numbersymbol<br>              Limits <span class="hljs-keyword">the</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> duplicate <span class="hljs-built_in">characters</span>.  -d <span class="hljs-number">2</span>@  limits  <span class="hljs-keyword">the</span>  lower  case<br>              alphabet <span class="hljs-keyword">to</span> output like aab <span class="hljs-keyword">and</span> aac.  aaa would <span class="hljs-keyword">not</span> be generated <span class="hljs-keyword">as</span> <span class="hljs-keyword">that</span> <span class="hljs-keyword">is</span><br>              <span class="hljs-number">3</span> consecutive letters <span class="hljs-keyword">of</span> a.  The format <span class="hljs-keyword">is</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">then</span> symbol <span class="hljs-keyword">where</span>  <span class="hljs-built_in">number</span><br>              <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> maximum <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> consecutive <span class="hljs-built_in">characters</span> <span class="hljs-keyword">and</span> symbol <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> symbol <span class="hljs-keyword">of</span><br>              <span class="hljs-keyword">the</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">character</span> <span class="hljs-keyword">set</span> you want <span class="hljs-keyword">to</span> limit i.e. @,%^   See examples <span class="hljs-number">17</span><span class="hljs-number">-19.</span><br>       -e <span class="hljs-built_in">string</span><br>              Specifies when crunch should stop early<br>       -f /path/<span class="hljs-keyword">to</span>/charset.lst charset-<span class="hljs-built_in">name</span><br>              Specifies a <span class="hljs-built_in">character</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">the</span> charset.lst<br>       -i  Inverts  <span class="hljs-keyword">the</span>   output   so   instead   <span class="hljs-keyword">of</span>   aaa,aab,aac,aad,   etc   you   <span class="hljs-keyword">get</span><br>              aaa,baa,caa,daa,aba,bba, etc<br>       -l  When  you  use  <span class="hljs-keyword">the</span> -t option this option tells crunch which symbols should be<br>              treated <span class="hljs-keyword">as</span> literals.  This will allow you <span class="hljs-keyword">to</span> use <span class="hljs-keyword">the</span> placeholders  <span class="hljs-keyword">as</span>  letâ€<br>              ters  <span class="hljs-keyword">in</span>  <span class="hljs-keyword">the</span>  pattern.   The -l option should be <span class="hljs-keyword">the</span> same <span class="hljs-built_in">length</span> <span class="hljs-keyword">as</span> <span class="hljs-keyword">the</span> -t<br>              option.  See example <span class="hljs-number">15.</span><br>       -m Merged <span class="hljs-keyword">with</span> -p.  Please use -p instead.<br>       -o wordlist.txt<br>              Specifies <span class="hljs-keyword">the</span> <span class="hljs-built_in">file</span> <span class="hljs-keyword">to</span> <span class="hljs-built_in">write</span> <span class="hljs-keyword">the</span> output <span class="hljs-keyword">to</span>, eg: wordlist.txt<br>       -p charset OR -p word1 word2 ...<br>              Tells crunch <span class="hljs-keyword">to</span> generate <span class="hljs-built_in">words</span> <span class="hljs-keyword">that</span> don&#x27;t have  repeating  <span class="hljs-built_in">characters</span>.   By<br>              default  crunch  will  generate  a  wordlist size <span class="hljs-keyword">of</span> <span class="hljs-comment">#of_chars_in_charset ^</span><br>              max_length.  This option will instead generate <span class="hljs-comment">#of_chars_in_charset!.   The</span><br>              !  stands <span class="hljs-keyword">for</span> factorial.  For example <span class="hljs-built_in">say</span> <span class="hljs-keyword">the</span> charset <span class="hljs-keyword">is</span> abc <span class="hljs-keyword">and</span> max <span class="hljs-built_in">length</span><br>              <span class="hljs-keyword">is</span> <span class="hljs-number">4.</span>.  Crunch will <span class="hljs-keyword">by</span> default generate <span class="hljs-number">3</span>^<span class="hljs-number">4</span> = <span class="hljs-number">81</span> <span class="hljs-built_in">words</span>.  This  option  will<br>              instead generate <span class="hljs-number">3</span>! = <span class="hljs-number">3</span>x2x1 = <span class="hljs-number">6</span> <span class="hljs-built_in">words</span> (abc, acb, bac, bca, cab, cba).  THIS<br>              MUST BE THE LAST OPTION!  This option CANNOT be used <span class="hljs-keyword">with</span> -s <span class="hljs-keyword">and</span> <span class="hljs-keyword">it</span> ignores<br>              min <span class="hljs-keyword">and</span> max <span class="hljs-built_in">length</span> however you must still specify two numbers.<br>       -q filename.txt<br>              Tells  crunch  <span class="hljs-keyword">to</span> <span class="hljs-built_in">read</span> filename.txt <span class="hljs-keyword">and</span> permute what <span class="hljs-keyword">is</span> <span class="hljs-built_in">read</span>.  This <span class="hljs-keyword">is</span> like<br>              <span class="hljs-keyword">the</span> -p option except <span class="hljs-keyword">it</span> gets <span class="hljs-keyword">the</span> input <span class="hljs-keyword">from</span> filename.txt.<br>       -r Tells crunch <span class="hljs-keyword">to</span> resume generate <span class="hljs-built_in">words</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">it</span> left off.  -r only works <span class="hljs-keyword">if</span><br>              you  use -o.  You must use <span class="hljs-keyword">the</span> same command <span class="hljs-keyword">as</span> <span class="hljs-keyword">the</span> original command used <span class="hljs-keyword">to</span><br>              generate <span class="hljs-keyword">the</span> <span class="hljs-built_in">words</span>.  The only exception <span class="hljs-keyword">to</span> this <span class="hljs-keyword">is</span> <span class="hljs-keyword">the</span> -s option.  If  your<br>              original  command  used  <span class="hljs-keyword">the</span> -s option you MUST remove <span class="hljs-keyword">it</span> <span class="hljs-keyword">before</span> you resume<br>              <span class="hljs-keyword">the</span> session.  Just add -r <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">end</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> original command.<br>       -s startblock<br>              Specifies a starting <span class="hljs-built_in">string</span>, eg: <span class="hljs-number">03</span>god22fs<br>       -t @,%^<br>              Specifies a pattern, eg: @@god@@@@ <span class="hljs-keyword">where</span> <span class="hljs-keyword">the</span> only <span class="hljs-keyword">the</span> @&#x27;s,  ,&#x27;s,  %&#x27;s,  <span class="hljs-keyword">and</span><br>              ^&#x27;s will change.<br>              @ will insert lower case <span class="hljs-built_in">characters</span><br>              , will insert upper case <span class="hljs-built_in">characters</span><br>              % will insert numbers<br>              ^ will insert symbols<br>       -u<br>              The -u option disables <span class="hljs-keyword">the</span> printpercentage thread.  This should be <span class="hljs-keyword">the</span> <span class="hljs-keyword">last</span><br>              option.<br>       -z gzip, bzip2, lzma, <span class="hljs-keyword">and</span> <span class="hljs-number">7</span>z<br>              Compresses <span class="hljs-keyword">the</span> output <span class="hljs-keyword">from</span> <span class="hljs-keyword">the</span>  -o  option.   Valid  parameters  are  gzip,<br>              bzip2, lzma, <span class="hljs-keyword">and</span> <span class="hljs-number">7</span>z.<br>              gzip  <span class="hljs-keyword">is</span>  <span class="hljs-keyword">the</span>  fastest  <span class="hljs-keyword">but</span>  <span class="hljs-keyword">the</span> compression <span class="hljs-keyword">is</span> minimal.  bzip2 <span class="hljs-keyword">is</span> a little<br>              slower than gzip <span class="hljs-keyword">but</span> has better compression.  <span class="hljs-number">7</span>z <span class="hljs-keyword">is</span>  slowest  <span class="hljs-keyword">but</span>  has  <span class="hljs-keyword">the</span><br>              best compression.<br></code></pre></div></td></tr></table></figure><p>å‘½ä»¤æ ¼å¼ä¸º: <code>crunch &lt;min-len&gt; &lt;max-len&gt; [&lt;charset string&gt;] [options]</code></p><ul><li>min-len: ç”Ÿæˆå­—å…¸çš„æœ€å°é•¿åº¦</li><li>max-len: ç”Ÿæˆå­—å…¸çš„æœ€å¤§é•¿åº¦</li></ul><p>å…¶ä¸­,å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„å‚æ•°:</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>-b</td><td>æŒ‡å®šå†™å…¥æ–‡ä»¶æœ€å¤§å­—èŠ‚æ•°,ç±»å‹å¯ä¸ºkb, mb, gb, kib, mib, and gib.æ³¨æ„æ­¤å‚æ•°å¿…é¡»è·Ÿ -o START ä¸€èµ·ä½¿ç”¨</td></tr><tr><td>-c</td><td>æŒ‡å®šå†™å‡ºæ–‡ä»¶çš„è¡Œæ•°</td></tr><tr><td>-s</td><td>æŒ‡å®šcrunchä»è¯¥å­—ç¬¦ä¸²å¼€å§‹ç”Ÿæˆå­—å…¸</td></tr><tr><td>-e</td><td>æŒ‡å®šcrunchä»è¯¥å­—ç¬¦ä¸²ç»“æŸç”Ÿæˆå­—å…¸</td></tr><tr><td>-f</td><td>æŒ‡å®šä¸€ä¸ªå­—ç¬¦é›†åˆ,é»˜è®¤è·¯å¾„ <strong>/usr/share/crunch/charset.lst</strong>,ä½œç”¨è§ä¸‹æ–‡</td></tr><tr><td>-l</td><td>ç±»ä¼¼äºè½¬ä¹‰çš„æ“ä½œ</td></tr><tr><td>-o</td><td>æŒ‡å®šå†™å‡ºæ–‡ä»¶å,è¦åˆ†æ¸…æ¥š <strong>-o START</strong></td></tr><tr><td>-t</td><td>æŒ‡å®šç”Ÿæˆå­—å…¸çš„ç‰¹æ®Šæ ¼å¼,æ­¤å‚æ•°ä¹ƒcrunchçš„æ ¸å¿ƒ!</td></tr><tr><td>-z</td><td>æŒ‡å®šå‹ç¼©ç”Ÿæˆçš„å­—å…¸æ–‡ä»¶,æ ¼å¼ä¸º:gzip, bzip2, lzma, and 7z,ä¸”ä¸ <strong>-o START</strong> ä½¿ç”¨</td></tr><tr><td>-p</td><td>è¿™ä¸ªå‚æ•°å¯ä»¥ç†è§£ä¸ºæŠŠæŒ‡å®šçš„å­—ç¬¦ä¸²çœ‹åš<strong>ä¸€ä¸ªæ•´ä½“</strong>å¹¶è‡ªç”±ç»„åˆ</td></tr></tbody></table><p><strong>æ³¨æ„:åœ¨ä½¿ç”¨crunchç”Ÿæˆå­—å…¸æ—¶,ä¸€å®šè¦çœ‹ç”Ÿæˆçš„å­—å…¸æ–‡ä»¶çš„é¢„è®¡å¤§å°.æ¯”å¦‚:[ crunch 1 8 ] å°±æ˜¯è¾“å‡º 1812GB çš„æ•°æ®!! è¿™æ ·çš„è¯ç¡¬ç›˜æ—©å°±æ’‘çˆ†äº†!!</strong></p><h4 id="example1"><a class="markdownIt-Anchor" href="#example1"></a> example1</h4><blockquote><p>$ crunch 1 8<br />è¿™å°†ä¼šæ˜¾ç¤ºå‡ºä» a åˆ° zzzzzzzz çš„æ•°æ®,ä¹Ÿå°±æ˜¯1812GB!</p></blockquote><h4 id="example2"><a class="markdownIt-Anchor" href="#example2"></a> example2</h4><blockquote><p>$ crunch 1 6 abcdefg -o mydict.lst<br />è¿™å°†ä¼šç”Ÿæˆä¸€ä¸ªä» a åˆ° gggggg çš„å­—å…¸æ–‡ä»¶</p></blockquote><h4 id="example3"><a class="markdownIt-Anchor" href="#example3"></a> example3</h4><blockquote><p>$ crunch 8 8 -f /usr/share/crunch/charset.lst <strong>mixalpha-numeric-all-space</strong><br />è¿™å°†ç”Ÿæˆ 8ä½ å¤§å°å†™ä»¥åŠç‰¹æ®Šç¬¦å·çš„å­—å…¸</p></blockquote><p>charset.lstæ–‡ä»¶å¦‚ä¸‹:<br /><img src="/uploads/images/linux/file_002.png" alt="img" /></p><p>å¯ä»¥çœ‹åˆ° mixalpha-numeric-all-space è¡¨ç¤º a-z,A-Zå¤§å°å†™+0-9æ•°å­—+ç‰¹æ®Šå­—ç¬¦:<br /><strong>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345 6789!@#$%^&amp;*()-_+=~`[]{}|:;â€â€˜&lt;&gt;,.?/</strong></p><p>å½“æŒ‡å®š <strong>-f</strong> å‚æ•°æ—¶,å¿…é¡»è¦æŒ‡æ˜ä¸€ä¸ªå˜é‡,å¦‚ <strong>mixalpha-numeric-all-space</strong></p><h4 id="example4"><a class="markdownIt-Anchor" href="#example4"></a> example4</h4><blockquote><p>$ crunch 6 6 -s <strong>xxdog5</strong> -t <strong>@@dog%</strong><br />æ³¨æ„è¿™é‡Œçš„<strong>æ ¼å¼</strong>,è¿™é‡Œä»¥ xxdog5 å¼€å§‹ä¸”å­—ç¬¦ä¸ªæ•°å¿…é¡»ä¸º6,å› ä¸ºè¿™é‡Œæœ€å°å­—ç¬¦æ•°ä¸º6,åŒæ—¶ <strong>-t</strong> æŒ‡å®šçš„è¯¥æ ¼å¼ä¹Ÿå¿…é¡»æ—¶ <strong>-s</strong> æŒ‡å®šçš„æ ¼å¼.</p></blockquote><p>ä¸€èˆ¬åœ°,crunchçš„4ä¸ª<strong>é€šé…ç¬¦</strong>ä»£è¡¨äº†ä¸åŒçš„æ„æ€</p><ul><li><strong>@</strong> :è¡¨ç¤ºä¸€ä¸ª a-z å°å†™å­—ç¬¦</li><li><strong>,</strong> :è¡¨ç¤ºä¸€ä¸ª A-Z å¤§å†™å­—ç¬¦</li><li><strong>%</strong> :è¡¨ç¤ºä¸€ä¸ª 0-9 çš„æ•°å­—</li><li><strong>^</strong> :è¡¨ç¤ºä¸€ä¸ªè±¡å¾ç¬¦å·</li></ul><p>å¼„æ¸…æ¥šè¿™å‡ ä¸ªå,ä¸Šé¢çš„ä¹Ÿå°±å¯ä»¥æ˜ç™½äº†,å¦‚æœæŠŠ xxdog5 æ¢æˆ xxdoga å°±é”™äº†</p><h4 id="example5"><a class="markdownIt-Anchor" href="#example5"></a> example5</h4><blockquote><p>$ crunch 3 3 -p abc<br />è¿™é‡ŒæŒ‡å®šäº† -p å‚æ•°,æ„å‘³ç€å§ a,b,c è¿™ä¸‰ä¸ªå­—ç¬¦è¿›è¡Œç»„åˆ .è¾“å‡ºç»“æœä¸º:<br />abc<br />acb<br />bac<br />bca<br />cab<br />cba</p></blockquote><p>å½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥å†™æˆ <strong>crunch 3 3 -p a b c</strong><br />ä¸¾ä¸€åä¸‰,å†æ¥ä¸€ä¸ªä¾‹å­:</p><blockquote><p>$ crunch 3 3 <strong>-p</strong> i love you<br />è¾“å‡º:<br />iloveyou<br />iyoulove<br />loveiyou<br />loveyoui<br />youilove<br />youlovei<br />å¯çœ‹åˆ°,è¯¥å‚æ•°å§ä¸€ä¸ªè¯çœ‹åšæ•´ä½“æ¥è¿›è¡ŒåŒ¹é…</p></blockquote><h4 id="example6"><a class="markdownIt-Anchor" href="#example6"></a> example6</h4><blockquote><p>$ crunch 3 3 abc <strong>-o START</strong> -c 10 -z bzip2<br />æœ€åä¼šç”Ÿæˆ3ä¸ª.bz2å‹ç¼©æ–‡ä»¶<br />aaa-baa.txt.bz2<br />bab-cab.txt.bz2<br />cac-ccc.txt.bz2</p></blockquote><p>è¿™é‡Œä½¿ç”¨å‚æ•° <strong>-o START</strong>, <strong>-c</strong> è¡¨ç¤ºç”Ÿæˆçš„å­—å…¸æ–‡ä»¶æ¯ä¸ª10è¡Œæ•°æ®,ç›´åˆ°ç”Ÿæˆç»“æŸ,åŠ å…¥ <strong>-z bzip2</strong> è¡¨ç¤ºç„¶åå†æŠŠè¿™äº› .txtæ–‡ä»¶å‹ç¼©æˆåç¼€ä¸º .bz2çš„å‹ç¼©åŒ…</p><p><strong>æ³¨æ„,è¿™é‡Œæ²¡æœ‰å¿…è¦å†æŒ‡å®šç”Ÿæˆå­—å…¸çš„æ–‡ä»¶å!</strong></p><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>å…³äºcrunchçš„ä¾‹å­,å¯ä»¥æŸ¥çœ‹æ–‡æ¡£,æ–‡æ¡£æ˜¯ä¸ªå¥½ä¸œè¥¿~<br />ç†Ÿæ‚‰crunchçš„ä½¿ç”¨,è¿˜æ˜¯å¾ˆé‡è¦çš„â€¦â€¦</p><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>Others</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux libxlså’Œxlslibè¯»å†™Excelæ–‡æ¡£</title>
    <link href="/linux-xls/"/>
    <url>/linux-xls/</url>
    
    <content type="html"><![CDATA[<p>è¿™é‡Œè¦è®¨è®ºçš„æ˜¯ä¸¤æ¬¾å¼€æºåº“ <strong>libxls</strong> å’Œ <strong>xlslib</strong>,å‰è€…ç”¨ä¸ <strong>è¯»</strong> Excel,åè€…ç”¨äº <strong>å†™</strong> .æ‰€ä»¥å¯ä»¥åœ¨Linuxæˆ–Windowsä¸Šä½¿ç”¨</p><span id="more"></span><h3 id="libxlsè¯»excel"><a class="markdownIt-Anchor" href="#libxlsè¯»excel"></a> libxls(è¯»Excel</h3><h4 id="è·å–libxls"><a class="markdownIt-Anchor" href="#è·å–libxls"></a> è·å–libxls</h4><p>å¯ä»¥åœ¨ <a href="http://libxls.sourceforge.net/">å®˜ç½‘</a> è·å–æºä»£ç , ç›®å‰æœ€æ–°ç‰ˆä¸º 1.4.0</p><blockquote><p>unzip libxls-1.4.0.zip<br />cd libxls<br />./configure<br />make<br />make install</p></blockquote><p>æ³¨æ„é»˜è®¤å®‰è£…åˆ° <strong>/usr/local</strong> ç›®å½•ä¸‹,æ‰€ä»¥éœ€è¦è‡ªå·±æ‰‹åŠ¨å¤åˆ¶ç›¸å…³æ–‡ä»¶åˆ°ç³»ç»Ÿç›®å½•ä¸‹</p><blockquote><p>cp -r /usr/local/libxls/include/* /usr/include<br />cp -r /usr/local/libxls/lib/* /usr</p></blockquote><p>è‡³æ­¤åŸºæœ¬ä¸Šå¯ä»¥äº†</p><h4 id="ä¾‹å­"><a class="markdownIt-Anchor" href="#ä¾‹å­"></a> ä¾‹å­</h4><p>test.cpp</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;xls.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> xls;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc,<span class="hljs-keyword">char</span> *argv[])</span> </span>&#123;<br>    <span class="hljs-comment">//ç‰ˆæœ¬ä¿¡æ¯</span><br>    cout&lt;&lt;<span class="hljs-string">&quot;version:&quot;</span>&lt;&lt;xls::<span class="hljs-built_in">xls_getVersion</span>()&lt;&lt;endl;<br>    xlsWorkBook *pwb;<br>    xlsWorkSheet *pws;<br>    <span class="hljs-comment">//æ‰“å¼€ä¸€ä¸ªexcelè¡¨æ ¼</span><br>    pwb=<span class="hljs-built_in">xls_open</span>(<span class="hljs-string">&quot;test.xls&quot;</span>,<span class="hljs-string">&quot;UTF-8&quot;</span>);<br>    <span class="hljs-keyword">if</span>(!pwb)&#123;<br>        cout&lt;&lt;<span class="hljs-string">&quot;open failed!&quot;</span>&lt;&lt;endl;<br>        <span class="hljs-built_in">exit</span>(EXIT_SUCCESS);<br>    &#125;<br>    xlsSummaryInfo *summaryInfo=<span class="hljs-built_in">xls_summaryInfo</span>(pwb);<br>    <span class="hljs-keyword">if</span>(summaryInfo)&#123;<br>        <span class="hljs-keyword">if</span>(summaryInfo-&gt;title)cout&lt;&lt;<span class="hljs-string">&quot;title:&quot;</span>&lt;&lt;summaryInfo-&gt;title&lt;&lt;endl;<br>        <span class="hljs-keyword">if</span>(summaryInfo-&gt;manager)cout&lt;&lt;<span class="hljs-string">&quot;manager:&quot;</span>&lt;&lt;summaryInfo-&gt;manager&lt;&lt;endl;<br>        <span class="hljs-keyword">if</span>(summaryInfo-&gt;lastAuthor)cout&lt;&lt;<span class="hljs-string">&quot;lastAuthor:&quot;</span>&lt;&lt;summaryInfo-&gt;lastAuthor&lt;&lt;endl;<br>        <span class="hljs-keyword">if</span>(summaryInfo-&gt;keywords)cout&lt;&lt;<span class="hljs-string">&quot;keywords:&quot;</span>&lt;&lt;summaryInfo-&gt;keywords&lt;&lt;endl;<br>        <span class="hljs-keyword">if</span>(summaryInfo-&gt;company)cout&lt;&lt;<span class="hljs-string">&quot;company:&quot;</span>&lt;&lt;summaryInfo-&gt;company&lt;&lt;endl;<br>        <span class="hljs-keyword">if</span>(summaryInfo-&gt;comment)cout&lt;&lt;<span class="hljs-string">&quot;comment:&quot;</span>&lt;&lt;summaryInfo-&gt;comment&lt;&lt;endl;<br>        <span class="hljs-keyword">if</span>(summaryInfo-&gt;appName)cout&lt;&lt;<span class="hljs-string">&quot;appName:&quot;</span>&lt;&lt;summaryInfo-&gt;appName&lt;&lt;endl;<br>        <span class="hljs-keyword">if</span>(summaryInfo-&gt;subject)cout&lt;&lt;<span class="hljs-string">&quot;subject:&quot;</span>&lt;&lt;summaryInfo-&gt;subject&lt;&lt;endl;<br>    &#125;<br>    cout&lt;&lt;<span class="hljs-string">&quot;charset:&quot;</span>&lt;&lt;pwb-&gt;charset&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;font name:&quot;</span>&lt;&lt;pwb-&gt;fonts.font-&gt;name&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;font bold:&quot;</span>&lt;&lt;pwb-&gt;fonts.font-&gt;bold&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;å½“å‰è¡¨å:&quot;</span>&lt;&lt;pwb-&gt;sheets.sheet-&gt;name&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;æ€»è¡¨æ•°:&quot;</span>&lt;&lt;pwb-&gt;sheets.count&lt;&lt;endl&lt;&lt;endl;<br>    <span class="hljs-comment">//è·å–ç¬¬ä¸€å¼ è¡¨å• ç´¢å¼•ä»0å¼€å§‹</span><br>    pws= <span class="hljs-built_in">xls_getWorkSheet</span>(pwb,<span class="hljs-number">0</span>);<br>    <span class="hljs-comment">//å¼€å§‹è§£æè¡¨å•</span><br>    <span class="hljs-built_in">xls_parseWorkSheet</span>(pws);<br>    cout&lt;&lt;<span class="hljs-string">&quot;è¡Œæ•°:&quot;</span>&lt;&lt;pws-&gt;rows.lastrow+<span class="hljs-number">1</span>&lt;&lt;endl;<br>    cout&lt;&lt;<span class="hljs-string">&quot;åˆ—æ•°:&quot;</span>&lt;&lt;pws-&gt;rows.lastcol&lt;&lt;endl;<br>    <span class="hljs-comment">//éå†</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; pws-&gt;rows.lastrow+<span class="hljs-number">1</span>; ++i) &#123;<br>        <span class="hljs-comment">//xlsRow = st_row::st_row_data</span><br>        <span class="hljs-comment">//è·å–æ¯ä¸€è¡Œçš„æ•°æ®</span><br>        st_row::st_row_data row= pws-&gt;rows.row[i];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; pws-&gt;rows.lastcol; ++j) &#123;<br>            <span class="hljs-keyword">if</span>(row.cells.cell[j].str) &#123;<br>                cout &lt;&lt; (<span class="hljs-keyword">char</span>*)row.cells.cell[j].str &lt;&lt; <span class="hljs-string">&quot;\t&quot;</span>;<br>            &#125;<br>        &#125;<br>        cout&lt;&lt;endl;<br>    &#125;<br>    <span class="hljs-comment">//å…³é—­</span><br>    <span class="hljs-built_in">xls_close_WS</span>(pws);<br>    <span class="hljs-built_in">xls_close_WB</span>(pwb);<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„,ç”±äºæˆ‘ä½¿ç”¨ clion ç¼–å†™ä»£ç ,æ‰€ä»¥åœ¨é“¾æ¥åº“æ—¶åœ¨ CMakeLists.txt æœ€åä¸€è¡Œæ·»åŠ  <strong>target_link_libraries(libxls_read <a href="http://libxlsreader.so">libxlsreader.so</a>)</strong> å…¶ä¸­ <strong>libxls_read</strong> ä¸ºé¡¹ç›®å.<br />æˆ–è€…ç›´æ¥ <code>g++ test.cpp -o libxls_read -lxlsreader</code></p><p>æµ‹è¯•:<br />å‡è®¾æœ‰ä¸€ä¸ªExcelæ–‡ä»¶<br /><img src="/uploads/images/libxls/file_001.png" alt="img" /></p><p>æ‰§è¡Œç¨‹åºè¾“å‡º</p><blockquote><p>version:1.4.0<br />æ ‡é¢˜:æˆ‘æ˜¯æ ‡é¢˜<br />keywords:æˆ‘æ˜¯å…³é”®å­—<br />comment:è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•<br />subject:æˆ‘æ˜¯ä¸»é¢˜<br />charset:UTF-8<br />font name:æ–‡æ³‰é©¿æ­£é»‘<br />font bold:400<br />å½“å‰è¡¨å:ç¬¬ä¸€å¼ è¡¨å•<br />æ€»è¡¨æ•°:1</p><p>è¡Œæ•°:4<br />åˆ—æ•°:5<br />åˆ˜å¤‡ å…³ç¾½ å¼ é£ æ›¹æ“ åˆ˜ç¦…<br />æ›¹ä¸• èµµäº‘ å­™æƒ é»„ç›– æ›¹æ¤<br />è²‚è‰ å¼ è§’ å­”æ˜ å‘¨ç‘œ å°ä¹”<br />é©¬è¶…</p></blockquote><h3 id="xlslibå†™excel"><a class="markdownIt-Anchor" href="#xlslibå†™excel"></a> xlslib(å†™Excel</h3><h4 id="è·å–xlslib"><a class="markdownIt-Anchor" href="#è·å–xlslib"></a> è·å–xlslib</h4><p>å¯ä»¥ä» <a href="http://sourceforge.net/projects/xlslib/">http://sourceforge.net/projects/xlslib/</a> è·å– xlslibå¹¶ç¼–è¯‘å®‰è£…,åŒæ ·çš„é»˜è®¤ä¹Ÿæ˜¯å®‰è£…åˆ° <strong>/usr/local/include</strong> ,éœ€æ‰‹åŠ¨å¤åˆ¶åˆ°ç³»ç»Ÿç›®å½•ä¸‹</p><blockquote><p>cp -r /usr/local/include/xlslib /usr/include/</p></blockquote><h4 id="ä¾‹å­-2"><a class="markdownIt-Anchor" href="#ä¾‹å­-2"></a> ä¾‹å­</h4><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;xlslib/xlslib.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> xlslib_core;<br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    workbook wb;<br>    string label;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Version: %s\n&quot;</span>,wb.<span class="hljs-built_in">version</span>());<br>    <span class="hljs-comment">//è®¾ç½®å­—ä½“</span><br>    <span class="hljs-keyword">font_t</span> *t=wb.<span class="hljs-built_in">font</span>(<span class="hljs-string">&quot;Ubuntu&quot;</span>);<br>    t-&gt;<span class="hljs-built_in">SetColor</span>(CLR_RED);<br>    t-&gt;<span class="hljs-built_in">SetItalic</span>(<span class="hljs-literal">true</span>);<br>    t-&gt;<span class="hljs-built_in">SetHeight</span>(<span class="hljs-number">20</span>*<span class="hljs-number">15</span>);<br>   <span class="hljs-comment">// t-&gt;SetBoldStyle(BOLDNESS_BOLD);</span><br>    <span class="hljs-keyword">xf_t</span> *xf= wb.<span class="hljs-built_in">xformat</span>();<br>    xf-&gt;<span class="hljs-built_in">SetFillBGColor</span>(CLR_GREEN);<br>    xf-&gt;<span class="hljs-built_in">SetFillFGColor</span>(CLR_RED);<br>    xf-&gt;<span class="hljs-built_in">SetFont</span>(t);<br>    <span class="hljs-comment">//ç¬¬ä¸€å¼ è¡¨å•</span><br>    worksheet *ws=wb.<span class="hljs-built_in">sheet</span>(<span class="hljs-string">&quot;one&quot;</span>);<br>    <span class="hljs-comment">//ç¬¬äºŒå¼ è¡¨å•</span><br>    worksheet* ws2=wb.<span class="hljs-built_in">sheet</span>(<span class="hljs-string">&quot;two&quot;</span>);<br>    ws-&gt;<span class="hljs-built_in">MakeActive</span>();<br>    <span class="hljs-comment">//è®¾ç½®åˆ—å®½åº¦,è¡Œé«˜åº¦</span><br>    ws-&gt;<span class="hljs-built_in">defaultColwidth</span>(<span class="hljs-number">15</span>);<br>    ws-&gt;<span class="hljs-built_in">defaultRowHeight</span>(<span class="hljs-number">25</span>);<br>    <span class="hljs-comment">//6è¡Œ</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">6</span>; ++i) &#123;<br>        <span class="hljs-comment">//6åˆ—</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt;<span class="hljs-number">6</span> ; ++j) &#123;<br>            <span class="hljs-keyword">char</span> buf[<span class="hljs-number">20</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br>            <span class="hljs-built_in">sprintf</span>(buf,<span class="hljs-string">&quot;%d&quot;</span>,i*j);<br>            label=buf;<br>            <span class="hljs-comment">// å†™å…¥</span><br>            <span class="hljs-keyword">cell_t</span> * cell= ws-&gt;<span class="hljs-built_in">label</span>(i,j,label,xf);<br>            <span class="hljs-comment">//æˆ–è€… ws-&gt;number(i,j,i*j,xf);</span><br>            <span class="hljs-comment">//è®¾ç½®å­—ä½“é˜´å½±</span><br>            cell-&gt;<span class="hljs-built_in">fontshadow</span>(<span class="hljs-literal">true</span>);<br>            <span class="hljs-comment">//è®¾ç½®å•å…ƒæ ¼æ–‡æœ¬å¯¹é½</span><br>            cell-&gt;<span class="hljs-built_in">halign</span>(HALIGN_CENTER);<br>            cell-&gt;<span class="hljs-built_in">valign</span>(VALIGN_CENTER);<br>            <span class="hljs-comment">//è®¾ç½®è¡Œé«˜åº¦</span><br>            ws-&gt;<span class="hljs-built_in">rowheight</span>(i,<span class="hljs-number">20</span>*<span class="hljs-number">15</span>);<br>        &#125;<br>    &#125;<br>    range *ran=ws-&gt;<span class="hljs-built_in">rangegroup</span>(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>);<br>    ran-&gt;<span class="hljs-built_in">cellcolor</span>(CLR_GREEN);<br>    <span class="hljs-comment">//ä¿å­˜åˆ°excelæ–‡ä»¶</span><br>    wb.<span class="hljs-built_in">Dump</span>(<span class="hljs-string">&quot;mynew.xls&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux Shellçª—å£åŒ–</title>
    <link href="/linux-shell-window/"/>
    <url>/linux-shell-window/</url>
    
    <content type="html"><![CDATA[<p>å‰æ®µæ—¶é—´åœ¨å­¦ä¹ Linux shellç¼–ç¨‹æ—¶,å‘ç°äº†å‡ ä¸ªæ¯”è¾ƒå¥½ç©çš„å·¥å…·,è¿™é‡Œç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹â€¦(Just for fun!)</p><span id="more"></span><p>ä»¥ä¸‹ä¸‰ä¸ªå…³äºåˆ›å»ºçª—å£éƒ¨ä»¶çš„åŒ…,ä¸€èˆ¬åº”ç”¨åœ¨æ²¡æœ‰çª—å£ç•Œé¢çš„è„šæœ¬(Script)ä¸­</p><h3 id="1dialog"><a class="markdownIt-Anchor" href="#1dialog"></a> 1.Dialog</h3><p>å®‰è£…æ–¹æ³•: <code>apt-get install dialog</code></p><p>help:</p><figure class="highlight dts"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dts">cdialog (ComeOn Dialog!) version <span class="hljs-number">1.3</span><span class="hljs-number">-20171209</span><br>Copyright <span class="hljs-number">2000</span><span class="hljs-number">-2016</span>,<span class="hljs-number">2017</span> Thomas E. Dickey<br>This is free software; see the source for copying conditions.  There is NO<br>warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.<br>* Display dialog boxes from shell scripts *<br><span class="hljs-symbol">Usage:</span> dialog <span class="hljs-params">&lt;options&gt;</span> &#123; --and-widget <span class="hljs-params">&lt;options&gt;</span> &#125;<br>where options are <span class="hljs-string">&quot;common&quot;</span> options, followed by <span class="hljs-string">&quot;box&quot;</span> options<br>Special options:<br>  [--create-rc <span class="hljs-string">&quot;file&quot;</span>]<br>Common options:<br>  [--ascii-lines] [--aspect <span class="hljs-params">&lt;ratio&gt;</span>] [--backtitle <span class="hljs-params">&lt;backtitle&gt;</span>] [--beep]<br>  [--beep-after] [--begin <span class="hljs-params">&lt;y&gt;</span> <span class="hljs-params">&lt;x&gt;</span>] [--cancel-label <span class="hljs-params">&lt;str&gt;</span>] [--clear]<br>  [--colors] [--column-separator <span class="hljs-params">&lt;str&gt;</span>] [--cr-wrap] [--date-format <span class="hljs-params">&lt;str&gt;</span>]<br>  [--default-button <span class="hljs-params">&lt;str&gt;</span>] [--default-item <span class="hljs-params">&lt;str&gt;</span>] [--defaultno]<br>  [--exit-label <span class="hljs-params">&lt;str&gt;</span>] [--extra-button] [--extra-label <span class="hljs-params">&lt;str&gt;</span>]<br>  [--help-button] [--help-label <span class="hljs-params">&lt;str&gt;</span>] [--help-status] [--help-tags]<br>  [--hfile <span class="hljs-params">&lt;str&gt;</span>] [--hline <span class="hljs-params">&lt;str&gt;</span>] [--ignore] [--input-fd <span class="hljs-params">&lt;fd&gt;</span>]<br>  [--insecure] [--item-help] [--keep-tite] [--keep-window] [--last-key]<br>  [--max-input <span class="hljs-params">&lt;n&gt;</span>] [--no-cancel] [--no-collapse] [--no-cr-wrap]<br>  [--no-items] [--no-kill] [--no-label <span class="hljs-params">&lt;str&gt;</span>] [--no-lines] [--no-mouse]<br>  [--no-nl-expand] [--no-ok] [--no-shadow] [--no-tags] [--nook]<br>  [--ok-label <span class="hljs-params">&lt;str&gt;</span>] [--output-fd <span class="hljs-params">&lt;fd&gt;</span>] [--output-separator <span class="hljs-params">&lt;str&gt;</span>]<br>  [--print-maxsize] [--print-size] [--print-version] [--quoted]<br>  [--reorder] [--scrollbar] [--separate-output] [--separate-widget <span class="hljs-params">&lt;str&gt;</span>]<br>  [--shadow] [--single-quoted] [--size-err] [--sleep <span class="hljs-params">&lt;secs&gt;</span>] [--stderr]<br>  [--stdout] [--tab-correct] [--tab-len <span class="hljs-params">&lt;n&gt;</span>] [--time-format <span class="hljs-params">&lt;str&gt;</span>]<br>  [--timeout <span class="hljs-params">&lt;secs&gt;</span>] [--title <span class="hljs-params">&lt;title&gt;</span>] [--trace <span class="hljs-params">&lt;file&gt;</span>] [--trim]<br>  [--version] [--visit-items] [--week-start <span class="hljs-params">&lt;str&gt;</span>] [--yes-label <span class="hljs-params">&lt;str&gt;</span>]<br>Box options:<br>  --buildlist    <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;list-height&gt;</span> <span class="hljs-params">&lt;tag1&gt;</span> <span class="hljs-params">&lt;item1&gt;</span> <span class="hljs-params">&lt;status1&gt;</span>...<br>  --calendar     <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;day&gt;</span> <span class="hljs-params">&lt;month&gt;</span> <span class="hljs-params">&lt;year&gt;</span><br>  --checklist    <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;list height&gt;</span> <span class="hljs-params">&lt;tag1&gt;</span> <span class="hljs-params">&lt;item1&gt;</span> <span class="hljs-params">&lt;status1&gt;</span>...<br>  --dselect      <span class="hljs-params">&lt;directory&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --editbox      <span class="hljs-params">&lt;file&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --form         <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;form height&gt;</span> <span class="hljs-params">&lt;label1&gt;</span> <span class="hljs-params">&lt;l_y1&gt;</span> <span class="hljs-params">&lt;l_x1&gt;</span> <span class="hljs-params">&lt;item1&gt;</span> <span class="hljs-params">&lt;i_y1&gt;</span> <span class="hljs-params">&lt;i_x1&gt;</span> <span class="hljs-params">&lt;flen1&gt;</span> <span class="hljs-params">&lt;ilen1&gt;</span>...<br>  --fselect      <span class="hljs-params">&lt;filepath&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --gauge        <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> [<span class="hljs-params">&lt;percent&gt;</span>]<br>  --infobox      <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --inputbox     <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> [<span class="hljs-params">&lt;init&gt;</span>]<br>  --inputmenu    <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;menu height&gt;</span> <span class="hljs-params">&lt;tag1&gt;</span> <span class="hljs-params">&lt;item1&gt;</span>...<br>  --menu         <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;menu height&gt;</span> <span class="hljs-params">&lt;tag1&gt;</span> <span class="hljs-params">&lt;item1&gt;</span>...<br>  --mixedform    <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;form height&gt;</span> <span class="hljs-params">&lt;label1&gt;</span> <span class="hljs-params">&lt;l_y1&gt;</span> <span class="hljs-params">&lt;l_x1&gt;</span> <span class="hljs-params">&lt;item1&gt;</span> <span class="hljs-params">&lt;i_y1&gt;</span> <span class="hljs-params">&lt;i_x1&gt;</span> <span class="hljs-params">&lt;flen1&gt;</span> <span class="hljs-params">&lt;ilen1&gt;</span> <span class="hljs-params">&lt;itype&gt;</span>...<br>  --mixedgauge   <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;percent&gt;</span> <span class="hljs-params">&lt;tag1&gt;</span> <span class="hljs-params">&lt;item1&gt;</span>...<br>  --msgbox       <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --passwordbox  <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> [<span class="hljs-params">&lt;init&gt;</span>]<br>  --passwordform <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;form height&gt;</span> <span class="hljs-params">&lt;label1&gt;</span> <span class="hljs-params">&lt;l_y1&gt;</span> <span class="hljs-params">&lt;l_x1&gt;</span> <span class="hljs-params">&lt;item1&gt;</span> <span class="hljs-params">&lt;i_y1&gt;</span> <span class="hljs-params">&lt;i_x1&gt;</span> <span class="hljs-params">&lt;flen1&gt;</span> <span class="hljs-params">&lt;ilen1&gt;</span>...<br>  --pause        <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;seconds&gt;</span><br>  --prgbox       <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;command&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --programbox   <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --progressbox  <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --radiolist    <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;list height&gt;</span> <span class="hljs-params">&lt;tag1&gt;</span> <span class="hljs-params">&lt;item1&gt;</span> <span class="hljs-params">&lt;status1&gt;</span>...<br>  --rangebox     <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;min-value&gt;</span> <span class="hljs-params">&lt;max-value&gt;</span> <span class="hljs-params">&lt;default-value&gt;</span><br>  --tailbox      <span class="hljs-params">&lt;file&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --tailboxbg    <span class="hljs-params">&lt;file&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --textbox      <span class="hljs-params">&lt;file&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>  --timebox      <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;hour&gt;</span> <span class="hljs-params">&lt;minute&gt;</span> <span class="hljs-params">&lt;second&gt;</span><br>  --treeview     <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span> <span class="hljs-params">&lt;list-height&gt;</span> <span class="hljs-params">&lt;tag1&gt;</span> <span class="hljs-params">&lt;item1&gt;</span> <span class="hljs-params">&lt;status1&gt;</span> <span class="hljs-params">&lt;depth1&gt;</span>...<br>  --yesno        <span class="hljs-params">&lt;text&gt;</span> <span class="hljs-params">&lt;height&gt;</span> <span class="hljs-params">&lt;width&gt;</span><br>Auto-size with height and width = <span class="hljs-number">0.</span> Maximize with height and width = <span class="hljs-number">-1.</span><br>Global-auto-size if also menu_height/list_height = <span class="hljs-number">0.</span><br><br></code></pre></div></td></tr></table></figure><h4 id="dialog-å‘½ä»¤é€‰é¡¹option"><a class="markdownIt-Anchor" href="#dialog-å‘½ä»¤é€‰é¡¹option"></a> dialog å‘½ä»¤é€‰é¡¹(option)</h4><blockquote><p><strong>â€“add-widget</strong> ç»§ç»­ä¸‹ä¸ªå¯¹è¯æ¡†,ç›´åˆ°æŒ‰ä¸‹Escæˆ–CancelæŒ‰é’®<br /><strong>â€“aspect ratio</strong> æŒ‡å®šçª—å£å®½åº¦å’Œé«˜åº¦çš„å®½é«˜æ¯”<br /><strong>â€“backtitle title</strong> æŒ‡å®šæ˜¾ç¤ºåœ¨å±å¹•é¡¶éƒ¨èƒŒæ™¯ä¸Šçš„æ ‡é¢˜<br /><strong>â€“begin x y</strong> æŒ‡å®šçª—å£å·¦ä¸Šè§’çš„èµ·å§‹ä½ç½®<br /><strong>â€“cancel-label label</strong> æŒ‡å®šCancelæŒ‰é’®çš„æ›¿ä»£æ ‡ç­¾<br /><strong>â€“clear</strong> ç”¨é»˜è®¤çš„å¯¹è¯èƒŒæ™¯è‰²æ¥æ¸…ç©ºå±å¹•å†…å®¹<br /><strong>â€“colors</strong> åœ¨å¯¹è¯æ–‡æœ¬ä¸­åµŒå…¥ANSIè‰²å½©ç¼–ç <br /><strong>â€“cr-wrap</strong> åœ¨å¯¹è¯æ–‡æœ¬ä¸­å…è®¸ä½¿ç”¨æ¢è¡Œç¬¦å¹¶å¼ºåˆ¶æ¢è¡Œ<br /><strong>â€“create-rc file</strong> å°†ç¤ºä¾‹é…ç½®æ–‡ä»¶çš„å†…å®¹å¤åˆ¶åˆ°æŒ‡å®šçš„fileæ–‡ä»¶ä¸­ 1<br /><strong>â€“defaultno</strong> å°†yes/noå¯¹è¯æ¡†çš„é»˜è®¤ç­”æ¡ˆè®¾ä¸ºNo<br /><strong>â€“default-item string</strong> è®¾å®šå¤é€‰åˆ—è¡¨ã€è¡¨å•æˆ–èœå•å¯¹è¯ä¸­çš„é»˜è®¤é¡¹<br /><strong>â€“exit-label label</strong> æŒ‡å®šExitæŒ‰é’®çš„æ›¿ä»£æ ‡ç­¾<br /><strong>â€“extra-button</strong> åœ¨OKæŒ‰é’®å’ŒCancelæŒ‰é’®ä¹‹é—´æ˜¾ç¤ºä¸€ä¸ªé¢å¤–æŒ‰é’®<br /><strong>â€“extra-label label</strong> æŒ‡å®šé¢å¤–æŒ‰é’®çš„æ›¿ä»£æ ‡ç­¾<br /><strong>â€“help</strong> æ˜¾ç¤ºdialogå‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯<br /><strong>â€“help-button</strong> åœ¨OKæŒ‰é’®å’ŒCancelæŒ‰é’®åæ˜¾ç¤ºä¸€ä¸ªHelpæŒ‰é’®<br /><strong>â€“help-label label</strong> æŒ‡å®šHelpæŒ‰é’®çš„æ›¿ä»£æ ‡ç­¾<br /><strong>â€“help-status</strong> å½“é€‰å®šHelpæŒ‰é’®å,åœ¨å¸®åŠ©ä¿¡æ¯åå†™å…¥å¤šé€‰åˆ—è¡¨ã€å•é€‰åˆ—è¡¨æˆ–è¡¨å•ä¿¡æ¯<br /><strong>â€“ignore</strong> å¿½ç•¥dialogä¸èƒ½è¯†åˆ«çš„é€‰é¡¹<br /><strong>â€“input-fd fd</strong> æŒ‡å®š STDIN ä¹‹å¤–çš„å¦ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦<br /><strong>â€“insecure</strong> åœ¨passwordéƒ¨ä»¶ä¸­é”®å…¥å†…å®¹æ—¶æ˜¾ç¤ºæ˜Ÿå·<br /><strong>â€“item-help</strong> ä¸ºå¤šé€‰åˆ—è¡¨ã€å•é€‰åˆ—è¡¨æˆ–èœå•ä¸­çš„æ¯ä¸ªæ ‡å·åœ¨å±å¹•çš„åº•éƒ¨æ·»åŠ ä¸€ä¸ªå¸®åŠ©æ <br /><strong>â€“keep-window</strong> ä¸è¦æ¸…é™¤å±å¹•ä¸Šæ˜¾ç¤ºè¿‡çš„éƒ¨ä»¶<br /><strong>â€“max-input size</strong> æŒ‡å®šè¾“å…¥çš„æœ€å¤§å­—ç¬¦ä¸²é•¿åº¦ã€‚é»˜è®¤ä¸º2048<br /><strong>â€“nocancel</strong> éšè—CancelæŒ‰é’®<br /><strong>â€“no-collapse</strong> ä¸è¦å°†å¯¹è¯æ–‡æœ¬ä¸­çš„åˆ¶è¡¨ç¬¦è½¬æ¢æˆç©ºæ ¼<br /><strong>â€“no-kill</strong> å°†tailboxbgå¯¹è¯æ”¾åˆ°åå°,å¹¶ç¦æ­¢è¯¥è¿›ç¨‹çš„ SIGHUP ä¿¡å·<br /><strong>â€“no-label label</strong> ä¸ºNoæŒ‰é’®æŒ‡å®šæ›¿ä»£æ ‡ç­¾<br /><strong>â€“no-shadow</strong> ä¸è¦æ˜¾ç¤ºå¯¹è¯çª—å£çš„é˜´å½±æ•ˆæœ<br /><strong>â€“ok-label label</strong> æŒ‡å®šOKæŒ‰é’®çš„æ›¿ä»£æ ‡ç­¾</p></blockquote><p><strong>æ³¨æ„: dialog é»˜è®¤æ˜¯é‡å®šå‘åˆ°æ ‡å‡†é”™è¯¯(stderr).</strong><br />ä¸è¿‡å¯ä»¥æ”¹å˜è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º <strong>â€“stdout</strong> .è¿™æ ·ç”¨è„šæœ¬ä¹Ÿå°±èƒ½å¾ˆå¿«è·å–è¿”å›çš„æ–‡æœ¬äº†</p><h4 id="ä¾‹å­"><a class="markdownIt-Anchor" href="#ä¾‹å­"></a> ä¾‹å­</h4><blockquote><p>$ dialog â€“timeout 5 <strong>â€“stdout</strong> â€“menu â€˜Choose a job: â€˜ 30 10 25 â€˜Programmerâ€™ 1 â€˜Teacherâ€™ 2 â€˜Workerâ€™ 3</p></blockquote><p><a href="http://example.sh">example.sh</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>name=$(dialog --max-input 5 --timeout 5 --inputbox &#x27;Please enter your name: &#x27; 10 10 &#x27;root&#x27; --stdout)<br>job=$(dialog  --timeout 5 --stdout --menu  &#x27;Choose a job: &#x27; 30 10 25 &#x27;Programmer&#x27; 1 &#x27;Teacher&#x27; 2 &#x27;Worker&#x27; 3)<br>clear<br>if [ -n &quot;$name&quot; ];then<br>    echo &quot;Your name is: [$name]&quot;<br>else<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-keyword">do</span> something...</span><br>fi<br>echo -e &quot;You are a :&quot;$job&quot;\t:)&quot;<br></code></pre></div></td></tr></table></figure><h3 id="2whiptail"><a class="markdownIt-Anchor" href="#2whiptail"></a> 2.whiptail</h3><p>å¯¹æ¯”dialog,è¿™ä¸ªå·¥å…·å‚æ•°å°±å°‘äº†ä¸€ç‚¹,åŠŸèƒ½ä¹Ÿå°±å°‘äº†ç‚¹,ä½†åŸºæœ¬çš„è¿˜æ˜¯<br />è¦æœ‰çš„</p><blockquote><p>There are visual differences which are not addressed by command-line options:</p><p><strong>dialog</strong> centers lists within the window. whiptail typically puts lists against<br />the left margin.</p><p><strong>whiptail</strong> uses angle brackets (â€œ&lt;â€ and â€œ&gt;â€) for marking buttons. dialog uses<br />square brackets.</p><p><strong>whiptail</strong> marks the limits of subtitles with vertical bars. dialog does not<br />mark the limits.</p><p><strong>whiptail</strong> attempts to mark the top/bottom cells of a scrollbar with up/down arâ€<br />rows. When it cannot do this, it fills those cells with the background color<br />of the scrollbar and confusing the user. dialog uses the entire scrollbar<br />space, thereby getting better resolution.</p></blockquote><h4 id="æ³¨æ„"><a class="markdownIt-Anchor" href="#æ³¨æ„"></a> æ³¨æ„</h4><p><strong>Most whiptail scripts write tostandard error, but error messages may also be written there, dependâ€ing on your script.</strong></p><p>help</p><figure class="highlight arduino"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arduino">Box options: <br>--msgbox &lt;text&gt; &lt;height&gt; &lt;width&gt;<br>--yesno  &lt;text&gt; &lt;height&gt; &lt;width&gt;<br>--infobox &lt;text&gt; &lt;height&gt; &lt;width&gt;<br>--inputbox &lt;text&gt; &lt;height&gt; &lt;width&gt; [init] <br>--passwordbox &lt;text&gt; &lt;height&gt; &lt;width&gt; [init] <br>--textbox &lt;file&gt; &lt;height&gt; &lt;width&gt;<br>--menu &lt;text&gt; &lt;height&gt; &lt;width&gt; &lt;listheight&gt; [tag item] ...<br>--checklist &lt;text&gt; &lt;height&gt; &lt;width&gt; &lt;listheight&gt; [tag item status]...<br>--radiolist &lt;text&gt; &lt;height&gt; &lt;width&gt; &lt;listheight&gt; [tag item status]...<br>--gauge &lt;text&gt; &lt;height&gt; &lt;width&gt; &lt;percent&gt;<br>Options: (depend on box-option)<br>--clearclear screen on exit<br>--defaultno<span class="hljs-keyword">default</span> no button<br>--<span class="hljs-keyword">default</span>-item &lt;string&gt;set <span class="hljs-keyword">default</span> string<br>--fb, --fullbuttonsuse full buttons<br>--nocancelno cancel button<br>--yes-button &lt;text&gt;set text of yes button<br>--no-button &lt;text&gt;set text of no button<br>--ok-button &lt;text&gt;set text of ok button<br>--cancel-button &lt;text&gt;set text of cancel button<br>--noitemdon<span class="hljs-number">&#x27;</span>t display items<br>--notagsdon<span class="hljs-number">&#x27;</span>t display tags<br>--separate-outputoutput one line at a time<br>--output-fd &lt;fd&gt;output to fd, <span class="hljs-keyword">not</span> stdout<br>--title &lt;title&gt;display title<br>--backtitle &lt;backtitle&gt;display backtitle<br>--scrolltextforce vertical scrollbars<br>--topleftput window in top-left corner<br>-h, --helpprint <span class="hljs-keyword">this</span> message<br>-v, --versionprint version information<br><br></code></pre></div></td></tr></table></figure><h4 id="ä¾‹å­-2"><a class="markdownIt-Anchor" href="#ä¾‹å­-2"></a> ä¾‹å­</h4><blockquote><p>$ whiptail â€“title â€˜Messageâ€™ â€“msgbox â€˜Hi man~â€™ 10 20 â€“ok-button â€˜OKâ€™<br />$ whiptail â€“title â€˜Loginâ€™ â€“output-fd 1 â€“inputbox â€˜Please enter username: â€˜ 10 20 â€˜rootâ€™</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>echo &quot;&quot; &gt; .tmp_username<br>echo &quot;&quot; &gt; .tmp_passphras<br>username=$(whiptail --title &#x27;Login&#x27; --inputbox &#x27;Please enter username: &#x27; 10 20 &#x27;root&#x27; 1&gt;&amp;2 2&gt;.tmp_username)<br>if [ &quot;$?&quot; -eq 0 ];then<br>    username=$(cat .tmp_username)<br>    if [[ -n $username  ]];then<br>        echo &quot;==&gt;&quot;$username<br>    else<br>        echo &#x27;Null Username!&#x27;<br>    fi<br>else<br>    echo &quot;ERROR=&gt; &quot;$?<br>    exit<br>fi<br>passphras=$(whiptail --title &#x27;Login&#x27; --passwordbox &#x27;Please enter password: &#x27; 10 20 1&gt;&amp;2 2&gt;.tmp_passphras)<br>if [ &quot;$?&quot; -eq 0 ];then<br>    passphras=$(cat .tmp_passphras)<br>    if [[ -n $passphras  ]];then<br>        echo &quot;==&gt;&quot;$passphras<br>    else<br>        echo &#x27;Null Passphras!&#x27;<br>    fi<br>else<br>    echo &quot;ERROR=&gt; &quot;$?<br>    exit<br>fi<br>rm .tmp_username<br>rm .tmp_passphras<br></code></pre></div></td></tr></table></figure><h3 id="3zenity"><a class="markdownIt-Anchor" href="#3zenity"></a> 3.Zenity</h3><p>é€‚ç”¨äº GNOMEç¯å¢ƒ çš„å›¾å½¢åŒ–ç•Œé¢åŒ…</p><figure class="highlight pgsql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pgsql">zenity <span class="hljs-comment">--help</span><br>ç”¨æ³•ï¼š<br>  zenity [<span class="hljs-keyword">OPTION</span>â€¦]<br>å¸®åŠ©é€‰é¡¹ï¼š<br>  -h, <span class="hljs-comment">--help                               æ˜¾ç¤ºå¸®åŠ©é€‰é¡¹</span><br>  <span class="hljs-comment">--help-all                               æ˜¾ç¤ºå…¨éƒ¨å¸®åŠ©é€‰é¡¹</span><br>  <span class="hljs-comment">--help-general                           æ˜¾ç¤ºå¸¸è§„é€‰é¡¹</span><br>  <span class="hljs-comment">--help-calendar                          æ˜¾ç¤ºæ—¥å†é€‰é¡¹</span><br>  <span class="hljs-comment">--help-entry                             æ˜¾ç¤ºæ–‡å­—è¾“å…¥é€‰é¡¹</span><br>  <span class="hljs-comment">--help-error                             æ˜¾ç¤ºé”™è¯¯é€‰é¡¹</span><br>  <span class="hljs-comment">--help-info                              æ˜¾ç¤ºä¿¡æ¯é€‰é¡¹</span><br>  <span class="hljs-comment">--help-file-selection                    æ˜¾ç¤ºæ–‡ä»¶é€‰æ‹©é€‰é¡¹</span><br>  <span class="hljs-comment">--help-list                              æ˜¾ç¤ºåˆ—è¡¨é€‰é¡¹</span><br>  <span class="hljs-comment">--help-notification                      æ˜¾ç¤ºé€šçŸ¥å›¾æ ‡é€‰é¡¹</span><br>  <span class="hljs-comment">--help-progress                          æ˜¾ç¤ºè¿›åº¦é€‰é¡¹</span><br>  <span class="hljs-comment">--help-question                          æ˜¾ç¤ºé—®é¢˜é€‰é¡¹</span><br>  <span class="hljs-comment">--help-warning                           æ˜¾ç¤ºè­¦å‘Šé€‰é¡¹</span><br>  <span class="hljs-comment">--help-scale                             æ˜¾ç¤ºèŒƒå›´é€‰é¡¹</span><br>  <span class="hljs-comment">--help-text-info                         æ˜¾ç¤ºæ–‡æœ¬ä¿¡æ¯é€‰é¡¹</span><br>  <span class="hljs-comment">--help-color-selection                   æ˜¾ç¤ºé¢œè‰²é€‰æ‹©é€‰é¡¹</span><br>  <span class="hljs-comment">--help-password                          æ˜¾ç¤ºå£ä»¤å¯¹è¯æ¡†é€‰é¡¹</span><br>  <span class="hljs-comment">--help-forms                             æ˜¾ç¤ºè¡¨å•å¯¹è¯æ¡†é€‰é¡¹</span><br>  <span class="hljs-comment">--help-misc                              æ˜¾ç¤ºæ‚ç±»é€‰é¡¹</span><br>  <span class="hljs-comment">--help-gtk                               æ˜¾ç¤º GTK+ é€‰é¡¹</span><br>åº”ç”¨ç¨‹åºé€‰é¡¹ï¼š<br>  <span class="hljs-comment">--calendar                               æ˜¾ç¤ºæ—¥å†å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--entry                                  æ˜¾ç¤ºæ–‡æœ¬è¾“å…¥å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--error                                  æ˜¾ç¤ºé”™è¯¯å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--info                                   æ˜¾ç¤ºä¿¡æ¯å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--file-selection                         æ˜¾ç¤ºæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--list                                   æ˜¾ç¤ºåˆ—è¡¨å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--notification                           æ˜¾ç¤ºé€šçŸ¥</span><br>  <span class="hljs-comment">--progress                               æ˜¾ç¤ºè¿›åº¦æŒ‡ç¤ºå¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--question                               æ˜¾ç¤ºé—®é¢˜å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--warning                                æ˜¾ç¤ºè­¦å‘Šå¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--scale                                  æ˜¾ç¤ºèŒƒå›´å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--text-info                              æ˜¾ç¤ºæ–‡æœ¬ä¿¡æ¯å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--color-selection                        æ˜¾ç¤ºé¢œè‰²é€‰æ‹©å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--password                               æ˜¾ç¤ºå£ä»¤å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--forms                                  æ˜¾ç¤ºè¡¨å•å¯¹è¯æ¡†</span><br>  <span class="hljs-comment">--display=DISPLAY                        X display to use</span><br><br></code></pre></div></td></tr></table></figure><blockquote><p>$ zenity â€“help-info<br />ç”¨æ³•ï¼š<br />zenity [OPTIONâ€¦]</p><p>ä¿¡æ¯é€‰é¡¹<br />â€“info æ˜¾ç¤ºä¿¡æ¯å¯¹è¯æ¡†<br />â€“text=æ–‡å­— è®¾ç½®å¯¹è¯æ¡†æ–‡å­—<br />â€“icon-name=å›¾æ ‡å è®¾ç½®å¯¹è¯æ¡†å›¾æ ‡<br />â€“no-wrap ä¸å¯ç”¨æ–‡æœ¬è‡ªåŠ¨æ¢è¡Œ<br />â€“no-markup ä¸å¯ç”¨ pango æ ‡è®°<br />â€“ellipsize åœ¨å¯¹è¯æ¡†æ–‡æœ¬ä¸­å¯ç”¨ç®€ç•¥æ˜¾ç¤ºã€‚è¿™å¯ä»¥ä¿®å¤å¸¦æœ‰é•¿æ–‡æœ¬çš„çª—å£çš„å°ºå¯¸è¿‡å¤§ã€‚</p></blockquote><p>æ›´å¤šä¿¡æ¯ man</p><blockquote><p>$ zenity â€“info â€“text=â€™Hello Worldâ€™ â€“title=â€™Messgeâ€™ â€“width=30 â€“height=30 â€“timeout=3<br />$ find . -name â€˜<em>â€™ | zenity â€“progress â€“pulsate<br />$ find . -name â€˜</em>â€™ | zenity â€“list â€“title â€œSearch Resultsâ€ â€“text â€œFinding all header filesâ€¦â€ â€“column â€œFilesâ€</p></blockquote><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>ç°åœ¨ï¼Œç»™å‡ºä¸€ä¸ªä¾‹å­æ¥å®ç°MySQLæ•°æ®åº“æ’å…¥æ•°æ®ï¼Œç”¨åˆ°äº† <strong>dialog</strong></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>exit_code=0<br>is_reg_ok=0<br>trap &quot;echo;echo Have fun!;&quot; EXIT<br><span class="hljs-meta">#</span><span class="bash"> get datetime</span><br>get_datenow()&#123;<br>    local now=$(date +&#x27;%Y-%m-%d %H:%M:%S&#x27;)<br>    echo $now<br>&#125;<br><span class="hljs-meta">#</span><span class="bash"> start MYSQL server</span><br>start_MYSQL_server()&#123;<br>    echo &#x27;Starting MYSQL Server...&#x27;<br>    service mysql start<br>    echo &#x27;MHSQL Started!&#x27;<br>&#125;<br><span class="hljs-meta">#</span><span class="bash"> showed user information when registered successfully</span><br>show_user_info()&#123;<br>    if [[ $is_reg_ok -eq 1 ]];then<br>        echo<br>        #shift<br>        echo -e &quot;UserName: [ \033[1;33m$1\033[0m ]&quot;<br>        echo -e &quot;PassWord: [ \033[1;33m$2\033[0m ]&quot;<br>        echo -e &quot;ID Name: [ \033[1;33m$3\033[0m ]&quot;<br>        echo -e &quot;Register Date: [ \033[1;33m$4\033[0m ]&quot;<br>        echo<br>    fi<br>&#125;<br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment">###########################################</span></span><br><span class="hljs-meta">#</span><span class="bash"></span><br><span class="bash"><span class="hljs-comment">#       this is a bash script that</span></span> <br><span class="hljs-meta">#</span><span class="bash">       quickly inset user data to mysql server database</span><br><span class="hljs-meta">#</span><span class="bash"></span><br><span class="bash"><span class="hljs-comment">############################################</span></span><br>echo<br>echo -e &quot;Welcome to here ,you can register the account quickly...so let &#x27;s go!&#x27;&quot;<br>echo<br>read -p &#x27;Your username: &#x27; -t 8 -r reg_user<br>if [ -z $reg_user ];then echo;echo &#x27;Empty!&#x27;; exit;fi<br>read -p &#x27;Your password: &#x27; -t 8 -r reg_pass<br>if [ -z $reg_pass ];then echo;echo &#x27;Empty!&#x27;; exit;fi<br>read -p &#x27;Your password[confirm]: &#x27; -s -t 8 -r reg_pass_confirm<br>if [ -z $reg_pass_confirm ];then echo;echo &#x27;Password not same!&#x27;; exit;fi<br>echo<br>read -p &#x27;Your ID name: &#x27; -t 8 -r reg_idname<br>if [ -z $reg_idname ];then echo;echo &#x27;Empty!&#x27;; exit;fi<br>start_MYSQL_server<br><span class="hljs-meta">#</span><span class="bash"> here append a --stdout instead of default --stderr,so we can get the result....</span><br>username=$(dialog --max-input 8 --timeout 8 --inputbox &#x27;Please enter MYSQL username: &#x27; 10 10 &#x27;root&#x27; --stdout)<br>exit_code=$?<br>password=$(dialog --max-input 15 --timeout 8 --passwordbox &#x27;Please enter MYSQL password: &#x27; 10 10 --stdout)<br>clear<br><span class="hljs-meta">#</span><span class="bash"> check the username is empty</span><br>if [ &quot;$exit_code&quot; -eq 0 ];then<br>    if [ -z &quot;$username&quot; ] ;then<br>        echo -e &quot;\033[1;31mNot Empty Username!\033[0m&quot;<br>        exit<br>    fi<br>else<br>    exit<br>fi<br>mysql_string=&quot;mysql -u$&#123;username&#125; -p$&#123;password&#125;&quot; <br>now_string=$(get_datenow)<br><span class="hljs-meta">#</span><span class="bash"> register ==&gt; insert data to mysql</span><br><span class="hljs-meta">$</span><span class="bash">&#123;mysql_string&#125; --execute=<span class="hljs-string">&quot;INSERT INTO db_info.tb_users (username,password,idname,reg_datetime) values (&#x27;<span class="hljs-variable">$&#123;reg_user&#125;</span>&#x27;,&#x27;<span class="hljs-variable">$&#123;reg_pass_confirm&#125;</span>&#x27;,&#x27;<span class="hljs-variable">$&#123;reg_idname&#125;</span>&#x27;,&#x27;<span class="hljs-variable">$&#123;now_string&#125;</span>&#x27;);&quot;</span></span><br>if [ &quot;$?&quot; -eq 0 ];then<br>    echo -e &quot;\033[1;32mRegister successfully!\033[0m&quot;<br>    let is_reg_ok=1 <br>    show_user_info $reg_user $reg_pass_confirm $reg_idname $now_string<br>    exit 0<br>else<br>    echo -e &quot;\033[1;31mRegister failed!\033[0m&quot;<br>    exit 1<br>fi<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vimæ”¯æŒPython2/Python3</title>
    <link href="/vim-support-python/"/>
    <url>/vim-support-python/</url>
    
    <content type="html"><![CDATA[<p>Archlinuxå®‰è£…vimæ˜¯é»˜è®¤åº”è¯¥æ˜¯æ”¯æŒPython2å’ŒPython3çš„ï¼Œè€ŒUbuntuç­‰è‹¥ç›´æ¥å®‰è£…vimåˆ™åªæ”¯æŒPython3ã€‚é‚£ä¹ˆè¿™æ ·çš„è¯vimå°±æ— æ³•ä½¿ç”¨YCMæ’ä»¶äº†ï¼Œå› æ­¤æœ¬æ–‡ä»‹ç»ä»æºä»£ç å®‰è£…vimæ”¯æŒä»¥Python2å’ŒPython3ã€‚</p><span id="more"></span><h3 id="æŸ¥çœ‹vimæ˜¯å¦æ”¯æŒpython"><a class="markdownIt-Anchor" href="#æŸ¥çœ‹vimæ˜¯å¦æ”¯æŒpython"></a> æŸ¥çœ‹vimæ˜¯å¦æ”¯æŒPython</h3><p>ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">vim --version<br></code></pre></div></td></tr></table></figure><p>è‹¥æ˜¾ç¤ºä¸€ä¸‹ï¼Œåˆ™è¡¨ç¤ºé»˜è®¤ä¸æ”¯æŒã€‚</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">-python/dyn<br>+python3/dyn <br></code></pre></div></td></tr></table></figure><h3 id="ç¼–è¯‘vimæºä»£ç å®‰è£…vim"><a class="markdownIt-Anchor" href="#ç¼–è¯‘vimæºä»£ç å®‰è£…vim"></a> ç¼–è¯‘vimæºä»£ç ï¼Œå®‰è£…vim</h3><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/vim/vim.git<br><span class="hljs-built_in">cd</span> vim<br>sudo apt-get install libncurses5-dev python-dev python3-dev<br><br>./configure --with-features=huge \<br>-enable-rubyinterp \<br>-enable-pythoninterp \<br>-enable-python3interp \<br>--enable-luainterp \<br>--enable-perlinterp \<br>--enable-multibyte \<br>--enable-cscope \<br>--with-python-config-dir=/usr/lib/python2.7/config-x86_64-linux-gnu/ \<br>--with-python3-config-dir=/usr/lib/python3.7/config-3.7m-x86_64-linux-gnu/<br><br>make<br>sudo make install<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­ <code>--with-python-config-dir</code> å’Œ <code>--with-python3-config-dir</code> è§†è‡ªå·±Pythonç›®å½•è€Œå®šã€‚</p><p>å†æ¬¡æŸ¥çœ‹vimç‰ˆæœ¬å°±å‘ç°æ”¯æŒPythonäº†ï¼</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Vim</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux dlopen åŠ è½½åŠ¨æ€é“¾æ¥åº“</title>
    <link href="/linux-dlopen/"/>
    <url>/linux-dlopen/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h3><p>è¯´åˆ°åŠ è½½åº“,ç¬¬ä¸€ä¸ªæ–¹æ³•å°±æ˜¯åŒ…å«åº“çš„å¤´æ–‡ä»¶,åœ¨ç¼–è¯‘æ—¶é€šè¿‡  åŠ è½½é“¾æ¥åº“.ç¬¬äºŒç§æ–¹æ³•åœ¨è¿è¡Œæ—¶ç”¨å‡½æ•°æ¥åŠ è½½é“¾æ¥åº“,è·å–å…¶ä¸­çš„å‡½æ•°åœ°å€å¹¶è°ƒç”¨.æœ¬æ–‡è®²è¿°åè€…</p><span id="more"></span><h3 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h3><p>æ¥è§¦è¿‡WindowsAPIçš„åº”è¯¥çŸ¥é“,é™æ€åº“åç¼€ä¸º,åŠ¨æ€é“¾æ¥åº“åç¼€,è€Œä¸»è¦ç”¨åˆ°å‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs C++"><span class="hljs-function">HMODULE WINAPI <span class="hljs-title">LoadLibrary</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ LPCTSTR lpFileName</span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>;<br></code></pre></div></td></tr></table></figure><p>è·å–å‡½æ•°åœ°å€åˆ™æ˜¯</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs C++"><span class="hljs-function">FARPROC WINAPI <span class="hljs-title">GetProcAddress</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ HMODULE hModule,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ LPCSTR  lpProcName</span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>;<br></code></pre></div></td></tr></table></figure><p>MSDNä¸Šçš„ä¾‹å­</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs C++"><span class="hljs-comment">//å£°æ˜å‡½æ•°æŒ‡é’ˆ</span><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">void</span> <span class="hljs-params">(WINAPI *PGNSI)</span><span class="hljs-params">(LPSYSTEM_INFO)</span></span>;<br><span class="hljs-comment">// Call GetNativeSystemInfo if supported or GetSystemInfo otherwise.</span><br>   PGNSI pGNSI;<br>   SYSTEM_INFO si;<br>   <span class="hljs-built_in">ZeroMemory</span>(&amp;si, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(SYSTEM_INFO));<br>   <br>   pGNSI = (PGNSI) <span class="hljs-built_in">GetProcAddress</span>(<br>      <span class="hljs-built_in">GetModuleHandle</span>(<span class="hljs-built_in">TEXT</span>(<span class="hljs-string">&quot;kernel32.dll&quot;</span>)), <br>      <span class="hljs-string">&quot;GetNativeSystemInfo&quot;</span>);<br>   <span class="hljs-keyword">if</span>(<span class="hljs-literal">NULL</span> != pGNSI)<br>   &#123;<br>      <span class="hljs-built_in">pGNSI</span>(&amp;si);<br>   &#125;<br>   <span class="hljs-keyword">else</span> <br>   &#123;<br>       <span class="hljs-built_in">GetSystemInfo</span>(&amp;si);<br>   &#125;<br></code></pre></div></td></tr></table></figure><p>ç”±æ­¤å¯çœ‹,Windowsä¹Ÿå®ç°äº†å¯¹åº“æ–‡ä»¶çš„è°ƒç”¨,é‚£ä¹ˆLinuxä¸‹æ€ä¹ˆè°ƒç”¨å‘¢?<br />å…³äºLinuxè°ƒç”¨åº“çš„å¤´æ–‡ä»¶å¯ä»¥å‚è€ƒ <a href="https://linux.die.net/man/3/dlopen">https://linux.die.net/man/3/dlopen</a></p><p>å¿…é¡»åŒ…å«çš„å¤´æ–‡ä»¶ <code>dlfcn.h</code><br />å¸¸ç”¨å‡½æ•°:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs C++"><span class="hljs-comment">//åŠ è½½é“¾æ¥åº“</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> *<span class="hljs-title">dlopen</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *filename, <span class="hljs-keyword">int</span> flag)</span></span>;<br><span class="hljs-comment">//è¿”å›è·å–çš„é”™è¯¯</span><br><span class="hljs-function"><span class="hljs-keyword">char</span> *<span class="hljs-title">dlerror</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>;<br><span class="hljs-comment">//è·å–é“¾æ¥åº“å‡½æ•°åœ°å€</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> *<span class="hljs-title">dlsym</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *handle, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *symbol)</span></span>;<br><span class="hljs-comment">//å¸è½½é“¾æ¥åº“</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dlclose</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *handle)</span></span>;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„,åœ¨ç¼–è¯‘æ—¶,è¦æŒ‡æ˜ <strong>-ldl</strong></p><p>é™¤æ­¤ä¹‹å¤–,è¿˜æœ‰è¿ä¸ªä¹Ÿæ¯”è¾ƒæœ‰ç”¨çš„å‡½æ•°<strong>dladdr() dlvsym()</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs C++"><span class="hljs-comment">//è·å–å‡½æ•°çš„ä¿¡æ¯</span><br><span class="hljs-comment">//dladdr() returns 0 on error, and nonzero on success</span><br><span class="hljs-comment">//If no symbol matching addr could be found, then dli_sname and dli_saddr are set to NULL</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">dladdr</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *addr, Dl_info *info)</span></span>;<br><span class="hljs-function">The function <span class="hljs-title">dladdr</span><span class="hljs-params">()</span> takes a function pointer <span class="hljs-keyword">and</span> tries to resolve name <span class="hljs-keyword">and</span> file where it is located. Information is stored in the Dl_info structure:</span><br><span class="hljs-function">typedef struct &#123;</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *dli_fname;  <span class="hljs-comment">/* Pathname of shared object that</span><br><span class="hljs-comment">                               contains address */</span><br>    <span class="hljs-keyword">void</span>       *dli_fbase;  <span class="hljs-comment">/* Address at which shared object</span><br><span class="hljs-comment">                               is loaded */</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *dli_sname;  <span class="hljs-comment">/* Name of nearest symbol with address</span><br><span class="hljs-comment">                               lower than addr */</span><br>    <span class="hljs-keyword">void</span>       *dli_saddr;  <span class="hljs-comment">/* Exact address of symbol named</span><br><span class="hljs-comment">                               in dli_sname */</span><br>&#125; Dl_info;<br><span class="hljs-comment">//ç±»ä¼¼dlsym()</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> *<span class="hljs-title">dlvsym</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *handle, <span class="hljs-keyword">char</span> *symbol, <span class="hljs-keyword">char</span> *version)</span></span>;<br></code></pre></div></td></tr></table></figure><p>ä¸‹é¢ä»¥ä¸€ä¸ªç®€å•çš„ä¾‹å­è¯´æ˜</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;dlfcn.h&gt;</span> <span class="hljs-comment">//åŒ…å«çš„å¤´æ–‡ä»¶</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LIB_PATH <span class="hljs-meta-string">&quot;./libtest.so&quot;</span></span><br><span class="hljs-comment">//å£°æ˜å‡½æ•°æŒ‡é’ˆ</span><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span> <span class="hljs-params">(*PFUN)</span><span class="hljs-params">(<span class="hljs-keyword">int</span> ,<span class="hljs-keyword">int</span> )</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    PFUN pf=<span class="hljs-literal">NULL</span>;<br>    <span class="hljs-comment">//åŠ è½½é“¾æ¥åº“</span><br>    <span class="hljs-keyword">void</span> *handle=<span class="hljs-built_in">dlopen</span>(LIB_PATH,RTLD_LAZY);<br>    <span class="hljs-keyword">if</span>(handle==<span class="hljs-literal">NULL</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;load library failed!\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br> <br>    <span class="hljs-comment">//dlvsym(handle,&quot;add&quot;,&quot;1.0.0&quot;); </span><br>    <span class="hljs-comment">//è·å–é“¾æ¥åº“é‡Œå‡½æ•°åœ°å€</span><br>    <span class="hljs-comment">//æ–¹æ³•1,å‚è€ƒç½‘ç«™ä¸Šçš„å†™æ³•</span><br>    <span class="hljs-comment">//*(void**)(&amp;pf)=dlsym(handle,&quot;add&quot;);</span><br>   <br>    <span class="hljs-comment">//æ–¹æ³•2,ç›¸å½“ä¸Windowsä¸‹çš„ GetProcAddress() å‡½æ•°.</span><br>    pf=(PFUN)<span class="hljs-built_in">dlsym</span>(handle,<span class="hljs-string">&quot;sub&quot;</span>);<br>    <span class="hljs-keyword">if</span>(pf!=<span class="hljs-literal">NULL</span>)&#123;<br>        <span class="hljs-comment">//è·å–å‡½æ•°åœ°å€ä¿¡æ¯</span><br>        Dl_info info;<br>       <span class="hljs-keyword">int</span> r= <span class="hljs-built_in">dladdr</span>((<span class="hljs-keyword">void</span>*)pf,&amp;info);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;library filepath:%s\n&quot;</span>\<br>                <span class="hljs-string">&quot;address1:0x%08x\n&quot;</span>\<br>                <span class="hljs-string">&quot;funciton name:%s\n&quot;</span>\<br>                <span class="hljs-string">&quot;address2:0x%08x\n\n&quot;</span>,<br>                info.dli_fname,info.dli_fbase,<br>                info.dli_sname,info.dli_saddr);<br>        <span class="hljs-comment">//0 è¡¨ç¤ºå¤±è´¥</span><br>        <span class="hljs-keyword">if</span>(r==<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;can not get the dl info...\n&quot;</span>);<br>        &#125;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;get the function address...\n&quot;</span>);<br>        <span class="hljs-comment">//è°ƒç”¨å‡½æ•°</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;result: %d \n&quot;</span>,<span class="hljs-built_in">pf</span>(<span class="hljs-number">50</span>,<span class="hljs-number">15</span>));<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;can not get the function address...\n&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//å¸è½½é“¾æ¥åº“</span><br>    <span class="hljs-built_in">dlclose</span>(handle);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç”Ÿæˆ:<code>g++ test.cpp -o out_test -ldl -rdynamic</code><br />è¿è¡Œ<code>./out_test</code><br />è¾“å‡ºç»“æœå¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">library filepath:./libtest.so<br>address1:<span class="hljs-number">0xeabfa000</span><br>funciton name:sub<br>address2:<span class="hljs-number">0xeabfa7f4</span><br>get the function address...<br>result: <span class="hljs-number">35</span><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ä¸Šé¢çš„åº“æ–‡ä»¶<strong><a href="http://libtest.so">libtest.so</a></strong>åœ¨å½“å‰ç¨‹åºç›®å½•ä¸‹çš„,ä»£ç å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> _TEST_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _TEST_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> a+b;<br>&#125;<br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">sub</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> a-b;<br>&#125;<br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">maxnum</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a,<span class="hljs-keyword">int</span> b)</span></span>&#123;<br>    <span class="hljs-keyword">return</span> a&gt;b?a:b;<br>&#125;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span><br></code></pre></div></td></tr></table></figure><p>ç„¶å <code>g++ -fPIC -shared test.cpp -o libtest.so</code>å³å¯ç”ŸæˆåŠ¨æ€é“¾æ¥åº“</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C++</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®‰è£…Linuxç³»ç»Ÿåˆ°Uç›˜</title>
    <link href="/installed-system-to-usb/"/>
    <url>/installed-system-to-usb/</url>
    
    <content type="html"><![CDATA[<p>æœ‰æ—¶æˆ‘ä»¬æƒ³è®©ä¸€ä¸ªç³»ç»Ÿéšæ—¶éšåœ°åˆ‡æ¢åˆ°å¦ä¸€å°æœºå™¨ä¸Šï¼Œå®ç°ä¾¿æºå¼ç³»ç»Ÿã€‚å³é€šè¿‡ä¸€ä¸ªUç›˜å¯åŠ¨åˆ‡æ¢è¦å¯åŠ¨çš„ç³»ç»Ÿã€‚æœ¬æ–‡ä»¥ä¸€ä¸ªLinuxç³»ç»Ÿå®‰è£…åˆ°Uç›˜ä¸ºä¾‹ç®€å•ä»‹ç»ã€‚</p><span id="more"></span><h3 id="å‡†å¤‡æ¡ä»¶"><a class="markdownIt-Anchor" href="#å‡†å¤‡æ¡ä»¶"></a> å‡†å¤‡æ¡ä»¶</h3><blockquote><p>Linux ISOé•œåƒæ–‡ä»¶ï¼š <a href="https://www.kali.org/downloads/">Kali Linux Light 64 Bit (2018.2)</a> <strong>865M</strong><br />VirtualBoxè™šæ‹Ÿæœºï¼š <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a><br />Uç›˜ï¼š Kingston Datatraveler USB(2.0) / <strong>SanDisk Ultra USB 3.0</strong> æ¨è30GBä»¥ä¸Š</p><p>æ³¨æ„ï¼š å¦‚æœUç›˜æ˜¯3.0çš„ï¼ŒVirtualBoxéœ€è¦é¢å¤–å®‰è£…æ‹“å±•åŒ…ã€‚æ–¹æ³•è§ä¸‹æ–‡</p></blockquote><p>æ³¨æ„ï¼š å¦‚æœUç›˜æ˜¯3.0çš„ï¼ŒVirtualBoxéœ€è¦é¢å¤–å®‰è£…æ‹“å±•åŒ…ã€‚æ–¹æ³•è§ä¸‹æ–‡</p><h3 id="æ”¯æŒusb30"><a class="markdownIt-Anchor" href="#æ”¯æŒusb30"></a> æ”¯æŒUSB3.0</h3><p>é»˜è®¤virtual boxåªæ”¯æŒUSB1.0/2.0ï¼Œè¦æƒ³è®©ä»–æ”¯æŒUSB3.0ï¼Œéœ€è¦åˆ° <a href="https://www.virtualbox.org/wiki/Downloads">å®˜ç½‘</a> ä¸‹è½½æ‹“å±•åŒ…ï¼ˆExtension Packï¼‰<br /><img src="/uploads/images/virtual_box/file_001.png" alt="img" /></p><p>æ³¨æ„ï¼Œè¦ä¸‹è½½å¯¹åº”VirtualBoxç‰ˆæœ¬çš„ <strong>Extension Pack</strong>ï¼Œå½“å‰æˆ‘ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯5.2.8ã€‚å¦å¤–æˆ‘çš„Uç›˜æ˜¯USB2.0çš„</p><h3 id="å®‰è£…"><a class="markdownIt-Anchor" href="#å®‰è£…"></a> å®‰è£…</h3><p>åœ¨å¯åŠ¨è™šæ‹Ÿæœºå‰ï¼Œéœ€è¦æ’å…¥Uç›˜ã€‚<br />ç”¨ <strong>lsblk</strong> å¯çœ‹åˆ°è¯¥è®¾å¤‡ä¸ºsdb</p><blockquote><p>sdb 8:16 1 7.2G 0 disk<br />â””â”€sdb1 8:17 1 7.2G 0 part /media/root/3c6de664-902f-4f45-b588-f295e7c42666</p></blockquote><p>è¦è®©VirtualBoxèƒ½å¤Ÿè®¿é—®åˆ°USBè®¾å¤‡ï¼Œè¿˜éœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">vboxmanage internalcommands createrawvmdk -filename usb.vmdk -rawdisk <span class="hljs-regexp">/dev/</span>sdb<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­ <strong>/dev/sdb</strong> å¯¹äºUSBçš„è®¾å¤‡æ–‡ä»¶åç§°<br />è¿™ä¼šåœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ª <strong>usb.vmdk</strong> æ–‡ä»¶</p><p>æ¥ç€å¯åŠ¨è™šæ‹Ÿæœºï¼Œä»»æ„æ–°å»ºä¸€ä¸ªè™šæ‹Ÿç”µè„‘ï¼Œé»˜è®¤ä¸‹ä¸€æ­¥ï¼Œç›´è‡³åˆ›å»ºæˆåŠŸ<br /><img src="/uploads/images/virtual_box/file_003.png" alt="img" /></p><p>ã€è®¾ç½®ã€‘-&gt;ã€å­˜å‚¨ã€‘åº•ç›˜ä¸ºLinux ISOæ–‡ä»¶ï¼ŒåŒæ—¶æ·»åŠ ä¸€ä¸ªè™šæ‹Ÿç›˜ï¼ˆ<strong>ä½¿ç”¨ç°æœ‰çš„è™šæ‹Ÿç›˜</strong>ï¼‰ï¼Œå¹¶é€‰æ‹©åˆšæ‰åˆ›å»ºå¥½çš„<strong>usb.vmdk</strong>æ–‡ä»¶</p><p>å¯åŠ¨è¯¥è™šæ‹Ÿæœº<br /><img src="/uploads/images/virtual_box/file_004.png" alt="img" /><br /><img src="/uploads/images/virtual_box/file_005.png" alt="img" /><br /><img src="/uploads/images/virtual_box/file_006.png" alt="img" /></p><p>åˆ°äº†ç£ç›˜åˆ†åŒºè¦æ³¨æ„ï¼Œæˆ‘ä»¬è¦é€‰æ‹© <strong>sdb</strong>ï¼Œå³è¦å°†Linuxç³»ç»Ÿå®‰è£…åˆ°çš„Uç›˜è®¾å¤‡</p><p><img src="/uploads/images/virtual_box/file_007.png" alt="img" /><br /><img src="/uploads/images/virtual_box/file_008.png" alt="img" /></p><p>ä¹‹åå°±æ˜¯æ¼«é•¿ç­‰å¾…â€¦<br /><img src="/uploads/images/virtual_box/file_009.png" alt="img" /></p><p>å®‰è£…å®Œæˆä¹‹åï¼Œé‡å¯è™šæ‹Ÿæœºï¼ŒåŒæ—¶æŒ‰ <strong>F11</strong> ï¼Œå³å¯è¿›å…¥ç³»ç»Ÿå¯åŠ¨é¡¹é€‰æ‹©ã€‚<br /><img src="/uploads/images/virtual_box/file_010.png" alt="img" /></p><h3 id="è§£å†³ä¸­æ–‡ä¹±ç "><a class="markdownIt-Anchor" href="#è§£å†³ä¸­æ–‡ä¹±ç "></a> è§£å†³ä¸­æ–‡ä¹±ç </h3><p>ç™»å½•ä¹‹åå‘ç°ç³»ç»Ÿæ˜¾ç¤ºä¸­æ–‡ä¹±ç ï¼</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$LANG</span><br>è¾“å‡º zh_CN.UTF-8<br></code></pre></div></td></tr></table></figure><p>å…ˆä¿®æ”¹æ›´æ–°æºï¼Œç¼–è¾‘ <strong>/etc/apt/sources.list</strong> æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">deb</span> http<span class="hljs-variable">s:</span>//mirrors.ustc.edu.<span class="hljs-keyword">cn</span>/kali kali-rolling main non-free contrib<br><span class="hljs-keyword">deb</span>-src http<span class="hljs-variable">s:</span>//mirrors.ustc.edu.<span class="hljs-keyword">cn</span>/kali kali-rolling main non-free contrib<br></code></pre></div></td></tr></table></figure><p>åœ¨ç»ˆç«¯ä¸‹è¾“å…¥ <code>apt-get upgrade</code> æ›´æ–°ç³»ç»Ÿ</p><p>è¾“å…¥ <strong>dpkg-reconfigure locales</strong> ä¹‹åé€‰ä¸­<strong>en_US.UTF-8</strong>å’Œ<strong>zh_CN.UTF-8</strong>ï¼Œç¡®å®šåï¼Œå°†<strong>zh_CN.UTF-8</strong>é€‰ä¸ºé»˜è®¤</p><p>å®‰è£…ä¸­æ–‡å­—ä½“</p><figure class="highlight maxima"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs maxima">apt-<span class="hljs-built_in">get</span> install xfonts-wqy xfonts-intl-<span class="hljs-built_in">chinese</span><br></code></pre></div></td></tr></table></figure><p>é‡å¯</p><p><img src="/uploads/images/virtual_box/file_011.png" alt="img" /></p><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>è¿™æ ·å°±å®Œæˆäº†ä¸€ä¸ªä¾¿æºå¼Uç›˜ç³»ç»Ÿäº†ï½</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C/C++æ­£åˆ™è¡¨è¾¾å¼regex</title>
    <link href="/cpp-regex/"/>
    <url>/cpp-regex/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘æ¥è§¦äº†C++çš„æ­£åˆ™è¡¨è¾¾å¼,æ„Ÿè§‰è¿˜å¯ä»¥,ä»¥æ­¤æ¥è®°å½•ä¸‹è¿‡ç¨‹</p><span id="more"></span><h3 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h3><p>å…³äºC++çš„æ­£åˆ™è¡¨è¾¾å¼å¤´æ–‡ä»¶,å¯ä»¥å‚è€ƒè¿™ä¸ªç½‘ç«™çš„æ•™ç¨‹http://www.cplusplus.com/reference/regex/</p><p>Cæ­£åˆ™è¡¨è¾¾å¼å¤´æ–‡ä»¶<strong>regex.h</strong><br /><a href="http://pubs.opengroup.org/onlinepubs/7908799/xsh/regex.h.html">http://pubs.opengroup.org/onlinepubs/7908799/xsh/regex.h.html</a></p><p>ä»£ç å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;regex.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;regex&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;sys/types.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-comment">//cè¯­è¨€å½¢å¼çš„æ­£åˆ™è¡¨è¾¾å¼</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">cRegex</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">regex_t</span> r;<br>    <span class="hljs-comment">//æˆåŠŸè¿”å›0(REG_NOERROR)</span><br>    <span class="hljs-keyword">int</span> ret=<span class="hljs-built_in">regcomp</span>(&amp;r,<span class="hljs-string">&quot;abc(.*?)-(.*?)xyz&quot;</span>,REG_EXTENDED|REG_ICASE);<br>    <span class="hljs-keyword">if</span>(ret==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-keyword">regmatch_t</span> pm[<span class="hljs-number">10</span>];<br>        <span class="hljs-keyword">char</span> src[]=<span class="hljs-string">&quot;abcQQQQQQ-5555555xyz&quot;</span>;<br>        ret=<span class="hljs-built_in">regexec</span>(&amp;r,src,<span class="hljs-number">10</span>,pm,<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">if</span>(ret!=REG_NOMATCH&amp;&amp;ret==REG_NOERROR)&#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(pm)/<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword">regmatch_t</span>); ++i) &#123;<br>                <span class="hljs-keyword">if</span>(pm[i].rm_so==<span class="hljs-number">-1</span>)&#123;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                <span class="hljs-comment">//rm_so:åŒ¹é…å­å­—ç¬¦ä¸²çš„å¼€å§‹</span><br>                <span class="hljs-comment">//rm_eo:åŒ¹é…å­å­—ç¬¦ä¸²çš„ç»“æŸ</span><br>                <span class="hljs-comment">//rm_eo-rm_so:è¡¨ç¤ºåŒ¹é…çš„å­—ç¬¦ä¸²çš„é•¿åº¦</span><br>                <span class="hljs-comment">//å¯å‚è€ƒ:http://pubs.opengroup.org/onlinepubs/7908799/xsh/regex.h.html</span><br>                <span class="hljs-comment">//cout&lt;&lt;pm[i].rm_so&lt;&lt;&quot;\t&quot;&lt;&lt;pm[i].rm_eo&lt;&lt;endl;</span><br>                <span class="hljs-keyword">int</span> matchcount=pm[i].rm_eo-pm[i].rm_so;<br>                <span class="hljs-keyword">char</span> matchvalue[<span class="hljs-number">20</span>+<span class="hljs-number">1</span>];<br>                <span class="hljs-built_in">bzero</span>(matchvalue,<span class="hljs-number">21</span>);<br>                <span class="hljs-comment">//ä»åŒ¹é…åˆ°çš„å­å­—ç¬¦ä¸²ç´¢å¼•æ‹·è´å†…å®¹</span><br>                <span class="hljs-built_in">memcpy</span>(matchvalue,src+pm[i].rm_so,matchcount);<br>                matchvalue[<span class="hljs-built_in">strlen</span>(matchvalue)]=<span class="hljs-string">&#x27;\0&#x27;</span>;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;---&gt;%s\n&quot;</span>,matchvalue);<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">char</span> errmsg[<span class="hljs-number">250</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br>            <span class="hljs-built_in">regerror</span>(ret,&amp;r,errmsg,<span class="hljs-number">250</span>);<br>            cout&lt;&lt;<span class="hljs-string">&quot;Message:&quot;</span>&lt;&lt;errmsg&lt;&lt;endl;<br>        &#125;<br>        <span class="hljs-comment">//é‡Šæ”¾å†…å­˜</span><br>        <span class="hljs-built_in">regfree</span>(&amp;r);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//c++è¯­è¨€æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">cppRegex_replace</span><span class="hljs-params">()</span></span>&#123;<br>    string tx=<span class="hljs-string">&quot;https://www.baidu.com&quot;</span>;<br>    cout&lt;&lt;<span class="hljs-string">&quot;old text:&quot;</span>&lt;&lt;tx.<span class="hljs-built_in">c_str</span>()&lt;&lt;endl;<br>    <span class="hljs-comment">//æ›¿æ¢</span><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-function">regex <span class="hljs-title">re</span><span class="hljs-params">(<span class="hljs-string">&quot;\\bbaidu\\b&quot;</span>)</span></span>;<br>        tx=<span class="hljs-built_in">regex_replace</span>(tx,re,<span class="hljs-string">&quot;google&quot;</span>);<br>        cout&lt;&lt;<span class="hljs-string">&quot;new text:&quot;</span>&lt;&lt;tx.<span class="hljs-built_in">c_str</span>()&lt;&lt;endl;<br>    &#125;<span class="hljs-built_in"><span class="hljs-keyword">catch</span></span> (regex_error &amp;e)&#123;<br>        <span class="hljs-keyword">if</span>(e.<span class="hljs-built_in">code</span>()==regex_constants::error_badrepeat)&#123;<br>            <span class="hljs-comment">//do something...</span><br>        &#125;<br>        cout&lt;&lt;<span class="hljs-string">&quot;code:&quot;</span>&lt;&lt;e.<span class="hljs-built_in">code</span>()&lt;&lt;endl<br>            &lt;&lt;<span class="hljs-string">&quot;msg:&quot;</span>&lt;&lt;e.<span class="hljs-built_in">what</span>()&lt;&lt;endl;<br>    &#125;<br>&#125;<br><span class="hljs-comment">//c++è¯­è¨€å½¢å¼çš„æ­£åˆ™è¡¨è¾¾å¼</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">cppRegex</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *æ£€æµ‹æ˜¯å¦ä¸ºæ­£ç¡®çš„é‚®ç®±æ ¼å¼*/</span><br>    string pattern=<span class="hljs-string">&quot;^\\w&#123;2,20&#125;@\\w&#123;2,&#125;.com$&quot;</span>;<br>    string text=<span class="hljs-string">&quot;josephxrays@qq.com&quot;</span>;<br>    <span class="hljs-function">regex <span class="hljs-title">re</span><span class="hljs-params">(pattern,</span></span><br><span class="hljs-params"><span class="hljs-function">             std::regex_constants::icase|</span></span><br><span class="hljs-params"><span class="hljs-function">             std::regex_constants::extended|</span></span><br><span class="hljs-params"><span class="hljs-function">             regex_constants::ECMAScript)</span></span>;<br>    match_results&lt;string::const_iterator&gt; res;<br>    <span class="hljs-comment">//smatch res;</span><br>    <span class="hljs-keyword">bool</span> is=<span class="hljs-built_in">regex_match</span>(text,res,re);<br>    <span class="hljs-comment">//is=regex_search(text,res,re);</span><br>    <span class="hljs-keyword">if</span>(is==<span class="hljs-literal">true</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ok ,this is a true email format :)\n&quot;</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;error email format :(\n&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//c++è¯­è¨€å½¢å¼çš„æ­£åˆ™è¡¨è¾¾å¼2</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">cppRegex_matchGroup</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     *æ£€æµ‹æ˜¯å¦ä¸ºæ­£ç¡®çš„é‚®ç®±æ ¼å¼*/</span><br>    string pattern=<span class="hljs-string">&quot;(.*?)@(.*?)\\.(.*?)&quot;</span>;<br>    string text=<span class="hljs-string">&quot;josephxrays@163.com&quot;</span>;<br>    <span class="hljs-function">regex <span class="hljs-title">re</span><span class="hljs-params">(pattern,</span></span><br><span class="hljs-params"><span class="hljs-function">             std::regex_constants::icase|<span class="hljs-comment">//å¿½ç•¥å¤§å°å†™</span></span></span><br><span class="hljs-params"><span class="hljs-function">             std::regex_constants::extended|</span></span><br><span class="hljs-params"><span class="hljs-function">             regex_constants::ECMAScript)</span></span>;<br>    match_results&lt;string::const_iterator&gt; res;<br>    <span class="hljs-comment">//smatch res;</span><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">//bool is=regex_search(text,res,re);</span><br>        <span class="hljs-keyword">bool</span> is=<span class="hljs-built_in">regex_match</span>(text,res,re);<br>        <span class="hljs-keyword">if</span>(is==<span class="hljs-literal">true</span>)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ok :)\n&quot;</span>);<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; res.<span class="hljs-built_in">size</span>(); i++) &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;--&gt;%s \n&quot;</span>,res.<span class="hljs-built_in">str</span>(i).<span class="hljs-built_in">c_str</span>());<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;no match :(\n&quot;</span>);<br>        &#125;<br>    &#125;<span class="hljs-built_in"><span class="hljs-keyword">catch</span></span> (regex_error &amp;e)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;exception:( \n \t %d \t %s\n&quot;</span>,e.<span class="hljs-built_in">code</span>(),e.<span class="hljs-built_in">what</span>());<br>    &#125;<br>&#125;<br><span class="hljs-comment">//c++è¯­è¨€å½¢å¼çš„æ­£åˆ™è¡¨è¾¾å¼3</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">cppRegex_matchGroup_iterator</span><span class="hljs-params">()</span></span>&#123;<br>    string pattern=<span class="hljs-string">&quot;&lt;a href=\&quot;(.*?)\&quot;&gt;(.*?)&lt;/a&gt;&quot;</span>;<br>    string text=<br>            <span class="hljs-string">&quot;&lt;a href=\&quot;https://www.baidu.com\&quot;&gt;ç™¾åº¦&lt;/a&gt;&quot;</span>\<br>            <span class="hljs-string">&quot;&lt;a href=\&quot;https://www.google.com\&quot;&gt;è°·æ­Œ&lt;/a&gt;&quot;</span>\<br>            <span class="hljs-string">&quot;&lt;a href=\&quot;http://www.csdn.net\&quot;&gt;CSDN&lt;/a&gt;&quot;</span>;<br>    <span class="hljs-function">regex <span class="hljs-title">re</span><span class="hljs-params">(pattern,</span></span><br><span class="hljs-params"><span class="hljs-function">             std::regex_constants::icase|</span></span><br><span class="hljs-params"><span class="hljs-function">             std::regex_constants::extended|</span></span><br><span class="hljs-params"><span class="hljs-function">             regex_constants::ECMAScript)</span></span>;<br>    <span class="hljs-comment">//regex_iterator åŒ¹é…æ‰€æœ‰å­ä¸²</span><br>    <span class="hljs-function">sregex_iterator <span class="hljs-title">its</span><span class="hljs-params">(text.begin(),text.end(),re)</span></span>;<br>    sregex_iterator ends;<br>    <span class="hljs-keyword">while</span> (its!=ends)&#123;<br>        <span class="hljs-comment">//match_results&lt;T&gt;</span><br>        <span class="hljs-comment">//printf(&quot;%s \n&quot;,its-&gt;str(0).c_str());</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;--&gt;%s \t&quot;</span>,its-&gt;<span class="hljs-built_in">str</span>(<span class="hljs-number">1</span>).<span class="hljs-built_in">c_str</span>());<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s \n&quot;</span>,its-&gt;<span class="hljs-built_in">str</span>(<span class="hljs-number">2</span>).<span class="hljs-built_in">c_str</span>());<br>        its++;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">cRegex</span>();<br>    <span class="hljs-built_in">cppRegex</span>();<br>    <span class="hljs-built_in">cppRegex_matchGroup</span>();<br>    <span class="hljs-built_in">cppRegex_replace</span>();<br>    <span class="hljs-built_in">cppRegex_matchGroup_iterator</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç¼–è¯‘è¿è¡Œ: <code>g++ main.cpp -o regex_test &amp;&amp; ./regex_test</code></p><p>è¾“å‡ºç»“æœ:</p><figure class="highlight livecodeserver"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs livecodeserver"><span class="hljs-comment">---&gt;abcQQQQQQ-5555555xyz</span><br><span class="hljs-comment">---&gt;QQQQQQ</span><br><span class="hljs-comment">---&gt;5555555</span><br>ok ,this is <span class="hljs-keyword">a</span> truly email <span class="hljs-built_in">format</span> :)<br>ok :)<br><span class="hljs-comment">--&gt;josephxrays@163.com </span><br><span class="hljs-comment">--&gt;josephxrays </span><br><span class="hljs-comment">--&gt;163 </span><br><span class="hljs-comment">--&gt;com </span><br>old <span class="hljs-keyword">text</span>:<span class="hljs-keyword">https</span>://www.baidu.com<br><span class="hljs-built_in">new</span> <span class="hljs-keyword">text</span>:<span class="hljs-keyword">https</span>://www.google.com<br><span class="hljs-comment">--&gt;https://www.baidu.com ç™¾åº¦ </span><br><span class="hljs-comment">--&gt;https://www.google.com è°·æ­Œ </span><br><span class="hljs-comment">--&gt;http://www.csdn.net CSDN</span><br></code></pre></div></td></tr></table></figure><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux lshwå’ŒdmidecodeæŸ¥çœ‹ç¡¬ä»¶ä¿¡æ¯</title>
    <link href="/linux-lshw-dmidecode/"/>
    <url>/linux-lshw-dmidecode/</url>
    
    <content type="html"><![CDATA[<p><strong>Dmidecode</strong>å’Œ<strong>lshw</strong>è¿™ä¸¤ä¸ªå·¥å…·å¯ä»¥æŸ¥çœ‹Linuxä¸‹æœ‰å…³ç¡¬ä»¶ä¿¡æ¯,è¿™äº›ä¿¡æ¯åŒ…æ‹¬ BIOSã€ç³»ç»Ÿã€ä¸»æ¿ã€å¤„ç†å™¨ã€å†…å­˜ã€ç¼“å­˜ç­‰ç­‰</p><span id="more"></span><h3 id="dmidecode"><a class="markdownIt-Anchor" href="#dmidecode"></a> Dmidecode</h3><p>LINUXä¸‹ç›´æ¥å®‰è£… <code>apt-get install dmidecode</code><br />è¾“å…¥ <strong>dmidecode â€“help</strong> æŸ¥çœ‹å¸®åŠ©</p><blockquote><p>Usage: dmidecode [OPTIONS]<br />Options are:<br />-d, â€“dev-mem FILE Read memory from device FILE (default: /dev/mem)<br />-h, â€“help Display this help text and exit<br />-q, â€“quiet Less verbose output<br />-s, â€“string KEYWORD Only display the value of the given DMI string<br />-t, â€“type TYPE Only display the entries of given type<br />-u, â€“dump Do not decode the entries<br />â€“dump-bin FILE Dump the DMI data to a binary file<br />â€“from-dump FILE Read the DMI data from a binary file<br />â€“no-sysfs Do not attempt to read DMI data from sysfs files<br />â€“oem-string N Only display the value of the given OEM string<br />-V, â€“version Display the version and exit</p></blockquote><blockquote><p>0 BIOS<br />1 System<br />2 Base Board<br />3 Chassis<br />4 Processor<br />5 Memory Controller<br />6 Memory Module<br />7 Cache<br />8 Port Connector<br />9 System Slots<br />10 On Board Devices<br />11 OEM Strings<br />12 System Configuration Options<br />13 BIOS Language<br />14 Group Associations<br />15 System Event Log<br />16 Physical Memory Array<br />17 Memory Device<br />18 32-bit Memory Error<br />19 Memory Array Mapped Address<br />20 Memory Device Mapped Address<br />21 Built-in Pointing Device<br />22 Portable Battery<br />23 System Reset<br />24 Hardware Security<br />25 System Power Controls<br />26 Voltage Probe<br />27 Cooling Device<br />28 Temperature Probe<br />29 Electrical Current Probe<br />30 Out-of-band Remote Access<br />31 Boot Integrity Services<br />32 System Boot<br />33 64-bit Memory Error<br />34 Management Device<br />35 Management Device Component<br />36 Management Device Threshold Data<br />37 Memory Channel<br />38 IPMI Device<br />39 Power Supply<br />40 Additional Information<br />41 Onboard Device</p></blockquote><p>1.è¾“å…¥ <strong>dmidecode -t</strong> åˆ—å‡ºå…³é”®å­—</p><blockquote><p>dmidecode: option requires an argument â€“ â€˜tâ€™<br />Type number or keyword expected<br />Valid type keywords are:</p><p>bios<br />system<br />baseboard<br />chassis<br />processor<br />memory<br />cache<br />connector<br />slot</p></blockquote><p>ç„¶ååœ¨ <strong>dmidecode -t system</strong> æˆ– <strong>dmidecode -t 1</strong> è¾“å‡º</p><blockquote><p># dmidecode 3.1<br />Getting SMBIOS data from sysfs.<br />SMBIOS 2.7 present.</p><p>Handle 0x0001, DMI type 1, 27 bytes<br />System Information<br />Manufacturer: LENOVO<br />Product Name: 33661R8<br />Version: ThinkPad Edge E530c<br />Serial Number: MP43X9V<br />â€¦â€¦</p></blockquote><p>2.<strong>dmidecode -s</strong></p><blockquote><p>dmidecode: option requires an argument â€“ â€˜sâ€™<br />String keyword expected<br />Valid string keywords are:<br />bios-vendor<br />bios-version<br />bios-release-date<br />system-manufacturer<br />system-product-name<br />system-version<br />system-serial-number<br />system-uuid<br />baseboard-manufacturer<br />baseboard-product-name<br />baseboard-version<br />baseboard-serial-number<br />baseboard-asset-tag<br />chassis-manufacturer<br />chassis-type<br />chassis-version<br />chassis-serial-number<br />chassis-asset-tag<br />processor-family<br />processor-manufacturer<br />processor-version<br />processor-frequency</p></blockquote><p><strong>dmidecode -s system-version</strong> è¾“å‡º</p><blockquote><p>ThinkPad Edge E530c</p></blockquote><h3 id="lshwhardware-lister"><a class="markdownIt-Anchor" href="#lshwhardware-lister"></a> lshw(Hardware Lister)</h3><p>å®‰è£…:<code>apt-get install lshw</code><br />lshw æ¯”è¾ƒç®€å• <strong>lshw â€“help</strong></p><blockquote><p>Hardware Lister (lshw) - unknown<br />usage: lshw [-format] [-options â€¦]<br />lshw -version</p><p>-version print program version (unknown)<br />format can be<br /><strong>-html</strong> output hardware tree as HTML<br /><strong>-xml</strong> output hardware tree as XML<br />-short output hardware paths<br />-businfo output bus information<br />-X use graphical interface</p><p>options can be<br /><strong>-class CLASS</strong> only show a certain class of hardware<br />-C CLASS same as â€˜-class CLASSâ€™<br />-c CLASS same as â€˜-class CLASSâ€™<br />-disable TEST disable a test (like pci, isapnp, cpuid, etc. )<br />-enable TEST enable a test (like pci, isapnp, cpuid, etc. )<br />-quiet donâ€™t display status<br />-sanitize sanitize output (remove sensitive information like serial numbers, etc.)<br />-numeric output numeric IDs (for PCI, USB, etc.)<br />-notime exclude volatile attributes (timestamps) from output</p></blockquote><p>1.æŠŠä¿¡æ¯ä¿å­˜ä¸ºHTML/XMLæ ¼å¼æ–‡æœ¬</p><blockquote><p>lshw -html &gt; my.html<br />lshw -xml &gt; my.html</p></blockquote><p>2.æ˜¾ç¤ºè®¾å¤‡åˆ—è¡¨ï¼Œè¾“å‡ºåŒ…æ‹¬è®¾å¤‡è·¯å¾„(path)ã€ç±»åˆ«(class)ä»¥åŠç®€å•æè¿° <strong>lshw -short</strong></p><blockquote><p>H/W path Device <strong>Class</strong> Description<br />â€¦â€¦</p></blockquote><p>3.æ˜¾ç¤ºæŒ‡å®šç±»åˆ«çš„è®¾å¤‡ <strong>lshw -C xxxx</strong>,å…¶ä¸­ <code>xxxx</code> å°±æ˜¯ <strong>lshw -short</strong> ä¸­çš„ <code>Class</code> å­—æ®µ.å¦‚ <strong>lshw -C disk</strong></p><blockquote><p>*-disk<br />description: ATA Disk<br />product: WDC WD5000LPVT-0<br />vendor: Western Digital<br />â€¦â€¦<br />*-cdrom<br />â€¦â€¦</p></blockquote><p>ä¾‹å¦‚: <strong>lshw -C system|grep version</strong> è¾“å‡º</p><blockquote><p>version: ThinkPad Edge E530c</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Wgetä¸‹è½½å·¥å…·</title>
    <link href="/wget-tool/"/>
    <url>/wget-tool/</url>
    
    <content type="html"><![CDATA[<p>ä½œä¸ºä¸€æ¬¾Linuxä¸‹è‘—åçš„æ–‡ä»¶ä¸‹è½½å·¥å…·â€“Wget,å®ƒçš„è½»å·§ä¾¿æ·åŠå¼ºå¤§çš„åŠŸèƒ½å¯ä»¥ä¸å¤§å¤šæ•°ä¸‹è½½å·¥å…·ç›¸åª²ç¾.æ”¯æŒ <strong>HTTP,HTTPS,FTPåè®®</strong>, ä¹Ÿå¯ä»¥ä½¿ç”¨<strong>ä»£ç†</strong>,æ–­ç‚¹ç»­ä¼ â€¦</p><span id="more"></span><h3 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h3><p><a href="http://www.gnu.org/software/wget/manual/wget.html">è‹±æ–‡å¸®åŠ©æ–‡æ¡£</a></p><p>ä½†ç”±äºå…¶æ˜¯åœ¨å‘½ä»¤è¡Œä¸‹æ“ä½œ,æ‰€ä»¥ç©ä¸€èµ·æ¥è¿˜æ˜¯æœ‰ä¸€å®šéš¾åº¦çš„.ä¸ <a href="https://curl.haxx.se/"><strong>curl</strong></a> (ç”±libcurlåº“å®ç°)ç›¸æ¯”ä¸¤è€…è¿˜æ˜¯æœ‰ä¸€å®šçš„åŒºåˆ«çš„.</p><p>Linuxä¸‹å¯ä»¥ <code>wget --help</code> æŸ¥çœ‹wgetå¸®åŠ©,æ›´è¯¦ç»†çš„å¯ä»¥ <code>man wget</code></p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli">å¯åŠ¨ï¼š<br>  -V,  <span class="hljs-params">--version</span>                   æ˜¾ç¤º Wget çš„ç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡º<br>  -h,  <span class="hljs-params">--help</span>                      æ‰“å°æ­¤å¸®åŠ©<br>  -b,  <span class="hljs-params">--background</span>                å¯åŠ¨åè½¬å…¥åå°<br>  -e,  <span class="hljs-params">--execute=</span>å‘½ä»¤              è¿è¡Œä¸€ä¸ªâ€œ<span class="hljs-string">.wgetrc</span>â€é£æ ¼çš„å‘½ä»¤<br>æ—¥å¿—å’Œè¾“å…¥æ–‡ä»¶ï¼š<br>  -o,  <span class="hljs-params">--output-file=</span>æ–‡ä»¶          å°†æ—¥å¿—ä¿¡æ¯å†™å…¥ FILE<br>  -a,  <span class="hljs-params">--append-output=</span>æ–‡ä»¶        å°†ä¿¡æ¯æ·»åŠ è‡³ FILE<br>  -d,  <span class="hljs-params">--debug</span>                     æ‰“å°å¤§é‡è°ƒè¯•ä¿¡æ¯<br>  -q,  <span class="hljs-params">--quiet</span>                     å®‰é™æ¨¡å¼ <span class="hljs-params">(æ— ä¿¡æ¯è¾“å‡º)</span><br>  -v,  <span class="hljs-params">--verbose</span>                   è¯¦å°½çš„è¾“å‡º <span class="hljs-params">(æ­¤ä¸ºé»˜è®¤å€¼)</span><br>  -nv, <span class="hljs-params">--no-verbose</span>                å…³é—­è¯¦å°½è¾“å‡ºï¼Œä½†ä¸è¿›å…¥å®‰é™æ¨¡å¼<br>       <span class="hljs-params">--report-speed=</span>ç±»å‹         ä»¥ &lt;ç±»å‹&gt; æŠ¥å‘Šå¸¦å®½ã€‚ç±»å‹å¯ä»¥æ˜¯ bits<br>  -i,  <span class="hljs-params">--input-file=</span>æ–‡ä»¶           ä¸‹è½½æœ¬åœ°æˆ–å¤–éƒ¨ &lt;æ–‡ä»¶&gt; ä¸­çš„ URL<br>  -F,  <span class="hljs-params">--force-html</span>                æŠŠè¾“å…¥æ–‡ä»¶å½“æˆ HTML æ–‡ä»¶<br>  -B,  <span class="hljs-params">--base=URL</span>                  è§£æç›¸å¯¹äº URL çš„ HTML è¾“å…¥æ–‡ä»¶é“¾æ¥ <span class="hljs-params">(-i -F)</span><br>       <span class="hljs-params">--config=</span>æ–‡ä»¶               æŒ‡å®šè¦ä½¿ç”¨çš„é…ç½®æ–‡ä»¶<br>       <span class="hljs-params">--no-cookies</span>                ä¸è¯»å–ä»»ä½•é…ç½®æ–‡ä»¶<br>       <span class="hljs-params">--rejected-log=</span>æ–‡ä»¶         å°†æ‹’ç» URL çš„åŸå› å†™å…¥ &lt;æ–‡ä»¶&gt;ã€‚<br>ä¸‹è½½ï¼š<br>  -t,  <span class="hljs-params">--tries=</span>æ•°å­—                è®¾ç½®é‡è¯•æ¬¡æ•°ä¸º &lt;æ•°å­—&gt; <span class="hljs-params">(0 ä»£è¡¨æ— é™åˆ¶)</span><br>       <span class="hljs-params">--retry-connrefused</span>         å³ä½¿æ‹’ç»è¿æ¥ä¹Ÿæ˜¯é‡è¯•<br>  -O,  <span class="hljs-params">--output-document=</span>æ–‡ä»¶      å°†æ–‡æ¡£å†™å…¥ FILE<br>  -nc, <span class="hljs-params">--no-clobber</span>                ä¸è¦ä¸‹è½½å·²å­˜åœ¨å°†è¢«è¦†ç›–çš„æ–‡ä»¶<br>       <span class="hljs-params">--no-netrc</span>                  don&#x27;t <span class="hljs-keyword">try</span> to obtain credentials from <span class="hljs-string">.netrc</span><br>  -c,  <span class="hljs-params">--continue</span>                  æ–­ç‚¹ç»­ä¼ ä¸‹è½½æ–‡ä»¶<br>       <span class="hljs-params">--start-pos=</span>åç§»é‡          ä»ç”±é›¶è®¡æ•°çš„ &lt;åç§»é‡&gt; å¼€å§‹ä¸‹è½½<br>       <span class="hljs-params">--progress=</span>ç±»å‹             é€‰æ‹©è¿›åº¦æ¡ç±»å‹<br>       <span class="hljs-params">--show-progress</span>             åœ¨ä»»æ„å•°å—¦çŠ¶æ€ä¸‹éƒ½æ˜¾ç¤ºè¿›åº¦æ¡<br>  -N,  <span class="hljs-params">--timestamping</span>              åªè·å–æ¯”æœ¬åœ°æ–‡ä»¶æ–°çš„æ–‡ä»¶<br>       <span class="hljs-params">--no-if-modified-since</span>      ä¸è¦åœ¨æ—¶é—´æˆ³ <span class="hljs-params">(timestamping)</span> æ¨¡å¼ä¸‹ä½¿ç”¨<br>                                     if-modified-since get æ¡ä»¶è¯·æ±‚<br>       <span class="hljs-params">--no-use-server-timestamps</span>       ä¸ç”¨æœåŠ¡å™¨ä¸Šçš„æ—¶é—´æˆ³æ¥è®¾ç½®æœ¬åœ°æ–‡ä»¶<br>  -S,  <span class="hljs-params">--server-response</span>           æ‰“å°æœåŠ¡å™¨å“åº”<br>       <span class="hljs-params">--spider</span>                    ä¸ä¸‹è½½ä»»ä½•æ–‡ä»¶<br>  -T,  <span class="hljs-params">--timeout=SECONDS</span>           å°†æ‰€æœ‰è¶…æ—¶è®¾ä¸º SECONDS ç§’<br>       <span class="hljs-params">--dns-timeout=SECS</span>          è®¾ç½® DNS æŸ¥å¯»è¶…æ—¶ä¸º SECS ç§’<br>       <span class="hljs-params">--connect-timeout=SECS</span>      è®¾ç½®è¿æ¥è¶…æ—¶ä¸º SECS ç§’<br>       <span class="hljs-params">--read-timeout=SECS</span>         è®¾ç½®è¯»å–è¶…æ—¶ä¸º SECS ç§’<br>  -w,  <span class="hljs-params">--wait=SECONDS</span>              ç­‰å¾…é—´éš”ä¸º SECONDS ç§’<br>       <span class="hljs-params">--waitretry=SECONDS</span>         åœ¨è·å–æ–‡ä»¶çš„é‡è¯•æœŸé—´ç­‰å¾… 1.<span class="hljs-string">.SECONDS</span> ç§’<br>       <span class="hljs-params">--random-wait</span>               è·å–å¤šä¸ªæ–‡ä»¶æ—¶ï¼Œæ¯æ¬¡éšæœºç­‰å¾…é—´éš” <span class="hljs-params">(0.5~1.5)</span>*WAIT ç§’<br>       <span class="hljs-params">--no-proxy</span>                  ç¦æ­¢ä½¿ç”¨ä»£ç†<br>  -Q,  <span class="hljs-params">--quota=</span>æ•°å­—                è®¾ç½®è·å–é…é¢ä¸º &lt;æ•°å­—&gt; å­—èŠ‚<br>       <span class="hljs-params">--bind-address=ADDRESS</span>      ç»‘å®šè‡³æœ¬åœ°ä¸»æœºä¸Šçš„ ADDRESS <span class="hljs-params">(ä¸»æœºåæˆ–æ˜¯ IP)</span><br>       <span class="hljs-params">--limit-rate=RATE</span>           é™åˆ¶ä¸‹è½½é€Ÿç‡ä¸º RATE<br>       <span class="hljs-params">--no-dns-cache</span>              å…³é—­ DNS æŸ¥è¯¢ç¼“å­˜<br>       <span class="hljs-params">--restrict-file-names=</span>ç³»ç»Ÿ  é™å®šæ–‡ä»¶åä¸­çš„å­—ç¬¦ä¸º &lt;ç³»ç»Ÿ&gt; å…è®¸çš„å­—ç¬¦<br>       <span class="hljs-params">--ignore-case</span>               åŒ¹é…æ–‡ä»¶/ç›®å½•æ—¶å¿½ç•¥å¤§å°å†™<br>  -4,  <span class="hljs-params">--inet4-only</span>                ä»…è¿æ¥è‡³ IPv4 åœ°å€<br>  -6,  <span class="hljs-params">--inet6-only</span>                ä»…è¿æ¥è‡³ IPv6 åœ°å€<br>       <span class="hljs-params">--prefer-family=</span>åœ°å€æ—      é¦–å…ˆè¿æ¥è‡³æŒ‡å®šå®¶æ—ï¼ˆIPv6ï¼ŒIPv4 æˆ– noneï¼‰çš„åœ°å€<br>       <span class="hljs-params">--user=</span>ç”¨æˆ·                 å°† ftp å’Œ http çš„ç”¨æˆ·åå‡è®¾ç½®ä¸º &lt;ç”¨æˆ·&gt;<br>       <span class="hljs-params">--password=</span>å¯†ç              å°† ftp å’Œ http çš„å¯†ç å‡è®¾ç½®ä¸º &lt;å¯†ç &gt;<br>       <span class="hljs-params">--ask-password</span>              æç¤ºè¾“å…¥å¯†ç <br>       <span class="hljs-params">--use-askpass=COMMAND</span>       specify credential handler for requesting <br>                                     username and password.  If no COMMAND is <br>                                     specified the WGET_ASKPASS or the SSH_ASKPASS <br>                                     environment variable is used.<br>       <span class="hljs-params">--no-iri</span>                    å…³é—­ IRI æ”¯æŒ<br>       <span class="hljs-params">--local-encoding=ENC</span>        ä½¿ç”¨ ENC ä½œä¸º IRI <span class="hljs-params">(å›½é™…åŒ–èµ„æºæ ‡è¯†ç¬¦)</span> çš„æœ¬åœ°ç¼–ç <br>       <span class="hljs-params">--remote-encoding=ENC</span>       ä½¿ç”¨ ENC ä½œä¸ºé»˜è®¤è¿œç¨‹ç¼–ç <br>       <span class="hljs-params">--unlink</span>                    è¦†ç›–å‰ç§»é™¤æ–‡ä»¶<br>       <span class="hljs-params">--no-xattr</span>                  ä¸è¦åœ¨æ–‡ä»¶çš„æ‹“å±•å±æ€§ä¸­å‚¨å­˜å…ƒæ•°æ®<br>ç›®å½•ï¼š<br>  -nd, <span class="hljs-params">--no-directories</span>            ä¸åˆ›å»ºç›®å½•<br>  -x,  <span class="hljs-params">--force-directories</span>         å¼ºåˆ¶åˆ›å»ºç›®å½•<br>  -nH, <span class="hljs-params">--no-host-directories</span>       ä¸è¦åˆ›å»ºä¸» <span class="hljs-params">(host)</span> ç›®å½•<br>       <span class="hljs-params">--protocol-directories</span>      åœ¨ç›®å½•ä¸­ä½¿ç”¨åè®®åç§°<br>  -P,  <span class="hljs-params">--directory-prefix=</span>å‰ç¼€     ä¿å­˜æ–‡ä»¶åˆ° &lt;å‰ç¼€&gt;<span class="hljs-string">/..</span><br>       <span class="hljs-params">--cut-dirs=</span>æ•°å­—             å¿½ç•¥è¿œç¨‹ç›®å½•ä¸­ &lt;æ•°å­—&gt; ä¸ªç›®å½•å±‚ã€‚<br>HTTP é€‰é¡¹ï¼š<br>       <span class="hljs-params">--http-user=</span>ç”¨æˆ·            è®¾ç½® http ç”¨æˆ·åä¸º &lt;ç”¨æˆ·&gt;<br>       <span class="hljs-params">--http-password=</span>å¯†ç         è®¾ç½® http å¯†ç ä¸º &lt;å¯†ç &gt;<br>       <span class="hljs-params">--no-cache</span>                  ä¸ä½¿ç”¨æœåŠ¡å™¨ç¼“å­˜çš„æ•°æ®ã€‚<br>       <span class="hljs-params">--default-page=NAME</span>         æ”¹å˜é»˜è®¤é¡µ <span class="hljs-params">(é€šå¸¸æ˜¯â€œindex.htmlâ€)</span>ã€‚<br>  -E,  <span class="hljs-params">--adjust-extension</span>          ä»¥åˆé€‚çš„æ‰©å±•åä¿å­˜ HTML/CSS æ–‡æ¡£<br>       <span class="hljs-params">--ignore-length</span>             å¿½ç•¥å¤´éƒ¨çš„â€˜Content-Lengthâ€™åŒºåŸŸ<br>       <span class="hljs-params">--header=</span>å­—ç¬¦ä¸²             åœ¨å¤´éƒ¨æ’å…¥ &lt;å­—ç¬¦ä¸²&gt;<br>       <span class="hljs-params">--compression=TYPE</span>          choose compression, one of auto, gzip and none<br>       <span class="hljs-params">--max-redirect</span>              æ¯é¡µæ‰€å…è®¸çš„æœ€å¤§é‡å®šå‘<br>       <span class="hljs-params">--proxy-user=</span>ç”¨æˆ·           ä½¿ç”¨ &lt;ç”¨æˆ·&gt; ä½œä¸ºä»£ç†ç”¨æˆ·å<br>       <span class="hljs-params">--proxy-password=</span>å¯†ç        ä½¿ç”¨ &lt;å¯†ç &gt; ä½œä¸ºä»£ç†å¯†ç <br>       <span class="hljs-params">--referer=URL</span>               åœ¨ HTTP è¯·æ±‚å¤´åŒ…å«â€˜Referer: URLâ€™<br>       <span class="hljs-params">--save-headers</span>              å°† HTTP å¤´ä¿å­˜è‡³æ–‡ä»¶ã€‚<br>  -U,  <span class="hljs-params">--user-agent=</span>ä»£ç†           æ ‡è¯†è‡ªå·±ä¸º &lt;ä»£ç†&gt; è€Œä¸æ˜¯ Wget/VERSIONã€‚<br>       <span class="hljs-params">--no-http-keep-alive</span>        ç¦ç”¨ HTTP keep-alive <span class="hljs-params">(æŒä¹…è¿æ¥)</span>ã€‚<br>       <span class="hljs-params">--no-cookies</span>                ä¸ä½¿ç”¨ cookiesã€‚<br>       <span class="hljs-params">--load-cookies=</span>æ–‡ä»¶         ä¼šè¯å¼€å§‹å‰ä» &lt;æ–‡ä»¶&gt; ä¸­è½½å…¥ cookiesã€‚<br>       <span class="hljs-params">--save-cookies=</span>æ–‡ä»¶         ä¼šè¯ç»“æŸåä¿å­˜ cookies è‡³ FILEã€‚<br>       <span class="hljs-params">--keep-session-cookies</span>      è½½å…¥å¹¶ä¿å­˜ä¼šè¯ <span class="hljs-params">(éæ°¸ä¹…)</span> cookiesã€‚<br>       <span class="hljs-params">--post-data=</span>å­—ç¬¦ä¸²          ä½¿ç”¨ POST æ–¹å¼ï¼›æŠŠ &lt;å­—ä¸²&gt;ä½œä¸ºæ•°æ®å‘é€ã€‚<br>       <span class="hljs-params">--post-file=</span>æ–‡ä»¶            ä½¿ç”¨ POST æ–¹å¼ï¼›å‘é€ &lt;æ–‡ä»¶&gt; å†…å®¹ã€‚<br>       <span class="hljs-params">--method=HTTP</span>æ–¹æ³•           åœ¨è¯·æ±‚ä¸­ä½¿ç”¨æŒ‡å®šçš„ &lt;HTTP æ–¹æ³•&gt;ã€‚<br>       <span class="hljs-params">--post-data=</span>å­—ç¬¦ä¸²          æŠŠ &lt;å­—ä¸²&gt; ä½œä¸ºæ•°æ®å‘é€ï¼Œå¿…é¡»è®¾ç½® <span class="hljs-params">--method</span><br>       <span class="hljs-params">--post-file=</span>æ–‡ä»¶            å‘é€ &lt;æ–‡ä»¶&gt; å†…å®¹ï¼Œå¿…é¡»è®¾ç½® <span class="hljs-params">--method</span><br>       <span class="hljs-params">--content-disposition</span>       å½“é€‰æ‹©æœ¬åœ°æ–‡ä»¶åæ—¶å…è®¸ Content-Disposition<br>                                   å¤´éƒ¨ <span class="hljs-params">(å®éªŒä¸­)</span>ã€‚<br>       <span class="hljs-params">--content-on-error</span>          åœ¨æœåŠ¡å™¨é”™è¯¯æ—¶è¾“å‡ºæ¥æ”¶åˆ°çš„å†…å®¹<br>       <span class="hljs-params">--auth-no-challenge</span>         ä¸å…ˆç­‰å¾…æœåŠ¡å™¨è¯¢é—®å°±å‘é€åŸºæœ¬ HTTP éªŒè¯ä¿¡æ¯ã€‚<br>HTTPS <span class="hljs-params">(SSL/TLS)</span> é€‰é¡¹ï¼š<br>       <span class="hljs-params">--secure-protocol=PR</span>        choose secure protocol, one of auto, SSLv2,<br>                                     SSLv3, TLSv1, TLSv1_1, TLSv1_2 and PFS<br>       <span class="hljs-params">--https-only</span>                 åªè·Ÿéšå®‰å…¨çš„ HTTPS é“¾æ¥<br>       <span class="hljs-params">--no-check-certificate</span>       ä¸è¦éªŒè¯æœåŠ¡å™¨çš„è¯ä¹¦ã€‚<br>       <span class="hljs-params">--certificate=</span>æ–‡ä»¶           å®¢æˆ·ç«¯è¯ä¹¦æ–‡ä»¶ã€‚<br>       <span class="hljs-params">--certificate-type=</span>ç±»å‹      å®¢æˆ·ç«¯è¯ä¹¦ç±»å‹ï¼ŒPEM æˆ– DERã€‚<br>       <span class="hljs-params">--private-key=</span>æ–‡ä»¶           ç§é’¥æ–‡ä»¶ã€‚<br>       <span class="hljs-params">--private-key-type=</span>ç±»å‹      ç§é’¥æ–‡ä»¶ç±»å‹ï¼ŒPEM æˆ– DERã€‚<br>       <span class="hljs-params">--ca-certificate=</span>æ–‡ä»¶        å¸¦æœ‰ä¸€ç»„ CA è¯ä¹¦çš„æ–‡ä»¶ã€‚<br>       <span class="hljs-params">--ca-directory=DIR</span>           ä¿å­˜ CA è¯ä¹¦çš„å“ˆå¸Œåˆ—è¡¨çš„ç›®å½•ã€‚<br>       <span class="hljs-params">--ca-certificate=</span>æ–‡ä»¶        å¸¦æœ‰ä¸€ç»„ CA è¯ä¹¦çš„æ–‡ä»¶ã€‚<br>       <span class="hljs-params">--pinnedpubkey=</span>æ–‡ä»¶/æ•£åˆ—å€¼  ç”¨äºéªŒè¯èŠ‚ç‚¹çš„å…¬é’¥ï¼ˆPEM/DERï¼‰æ–‡ä»¶æˆ–<br>                                   ä»»ä½•æ•°é‡çš„ sha256 æ•£åˆ—å€¼ï¼Œä»¥ base64 ç¼–ç ã€<br>                                   â€œsha256//â€ å¼€å¤´ã€ç”¨â€œ;â€é—´éš”<br>HSTS é€‰é¡¹ï¼š<br>       <span class="hljs-params">--no-hsts</span>                   ç¦ç”¨ HSTS<br>       <span class="hljs-params">--hsts-file</span>                 HSTS æ•°æ®åº“è·¯å¾„ï¼ˆå°†è¦†ç›–é»˜è®¤å€¼ï¼‰<br>FTP é€‰é¡¹ï¼š<br>       <span class="hljs-params">--ftp-user=</span>ç”¨æˆ·             è®¾ç½® ftp ç”¨æˆ·åä¸º &lt;ç”¨æˆ·&gt;ã€‚<br>       <span class="hljs-params">--ftp-password=</span>å¯†ç          è®¾ç½® ftp å¯†ç ä¸º &lt;å¯†ç &gt;<br>       <span class="hljs-params">--no-remove-listing</span>         ä¸è¦åˆ é™¤â€˜<span class="hljs-string">.listing</span>â€™æ–‡ä»¶<br>       <span class="hljs-params">--no-glob</span>                   ä¸åœ¨ FTP æ–‡ä»¶åä¸­ä½¿ç”¨é€šé…ç¬¦å±•å¼€<br>       <span class="hljs-params">--no-passive-ftp</span>            ç¦ç”¨â€œpassiveâ€ä¼ è¾“æ¨¡å¼<br>       <span class="hljs-params">--preserve-permissions</span>      ä¿ç•™è¿œç¨‹æ–‡ä»¶çš„æƒé™<br>       <span class="hljs-params">--retr-symlinks</span>             é€’å½’ç›®å½•æ—¶ï¼Œè·å–é“¾æ¥çš„æ–‡ä»¶ <span class="hljs-params">(è€Œéç›®å½•)</span><br>FTPS é€‰é¡¹ï¼š<br>       <span class="hljs-params">--ftps-implicit</span>                 ä½¿ç”¨éšå¼ FTPSï¼ˆé»˜è®¤ç«¯å£ 990ï¼‰<br>       <span class="hljs-params">--ftps-resume-ssl</span>               æ‰“å¼€æ•°æ®è¿æ¥æ—¶ç»§ç»­æ§åˆ¶è¿æ¥ä¸­çš„ SSL/TLS ä¼šè¯<br>       <span class="hljs-params">--ftps-clear-data-connection</span>    åªåŠ å¯†æ§åˆ¶ä¿¡é“ï¼›æ•°æ®ä¼ è¾“ä½¿ç”¨æ˜æ–‡<br>       <span class="hljs-params">--ftps-fallback-to-ftp</span>          å›è½åˆ° FTPï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨ä¸æ”¯æŒ FTPS<br>WARC é€‰é¡¹ï¼š<br>       <span class="hljs-params">--warc-file=</span>æ–‡ä»¶å          åœ¨ä¸€ä¸ª <span class="hljs-string">.warc.gz</span> æ–‡ä»¶é‡Œä¿æŒè¯·æ±‚/å“åº”æ•°æ®<br>       <span class="hljs-params">--warc-header=</span>å­—ç¬¦ä¸²        åœ¨å¤´éƒ¨æ’å…¥ &lt;å­—ç¬¦ä¸²&gt;<br>       <span class="hljs-params">--warc-max-size=</span>æ•°å­—        å°† WARC çš„æœ€å¤§å°ºå¯¸è®¾ç½®ä¸º &lt;æ•°å­—&gt;<br>       <span class="hljs-params">--warc-cdx</span>                  å†™å…¥ CDX ç´¢å¼•æ–‡ä»¶<br>       <span class="hljs-params">--warc-dedup=</span>æ–‡ä»¶å         ä¸è¦è®°å½•åˆ—åœ¨æ­¤ CDX æ–‡ä»¶å†…çš„è®°å½•<br>       <span class="hljs-params">--no-warc-compression</span>       ä¸è¦ GZIP å‹ç¼© WARC æ–‡ä»¶<br>       <span class="hljs-params">--no-warc-digests</span>           ä¸è¦è®¡ç®— SHA1 æ‘˜è¦<br>       <span class="hljs-params">--no-warc-keep-log</span>          ä¸è¦åœ¨ WARC è®°å½•ä¸­å­˜å‚¨æ—¥å¿—æ–‡ä»¶<br>       <span class="hljs-params">--warc-tempdir=</span>ç›®å½•         WARC å†™å…¥å™¨çš„ä¸´æ—¶æ–‡ä»¶ç›®å½•<br>é€’å½’ä¸‹è½½ï¼š<br>  -r,  <span class="hljs-params">--recursive</span>                 æŒ‡å®šé€’å½’ä¸‹è½½<br>  -l,  <span class="hljs-params">--level=</span>æ•°å­—                æœ€å¤§é€’å½’æ·±åº¦ <span class="hljs-params">(inf æˆ– 0 ä»£è¡¨æ— é™åˆ¶ï¼Œå³å…¨éƒ¨ä¸‹è½½)</span>ã€‚<br>       <span class="hljs-params">--delete-after</span>             ä¸‹è½½å®Œæˆååˆ é™¤æœ¬åœ°æ–‡ä»¶<br>  -k,  <span class="hljs-params">--convert-links</span>            è®©ä¸‹è½½å¾—åˆ°çš„ HTML æˆ– CSS ä¸­çš„é“¾æ¥æŒ‡å‘æœ¬åœ°æ–‡ä»¶<br>       <span class="hljs-params">--convert-file-only</span>         åªè½¬æ¢ URL çš„æ–‡ä»¶éƒ¨åˆ†ï¼ˆä¸€èˆ¬å«åšâ€œåŸºç¡€åâ€<span class="hljs-string">/basename</span>ï¼‰<br>       <span class="hljs-params">--backups=N</span>                 å†™å…¥æ–‡ä»¶ X å‰ï¼Œè½®æ¢ç§»åŠ¨æœ€å¤š N ä¸ªå¤‡ä»½æ–‡ä»¶<br>  -K,  <span class="hljs-params">--backup-converted</span>         åœ¨è½¬æ¢æ–‡ä»¶ X å‰å…ˆå°†å®ƒå¤‡ä»½ä¸º X.origã€‚<br>  -m,  <span class="hljs-params">--mirror</span>                   -N -r -l inf <span class="hljs-params">--no-remove-listing</span> çš„ç¼©å†™å½¢å¼ã€‚<br>  -p,  <span class="hljs-params">--page-requisites</span>          ä¸‹è½½æ‰€æœ‰ç”¨äºæ˜¾ç¤º HTML é¡µé¢çš„å›¾ç‰‡ä¹‹ç±»çš„å…ƒç´ ã€‚<br>       <span class="hljs-params">--strict-comments</span>          ç”¨ä¸¥æ ¼æ–¹å¼ <span class="hljs-params">(SGML)</span> å¤„ç† HTML æ³¨é‡Šã€‚<br>é€’å½’æ¥å—/æ‹’ç»ï¼š<br>  -A,  <span class="hljs-params">--accept=</span>åˆ—è¡¨               é€—å·åˆ†éš”çš„å¯æ¥å—çš„æ‰©å±•ååˆ—è¡¨<br>  -R,  <span class="hljs-params">--reject=</span>åˆ—è¡¨               é€—å·åˆ†éš”çš„è¦æ‹’ç»çš„æ‰©å±•ååˆ—è¡¨<br>       <span class="hljs-params">--accept-regex=REGEX</span>        åŒ¹é…æ¥å—çš„ URL çš„æ­£åˆ™è¡¨è¾¾å¼<br>       <span class="hljs-params">--reject-regex=REGEX</span>        åŒ¹é…æ‹’ç»çš„ URL çš„æ­£åˆ™è¡¨è¾¾å¼<br>       <span class="hljs-params">--regex-type=</span>ç±»å‹           æ­£åˆ™ç±»å‹ <span class="hljs-params">(posix|pcre)</span><br>  -D,  <span class="hljs-params">--domains=</span>åˆ—è¡¨              é€—å·åˆ†éš”çš„å¯æ¥å—çš„åŸŸååˆ—è¡¨<br>       <span class="hljs-params">--exclude-domains=</span>åˆ—è¡¨      é€—å·åˆ†éš”çš„è¦æ‹’ç»çš„åŸŸååˆ—è¡¨<br>       <span class="hljs-params">--follow-ftp</span>                è·Ÿè¸ª HTML æ–‡æ¡£ä¸­çš„ FTP é“¾æ¥<br>       <span class="hljs-params">--follow-tags=</span>åˆ—è¡¨          é€—å·åˆ†éš”çš„è·Ÿè¸ªçš„ HTML æ ‡è¯†åˆ—è¡¨<br>       <span class="hljs-params">--ignore-tags=</span>åˆ—è¡¨          é€—å·åˆ†éš”çš„å¿½ç•¥çš„ HTML æ ‡è¯†åˆ—è¡¨<br>  -H,  <span class="hljs-params">--span-hosts</span>                é€’å½’æ—¶è½¬å‘å¤–éƒ¨ä¸»æœº<br>  -L,  <span class="hljs-params">--relative</span>                  ä»…è·Ÿè¸ªç›¸å¯¹é“¾æ¥<br>  -I,  <span class="hljs-params">--include-directories=</span>åˆ—è¡¨  å…è®¸ç›®å½•çš„åˆ—è¡¨<br>       <span class="hljs-params">--trust-server-names</span>        ä½¿ç”¨é‡å®šå‘ URL çš„æœ€åä¸€æ®µä½œä¸ºæœ¬åœ°æ–‡ä»¶å<br>  -X,  <span class="hljs-params">--exclude-directories=</span>åˆ—è¡¨  æ’é™¤ç›®å½•çš„åˆ—è¡¨<br>  -np, <span class="hljs-params">--no-parent</span>                 ä¸è¿½æº¯è‡³çˆ¶ç›®å½•<br></code></pre></div></td></tr></table></figure><p>å¦‚æ­¤å¤šçš„å‚æ•°,çœ‹ç€å®åœ¨æœ›è€Œç”Ÿç•,ä¸è¿‡å¥½åœ¨è¿™æ˜¯æœ‰ä¸­æ–‡çš„,æ‰€ä»¥â€¦æ…¢æ…¢æ¥</p><p>ä¸‹é¢ä»¥å®ä¾‹æ¥ä»‹ç»è¯¥ç”¨å…·çš„ä¸»è¦ç”¨æ³•</p><h4 id="ä¸‹è½½å•ä¸ªæ–‡ä»¶"><a class="markdownIt-Anchor" href="#ä¸‹è½½å•ä¸ªæ–‡ä»¶"></a> ä¸‹è½½å•ä¸ªæ–‡ä»¶</h4><p># wget <a href="https://ftp.gnu.org/gnu/wget/wget-1.19.tar.gz">https://ftp.gnu.org/gnu/wget/wget-1.19.tar.gz</a> -P save_files -O wget.tar.gz</p><blockquote><p>â€“2018-01-06 17:22:48â€“ <a href="https://ftp.gnu.org/gnu/wget/wget-1.19.tar.gz">https://ftp.gnu.org/gnu/wget/wget-1.19.tar.gz</a><br />æ­£åœ¨è§£æä¸»æœº <a href="http://ftp.gnu.org">ftp.gnu.org</a> (<a href="http://ftp.gnu.org">ftp.gnu.org</a>)â€¦ 208.118.235.20, 2001:4830:134:3::b<br />æ­£åœ¨è¿æ¥ <a href="http://ftp.gnu.org">ftp.gnu.org</a> (<a href="http://ftp.gnu.org">ftp.gnu.org</a>)|208.118.235.20|:443â€¦ å·²è¿æ¥ã€‚<br />å·²å‘å‡º HTTP è¯·æ±‚ï¼Œæ­£åœ¨ç­‰å¾…å›åº”â€¦ 200 OK<br />é•¿åº¦ï¼š4202290 (4.0M) [application/x-gzip]<br />æ­£åœ¨ä¿å­˜è‡³: â€œwget.tar.gzâ€<br />6%[=&gt; ] 280.00K 21.8KB/s å‰©ä½™ 3m 6s</p></blockquote><ul><li><p>-O æŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åå­—</p></li><li><p>-P æŒ‡å®šä¿å­˜æ–‡ä»¶çš„ç›®å½• (æœªæŒ‡å®šè¯¥å‚æ•°é»˜è®¤ä¿å­˜åœ¨å½“å‰è·¯å¾„)</p><h4 id="ä¸‹è½½å¤šä¸ªæ–‡ä»¶"><a class="markdownIt-Anchor" href="#ä¸‹è½½å¤šä¸ªæ–‡ä»¶"></a> ä¸‹è½½å¤šä¸ªæ–‡ä»¶</h4><p>å¯ä»¥æŠŠè¦ä¸‹è½½çš„å¤šä¸ªé“¾æ¥åœ°å€ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­,å¹¶åœ¨wgetæ—¶æŒ‡å®š -i å‚æ•°</p></li></ul><p>#  wget -i files.txt</p><h4 id="æ–­ç‚¹ç»­ä¼ "><a class="markdownIt-Anchor" href="#æ–­ç‚¹ç»­ä¼ "></a> æ–­ç‚¹ç»­ä¼ </h4><p>æœ‰æ—¶å€™åœ¨ä¸‹è½½ä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ–‡ä»¶,ç¢°åˆ°ç½‘ç»œç¯å¢ƒä¸å¥½æˆ–è€…çªç„¶æ–­ç½‘äº†,é‚£ä¹ˆè¦é‡æ–°ä¸‹è½½è¿™ä¸ªæ–‡ä»¶äº†.ä¸ºäº†é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿ,å¤§å¤šæ•°ä¸‹è½½è½¯ä»¶éƒ½æ”¯æŒæ–­ç‚¹ç»­ä¼ .é¡¾åæ€ä¹‰,å°±æ˜¯åœ¨ç½‘ç»œç­‰é—®é¢˜çš„å½±å“ä¸‹è€Œè¢«ä¸­æ–­ä¸‹è½½å,ç­‰åˆ°ç½‘ç»œæ¢å¤å,åœ¨åŸæ¥çš„åœ°æ–¹æ¥ç€ä¸‹è½½.</p><p>wgetä¹Ÿæ”¯æŒè¯¥åŠŸèƒ½,ç”±å‚æ•° <strong>-c</strong> æŒ‡å®š<br /># wget -c <a href="https://baidu.com">https://baidu.com</a> -t 5</p><ul><li>-t æŒ‡å®š<strong>é‡è¯•æ¬¡æ•°</strong> ,0 è¡¨ç¤ºæ— é™åˆ¶</li></ul><h4 id="ä»£ç†ä¸‹è½½"><a class="markdownIt-Anchor" href="#ä»£ç†ä¸‹è½½"></a> ä»£ç†ä¸‹è½½</h4><p>è¦ä¸‹è½½ä¸€ä¸ªå›½å¤–çš„æ–‡ä»¶,æœ‰æ—¶è¿æ°”ä¸å¥½(è¢«å¢™),å¯¼è‡´æ— æ³•ä¸‹è½½æ‰€éœ€æ–‡ä»¶.è¿™æ—¶å°±è¦ä½¿ç”¨ä»£ç†äº†,è€Œä¸æ˜¯çº ç»“è¯¥é“¾æ¥åœ°å€æœ‰é—®é¢˜.</p><p>è¯´åˆ°ä»£ç†,å¯ä»¥æ˜¯æœ¬åœ°æ­å»ºä»£ç†çš„æœåŠ¡å™¨,ä¹Ÿå¯ä»¥ä»ç½‘ç»œä¸Šè·å¾—çš„å…¬å…±æœåŠ¡å™¨,è¿™é‡Œä»¥æœ¬åœ°ä»£ç†æœåŠ¡å™¨ä¸ºä¾‹.<br />ä¸è¿‡åœ¨æ­¤ä¹‹å‰æˆ‘å·²è®¾ç½®å¥½äº†ä»£ç†æœåŠ¡å™¨,è¯¥æœåŠ¡å™¨ä¸º: <a href="http://127.0.0.1:8087">http://127.0.0.1:8087</a></p><p># wget <a href="https://www.google.com">https://www.google.com</a> -O output.html <strong>-e â€œuse_proxy=onâ€ -e â€œhttps_proxy=http://127.0.0.1:8087â€œ</strong></p><ul><li>-e è¿è¡Œä¸€ä¸ªâ€œ.wgetrcâ€é£æ ¼çš„å‘½ä»¤,<strong>wgetrc</strong>æ–‡ä»¶ä½äº /etc/wgetrc,ä¸ºwgetè¿è¡Œæ—¶çš„åˆå§‹åŒ–æ–‡ä»¶.ä¹Ÿå¯ä»¥åœ¨è¯¥æ–‡ä»¶é‡Œè®¾ç½®ä»£ç†æœåŠ¡å™¨åœ°å€(å…¨å±€å˜é‡)</li><li>use_proxy=on/no ä½¿ç”¨/ç¦æ­¢ä»£ç†,ä¸€èˆ¬ä½¿ç”¨ä»£ç†æ—¶,è¦æŒ‡æ˜è¯¥æ“ä½œ</li><li>http_proxy/https_proxy/ftp_proxy 3ç§åè®®çš„ä»£ç†æœåŠ¡å™¨,æ ¼å¼<strong>çš†ä¸º</strong>: <a href="http://proxy.yoyodyne.com:18023">http://proxy.yoyodyne.com:18023</a></li></ul><p>è¿è¡Œè¯¥å‘½ä»¤è¾“å‡ºå¦‚ä¸‹</p><blockquote><p>â€“2018-01-06 17:45:29â€“ <a href="https://www.google.com/">https://www.google.com/</a><br />æ­£åœ¨è¿æ¥ 127.0.0.1:8087â€¦ å·²è¿æ¥ã€‚<br />é”™è¯¯: â€œ<a href="http://www.google.com">www.google.com</a>â€ çš„è¯ä¹¦ä¸å¯ä¿¡ã€‚<br />é”™è¯¯: â€œ<a href="http://www.google.com">www.google.com</a>â€ çš„è¯ä¹¦é¢å‘è€…æœªçŸ¥ã€‚<br />é”™è¯¯: â€œ<a href="http://www.google.com">www.google.com</a>â€ çš„è¯ä¹¦ä½¿ç”¨ä¸å®‰å…¨çš„ç®—æ³•ç­¾åã€‚</p></blockquote><p>æ³¨æ„è¯¥å¤„,æˆ‘ç”¨çš„æ˜¯ <strong>gae_proxy</strong> ,ç”±äºè¯ä¹¦é—®é¢˜è€Œå‡ºç°è¯¥é”™è¯¯,è§£å†³æ–¹æ³•ä¸¤ç§</p><ul><li>ç›´æ¥åœ¨åŸæ¥å‘½ä»¤è¡ŒååŠ ä¸Š <strong>â€“no-check-certificate</strong>é€‰é¡¹ ,è¡¨ç¤ºä¸æ£€æŸ¥è¯ä¹¦å®‰å…¨é—®é¢˜,å¿½ç•¥è¯¥è¿‡ç¨‹.ä¸”<strong>é”™è¯¯</strong>å˜æˆäº†<strong>è­¦å‘Š</strong></li><li>æŒ‡å®šè¯ä¹¦,æˆ‘çš„æ˜¯ <strong>CA.crt</strong> ç”¨åˆ° <strong>â€“ca-certificate</strong> é€‰é¡¹,ä¹‹åä¾¿å¯æ­£å¸¸ä¸‹è½½äº†.å¦‚:</li></ul><blockquote><p>wget <a href="https://www.google.com">https://www.google.com</a> -O output.html â€“progress=dot -e â€œuse_proxy=onâ€ -e â€œhttps_proxy=http://127.0.0.1:8087â€œ <strong>â€“ca-certificate=data/gae_proxy/CA.crt</strong></p></blockquote><h4 id="é™é€Ÿä¸‹è½½"><a class="markdownIt-Anchor" href="#é™é€Ÿä¸‹è½½"></a> é™é€Ÿä¸‹è½½</h4><p># wget <strong>â€“limit-rate=10k</strong> <a href="https://ftp.gnu.org/gnu/wget/wget-1.18.tar.gz">https://ftp.gnu.org/gnu/wget/wget-1.18.tar.gz</a></p><ul><li>â€“limit-rate æŒ‡å®šè¦é™åˆ¶çš„å¤§å°</li></ul><p><img src="/uploads/images/wget/file_002.gif" alt="img" /></p><h4 id="æµ‹è¯•ä¸‹è½½é“¾æ¥"><a class="markdownIt-Anchor" href="#æµ‹è¯•ä¸‹è½½é“¾æ¥"></a> æµ‹è¯•ä¸‹è½½é“¾æ¥</h4><p># wget â€“spider <a href="http://baidu.com">http://baidu.com</a></p><blockquote><p>æ‰“å¼€ Spider æ¨¡å¼ã€‚æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¿œç¨‹æ–‡ä»¶ã€‚<br />â€“2018-01-06 18:13:16â€“ <a href="http://baidu.com/">http://baidu.com/</a><br />æ­£åœ¨è§£æä¸»æœº <a href="http://baidu.com">baidu.com</a> (<a href="http://baidu.com">baidu.com</a>)â€¦ 111.13.101.208, 123.125.114.144, 220.181.57.217<br />æ­£åœ¨è¿æ¥ <a href="http://baidu.com">baidu.com</a> (<a href="http://baidu.com">baidu.com</a>)|111.13.101.208|:80â€¦ å·²è¿æ¥ã€‚<br />å·²å‘å‡º HTTP è¯·æ±‚ï¼Œæ­£åœ¨ç­‰å¾…å›åº”â€¦ 200 OK<br />é•¿åº¦ï¼š81 [text/html]<br /><strong>å­˜åœ¨è¿œç¨‹æ–‡ä»¶ä¸”è¯¥æ–‡ä»¶å¯èƒ½å«æœ‰æ›´æ·±å±‚çš„é“¾æ¥ï¼Œä½†ä¸èƒ½è¿›è¡Œé€’å½’æ“ä½œ â€“ æ— æ³•è·å–</strong></p></blockquote><ul><li>é€šè¿‡ â€“spiderå‚æ•°,å¯ä»¥æµ‹è¯•ä¸‹è½½é“¾æ¥æ˜¯å¦æœ‰æ•ˆ</li></ul><p>æœ€åä¸€ä¸ªä¾‹å­:</p><p># wget â€“user-agent=â€Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36â€ <a href="https://ftp.gnu.org/gnu/wget/wget-1.18.tar.xz">https://ftp.gnu.org/gnu/wget/wget-1.18.tar.xz</a> -e â€œuse_proxy=onâ€ -e â€œhttp_proxy=http://127.0.0.1:8087â€œ -t 5 -P save_file â€“progress=dot</p><p>æ›´å¤šçš„å‚æ•°è¿˜æ˜¯è¦å»æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£çš„â€¦</p><h3 id="ç»“æŸ"><a class="markdownIt-Anchor" href="#ç»“æŸ"></a> ç»“æŸ</h3><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MongoDBæ•°æ®åº“æ­å»º(Windows)</title>
    <link href="/win-mongodb/"/>
    <url>/win-mongodb/</url>
    
    <content type="html"><![CDATA[<p>å…³äºMongoDéå…³ç³»æ•°æ®åº“ï¼Œç½‘ä¸Šæœ‰å¤ªå¤šçš„è§£é‡Šï¼Œä¸å…¶è®²å¾—å†å¤šï¼Œè¿˜ä¸å¦‚äº²è‡ªä½“éªŒä¸€ä¸‹</p><span id="more"></span><h3 id="mongodb"><a class="markdownIt-Anchor" href="#mongodb"></a> MongoDB</h3><p>æœ‰ç”¨è¿‡MySQLï¼ŒPostgreSQLï¼Œsqlite3ç­‰è¿™äº›æ•°æ®åº“çš„ï¼Œæ˜¯æ—¶å€™åº”è¯¥è€ƒè™‘ä¸‹MongoDBäº†ã€‚ã€‚æ­¤å¤„ä¹‹å¤–ï¼ŒMongoDBæ­å»ºä¹Ÿæ˜¯éå¸¸ç®€å•çš„ï¼Œæœ¬æ–‡ä»¥windowsç³»ç»Ÿä¸ºä¾‹ï¼ˆé—®ï¼šä¸ºä»€ä¹ˆä¸æ˜¯Linuxï¼Ÿç­”ï¼šæˆ‘æƒ³æ€ä¹ˆç©å°±è¿™ä¹ˆæ€ä¹ˆç©ï¼ç®¡å¾—ç€ï¼Ÿï¼‰</p><p>æµ‹è¯•ç¯å¢ƒï¼š</p><blockquote><p>Windows 10<br />MongoDB 3.6.3</p></blockquote><p><a href="https://www.mongodb.com">ä¸‹è½½åœ°å€è§å®˜ç½‘</a></p><p>ä¸‹è½½å®Œæˆåæ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œè§£å‹åbinç›®å½•ä¸‹æœ‰å¦‚ä¸‹æ–‡ä»¶<br /><img src="/uploads/images/windows/file_001.png" alt="img" /></p><p>mongod.exe æ•°æ®åº“æœåŠ¡å™¨è¿›ç¨‹ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰<br />mongo.exe ç”¨äºä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’çš„shellæ§åˆ¶å°ï¼ˆJavaScriptï¼‰<br />mongoexport.exe æ•°æ®å¯¼å‡ºï¼ˆå¤‡ä»½ï¼‰<br />mongoimport.exe æ•°æ®å¯¼å…¥ï¼ˆæ¢å¤ï¼‰</p><p>è¿›å…¥CMDï¼Œcd åˆ°mongoDB binç›®å½•ï¼Œé€šè¿‡ <code>mongod.exe --help</code> å¯æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶çš„å‚æ•°åˆ—è¡¨ï¼Œå‚æ•°è¿˜æŒºå¤šçš„ã€‚ã€‚ã€‚<br /><img src="/uploads/images/windows/file_002.png" alt="img" /></p><p>æ³¨æ„é‚£ä¸€ä¸ªå‚æ•°</p><blockquote><p>-f [ â€“config ] arg configuration file specifying additional options</p></blockquote><p>å¯ä»¥æŒ‡å®šä¸€ä¸ªé…ç½®æ–‡ä»¶ä½œä¸ºæœåŠ¡å™¨å¯åŠ¨çš„å‚æ•°<br />æ¯”å¦‚ä»¥ä¸‹å‡ ä¸ªå‚æ•°ï¼š</p><blockquote><p>dbpath=C:\MongoDB\data\db<br />logpath=C:\MongoDB\logs\mongo.log<br />logappend=true<br />port=27017<br />auth=true<br />bind_ip_all=true</p></blockquote><p><strong>dbpath</strong> æŒ‡å®šdatabase<strong>ç›®å½•</strong>ï¼Œé»˜è®¤ä¸º <em><em>C:\data\db*</em><br /><strong>logpath</strong> æŒ‡å®šæ—¥å¿—</em><em>æ–‡ä»¶</em>*ï¼Œè€Œä¸æ˜¯æ ‡å‡†è¾“å‡ºåˆ°consoleã€‚æ³¨æ„æ˜¯æ–‡ä»¶ï¼Œä¸æ˜¯ç›®å½•ï¼<br /><strong>logappend</strong> æŒ‡å®šä»¥è¿½åŠ çš„æ¨¡å¼å†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œè€Œä¸æ˜¯è¦†ç›–<br /><strong>port</strong> æŒ‡å®šæœåŠ¡å™¨ç›‘å¬çš„ç«¯å£ï¼Œé»˜è®¤ 27017<br /><strong>auth</strong> æŒ‡å®šè®¿é—®æ•°æ®åº“æ—¶å¿…é¡»è¦ç»è¿‡èº«ä»½éªŒè¯<br /><strong>bind_ip_all</strong> ç»‘å®šï¼ˆç›‘å¬ï¼‰æ‰€æœ‰IPåœ°å€ï¼Œæˆ–è€… <strong>bind_ip</strong> æŒ‡å®šè¦ç»‘å®šçš„IPåœ°å€åˆ—è¡¨ï¼Œé»˜è®¤ <strong>localhost</strong><br />å…³äºé…ç½®æ–‡ä»¶æ›´è¯¦ç»†ä¿¡æ¯è¿˜å¾—å»å®˜ç½‘æŸ¥æŸ¥â€¦</p><p>MongoDBæ ¹ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ï¼Œä¸å­˜åœ¨çš„ç›®å½•å’Œæ–‡ä»¶è‡ªè¡Œåˆ›å»º</p><blockquote><p>C:\MongoDB<br />|â€“bin<br />â€”â€”-|â€“ â€¦<br />|â€“conf<br />â€”â€”-|â€“ mongo.conf<br />|â€“data<br />â€”â€”-|â€“ db<br />|â€“logs<br />â€”â€”-|â€“ mongo.log</p></blockquote><p>ä¹‹ååœ¨<br /><code>mongod.exe --config c:\MongoDB\conf\mongo.conf</code><br /><img src="/uploads/images/windows/file_003.png" alt="img" /></p><p>æ¥ç€æˆ‘ä»¬è¾“å‡º show dbs</p><blockquote><p>&gt;show dbs<br />2018-02-21T10:29:48.852+0800 E QUERY [thread1] Error: listDatabases failed:{<br />â€œokâ€ : 0,<br />â€œerrmsgâ€ : â€œnot authorized on admin to execute command { listDatabases: 1.0, $db: \â€admin\â€ }â€,<br />â€œcodeâ€ : 13,<br />â€œcodeNameâ€ : â€œUnauthorizedâ€<br />} :<br />_getErrorWithCode@src/mongo/shell/utils.js:25:13<br />Mongo.prototype.getDBs@src/mongo/shell/mongo.js:65:1<br />shellHelper.show@src/mongo/shell/utils.js:816:19<br />shellHelper@src/mongo/shell/utils.js:706:15<br />@(shellhelp2):1:1<br />&gt;</p></blockquote><p>æŠ¥é”™äº†ï¼Œå› ä¸ºæ²¡æœ‰æƒé™åˆ—ä¸¾å‡ºæ‰€æœ‰çš„databaseï¼Œè¿™å°±æ˜¯ä¹‹å‰çš„ <strong>auth</strong> çš„ä½œç”¨ã€‚é‚£ä¹ˆç°åœ¨åˆ›å»ºä¸€ä¸ªç”¨æˆ·</p><blockquote><p>&gt; <strong>use admin</strong><br />switched to db admin<br />&gt; <strong>db.createUser({user:â€™fuckâ€™,pwd:â€™12345â€™,roles:[{role:â€™rootâ€™,db:â€™adminâ€™}]})</strong></p><p>Successfully added user: {<br />â€œuserâ€ : â€œfuckâ€,<br />â€œrolesâ€ : [<br />{<br />â€œroleâ€ : â€œrootâ€,<br />â€œdbâ€ : â€œadminâ€<br />}<br />]<br />}<br />&gt;</p></blockquote><p>é¦–å…ˆï¼Œåˆ‡æ¢åˆ° admin è¿™ä¸ªdatabaseï¼Œç„¶åé€šè¿‡ <code>db.createUser</code> æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·ï¼Œè¿™é‡Œåˆ›å»ºä¸€ä¸ªrootæƒé™çš„ç”¨æˆ· ğŸ˜ƒ<br />exitï¼Œé‡æ–°è¿›å…¥ mongo console<br />å†æ¬¡ <code>show dbs</code>ï¼ŒåŒæ ·æŠ¥é”™ã€‚æ¥ç€</p><blockquote><p>&gt;use admin<br />&gt;db.auth(â€˜fuckâ€™,â€™12345â€™)<br />&gt;1<br />&gt;show dbs<br />admin 0.000GB<br />config 0.000GB<br />local 0.000GB<br />1 è¯´æ˜éªŒè¯æˆåŠŸï¼›0 éªŒè¯å¤±è´¥</p></blockquote><p>ç°åœ¨æˆ‘ä»¬å·²ç»æˆåŠŸæ­å»ºçš„MongoDBæœåŠ¡å™¨ã€‚ã€‚ç­‰ç­‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸‹æ¬¡å¼€æœºè¿˜ä¸æ˜¯è¿˜è¦é‡æ–°é€šè¿‡å‘½ä»¤è¡Œæ¥å¯åŠ¨æœåŠ¡å™¨ï¼Ÿè¿™æ ·ä¹Ÿå¤ªéº»çƒ¦äº†å§ã€‚æ˜¯çš„ï¼Œæ‰€ä»¥å¯ä»¥æŠŠMongoDBæ·»åŠ åˆ°ç³»ç»ŸæœåŠ¡é‡Œé¢ï¼Œè®©å®ƒå¼€æœºè‡ªå¯åŠ¨ã€‚</p><p>è¿˜è®°å¾— <code>mongod.exe --help</code>å—ï¼Ÿæˆ‘ä»¬å¯ä»¥æ‰¾æ‰¾æœ‰å“ªäº›å‚æ•°æœ‰ç”¨å¾—åˆ°çš„ã€‚ã€‚ã€‚</p><p>WindowsæœåŠ¡æ§åˆ¶ç®¡ç†</p><blockquote><p>Windows Service Control Manager options:<br /><strong>â€“install</strong> install Windows service<br /><strong>â€“remove</strong> remove Windows service<br />-<strong>-reinstall</strong> reinstall Windows service (equivalent<br />to â€“remove followed by â€“install)<br /><strong>â€“serviceName</strong> arg Windows service name<br /><strong>â€“serviceDisplayName</strong> arg Windows service display name<br /><strong>â€“serviceDescription</strong> arg Windows service description<br /><strong>â€“serviceUser</strong> arg account for service execution<br /><strong>â€“servicePassword</strong> arg password used to authenticate<br />serviceUser</p></blockquote><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšï¼Œé€šè¿‡ --install å®‰è£…ç³»ç»ŸæœåŠ¡</p><blockquote><p>mongod.exe --config c:\MongoDB\conf\mongo.conf <strong>â€“serviceName MongoDB</strong> --serviceDisplayName MongoDB_Server --serviceDescription â€œThis is my MongoDB Serverâ€¦â€ <strong>â€“install</strong></p></blockquote><p><img src="/uploads/images/windows/file_004.png" alt="img" /></p><p>çœ‹ï¼æ˜¯ä¸æ˜¯OKäº†ï¼ŒSo easy!é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠ <code>C:\MongoDB\bin</code> æ·»åŠ åˆ°PATHç¯å¢ƒå˜é‡é‡Œã€‚<br />ç°åœ¨å¯åŠ¨è¯¥æœåŠ¡æˆ–è€… <code>net start MongoDB</code>ï¼Œå›åˆ°cmdï¼Œè¾“å…¥</p><blockquote><p>mongo -u fuck -p 12345 admin</p></blockquote><p>-u æŒ‡å®šç”¨æˆ·åç§°<br />-p æŒ‡å®šç”¨æˆ·å¯†ç <br />åé¢çš„ admin åˆ™æ˜¯è¦ç™»å½•çš„database</p><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>å—¯â€¦å¾ˆç®€å•å§ï¼é™¤æ­¤ä¹‹å¤–ï¼ŒMongoDBæ•°æ®åº“æä¾›çš„ç¼–ç¨‹æ¥å£ä¹Ÿæ˜¯æ”¯æŒå¤§å¤šæ•°è¯­è¨€çš„ï¼Œæ¯”å¦‚ Cï¼ŒC++ï¼ŒJavaï¼ŒPythonï¼ŒPHPâ€¦â€¦å…·ä½“å¯ä»å®˜ç½‘ä¸ŠæŸ¥çœ‹ä½¿ç”¨æ–¹æ³•ã€‚å¯¹äºC/C++ï¼Œä¼¼ä¹æŒºå¤æ‚çš„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>MongoDB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
      <tag>MongoDB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ©ç”¨winpcapè·å–ç½‘ç»œæ•°æ®ä¼ è¾“</title>
    <link href="/winpcap-use/"/>
    <url>/winpcap-use/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h3><blockquote><p><strong>winpcap</strong>(windows packet capture)æ˜¯windowså¹³å°ä¸‹ä¸€ä¸ªå…è´¹ï¼Œå…¬å…±çš„ç½‘ç»œè®¿é—®ç³»ç»Ÿã€‚å¼€å‘winpcapè¿™ä¸ªé¡¹ç›®çš„ç›®çš„åœ¨äºä¸ºwin32åº”ç”¨ç¨‹åºæä¾›è®¿é—®ç½‘ç»œåº•å±‚çš„èƒ½åŠ›ã€‚å®ƒç”¨äºwindowsç³»ç»Ÿä¸‹çš„ç›´æ¥çš„ç½‘ç»œç¼–ç¨‹ã€‚</p><p><strong>é©±åŠ¨åŠŸèƒ½</strong><br />æ•è·åŸå§‹æ•°æ®åŒ…ï¼ŒåŒ…æ‹¬åœ¨å…±äº«ç½‘ç»œä¸Šå„ä¸»æœºå‘é€/æ¥æ”¶çš„ä»¥åŠç›¸äº’ä¹‹é—´äº¤æ¢çš„æ•°æ®åŒ…ï¼›<br />åœ¨æ•°æ®åŒ…å‘å¾€åº”ç”¨ç¨‹åºä¹‹å‰ï¼ŒæŒ‰ç…§è‡ªå®šä¹‰çš„è§„åˆ™å°†æŸäº›ç‰¹æ®Šçš„æ•°æ®åŒ…è¿‡æ»¤æ‰ï¼›<br />åœ¨ç½‘ç»œä¸Šå‘é€åŸå§‹çš„æ•°æ®åŒ…ï¼›<br />æ”¶é›†ç½‘ç»œé€šä¿¡è¿‡ç¨‹ä¸­çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</p></blockquote><span id="more"></span><h3 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h3><p>åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œå¯ä»¥åˆ°winpcapå®˜ç½‘ä¸‹è½½å®‰è£…</p><p>ä»£ç è¯´æ˜ä¸€åˆ‡</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>  HAVE_REMOTE</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;pcap.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;WinSock2.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> comment(lib,<span class="hljs-meta-string">&quot;ws2_32&quot;</span>)</span><br> <br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br> <br><span class="hljs-comment">/* packet handler å‡½æ•°åŸå‹ */</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">packet_handler</span><span class="hljs-params">(u_char *param, <span class="hljs-keyword">const</span> struct pcap_pkthdr *header, <span class="hljs-keyword">const</span> u_char *pkt_data)</span></span>;<br> <br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> Ethernet_IPv4 0x0800</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> Ethernet_ARP 0x0806</span><br> <br><span class="hljs-comment">//Ethernetå¸§ size:14(Ethernet II)</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">EthernetHeader</span></span><br><span class="hljs-class">&#123;</span><br>       BYTE byDestMac[<span class="hljs-number">6</span>];<br>       BYTE bySrcMac[<span class="hljs-number">6</span>];     <br>       USHORT usType;  <br>&#125;;<br> <br><span class="hljs-comment">//TCP å¤´ä¿¡æ¯ size:20</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">TCPHeader</span></span><br><span class="hljs-class">&#123;</span><br>       USHORT m_sSourPort;   <span class="hljs-comment">// æºç«¯å£å·16bit</span><br>       USHORT m_sDestPort;   <span class="hljs-comment">// ç›®çš„ç«¯å£å·16bit</span><br>       ULONG m_uiSequNum;<span class="hljs-comment">// åºåˆ—å·32bit</span><br>       ULONG m_uiAcknowledgeNum;  <span class="hljs-comment">// ç¡®è®¤å·32bit</span><br>       USHORT m_sHeaderLenAndFlag;<span class="hljs-comment">// å‰4ä½ï¼šTCPå¤´é•¿åº¦ï¼›ä¸­6ä½ï¼šä¿ç•™ï¼›å6ä½ï¼šæ ‡å¿—ä½</span><br>       USHORT m_sWindowSize;<span class="hljs-comment">// çª—å£å¤§å°16bit</span><br>       USHORT m_sCheckSum;<span class="hljs-comment">// æ£€éªŒå’Œ16bit</span><br>       USHORT m_surgentPointer;<span class="hljs-comment">// ç´§æ€¥æ•°æ®åç§»é‡16bit</span><br>&#125;;<br> <br><span class="hljs-comment">//ARP å¤´ä¿¡æ¯</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ARPHeader</span></span><br><span class="hljs-class">&#123;</span><br>       USHORT usHardwareType;<span class="hljs-comment">//Ethernet(1)</span><br>       USHORT ProtocolType;<span class="hljs-comment">//IPv4(0x0800)</span><br>       BYTE byHardwareSize;<br>       BYTE byProtocolSize;<br>       BYTE byOpcode;<span class="hljs-comment">//request(1)</span><br>       BYTE bySenderMAC[<span class="hljs-number">6</span>];<br>       DWORD dwSenderIPaddress;<br>       BYTE byTargetMAC[<span class="hljs-number">6</span>];<br>       DWORD dwTargetIPaddress;<br>&#125;;<br> <br><span class="hljs-comment">/* 4å­—èŠ‚çš„IPåœ°å€ */</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">IPAddress</span></span><br><span class="hljs-class">&#123;</span><br>       u_char byte1;<br>       u_char byte2;<br>       u_char byte3;<br>       u_char byte4;<br>&#125; IPAddress;<br> <br><span class="hljs-comment">/* IPv4 é¦–éƒ¨ */</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">IPHeader</span></span><br><span class="hljs-class">&#123;</span><br>       BYTE m_byVerHLen;     <span class="hljs-comment">//4ä½ç‰ˆæœ¬+4ä½é¦–éƒ¨é•¿åº¦</span><br>       BYTE m_byTOS;                    <span class="hljs-comment">//æœåŠ¡ç±»å‹</span><br>       USHORT m_usTotalLen; <span class="hljs-comment">//æ€»é•¿åº¦</span><br>       USHORT m_usID; <span class="hljs-comment">//æ ‡è¯†</span><br>       USHORT m_usFlagFragOffset; <span class="hljs-comment">//3ä½æ ‡å¿—+13ä½ç‰‡åç§»</span><br>       BYTE m_byTTL; <span class="hljs-comment">//TTL</span><br>       BYTE m_byProtocol; <span class="hljs-comment">//åè®®</span><br>       USHORT m_usHChecksum; <span class="hljs-comment">//é¦–éƒ¨æ£€éªŒå’Œ</span><br>       DWORD m_ulSrcIP; <span class="hljs-comment">//æºIPåœ°å€</span><br>       DWORD m_ulDestIP; <span class="hljs-comment">//ç›®çš„IPåœ°å€</span><br>&#125;IPHeader;<br> <br><span class="hljs-comment">/* IPv4 é¦–éƒ¨ */</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">IPHeader2</span></span><br><span class="hljs-class">&#123;</span><br>       BYTE m_byVerHLen;     <span class="hljs-comment">//4ä½ç‰ˆæœ¬+4ä½é¦–éƒ¨é•¿åº¦</span><br>       BYTE m_byTOS;                    <span class="hljs-comment">//æœåŠ¡ç±»å‹</span><br>       USHORT m_usTotalLen; <span class="hljs-comment">//æ€»é•¿åº¦</span><br>       USHORT m_usID; <span class="hljs-comment">//æ ‡è¯†</span><br>       USHORT m_usFlagFragOffset; <span class="hljs-comment">//3ä½æ ‡å¿—+13ä½ç‰‡åç§»</span><br>       BYTE m_byTTL; <span class="hljs-comment">//TTL</span><br>       BYTE m_byProtocol; <span class="hljs-comment">//åè®®</span><br>       USHORT m_usHChecksum; <span class="hljs-comment">//é¦–éƒ¨æ£€éªŒå’Œ</span><br>       IPAddress m_ulSrcIP; <span class="hljs-comment">//æºIPåœ°å€</span><br>       IPAddress m_ulDestIP; <span class="hljs-comment">//ç›®çš„IPåœ°å€</span><br>&#125;IPHeader2;<br> <br><span class="hljs-comment">/* UDP é¦–éƒ¨*/</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">UDPHeader</span></span><br><span class="hljs-class">&#123;</span><br>       USHORT src_port;          <span class="hljs-comment">// æºç«¯å£(Source port) </span><br>       USHORT dest_port;          <span class="hljs-comment">// ç›®çš„ç«¯å£(Destination port) </span><br>       USHORT datalen;            <span class="hljs-comment">// UDPæ•°æ®åŒ…é•¿åº¦(Datagram length) </span><br>       USHORT checksum;            <span class="hljs-comment">// æ ¡éªŒå’Œ(Checksum) </span><br>&#125; UDPHeader;<br> <br><span class="hljs-comment">//ICMPå¤´ä¿¡æ¯</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ICMPHeader</span></span><br><span class="hljs-class">&#123;</span><br>       BYTE m_byType; <span class="hljs-comment">//ç±»å‹</span><br>       BYTE m_byCode; <span class="hljs-comment">//ä»£ç </span><br>       USHORT m_usChecksum; <span class="hljs-comment">//æ£€éªŒå’Œ</span><br>       USHORT m_usID; <span class="hljs-comment">//æ ‡è¯†ç¬¦</span><br>       USHORT m_usSeq; <span class="hljs-comment">//åºå·</span><br>       ULONG m_ulTimeStamp; <span class="hljs-comment">//æ—¶é—´æˆ³ï¼ˆéæ ‡å‡†ICMPå¤´éƒ¨ï¼‰</span><br>&#125;;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>       <span class="hljs-comment">//é€‚é…å™¨çš„è¯¦ç»†ä¿¡æ¯</span><br>       <span class="hljs-keyword">pcap_if_t</span> *alldevs;<br>       <span class="hljs-keyword">pcap_if_t</span> *d;<br> <br>       <span class="hljs-keyword">char</span> errorbuff[PCAP_ERRBUF_SIZE];<br>       <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Winpcap lib version:\n%s \n&quot;</span>, <span class="hljs-built_in">pcap_lib_version</span>());<br>       <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pcap_findalldevs</span>( &amp;alldevs, errorbuff) == PCAP_ERROR)<br>       &#123;<br>              <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;error..&quot;</span>);<br>       &#125;<br> <br>       <span class="hljs-keyword">int</span> index = <span class="hljs-number">0</span>;<br>       <span class="hljs-keyword">char</span> Name[<span class="hljs-number">256</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>       <span class="hljs-comment">//è¿‡æ»¤æ—¶ç”¨çš„å­ç½‘æ©ç  </span><br>       u_int ulNetMask;<br>       <span class="hljs-keyword">for</span> (d=alldevs ;d!=<span class="hljs-literal">NULL</span>;d=d-&gt;next)<br>       &#123;<br> <br>              <span class="hljs-keyword">if</span> (index==<span class="hljs-number">1</span>)<br>              &#123;<br>                     <span class="hljs-keyword">for</span> (<span class="hljs-keyword">pcap_addr_t</span> *tmp = d-&gt;addresses, *t = <span class="hljs-literal">NULL</span>;tmp != t;tmp = tmp-&gt;next)<br>                     &#123;<br>                            <span class="hljs-comment">//æ©ç </span><br>                            ulNetMask = ((sockaddr_in*)(tmp-&gt;netmask))-&gt;sin_addr.S_un.S_addr;<br>                            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;NetMask: %s\n&quot;</span>, <span class="hljs-built_in">inet_ntoa</span>(((sockaddr_in*)(tmp-&gt;netmask))-&gt;sin_addr));<br>                            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, ulNetMask);<br>                     &#125;<br> <br>                     <span class="hljs-built_in">strcpy</span>(Name, d-&gt;name);<br>              &#125;<br>              <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;description:%s\n&quot;</span>, d-&gt;description);<br>              <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;name:%s\n&quot;</span>, d-&gt;name);<br> <br>                    <br>              <span class="hljs-comment">/*</span><br><span class="hljs-comment">                     pcap_addr *  next     æŒ‡å‘ä¸‹ä¸€ä¸ªåœ°å€çš„æŒ‡é’ˆ</span><br><span class="hljs-comment">                     sockaddr *  addr       IPåœ°å€</span><br><span class="hljs-comment">                     sockaddr *  netmask  å­ç½‘æ©ç </span><br><span class="hljs-comment">                     sockaddr *  broadaddr   å¹¿æ’­åœ°å€</span><br><span class="hljs-comment">                     sockaddr *  dstaddr        ç›®çš„åœ°å€             </span><br><span class="hljs-comment">              */</span><br> <br>              <span class="hljs-comment">//è·å– ip åœ°å€</span><br>              <span class="hljs-keyword">for</span> (<span class="hljs-keyword">pcap_addr_t</span> *tmp = d-&gt;addresses, *t=<span class="hljs-literal">NULL</span>;tmp != t;tmp = tmp-&gt;next)<br>              &#123;<br>                     <span class="hljs-keyword">if</span> (tmp-&gt;addr-&gt;sa_family == AF_INET)<br>                     &#123;<br>                            <span class="hljs-keyword">if</span> (tmp-&gt;addr)<br>                            &#123;<br>                                   <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;address:%s\n&quot;</span>, <span class="hljs-built_in">inet_ntoa</span>(((sockaddr_in*)tmp-&gt;addr)-&gt;sin_addr));<br>                            &#125;<br>                     &#125;<br>              &#125;<br> <br>              <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n&quot;</span>);<br>              index++;<br> <br>       &#125;<br> <br>       <span class="hljs-keyword">pcap_t</span> *adHande = <span class="hljs-built_in">pcap_open</span>(Name,<br>              <span class="hljs-number">65536</span>,<br>              PCAP_OPENFLAG_PROMISCUOUS,<span class="hljs-comment">// æ··æ‚æ¨¡å¼</span><br>              <span class="hljs-number">1000</span>, <span class="hljs-literal">NULL</span>,<br>              errorbuff);<br> <br>       <span class="hljs-keyword">if</span> (adHande!=<span class="hljs-literal">NULL</span>)<br>       &#123;<br>              <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pcap_datalink</span>(adHande)==DLT_IEEE802)<br>              &#123;<br>                     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;DLT_IEEE802\n&quot;</span>);<br>              &#125;<br> <br>              <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pcap_datalink</span>(adHande) == DLT_EN10MB)<br>              &#123;<br>                     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;DLT_EN10MB\n&quot;</span>);<br>              &#125;<br>              <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pcap_datalink</span>(adHande) != DLT_EN10MB)<br>              &#123;<br>                     <span class="hljs-built_in">pcap_freealldevs</span>(alldevs);<br>              &#125;     <br>              <span class="hljs-comment">/* ä¸ç”¨å…³å¿ƒæ©ç ï¼Œåœ¨è¿™ä¸ªè¿‡æ»¤å™¨ä¸­ï¼Œå®ƒä¸ä¼šè¢«ä½¿ç”¨ */</span><br>              ulNetMask = <span class="hljs-number">0xffffffff</span>;<br>              bpf_program bpf_pro = &#123; <span class="hljs-number">0</span> &#125;;<br>              <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pcap_compile</span>(adHande, &amp;bpf_pro, <span class="hljs-string">&quot;tcp or ip or icmp  or arp&quot;</span>, <span class="hljs-number">1</span>, ulNetMask) &lt; <span class="hljs-number">0</span>)<br>              &#123;<br>                     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;-----------&gt;error:pcap_compile\n&quot;</span>);<br>                     <span class="hljs-built_in">pcap_freealldevs</span>(alldevs);<br>                     <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>              &#125;<br>              <span class="hljs-comment">//è®¾ç½®è¿‡æ»¤æ¡ä»¶</span><br>              <span class="hljs-keyword">if</span> (<span class="hljs-built_in">pcap_setfilter</span>(adHande, &amp;bpf_pro) &lt; <span class="hljs-number">0</span>)<br>              &#123;<br>                     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;-----------&gt;error:pcap_setfilter\n&quot;</span>);<br>                     <span class="hljs-built_in">pcap_freealldevs</span>(alldevs);<br>                     <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> <br>              &#125;<br> <br>      <br>              <span class="hljs-comment">//å¼€å§‹å¤„ç†å‡½æ•°</span><br>              <span class="hljs-built_in">pcap_loop</span>(adHande, <span class="hljs-number">0</span>, packet_handler, <span class="hljs-literal">NULL</span>);<br>             <br>              <span class="hljs-built_in">pcap_freealldevs</span>(alldevs);<br> <br>              <span class="hljs-comment">//é‡Šæ”¾ä¸€ä¸ªè¿‡æ»¤å™¨</span><br>              <span class="hljs-built_in">pcap_freecode</span>(&amp;bpf_pro);ã€‚<br> <br>              <span class="hljs-built_in">pcap_close</span>(adHande);<br>       &#125;<br>       <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br> <br><span class="hljs-comment">//å¼€å§‹å¤„ç†è·å–çš„æ•°æ®åŒ…</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">packet_handler</span><span class="hljs-params">(u_char *param, <span class="hljs-keyword">const</span> struct pcap_pkthdr *header, <span class="hljs-keyword">const</span> u_char *pkt_data)</span></span><br><span class="hljs-function"></span>&#123;<br>       <span class="hljs-comment">//æ‰“å°MACåœ°å€</span><br>       <span class="hljs-keyword">int</span> j;<br>       EthernetHeader *ethernet = (EthernetHeader*)pkt_data;<br>       <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Source MAC:&quot;</span>);<br>       <span class="hljs-keyword">for</span> (j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">6</span>;j++)<br>       &#123;<br>              <span class="hljs-keyword">if</span> (j==<span class="hljs-number">5</span>)<br>                     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%2x&quot;</span>, ethernet-&gt;bySrcMac[j]);<br>              <span class="hljs-keyword">else</span>      <br>                     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%2x:&quot;</span>, ethernet-&gt;bySrcMac[j]);<br>       &#125;<br>       <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\t&quot;</span>);<br> <br>       <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Dest MAC:&quot;</span>);<br>       <span class="hljs-keyword">for</span> (j = <span class="hljs-number">0</span>;j &lt; <span class="hljs-number">6</span>;j++)<br>       &#123;<br>              <span class="hljs-keyword">if</span> (j == <span class="hljs-number">5</span>)<br>                     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%2x&quot;</span>, ethernet-&gt;byDestMac[j]);<br>              <span class="hljs-keyword">else</span><br>                     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%2x:&quot;</span>, ethernet-&gt;byDestMac[j]);<br>       &#125;<br>       <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br> <br> <br> <br>       <span class="hljs-comment">// ä» IPå±‚å¼€å§‹è¯»å–æ•°æ®ï¼ï¼åç§» 14å­—èŠ‚</span><br>       <span class="hljs-comment">//14ä¸ºä»¥å¤ªç½‘å¸§å¤´éƒ¨é•¿åº¦</span><br>      <br>       <span class="hljs-comment">//è·å–åŸå§‹çš„IPå±‚åè®®</span><br>       IPHeader2* iphdr = (IPHeader2*)(pkt_data + <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(EthernetHeader));<br>       IPHeader* iphdr0 = (IPHeader*)(pkt_data + <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(EthernetHeader));<br>      <br> <br>       <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d.%d.%d.%d\t%d.%d.%d.%d\n&quot;</span>,<br>              iphdr-&gt;m_ulSrcIP.byte1, iphdr-&gt;m_ulSrcIP.byte2,<br>              iphdr-&gt;m_ulSrcIP.byte3, iphdr-&gt;m_ulSrcIP.byte4,<br>              iphdr-&gt;m_ulDestIP.byte1, iphdr-&gt;m_ulDestIP.byte2,<br>              iphdr-&gt;m_ulDestIP.byte3, iphdr-&gt;m_ulDestIP.byte4<br>       );<br>      <br>       <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d.%05d\tlen:%d\n&quot;</span>,header-&gt;ts.tv_sec, header-&gt;ts.tv_usec, header-&gt;len);<br> <br>       <span class="hljs-comment">//icmp</span><br>       <span class="hljs-keyword">if</span> (iphdr-&gt;m_byProtocol==IPPROTO_ICMP)<br>       &#123;<br>              ICMPHeader*icmphdr = (ICMPHeader*)(pkt_data + <span class="hljs-number">14</span> + <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(IPHeader));<br> <br>              <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Type:%d\t%d\n&quot;</span>, icmphdr-&gt;m_byType, icmphdr-&gt;m_ulTimeStamp);<br> <br>              <span class="hljs-keyword">char</span> data[<span class="hljs-number">100</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>              <span class="hljs-built_in">memcpy</span>(data, ((<span class="hljs-keyword">char</span>*)icmphdr) + <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(ICMPHeader), <span class="hljs-number">50</span>);<br>              data[<span class="hljs-built_in">strlen</span>(data) - <span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>              <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Data:%s\n&quot;</span>, data);<br> <br>       &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Qtå®ç°è´ªåƒè›‡2:é“¾è¡¨å®ç°</title>
    <link href="/cpp-snake2/"/>
    <url>/cpp-snake2/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h3><p>å‰é¢å·²ç»ä»‹ç»äº†ç”¨æ•°ç»„å®ç°è´ªåƒè›‡ï¼Œæœ‰äº†å‰é¢çš„åŸºç¡€çŸ¥è¯†ï¼Œæ‰€ä»¥æˆ‘å°±å¼€é—¨è§å±±äº†ã€‚</p><span id="more"></span><h3 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h3><p>æ­¤æ–‡æ˜¯åœ¨å‰é¢çš„æ•°ç»„å®ç°åŸºç¡€ä¸ŠåŠ ä»¥æ”¹è¿›çš„ï¼Œæ‰€ä»¥è¯´å¤§éƒ¨åˆ†è¿˜æ˜¯å¾ˆç›¸ä¼¼çš„ã€‚ä¸è¿‡é“¾è¡¨è¿˜æ˜¯å’Œæ•°ç»„æœ‰ä¸€å®šçš„åŒºåˆ«çš„ï¼Œæ‰€ä»¥åœ¨çœ‹æ­¤æ–‡ä¹‹å‰ï¼Œè¦æœ‰ä¸€äº›å…³äºcé“¾è¡¨çš„çš„çŸ¥è¯†â€¦è€Œä¸”å¯¹äºæ–°æ‰‹æ¥è®²è¿˜æ˜¯æœ‰ä¸€å®šéš¾åº¦çš„ã€‚ã€‚ã€‚é‚£ä¹ˆå¼€å§‹å§</p><ul><li>é¦–å…ˆï¼Œæˆ‘å…ˆåˆ›å»ºä¸€ä¸ªé“¾è¡¨ç±»ï¼ˆä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½Qtè‡ªå¸¦çš„ <code>QLinkedList</code> ï¼Œå› ä¸ºç”¨ä¸ä¹ æƒ¯ï¼š(</li></ul><p><strong>linkedlist.h</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> LINKEDLIST_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> LINKEDLIST_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span></span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Linkedlist</span>:</span>QObject<br>&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">//è›‡èŠ‚ç‚¹</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SnakeNode</span>&#123;</span><br>        QPoint pos;<br>        SnakeNode* next;<br>        SnakeNode* prev;<br>    &#125;;<br>    <span class="hljs-built_in">Linkedlist</span>(QObject *parent=<span class="hljs-number">0</span>,QPoint headPos=<span class="hljs-built_in">QPoint</span>()):<br>        <span class="hljs-built_in">QObject</span>(parent),<span class="hljs-built_in">m_length</span>(<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-comment">//åˆå§‹åŒ–é“¾è¡¨å¤´ï¼Œå³è›‡å¤´</span><br>            m_head=<span class="hljs-keyword">new</span> SnakeNode;<br>            m_head-&gt;pos=headPos;<br>            m_head-&gt;next=<span class="hljs-literal">NULL</span>;<br>            m_head-&gt;prev=<span class="hljs-literal">NULL</span>;<br>    &#125;<br>    ~<span class="hljs-built_in">Linkedlist</span>()&#123;<br>            <span class="hljs-built_in">clearAllNodes</span>();<br>    &#125;<br>    <span class="hljs-comment">//è¿”å›å¤´èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">inline</span> SnakeNode *<span class="hljs-title">first</span><span class="hljs-params">()</span><span class="hljs-keyword">const</span></span>&#123;<span class="hljs-keyword">if</span>(m_head)&#123;<span class="hljs-keyword">return</span> m_head;&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;&#125;<br>    <span class="hljs-comment">//è¿”å›å°¾èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">inline</span> SnakeNode *<span class="hljs-title">last</span><span class="hljs-params">()</span><span class="hljs-keyword">const</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(m_head)&#123;<br>            SnakeNode *p1=m_head;<br>            SnakeNode *p2;<br>            <span class="hljs-keyword">do</span> &#123;<br>                p2=p1;<br>                p1=p1-&gt;next;<br>            &#125; <span class="hljs-keyword">while</span> (p1);<br>            <span class="hljs-keyword">return</span> p2;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//è¿”å›èŠ‚ç‚¹æ€»æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getLength</span><span class="hljs-params">()</span></span>&#123;<br>         m_length=<span class="hljs-number">0</span>;<br>         <span class="hljs-keyword">if</span>(m_head)&#123;<br>             SnakeNode *p=m_head;<br>             <span class="hljs-keyword">do</span> &#123;<br>                 m_length+=<span class="hljs-number">1</span>;<br>                 p=p-&gt;next;<br>             &#125; <span class="hljs-keyword">while</span> (p!=<span class="hljs-literal">NULL</span>);<br>         &#125;<br>         <span class="hljs-keyword">return</span> m_length;<br>    &#125;<br>    <span class="hljs-comment">//æ‰“å°æ‰€ä»¥èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">printLinkedlist</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(m_head )&#123;<br>            SnakeNode *p=m_head;<br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-built_in">qDebug</span>()&lt;pos;<br>                p=p-&gt;next;<br>            &#125; <span class="hljs-keyword">while</span> (p);<br>            <span class="hljs-built_in">qDebug</span>()&lt;<span class="hljs-built_in">last</span>())&#123;<br>          SnakeNode *ls=<span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">last</span>();<br>          <span class="hljs-keyword">if</span>(ls)&#123;<br>              SnakeNode *p2=<span class="hljs-keyword">new</span> SnakeNode;<br>              p2-&gt;prev=ls;<br>              p2-&gt;next=<span class="hljs-literal">NULL</span>;<br>              p2-&gt;pos=pos;<br><br>              ls-&gt;next=p2;<br>          &#125;<br>      &#125;<br>    &#125;<br>    <span class="hljs-comment">//é‡Šæ”¾æ‰€æœ‰èŠ‚ç‚¹</span><br>    <span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">clearAllNodes</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">if</span>(m_head)&#123;<br>            SnakeNode *p=m_head;<br>            <span class="hljs-keyword">do</span> &#123;<br>                SnakeNode*t=p;<br>                m_head=p-&gt;next;<br>                <span class="hljs-keyword">delete</span> t;<br>                t=<span class="hljs-literal">NULL</span>;<br>                p=m_head;<br>            &#125; <span class="hljs-keyword">while</span> (p);<br>        &#125;<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-keyword">int</span> m_length;<br>    SnakeNode *m_head;<br>&#125;;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">// LINKEDLIST_H</span></span><br><br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œå°±ä¸å¤šè¯´äº†ã€‚ã€‚ã€‚ä¸è¿‡è¦æ³¨æ„è¿™é‡Œçš„</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//è›‡èŠ‚ç‚¹</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">SnakeNode</span>&#123;</span><br>    QPoint pos;<br>    SnakeNode* next;<br>    SnakeNode* prev;<br>&#125;;<br></code></pre></div></td></tr></table></figure><p>åŸæœ¬æ˜¯æ²¡æœ‰ <code>SnakeNode* prev;</code> çš„ï¼Œåæ¥åœ¨å†™ä»£ç æ—¶é‡åˆ°ç‚¹æ£˜æ‰‹çš„é—®é¢˜ï¼Œæ‰€ä»¥å°±è¯¥äº†ä¸€ä¸‹ï¼Œå˜æˆåŒå‘é“¾è¡¨ã€‚ä¸è¿‡è¿™é‡Œæ²¡æœ‰å¤ªåœ¨æ„è¿™äº›ï¼Œè€Œä¸”å…³äºé“¾è¡¨çš„æ“ä½œä¹Ÿå¾ˆå°‘</p><p><strong>widget.h</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> WIDGET_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WIDGET_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;QWidget&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QLinkedList&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QTimer&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QKeyEvent&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&quot;linkedlist.h&quot;</span></span><br><span class="hljs-keyword">namespace</span> Ui &#123;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Widget</span>;</span><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">QLineEdit</span>;</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Widget</span> :</span> <span class="hljs-keyword">public</span> QWidget<br>&#123;<br>    Q_OBJECT<br><span class="hljs-keyword">protected</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">keyPressEvent</span><span class="hljs-params">(QKeyEvent *event)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">paintEvent</span><span class="hljs-params">(QPaintEvent *event)</span></span>;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">//è›‡å¤´ç§»åŠ¨æ–¹å‘</span><br>    <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">SnakeDirection</span>:</span><span class="hljs-keyword">int</span>&#123;<br>        Up,<br>        Down,<br>        Left,<br>        Right<br>    &#125;;<br>    <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">Widget</span><span class="hljs-params">(QWidget *parent = <span class="hljs-number">0</span>)</span></span>;<br>    ~<span class="hljs-built_in">Widget</span>();<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">initializedGUI</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">resetFoodPos</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">checkisEatSelf</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">checkisEatFood</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">checkisHitWall</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">checkFoodPosisEqualHeadPos</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">snakeRunning</span><span class="hljs-params">()</span></span>;<br><span class="hljs-keyword">public</span> slots:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">timeOut</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">startGame</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">stopGame</span><span class="hljs-params">()</span></span>;<br><span class="hljs-keyword">private</span>:<br>    Linkedlist *linkedlist;  <span class="hljs-comment">//è›‡é“¾è¡¨</span><br>    <span class="hljs-keyword">int</span> m_eatfoodCount; <span class="hljs-comment">//åƒåˆ°é£Ÿç‰©æ€»æ•°</span><br>    QPoint m_foodPos;<span class="hljs-comment">//é£Ÿç‰©åæ ‡</span><br>    <span class="hljs-keyword">int</span> m_direction;<span class="hljs-comment">//è›‡å¤´æ–¹å‘</span><br>    <span class="hljs-keyword">int</span> m_speed;<span class="hljs-comment">//è›‡ç§»åŠ¨é€Ÿåº¦</span><br>    <span class="hljs-keyword">int</span> m_score ;<span class="hljs-comment">//å¾—åˆ†</span><br>    QPoint m_tmpPosPrev;<br>    QTimer *m_timerControl;<br>    QLineEdit *leScore;<br>    Ui::Widget *ui;<br>&#125;;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">// WIDGET_H</span></span><br></code></pre></div></td></tr></table></figure><p><strong>widget.cpp</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;widget.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;ui_widget.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QVBoxLayout&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QPushButton&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QLabel&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QLineEdit&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QPainter&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QTime&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QDebug&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QMessageBox&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ROW 20 <span class="hljs-comment">//è¡Œæ•°</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> COLUMN 20 <span class="hljs-comment">//åˆ—æ•°</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> Direction 4 <span class="hljs-comment">//æ–¹å‘(æšä¸¾å€¼</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::keyPressEvent</span><span class="hljs-params">(QKeyEvent *event)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(event-&gt;<span class="hljs-built_in">key</span>()==<span class="hljs-string">&#x27;W&#x27;</span>&amp;&amp;m_direction!=Down)&#123;<br>        m_direction=Up;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(event-&gt;<span class="hljs-built_in">key</span>()==<span class="hljs-string">&#x27;S&#x27;</span>&amp;&amp;m_direction!=Up)&#123;<br>        m_direction=Down;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(event-&gt;<span class="hljs-built_in">key</span>()==<span class="hljs-string">&#x27;A&#x27;</span>&amp;&amp;m_direction!=Right)&#123;<br>        m_direction=Left;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(event-&gt;<span class="hljs-built_in">key</span>()==<span class="hljs-string">&#x27;D&#x27;</span>&amp;&amp;m_direction!=Left)&#123;<br>        m_direction=Right;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::paintEvent</span><span class="hljs-params">(QPaintEvent *event)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">Q_UNUSED</span>(event);<br>    QPen pen;<br>    pen.<span class="hljs-built_in">setColor</span>(<span class="hljs-built_in">QColor</span>(Qt::darkGray));<br>    QFont font;<br>    font.<span class="hljs-built_in">setPointSize</span>(<span class="hljs-number">6</span>);<br>    <span class="hljs-function">QPainter <span class="hljs-title">p</span><span class="hljs-params">(<span class="hljs-keyword">this</span>)</span></span>;<br>    p.<span class="hljs-built_in">drawPixmap</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-built_in">width</span>(),<span class="hljs-built_in">height</span>(),<span class="hljs-built_in">QPixmap</span>(<span class="hljs-string">&quot;:/img/imgs/bg.jpg&quot;</span>));<br>    p.<span class="hljs-built_in">setPen</span>(pen);<br>    p.<span class="hljs-built_in">setFont</span>(font);<br>    <span class="hljs-comment">//ç»˜åˆ¶æ¸¸æˆå¸ƒå±€</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> row = <span class="hljs-number">0</span>; row &lt; ROW; ++row) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> column =<span class="hljs-number">0</span>; column &lt; COLUMN; ++column) &#123;<br>            p.<span class="hljs-built_in">fillRect</span>(row*<span class="hljs-number">20</span>,column*<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<span class="hljs-built_in">QBrush</span>(<span class="hljs-built_in">QColor</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">10</span>)));<br>            p.<span class="hljs-built_in">drawRect</span>(row*<span class="hljs-number">20</span>,column*<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<span class="hljs-number">20</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//ç»˜åˆ¶é£Ÿç‰©</span><br>    p.<span class="hljs-built_in">fillRect</span>(m_foodPos.<span class="hljs-built_in">x</span>()*<span class="hljs-number">20</span>,m_foodPos.<span class="hljs-built_in">y</span>()*<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<br>               <span class="hljs-built_in">QBrush</span>(<span class="hljs-built_in">QPixmap</span>(<span class="hljs-string">&quot;:/img/imgs/apple.png&quot;</span>).<span class="hljs-built_in">scaled</span>(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>)));<br>    <span class="hljs-comment">//ç»˜åˆ¶è›‡</span><br>    <span class="hljs-keyword">if</span>(linkedlist-&gt;<span class="hljs-built_in">first</span>())&#123;<br>       Linkedlist:: SnakeNode *pt=linkedlist-&gt;<span class="hljs-built_in">first</span>();<br>        <span class="hljs-keyword">do</span>&#123;<br>           <span class="hljs-keyword">if</span>(linkedlist-&gt;<span class="hljs-built_in">first</span>()==pt)&#123;<span class="hljs-comment">//ç»˜åˆ¶è›‡å¤´</span><br>               QPixmap pixmap;<br>               <span class="hljs-built_in"><span class="hljs-keyword">switch</span></span> (m_direction) &#123;<br>               <span class="hljs-keyword">case</span> Up:<br>                   pixmap=<span class="hljs-built_in">QPixmap</span>(<span class="hljs-string">&quot;:/img/imgs/up.png&quot;</span>).<span class="hljs-built_in">scaled</span>(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>);<br>                   <span class="hljs-keyword">break</span>;<br>               <span class="hljs-keyword">case</span> Down:<br>                   pixmap=<span class="hljs-built_in">QPixmap</span>(<span class="hljs-string">&quot;:/img/imgs/down.png&quot;</span>).<span class="hljs-built_in">scaled</span>(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>);<br>                   <span class="hljs-keyword">break</span>;<br>               <span class="hljs-keyword">case</span> Left:<br>                   pixmap=<span class="hljs-built_in">QPixmap</span>(<span class="hljs-string">&quot;:/img/imgs/left.png&quot;</span>).<span class="hljs-built_in">scaled</span>(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>);<br>                   <span class="hljs-keyword">break</span>;<br>               <span class="hljs-keyword">case</span> Right:<br>                   pixmap=<span class="hljs-built_in">QPixmap</span>(<span class="hljs-string">&quot;:/img/imgs/right.png&quot;</span>).<span class="hljs-built_in">scaled</span>(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>);<br>                   <span class="hljs-keyword">break</span>;<br>               <span class="hljs-keyword">default</span>:<br>                   <span class="hljs-keyword">break</span>;<br>               &#125;<br>               p.<span class="hljs-built_in">fillRect</span>(pt-&gt;pos.<span class="hljs-built_in">x</span>()*<span class="hljs-number">20</span>,<br>                          pt-&gt;pos.<span class="hljs-built_in">y</span>()*<span class="hljs-number">20</span>,<br>                          <span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<br>                          <span class="hljs-built_in">QBrush</span>(pixmap));<br>           &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(linkedlist-&gt;<span class="hljs-built_in">last</span>()==pt)&#123; <span class="hljs-comment">//ç»˜åˆ¶è›‡å°¾</span><br>               QPixmap pixmap;<br>               pixmap=<span class="hljs-built_in">QPixmap</span>(<span class="hljs-string">&quot;:/img/imgs/tail.png&quot;</span>).<span class="hljs-built_in">scaled</span>(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>);<br>               p.<span class="hljs-built_in">fillRect</span>(pt-&gt;pos.<span class="hljs-built_in">x</span>()*<span class="hljs-number">20</span>,<br>                          pt-&gt;pos.<span class="hljs-built_in">y</span>()*<span class="hljs-number">20</span>,<br>                          <span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<br>                          <span class="hljs-built_in">QBrush</span>(pixmap));<br>           &#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-comment">//ç»˜åˆ¶è›‡çš„å…¶ä»–ä½ç½®</span><br>               QPixmap pixmap;<br>               pixmap=<span class="hljs-built_in">QPixmap</span>(<span class="hljs-string">&quot;:/img/imgs/body.png&quot;</span>).<span class="hljs-built_in">scaled</span>(<span class="hljs-number">20</span>,<span class="hljs-number">20</span>);<br>               p.<span class="hljs-built_in">fillRect</span>(pt-&gt;pos.<span class="hljs-built_in">x</span>()*<span class="hljs-number">20</span>,<br>                          pt-&gt;pos.<span class="hljs-built_in">y</span>()*<span class="hljs-number">20</span>,<br>                          <span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<br>                          <span class="hljs-built_in">QBrush</span>(pixmap));<br>           &#125;<br>           <span class="hljs-comment">//æŒ‡å‘ä¸‹ä¸€ä¸ªè›‡èº«èŠ‚ç‚¹</span><br>            pt=pt-&gt;next;<br>        &#125;<span class="hljs-keyword">while</span>(pt!=<span class="hljs-literal">NULL</span>);<br>    &#125;<br>&#125;<br>Widget::<span class="hljs-built_in">Widget</span>(QWidget *parent) :<br>    <span class="hljs-built_in">QWidget</span>(parent),<br>    <span class="hljs-built_in">ui</span>(<span class="hljs-keyword">new</span> Ui::Widget)<br>&#123;<br>    ui-&gt;<span class="hljs-built_in">setupUi</span>(<span class="hljs-keyword">this</span>);<br>    <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">setFixedSize</span>(<span class="hljs-number">800</span>,<span class="hljs-number">450</span>);<br>    <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">setWindowTitle</span>(<span class="hljs-string">&quot;è´ªåƒè›‡&quot;</span>);<br>    <span class="hljs-built_in">initializedGUI</span>();<br>&#125;<br>Widget::~<span class="hljs-built_in">Widget</span>()<br>&#123;<br>    <span class="hljs-keyword">delete</span> ui;<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Widget::initializedGUI</span><br><span class="hljs-comment">/// åˆå§‹åŒ–</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::initializedGUI</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    m_score=<span class="hljs-number">0</span>;<br>    QPushButton *btnStart=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QPushButton</span>(<span class="hljs-keyword">this</span>);<br>    QPushButton *btnStop=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QPushButton</span>(<span class="hljs-keyword">this</span>);<br>    QLabel *lbScore=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-keyword">this</span>);<br>    leScore=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLineEdit</span>(<span class="hljs-keyword">this</span>);<br>    btnStart-&gt;<span class="hljs-built_in">setText</span>(QObject::<span class="hljs-built_in">tr</span>(<span class="hljs-string">&quot;å¼€å§‹æ¸¸æˆ&quot;</span>));<br>    btnStop-&gt;<span class="hljs-built_in">setText</span>(QObject::<span class="hljs-built_in">tr</span>(<span class="hljs-string">&quot;æš‚åœæ¸¸æˆ&quot;</span>));<br>    btnStart-&gt;<span class="hljs-built_in">setFlat</span>(<span class="hljs-literal">true</span>);<br>    btnStop-&gt;<span class="hljs-built_in">setFlat</span>(<span class="hljs-literal">true</span>);<br>    lbScore-&gt;<span class="hljs-built_in">setText</span>(<span class="hljs-built_in">tr</span>(<span class="hljs-string">&quot;å¾—åˆ†:&quot;</span>));<br>    leScore-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(m_score));<br>    leScore-&gt;<span class="hljs-built_in">setFocusPolicy</span>(Qt::NoFocus);<br>    leScore-&gt;<span class="hljs-built_in">setEnabled</span>(<span class="hljs-literal">false</span>);<br>    lbScore-&gt;<span class="hljs-built_in">move</span>(<span class="hljs-number">500</span>,<span class="hljs-number">50</span>);<br>    leScore-&gt;<span class="hljs-built_in">move</span>(<span class="hljs-number">560</span>,<span class="hljs-number">50</span>);<br>    btnStart-&gt;<span class="hljs-built_in">move</span>(<span class="hljs-number">500</span>,<span class="hljs-number">100</span>);<br>    btnStop-&gt;<span class="hljs-built_in">move</span>(<span class="hljs-number">500</span>,<span class="hljs-number">150</span>);<br>    <span class="hljs-built_in">connect</span>(btnStart,<span class="hljs-built_in">SIGNAL</span>(<span class="hljs-built_in">clicked</span>(<span class="hljs-keyword">bool</span>)),<span class="hljs-keyword">this</span>,<span class="hljs-built_in">SLOT</span>(<span class="hljs-built_in">startGame</span>()));<br>    <span class="hljs-built_in">connect</span>(btnStop,<span class="hljs-built_in">SIGNAL</span>(<span class="hljs-built_in">clicked</span>(<span class="hljs-keyword">bool</span>)),<span class="hljs-keyword">this</span>,<span class="hljs-built_in">SLOT</span>(<span class="hljs-built_in">stopGame</span>()));<br>    QTime t= QTime::<span class="hljs-built_in">currentTime</span>();<br>    <span class="hljs-keyword">int</span> s= t.<span class="hljs-built_in">secsTo</span>(<span class="hljs-built_in">QTime</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>));<br>    <span class="hljs-built_in">qsrand</span>(s);<span class="hljs-comment">//éšæœºæ•°</span><br>    m_direction=<span class="hljs-built_in">qrand</span>()%Direction;<br>    <span class="hljs-built_in"><span class="hljs-keyword">switch</span></span> (m_direction) &#123;<br>    <span class="hljs-keyword">case</span> Up:<span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;è›‡å¤´æ–¹å‘:ä¸Š&quot;</span>;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> Down:<span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;è›‡å¤´æ–¹å‘:ä¸‹&quot;</span>;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> Left:<span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;è›‡å¤´æ–¹å‘:å·¦&quot;</span>;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> Right:<span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;è›‡å¤´æ–¹å‘:å³&quot;</span>;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    m_foodPos.<span class="hljs-built_in">setX</span>(<span class="hljs-built_in">qrand</span>()%COLUMN);<br>    m_foodPos.<span class="hljs-built_in">setY</span>(<span class="hljs-built_in">qrand</span>()%ROW);<br>    <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;é£Ÿç‰©åæ ‡:&quot;</span>&lt;&lt;m_foodPos;<br>    m_speed=<span class="hljs-number">150</span>;<br>    m_timerControl=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QTimer</span>(<span class="hljs-keyword">this</span>);<br>    m_timerControl-&gt;<span class="hljs-built_in">setInterval</span>(m_speed);<br>    <span class="hljs-built_in">connect</span>(m_timerControl,<span class="hljs-built_in">SIGNAL</span>(<span class="hljs-built_in">timeout</span>()),<span class="hljs-keyword">this</span>,<span class="hljs-built_in">SLOT</span>(<span class="hljs-built_in">timeOut</span>()));<br>    QPoint pos;<br>    pos.<span class="hljs-built_in">setX</span>(<span class="hljs-built_in">qrand</span>()%COLUMN);<br>    pos.<span class="hljs-built_in">setY</span>(<span class="hljs-built_in">qrand</span>()%ROW);<br>    <span class="hljs-comment">//åœ¨Linkedlistæ„é€ æ—¶åˆå§‹åŒ–è›‡å¤´åæ ‡</span><br>    linkedlist=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Linkedlist</span>(<span class="hljs-keyword">this</span>,pos);<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Widget::resetFoodPos</span><br><span class="hljs-comment">/// é‡è®¾é£Ÿç‰©åæ ‡</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::resetFoodPos</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    m_foodPos.<span class="hljs-built_in">setX</span>(<span class="hljs-built_in">qrand</span>()%COLUMN);<br>    m_foodPos.<span class="hljs-built_in">setY</span>(<span class="hljs-built_in">qrand</span>()%ROW);<br>    <span class="hljs-built_in">checkFoodPosisEqualHeadPos</span>();<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Widget::checkisEatSelf</span><br><span class="hljs-comment">/// åˆ¤æ–­æ˜¯å¦åƒåˆ°è‡ªå·±</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::checkisEatSelf</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(linkedlist-&gt;<span class="hljs-built_in">first</span>())&#123;<br>        Linkedlist::SnakeNode *p0=linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;next;<br>        <span class="hljs-keyword">if</span>(p0)&#123;<br>        <span class="hljs-keyword">do</span> &#123;<br>            <span class="hljs-comment">//åˆ¤æ–­è›‡å¤´åæ ‡æ˜¯å¦ç­‰äºè›‡èº«æŸä¸ªèŠ‚ç‚¹åæ ‡</span><br>            <span class="hljs-keyword">if</span>(linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos==p0-&gt;pos)&#123;<br>                <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;åƒåˆ°è‡ªå·±!æ¸¸æˆç»“æŸ&quot;</span>;<br>                m_timerControl-&gt;<span class="hljs-built_in">stop</span>();<br>                QMessageBox::<span class="hljs-built_in">critical</span>(<span class="hljs-keyword">this</span>,<span class="hljs-string">&quot;game over&quot;</span>,<span class="hljs-string">&quot;game over&quot;</span>);<br>                <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">close</span>();<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            p0=p0-&gt;next;<br>        &#125; <span class="hljs-keyword">while</span> (p0);<br>    &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Widget::checkisEatFood</span><br><span class="hljs-comment">/// æ£€æµ‹æ˜¯å¦åƒåˆ°é£Ÿç‰©</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::checkisEatFood</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">x</span>()==m_foodPos.<span class="hljs-built_in">x</span>()&amp;&amp;<br>            linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">y</span>()==m_foodPos.<span class="hljs-built_in">y</span>())&#123;<br>        <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;åƒåˆ°é£Ÿç‰©ï¼&quot;</span>;<br>        m_eatfoodCount++;<br>        m_score+=<span class="hljs-number">20</span>;<br>        leScore-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(m_score)+<span class="hljs-string">&quot; åˆ†&quot;</span>);<br>        <span class="hljs-keyword">if</span>(m_score&gt;=<span class="hljs-number">100</span>)&#123;<br>            m_speed=<span class="hljs-number">80</span>;<br>            m_timerControl-&gt;<span class="hljs-built_in">setInterval</span>(m_speed);<br>        &#125;<br>        <span class="hljs-comment">//éšä¾¿è®¾ç½®çš„x y åæ ‡</span><br>        QPoint pos=<span class="hljs-built_in">QPoint</span>();<br>        linkedlist-&gt;<span class="hljs-built_in">append</span>(pos);<br>        <span class="hljs-comment">//é‡æ–°è®¾ç½®é£Ÿç‰©åæ ‡</span><br>        <span class="hljs-built_in">resetFoodPos</span>();<br>    &#125;<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Widget::checkisHitWall</span><br><span class="hljs-comment">/// æ£€æµ‹æ˜¯å¦æ’åˆ°å¢™</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::checkisHitWall</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">x</span>()&lt;<span class="hljs-number">0</span>||linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">y</span>()&lt;<span class="hljs-number">0</span>||<br>            linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">x</span>()&gt;COLUMN<span class="hljs-number">-1</span>||linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">y</span>()&gt;ROW<span class="hljs-number">-1</span>)&#123;<br>        m_timerControl-&gt;<span class="hljs-built_in">stop</span>();<br>        <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;æ’åˆ°å¢™å£ï¼æ¸¸æˆç»“æŸï¼&quot;</span>;<br>        QMessageBox::<span class="hljs-built_in">critical</span>(<span class="hljs-keyword">this</span>,<span class="hljs-string">&quot;game over&quot;</span>,<span class="hljs-string">&quot;game over!&quot;</span>);<br>        <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">close</span>();<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::timeOut</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">checkisEatFood</span>();<br>    <span class="hljs-comment">//æ‰“å°å‡ºè›‡èº«èŠ‚ç‚¹åæ ‡</span><br>    linkedlist-&gt;<span class="hljs-built_in">printLinkedlist</span>();<br>    <span class="hljs-comment">//è›‡èº«ç§»åŠ¨</span><br>    <span class="hljs-keyword">if</span>(linkedlist-&gt;<span class="hljs-built_in">first</span>())&#123;<br>        Linkedlist::SnakeNode *p0=linkedlist-&gt;<span class="hljs-built_in">last</span>();<br>        <span class="hljs-keyword">if</span>(linkedlist-&gt;<span class="hljs-built_in">getLength</span>()!=<span class="hljs-number">1</span>&amp;&amp;p0)&#123;<br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-comment">//æŠŠå‰ä¸€ä¸ªèŠ‚ç‚¹çš„åæ ‡èµ‹å€¼ç»™å½“å‰èŠ‚ç‚¹ ï¼Œå³è›‡å‘å‰ç§»åŠ¨ä¸€æ ¼</span><br>                p0-&gt;pos=p0-&gt;prev-&gt;pos;<br>                <span class="hljs-comment">//æŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹</span><br>                p0=p0-&gt;prev;<br>                <span class="hljs-comment">//å› ä¸º å¤´ç»“ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ä¸ºNULL</span><br>                <span class="hljs-comment">//æ‰€ä»¥è¿™é‡Œå¿…é¡» p0!= linkedlist-&gt;first()</span><br>            &#125; <span class="hljs-keyword">while</span> (p0!=linkedlist-&gt;<span class="hljs-built_in">first</span>());<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//è›‡è¿åŠ¨</span><br>    <span class="hljs-built_in">snakeRunning</span>();<br>    <span class="hljs-built_in">checkisHitWall</span>();<br>    <span class="hljs-built_in">checkisEatSelf</span>();<br>    <span class="hljs-comment">//æ›´æ–°ç»˜å›¾</span><br>    <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">update</span>();<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Widget::startGame</span><br><span class="hljs-comment">/// å¼€å§‹æ¸¸æˆ</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::startGame</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    m_timerControl-&gt;<span class="hljs-built_in">start</span>();<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Widget::stopGame</span><br><span class="hljs-comment">/// ç»“æŸæ¸¸æˆ</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::stopGame</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    m_timerControl-&gt;<span class="hljs-built_in">stop</span>();<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Widget::snakeRunning</span><br><span class="hljs-comment">/// è›‡è¿åŠ¨</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::snakeRunning</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> x=linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">x</span>();<br>    <span class="hljs-keyword">int</span> y=linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">y</span>();<br>    <span class="hljs-comment">//åˆ¤æ–­æ–¹å‘</span><br>    <span class="hljs-built_in"><span class="hljs-keyword">switch</span></span> (m_direction) &#123;<br>    <span class="hljs-keyword">case</span> Up:<br>        linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">setY</span>(y-=<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> Down:<br>        linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">setY</span>(y+=<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> Left:<br>        linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">setX</span>(x-=<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> Right:<br>        linkedlist-&gt;<span class="hljs-built_in">first</span>()-&gt;pos.<span class="hljs-built_in">setX</span>(x+=<span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Widget::checkFoodPosisEqualHeadPos</span><br><span class="hljs-comment">/// \param head</span><br><span class="hljs-comment">/// \param foodPos</span><br><span class="hljs-comment">/// æ£€æµ‹é£Ÿç‰©å‡ºç°åæ ‡æ˜¯å¦åœ¨è›‡èº«ä¸Š</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::checkFoodPosisEqualHeadPos</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(linkedlist-&gt;<span class="hljs-built_in">first</span>())&#123;<br>        Linkedlist::SnakeNode *p0=linkedlist-&gt;<span class="hljs-built_in">first</span>();<br>        <span class="hljs-keyword">do</span> &#123;<br>            <span class="hljs-keyword">if</span>(p0-&gt;pos==m_foodPos)&#123;<br>                <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;æ£€æµ‹åˆ°é£Ÿç‰©å¤„äºè›‡èº«ä¸Š...&quot;</span>;<br>                <span class="hljs-built_in">resetFoodPos</span>();<br>            &#125;<br>            p0=p0-&gt;next;<br>        &#125; <span class="hljs-keyword">while</span> (p0);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æµ‹è¯•<br /><img src="/uploads/images/snake/snake2.gif" alt="img" /></p><p>Bye~</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C++</tag>
      
      <tag>Qt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Qtå®ç°è´ªåƒè›‡1:æ•°ç»„å®ç°</title>
    <link href="/cpp-snake1/"/>
    <url>/cpp-snake1/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h3><p>æœ€è¿‘åˆšå­¦äº†é“¾è¡¨è¿™ä¸€æ–¹é¢çš„å†…å®¹ï¼Œæ„Ÿè§‰æŒºå¼ºå¤§çš„ï¼Œæ­£å·§æƒ³èµ·ä»¥å‰ç”¨æ•°ç»„å†™è¿‡ä¸€ä¸ªè´ªåƒè›‡æ¸¸æˆä»£ç ï¼Œäºæ˜¯æ‰“ç®—ç”¨ä¸¤ç§æ–¹æ³•å®ç°å®ƒã€‚æ–¹æ³•ä¸ºä»¥ä¸‹ä¸¤ç§ï¼š</p><ul><li>æ•°ç»„</li><li>é“¾è¡¨</li></ul><span id="more"></span><h3 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h3><p>å…¶å®ï¼Œç”¨æ•°ç»„å®ç°è´ªåƒè›‡è¿˜ç®—æ˜¯æ¯”è¾ƒç®€å•çš„äº†ï¼Œä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºä¸ç”¨èŠ±å¤ªå¤§åŠŸå¤«å»è€ƒè™‘è›‡èº«çš„æ¯ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ã€‚åŒæ ·ï¼Œåœ¨å®ç°è›‡çš„æ¸¸åŠ¨ã€åƒé£Ÿã€æ’å¢™ã€åƒåˆ°è‡ªå·±ç­‰åŠŸèƒ½æ—¶ï¼Œæœ€æ ¸å¿ƒçš„éƒ¨åˆ†æˆ‘è§‰å¾—æ˜¯è¦å¼„æ¸…ã€‚</p><ul><li>å…¶ä¸­ <code>void paintEvent(QPaintEvent *event)</code> ç”¨æ¥åœ¨æ¯æ¬¡é‡ç»˜æ—¶ç»˜åˆ¶æ¸¸æˆå¸ƒå±€ã€é£Ÿç‰©çš„ä½ç½®ã€è›‡çš„ä½ç½®ã€‚åˆ†åˆ«ç”¨ä¸¤ä¸ªæ•°ç»„è¡¨ç¤º <strong>é£Ÿç‰©çš„ä½ç½®ã€è›‡çš„ä½ç½®</strong></li></ul><figure class="highlight c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c"><span class="hljs-keyword">int</span> food[<span class="hljs-number">2</span>];<span class="hljs-comment">// food[0]è¡¨ç¤º xåæ ‡ï¼Œfood[1]è¡¨ç¤º yåæ ‡ </span><br><span class="hljs-keyword">int</span> snake[<span class="hljs-number">100</span>][<span class="hljs-number">2</span>]; <span class="hljs-comment">//åŒç†ï¼Œä¸è¿‡è¿™é‡Œ100ç›¸å½“äºæœ€å¤šæœ‰100ä¸ªè›‡èŠ‚ç‚¹</span><br></code></pre></div></td></tr></table></figure><ul><li>æ¥ç€ï¼Œ<code>void keyPressEvent(QKeyEvent * event)</code> äº‹ä»¶ç”¨æ¥æ”¹å˜è›‡è¿åŠ¨çš„æ–¹å‘ã€‚æˆ‘æ·»åŠ äº†ä¸€ä¸ªæšä¸¾å€¼</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">enum</span>  <span class="hljs-title">Direction</span>:</span><span class="hljs-keyword">int</span><br>&#123;<br>    East,<br>    South,<br>    West,<br>    North<br>&#125;;<br></code></pre></div></td></tr></table></figure><ul><li>ç”±äºè›‡æ˜¯è‡ªå·±ç§»åŠ¨çš„ï¼Œæ‰€ä»¥è¿˜æ˜¯åˆ›å»ºä¸€ä¸ªæ—¶é’Ÿ <code>QTimer</code> å¯¹è±¡ã€‚</li><li>é‚£ä¹ˆæ€ä¹ˆåˆ¤æ–­è›‡æ˜¯å¦åƒåˆ°é£Ÿç‰©å‘¢ï¼Œè¿™é‡Œå…¶å®å¾ˆç®€å•ï¼Œå¯ä»¥<strong>åˆ¤æ–­è›‡å¤´çš„x,yåæ ‡æ˜¯å¦ä¸é£Ÿç‰©çš„x,yåæ ‡ç›¸ç­‰å³å¯</strong>ï¼Œå³<code>if(snake[0][0]==food[0]&amp;&amp;snake[0][1]==food[1])&#123;...&#125;</code></li><li>æ‰€ä»¥ï¼Œæ£€æµ‹æ˜¯å¦æ’åˆ°å¢™ï¼Œä¹Ÿå¯ä»¥è¿™æ ·åˆ¤æ–­è›‡å¤´æ˜¯å¦è¶…è¿‡äº†è¾¹ç•Œ <code>if((snake[0][0]&lt;0||snake[0][1]&lt;0||snake[0][0]&gt;Columns-1||snake[0][1]&gt;Rows-1))&#123; ... &#125;</code></li><li>æ£€æµ‹è›‡æ˜¯å¦åƒåˆ°è‡ªå·±ï¼Œå¯ä»¥ <strong>éå†æ¯ä¸ªè›‡èŠ‚ç‚¹ï¼Œåˆ¤æ–­è›‡å¤´ snake[0] æ˜¯å¦ç­‰äº æŸä¸€ä¸ªè›‡èº«èŠ‚ç‚¹ snake[n] å³ï¼šè›‡å¤´åœ¨è›‡çš„èº«ä¸Šï¼Œè¡¨ç¤ºåƒåˆ°è‡ªå·±</strong></li></ul><p>å¥½äº†ï¼Œæœ‰äº†è¿™äº›æ€è·¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¼€å§‹å†™ä»£ç äº†ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªQt widgeté¡¹ç›®ã€‚<br />ä»£ç å¦‚ä¸‹ï¼š</p><p>dialog.h</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DIALOG_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DIALOG_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;QDialog&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QPalette&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QPushButton&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QLabel&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QPainter&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QDebug&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QKeyEvent&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QTimer&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QTime&gt;</span></span><br><span class="hljs-keyword">namespace</span> Ui &#123;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dialog</span>;</span><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dialog</span> :</span> <span class="hljs-keyword">public</span> QDialog<br>&#123;<br>    Q_OBJECT<br><span class="hljs-keyword">public</span> slots:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">timeOut</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">btnStartslot</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">btnPauseslot</span><span class="hljs-params">()</span></span>;<br><span class="hljs-keyword">protected</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">keyPressEvent</span><span class="hljs-params">(QKeyEvent *)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">paintEvent</span><span class="hljs-params">(QPaintEvent *event)</span></span>;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">Dialog</span><span class="hljs-params">(QWidget *parent = <span class="hljs-number">0</span>)</span></span>;<br>    ~<span class="hljs-built_in">Dialog</span>();<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">initialized</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">snakeRun</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">checkHItWall</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">checkEatSelf</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-class"><span class="hljs-keyword">enum</span>  <span class="hljs-title">Direction</span>:</span><span class="hljs-keyword">int</span>&#123;<br>        East,<br>        South,<br>        West,<br>        North<br>    &#125;;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-keyword">int</span> food[<span class="hljs-number">2</span>];<span class="hljs-comment">//é£Ÿç‰©åæ ‡</span><br>    <span class="hljs-keyword">int</span> snake[<span class="hljs-number">100</span>][<span class="hljs-number">2</span>];<span class="hljs-comment">//è›‡åæ ‡</span><br>    <span class="hljs-keyword">int</span> eatfoodCount;<span class="hljs-comment">//åƒåˆ°çš„é£Ÿç‰©æ€»æ•°</span><br>    <span class="hljs-keyword">int</span> directtion;<span class="hljs-comment">//è›‡å¤´æ–¹å‘</span><br>    <span class="hljs-keyword">int</span> scores;<span class="hljs-comment">//å¾—åˆ†</span><br>    <span class="hljs-keyword">int</span> speed;<span class="hljs-comment">//è›‡ç§»åŠ¨é€Ÿåº¦</span><br>    QLabel *lbScroe;<br>    QTimer *timer;<br>    Ui::Dialog *ui;<br>&#125;;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">// DIALOG_H</span></span><br></code></pre></div></td></tr></table></figure><p>dialog.cpp</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;dialog.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;ui_dialog.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QMessageBox&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> Columns 20 <span class="hljs-comment">//20åˆ—</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> Rows 20  <span class="hljs-comment">//20è¡Œ</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dialog::timeOut</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">snakeRun</span>();<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dialog::btnStartslot</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    timer-&gt;<span class="hljs-built_in">start</span>();<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dialog::btnPauseslot</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    timer-&gt;<span class="hljs-built_in">stop</span>();<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dialog::keyPressEvent</span><span class="hljs-params">(QKeyEvent * event)</span></span><br><span class="hljs-function"></span>&#123;<br>        <span class="hljs-keyword">if</span>(event-&gt;<span class="hljs-built_in">key</span>()==<span class="hljs-string">&#x27;A&#x27;</span>)&#123;<br>            <span class="hljs-keyword">if</span>(directtion!=West)&#123;<br>                 directtion=East;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(event-&gt;<span class="hljs-built_in">key</span>()==<span class="hljs-string">&#x27;D&#x27;</span>)&#123;<br>           <span class="hljs-keyword">if</span>(directtion!=East)&#123;<br>                directtion=West;<br>           &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(event-&gt;<span class="hljs-built_in">key</span>()==<span class="hljs-string">&#x27;W&#x27;</span>)&#123;<br>            <span class="hljs-keyword">if</span>(directtion!=South)&#123;<br>                directtion=North;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span>(event-&gt;<span class="hljs-built_in">key</span>()==<span class="hljs-string">&#x27;S&#x27;</span>)&#123;<br>            <span class="hljs-keyword">if</span>(directtion!=North)&#123;<br>                directtion=South;<br>            &#125;<br>        &#125;<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Dialog::paintEvent</span><br><span class="hljs-comment">/// \param event</span><br><span class="hljs-comment">/// ç»˜å›¾äº‹ä»¶ä¸»è¦è´Ÿè´£ ç»˜åˆ¶ è›‡</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dialog::paintEvent</span><span class="hljs-params">(QPaintEvent *event)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-function">QPainter <span class="hljs-title">painter</span><span class="hljs-params">(<span class="hljs-keyword">this</span>)</span></span>;<br>    QPen pen;<br>    pen.<span class="hljs-built_in">setColor</span>(<span class="hljs-built_in">QColor</span>(Qt::darkGray));<br>    painter.<span class="hljs-built_in">setPen</span>(pen);<br>    <span class="hljs-comment">//ç»˜åˆ¶æ¸¸æˆå¸ƒå±€</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> row = <span class="hljs-number">0</span>; row &lt; Rows; ++row) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> column = <span class="hljs-number">0</span>; column &lt; Columns; ++column) &#123;<br>            painter.<span class="hljs-built_in">drawRect</span>(row*<span class="hljs-number">20</span>,column*<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<span class="hljs-number">20</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//ç»˜åˆ¶é£Ÿç‰©</span><br>    painter.<span class="hljs-built_in">fillRect</span>(food[<span class="hljs-number">0</span>]*<span class="hljs-number">20</span>,food[<span class="hljs-number">1</span>]*<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,Qt::red);<br>    <span class="hljs-comment">//ç»˜åˆ¶è›‡å¤´</span><br>    painter.<span class="hljs-built_in">fillRect</span>(snake[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]*<span class="hljs-number">20</span>,snake[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]*<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,Qt::green);<br>    <span class="hljs-comment">//æ ¹æ®é£Ÿç‰©çš„å¤šå°‘æ¥ç»˜åˆ¶è›‡èº«å¤§é•¿åº¦</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> snakeBody = <span class="hljs-number">1</span>; snakeBody &lt;= eatfoodCount; snakeBody++) &#123;<br>        painter.<span class="hljs-built_in">fillRect</span>(snake[snakeBody][<span class="hljs-number">0</span>]*<span class="hljs-number">20</span>,snake[snakeBody][<span class="hljs-number">1</span>]*<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<span class="hljs-number">20</span>,<span class="hljs-built_in">QColor</span>(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>,<span class="hljs-number">0</span>));<br>    &#125;<br>&#125;<br>Dialog::<span class="hljs-built_in">Dialog</span>(QWidget *parent) :<br>    <span class="hljs-built_in">QDialog</span>(parent),<br>    <span class="hljs-built_in">ui</span>(<span class="hljs-keyword">new</span> Ui::Dialog)<br>&#123;<br>    ui-&gt;<span class="hljs-built_in">setupUi</span>(<span class="hljs-keyword">this</span>);<br>    <span class="hljs-comment">//è®¾ç½®éšæœºæ•°</span><br>    QTime t=QTime::<span class="hljs-built_in">currentTime</span>();<br>    <span class="hljs-keyword">int</span> s=  t.<span class="hljs-built_in">secsTo</span>(<span class="hljs-built_in">QTime</span>(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>));<br>     <span class="hljs-built_in">qsrand</span>(s);<br>    <span class="hljs-comment">//åˆå§‹åŒ–</span><br>     <span class="hljs-built_in">initialized</span>();<br>    QPushButton *btnStart=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QPushButton</span>(<span class="hljs-keyword">this</span>);<br>    btnStart-&gt;<span class="hljs-built_in">setFlat</span>(<span class="hljs-literal">true</span>);<br>    btnStart-&gt;<span class="hljs-built_in">setText</span>(<span class="hljs-string">&quot;start ...&quot;</span>);<br>    btnStart-&gt;<span class="hljs-built_in">setGeometry</span>(<span class="hljs-number">500</span>,<span class="hljs-number">100</span>,<span class="hljs-number">250</span>,<span class="hljs-number">50</span>);<br>    QPushButton *btnPause=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QPushButton</span>(<span class="hljs-keyword">this</span>);<br>    btnPause-&gt;<span class="hljs-built_in">setFlat</span>(<span class="hljs-literal">true</span>);<br>    btnPause-&gt;<span class="hljs-built_in">setText</span>(<span class="hljs-string">&quot;pause ...&quot;</span>);<br>    btnPause-&gt;<span class="hljs-built_in">setGeometry</span>(<span class="hljs-number">500</span>,<span class="hljs-number">180</span>,<span class="hljs-number">250</span>,<span class="hljs-number">50</span>);<br>    <span class="hljs-built_in">connect</span>(btnStart,<span class="hljs-built_in">SIGNAL</span>(<span class="hljs-built_in">clicked</span>(<span class="hljs-keyword">bool</span>)),<span class="hljs-keyword">this</span>,<span class="hljs-built_in">SLOT</span>(<span class="hljs-built_in">btnStartslot</span>()));<br>    <span class="hljs-built_in">connect</span>(btnPause,<span class="hljs-built_in">SIGNAL</span>(<span class="hljs-built_in">clicked</span>(<span class="hljs-keyword">bool</span>)),<span class="hljs-keyword">this</span>,<span class="hljs-built_in">SLOT</span>(<span class="hljs-built_in">btnPauseslot</span>()));<br>    QLabel *lbshowScroe=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-keyword">this</span>);<br>    lbScroe=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QLabel</span>(<span class="hljs-keyword">this</span>);<br>    lbshowScroe-&gt;<span class="hljs-built_in">setText</span>(<span class="hljs-string">&quot;å¾—åˆ†ï¼š&quot;</span>);<br>    lbScroe-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(scores));<br>    lbshowScroe-&gt;<span class="hljs-built_in">setGeometry</span>(<span class="hljs-number">500</span>,<span class="hljs-number">50</span>,<span class="hljs-number">100</span>,<span class="hljs-number">50</span>);<br>    lbScroe-&gt;<span class="hljs-built_in">setGeometry</span>(<span class="hljs-number">600</span>,<span class="hljs-number">50</span>,<span class="hljs-number">100</span>,<span class="hljs-number">50</span>);<br>    <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">setFixedSize</span>(<span class="hljs-number">800</span>,<span class="hljs-number">460</span>);<br>    <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">setWindowTitle</span>(<span class="hljs-string">&quot;è´ªåƒè›‡&quot;</span>);<br>    <span class="hljs-comment">//è®¾ç½®æ—¶é’Ÿ</span><br>    timer=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QTimer</span>(<span class="hljs-keyword">this</span>);<br>    timer-&gt;<span class="hljs-built_in">setInterval</span>(speed);<br>    <span class="hljs-built_in">connect</span>(timer,<span class="hljs-built_in">SIGNAL</span>(<span class="hljs-built_in">timeout</span>()),<span class="hljs-keyword">this</span>,<span class="hljs-built_in">SLOT</span>(<span class="hljs-built_in">timeOut</span>()));<br>&#125;<br>Dialog::~<span class="hljs-built_in">Dialog</span>()<br>&#123;<br>    <span class="hljs-keyword">delete</span> ui;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dialog::initialized</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    eatfoodCount=<span class="hljs-number">0</span>;<br>    scores=<span class="hljs-number">0</span>;<br>    speed=<span class="hljs-number">200</span>;<br>    <span class="hljs-comment">//åˆå§‹åŒ–é£Ÿç‰©åæ ‡</span><br>    food[<span class="hljs-number">0</span>]=<span class="hljs-built_in">qrand</span>()%Columns;<br>    food [<span class="hljs-number">1</span>]= <span class="hljs-built_in">qrand</span>()%Rows;<br>    <span class="hljs-comment">//åˆå§‹åŒ–è›‡å¤´åæ ‡</span><br>    snake[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=<span class="hljs-built_in">qrand</span>()%Columns;<br>    snake[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]=<span class="hljs-built_in">qrand</span>()%Rows;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; eatfoodCount; ++i) &#123;<br>        <span class="hljs-comment">//åˆ¤æ–­é£Ÿç‰©æ˜¯å¦å‡ºç°åœ¨è›‡çš„èº«ä¸Š</span><br>        <span class="hljs-keyword">if</span>(food[<span class="hljs-number">0</span>]==snake[i][<span class="hljs-number">0</span>]&amp;&amp;food[<span class="hljs-number">1</span>]==snake[i][<span class="hljs-number">1</span>])&#123;<br>            <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;the food position is at snake ...&quot;</span>;<br>            snake[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=<span class="hljs-built_in">qrand</span>()%Columns;<br>            snake[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]=<span class="hljs-built_in">qrand</span>()%Rows;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">//åˆå§‹åŒ–è›‡å¤´æ–¹å‘</span><br>    directtion=<span class="hljs-built_in">qrand</span>()%<span class="hljs-number">4</span>;<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Dialog::snakeRun</span><br><span class="hljs-comment">/// è›‡ç§»åŠ¨</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dialog::snakeRun</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//æ‰“å°å‡ºè›‡çš„æ¯ä¸ªèŠ‚ç‚¹åæ ‡ï¼Œç”¨äºæµ‹è¯•</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; eatfoodCount; ++i) &#123;<br>        <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-built_in">QString</span>(<span class="hljs-string">&quot;%1 : (%2-%3)&quot;</span>).<span class="hljs-built_in">arg</span>(i).<span class="hljs-built_in">arg</span>(snake[i][<span class="hljs-number">0</span>]).<span class="hljs-built_in">arg</span>(snake[i][<span class="hljs-number">1</span>]);<br>    &#125;<br>    <span class="hljs-built_in">qDebug</span>()&lt;&lt;endl;<br>    <span class="hljs-comment">//åƒåˆ°é£Ÿç‰©ï¼Œå³ é£Ÿç‰© food x,yåæ ‡ ç­‰äº è›‡å¤´snake[0] xï¼Œyåæ ‡</span><br>    <span class="hljs-keyword">if</span>(snake[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]==food[<span class="hljs-number">0</span>]&amp;&amp;snake[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]==food[<span class="hljs-number">1</span>])&#123;<br>        scores+=<span class="hljs-number">20</span>; <span class="hljs-comment">//å¾—åˆ†</span><br>        <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;eat the food&quot;</span>;<br>        eatfoodCount++;<span class="hljs-comment">//é£Ÿç‰©ä¸ªæ•°++</span><br>        lbScroe-&gt;<span class="hljs-built_in">setText</span>(QString::<span class="hljs-built_in">number</span>(scores));<br>        <span class="hljs-comment">//äº§ç”Ÿæ–°çš„é£Ÿç‰©ä½ç½®</span><br>        food[<span class="hljs-number">0</span>]=<span class="hljs-built_in">qrand</span>()%Columns;<br>        food [<span class="hljs-number">1</span>]= <span class="hljs-built_in">qrand</span>()%Rows;<br>    &#125;<br>    <span class="hljs-comment">//å˜æ¢é€Ÿåº¦</span><br>    <span class="hljs-keyword">if</span>(scores&gt;= <span class="hljs-number">50</span>)&#123;<br>        speed=<span class="hljs-number">100</span>;<br>        timer-&gt;<span class="hljs-built_in">setInterval</span>(speed);<br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(scores&gt;=<span class="hljs-number">100</span>)&#123;<br>        speed=<span class="hljs-number">50</span>;<br>        timer-&gt;<span class="hljs-built_in">setInterval</span>(speed);<br>    &#125;<br>    <span class="hljs-built_in">checkHItWall</span>();<br>    <span class="hljs-built_in">checkEatSelf</span>();<br>    <span class="hljs-comment">//è›‡å¤´å‘å‰ç§»åŠ¨ä¸€æ ¼åï¼Œè›‡å¤´åæ ‡å˜äº†ï¼Œ</span><br>    <span class="hljs-comment">//åŸè›‡å¤´çš„åæ ‡ä¸ºç¬¬ä¸€èŠ‚èº«ä½“çš„åæ ‡ï¼Œ</span><br>    <span class="hljs-comment">//åŸç¬¬ä¸€èŠ‚èº«ä½“åæ ‡ä¸ºç°åœ¨ç¬¬äºŒèŠ‚çš„åæ ‡ï¼Œå³æ‰€æœ‰åæ ‡å‘å‰ç§»åŠ¨ä¸€æ ¼</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i =  eatfoodCount; i &gt;<span class="hljs-number">0</span>; i--) &#123;<br>        snake[i][<span class="hljs-number">0</span>]=snake[i<span class="hljs-number">-1</span>][<span class="hljs-number">0</span>];<br>        snake[i][<span class="hljs-number">1</span>]=snake[i<span class="hljs-number">-1</span>][<span class="hljs-number">1</span>];<br>    &#125;<br>    <span class="hljs-comment">//æ ¹æ®æ–¹å‘æ¥ç§»åŠ¨è›‡</span><br>    <span class="hljs-built_in"><span class="hljs-keyword">switch</span></span> (directtion) &#123;<br>    <span class="hljs-keyword">case</span> East:<br>        snake[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]--;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> South:<br>        snake[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]++;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> West:<br>        snake[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]++;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> North:<br>        snake[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]--;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-comment">/// æ›´æ–°ç»˜å›¾</span><br>    <span class="hljs-built_in">update</span>();<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Dialog::checkHItWall</span><br><span class="hljs-comment">/// æ˜¯å¦æ’å¢™</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dialog::checkHItWall</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//å³ åˆ¤æ–­æ˜¯å¦è¶…è¿‡äº†è¾¹ç•Œ</span><br>    <span class="hljs-keyword">if</span>((snake[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]&lt;<span class="hljs-number">0</span>||snake[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]&lt;<span class="hljs-number">0</span>||snake[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]&gt;Columns<span class="hljs-number">-1</span>||snake[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]&gt;Rows<span class="hljs-number">-1</span>))&#123;<br>       <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;Game Over&quot;</span>;<br>       timer-&gt;<span class="hljs-built_in">stop</span>();<br>       QMessageBox::<span class="hljs-built_in">information</span>(<span class="hljs-keyword">this</span>,<span class="hljs-string">&quot;game over&quot;</span>,<span class="hljs-string">&quot;hit the wall&quot;</span>);<br>       <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">close</span>();<br>    &#125;<br>&#125;<br><span class="hljs-comment">///</span><br><span class="hljs-comment">/// \brief Dialog::checkEatSelf</span><br><span class="hljs-comment">/// æ˜¯å¦åƒåˆ°è‡ªå·±</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dialog::checkEatSelf</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//éå†æ¯ä¸ªè›‡èŠ‚ç‚¹ï¼Œåˆ¤æ–­è›‡å¤´ snake[0]  æ˜¯å¦ç­‰äº æŸä¸€ä¸ªè›‡èº«èŠ‚ç‚¹ snake[n]</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> n = <span class="hljs-number">1</span>; n &lt;= eatfoodCount; n++) &#123;<br>            <span class="hljs-keyword">if</span>(snake[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]==snake[n][<span class="hljs-number">0</span>]&amp;&amp;snake[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>]==snake[n][<span class="hljs-number">1</span>])&#123;<br>                <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;Game Over;;;&quot;</span>;<br>                timer-&gt;<span class="hljs-built_in">stop</span>();<br>                QMessageBox::<span class="hljs-built_in">information</span>(<span class="hljs-keyword">this</span>,<span class="hljs-string">&quot;game over&quot;</span>,<span class="hljs-string">&quot;eat self&quot;</span>);<br>                <span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">close</span>();<br>            &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä»£ç ä¸­çš„æ³¨é‡Šè¿˜ç®—æ˜¯æ¯”è¾ƒè¯¦ç»†çš„å§ã€‚ã€‚ã€‚ä¸è¿‡å…³é”®è¿˜æ˜¯è‡ªå·±äº²æ‰‹å†™å‡ºæ¥ï¼<br />ç°åœ¨ï¼Œæ¥çœ‹ä¸€ä¸‹è¿è¡Œç»“æœ<br /><img src="/uploads/images/snake/snake1.gif" alt="img" /></p><p>é‚£ä¹ˆï¼Œä¸‹æ¬¡åœ¨ä»‹ç»ç”¨é“¾è¡¨å®ç°è´ªåƒè›‡ï¼</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C++</tag>
      
      <tag>Qt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Qt5.10.0ç¼–è¯‘MYSQL(Mariadb)é©±åŠ¨</title>
    <link href="/linux-qt-com-mysql/"/>
    <url>/linux-qt-com-mysql/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å®‰è£…äº†æ–°ç‰ˆæœ¬çš„Qt,å½“è¿æ¥MySQLæ•°æ®åº“æ—¶,åˆå‡ºç°é‚£ä¸ªä¼¼æ›¾ç›¸è¯†çš„é”™è¯¯ <strong>QSqlDatabase: QMYSQL driver not loaded</strong>.çŸ¥é“åå°±èµ¶ç´§å»ç¼–è¯‘æºç .ç„¶è€Œä½ ä»¥ä¸ºçœŸçš„å°±é‚£ä¹ˆä¸€å¸†é£é¡ºå—?</p><span id="more"></span><h3 id="é—®é¢˜"><a class="markdownIt-Anchor" href="#é—®é¢˜"></a> é—®é¢˜</h3><p>æµ‹è¯•ç¯å¢ƒ:</p><ul><li>Linux</li><li>Qt 5.10.0</li><li>MariaDB 10.1.29</li></ul><p>å‡ºç°é—®é¢˜:<br />æˆ‘æ˜¯æ–°æ¢æˆäº†MariaDB,æ¯”èµ·ä¹‹å‰ä¼ ç»ŸMySQL,ç›¸åº”çš„æ–‡ä»¶è·¯å¾„ä¹Ÿå‘ç”Ÿäº†å˜åŒ–.è€Œå…¶ç»“æœæ—¶å¯¼è‡´åé¢ä¸€è¿ä¸²çš„é—®é¢˜.<br />ç°åœ¨ç½‘ä¸Šå¤§éƒ¨åˆ†éƒ½æ˜¯ä»¥å‰çš„MySQLé©±åŠ¨ç¼–è¯‘æ•™ç¨‹,å…³äºMariaDBæ•°æ®åº“(æœ¬è´¨ä¸Šä¹Ÿæ˜¯MySQL)çš„èµ„æ–™å¾ˆå°‘,æ‰€ä»¥è¿™é‡Œå°±æ€»ç»“ä¸€ä¸‹æœŸé—´é‡åˆ°çš„é—®é¢˜â€¦â€¦</p><p>ç»ˆç«¯ä¸‹è¾“å…¥: <code>$ locate mysql.h</code><br />åœ¨æˆ‘è¿™é‡Œè¾“å‡º</p><blockquote><p><strong>/usr/include/mariadb/mysql.h</strong><br />/usr/include/qt4/Qt/qsql_mysql.h<br />/usr/include/qt4/QtSql/qsql_mysql.h</p></blockquote><p>æ³¨æ„äº†æ²¡,å°±è¿™é‡Œæ³¨å®šç¼–è¯‘MySQLé©±åŠ¨ä¼šå¤±è´¥!å› ä¸ºé»˜è®¤çš„æœç´¢è·¯å¾„ä¸º <strong>/usr/include/mysql.h</strong></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹ <strong><a href="http://libqsqlmysql.so">libqsqlmysql.so</a></strong> è¿™ä¸ªåº“æ–‡ä»¶<br /><code>$ ldd libqsqlmysql.so</code><br /><img src="/uploads/images/linux/file_001_qt1.png" alt="img" /></p><p>ä»–è¯´ libqsqlmysql.so.18 è¿™ä¸ªåº“æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°,é‚£ä¹ˆå°±åªèƒ½é‡æ–°ç¼–è¯‘äº†â€¦</p><h3 id="å°è¯•æˆåŠŸ"><a class="markdownIt-Anchor" href="#å°è¯•æˆåŠŸ"></a> å°è¯•æˆåŠŸ</h3><p>ä½†æ˜¯è¿™é‡Œæˆ‘è¿˜æ˜¯è®²ä¸€ä¸‹æˆ‘ç¬¬ä¸€æ¬¡å°è¯•çš„æ–¹æ³•(å°±æ˜¯æŠŠ <strong>mariadb</strong> çš„åº“é“¾æ¥åˆ° libqsqlmysql.so.18)</p><p><code>$ locate libmariadb|grep so</code> æŸ¥çœ‹ mariadbåº“æ–‡ä»¶çš„è·¯å¾„</p><blockquote><p>/usr/lib/x86_64-linux-gnu/libmariadb.so<br />/usr/lib/x86_64-linux-gnu/libmariadb.so.2<br />/usr/lib/x86_64-linux-gnu/libmariadbclient.so.18<br /><strong>/usr/lib/x86_64-linux-gnu/libmariadbclient.so.18.0.0</strong></p></blockquote><p>æ¥ç€æˆ‘å†æ‰¾ä¸‹æ˜¯å¦è¿˜å­˜åœ¨ä¹‹å‰çš„ <strong><a href="http://libmysqlclient.so">libmysqlclient.so</a></strong><br /><code>$ locate libmysqlclient.so</code></p><blockquote><p>/usr/lib/libmysqlclient.so</p></blockquote><p><code>$ ls -l /usr/lib/libmysqlclient.so</code> å‘ç° <a href="http://libmysqlclient.so">libmysqlclient.so</a> æ˜¯ä¸ªè½¯é“¾æ¥</p><blockquote><p>lrwxrwxrwx 1 root root 43 9æœˆ 17 08:01 /usr/lib/libmysqlclient.so -&gt; /usr/lib/x86_64-linux-gnu/libmysqlclient.so</p></blockquote><p>æ¥ç€ <code>$ ls -l /usr/lib/x86_64-linux-gnu/libmysqlclient.so</code></p><blockquote><p>ls: æ— æ³•è®¿é—®â€™/usr/lib/x86_64-linux-gnu/libmysqlclient.soâ€™: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</p></blockquote><p>what!å±…ç„¶ä¸å­˜åœ¨!?æ‰€ä»¥èµ¶ç´§æŠŠé‚£é“¾æ¥åˆ äº†</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯ç»™ <strong><a href="http://libmariadbclient.so">libmariadbclient.so</a></strong> è®¾ä¸ªè½¯é“¾æ¥</p><blockquote><p>ln -s /usr/lib/x86_64-linux-gnu/libmariadbclient.so.18 /usr/lib/libmysqlclient.so<br /><strong>ln -s /usr/lib/x86_64-linux-gnu/libmariadbclient.so.18 /usr/lib/libmysqlclient.so.18</strong></p></blockquote><p>æœ€åçœ‹çœ‹ <code>$ ldd libqsqlmysql.so</code></p><blockquote><p>libmysqlclient.so.18 =&gt; /usr/lib/libmysqlclient.so.18 (0x00007fdf1a1df000)</p></blockquote><p>â€¦â€¦å±…ç„¶æˆåŠŸäº†!!é‚£è¿˜ç”¨ç¼–è¯‘ä¸ªæ¯›å•Š??ç„¶è€Œè¿™ä¸æ˜¯æœ¬æ–‡é‡ç‚¹è›¤â€¦â€¦</p><h3 id="é‡ç‚¹ç¼–è¯‘mysqlé©±åŠ¨"><a class="markdownIt-Anchor" href="#é‡ç‚¹ç¼–è¯‘mysqlé©±åŠ¨"></a> é‡ç‚¹(ç¼–è¯‘MySQLé©±åŠ¨)</h3><p>è¿™é‡Œæ‰€è¯´çš„é©±åŠ¨å…¶å®ä¹Ÿä¸è¿‡å°±æ˜¯ä¸€ä¸ªé“¾æ¥åº“ç½¢äº†â€¦â€¦</p><p>é¦–å…ˆè¿›å…¥è¯¥æºä»£ç ç›®å½•ä¸‹ <code>$ cd $&#123;QTDIR&#125;/5.10.0/Src/qtbase/src/plugins/sqldrivers/mysql</code></p><p>ä¸€èˆ¬æ­£å¸¸æ¥è®²æ¥ä¸‹æ¥å°±æ˜¯ <code>qmake mysql.pro</code>,<code>make</code><br />ä¸è¿‡è¿™é‡Œä¼šå‡ºç°ä¸€ä¸ªé”™è¯¯<br /><img src="/uploads/images/linux/file_002_qt2.png" alt="img" /></p><p>è¿™å°±è¦ä¿®æ”¹ <strong><a href="http://mysql.pro">mysql.pro</a></strong></p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">TARGET = qsqlmysql<br>HEADERS += $<span class="hljs-variable">$PWD</span>/qsql_mysql_p<span class="hljs-selector-class">.h</span><br>SOURCES += $<span class="hljs-variable">$PWD</span>/qsql_mysql<span class="hljs-selector-class">.cpp</span> $<span class="hljs-variable">$PWD</span>/<span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.cpp</span><br>QMAKE_USE += mysql<br>OTHER_FILES += mysql<span class="hljs-selector-class">.json</span><br>INCLUDEPATH += /usr/include/mariadb<br>PLUGIN_CLASS_NAME = QMYSQLDriverPlugin<br><span class="hljs-function"><span class="hljs-title">include</span><span class="hljs-params">(../qsqldriverbase.pri)</span></span><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„æˆ‘æ·»åŠ äº† <strong>INCLUDEPATH += /usr/include/mariadb</strong></p><p>æ¥ç€ <code>qmake;make</code> æ­å–œ,ç‰¹ä¹ˆçš„åˆå‡ºç°äº†ä¸ªé”™è¯¯.ä¸æ€¥æ‰¾æ‰¾çœ‹é‚£å‡ºäº†é—®é¢˜â€¦</p><blockquote><p>/opt/Qt5.10.0/5.10.0/gcc_64/bin/qmake -o Makefile <a href="http://mysql.pro">mysql.pro</a><br />rm -f <a href="http://libqsqlmysql.so">libqsqlmysql.so</a><br />g++ -Wl,â€“no-undefined -Wl,-O1 -Wl,â€“enable-new-dtags -Wl,-z,origin -Wl,-rpath,$ORIGIN/â€¦/â€¦/lib -Wl,-rpath,$ORIGIN/â€¦/â€¦/lib -shared -o <a href="http://libqsqlmysql.so">libqsqlmysql.so</a> .obj/qsql_mysql.o .obj/main.o .obj/moc_qsql_mysql_p.o -L/opt/Qt5.10.0/5.10.0/gcc_64/lib -lQt5Sql -lQt5Core <strong>-lmariadbclient</strong> -lpthread -lz -lm -ldl<br /><strong>/usr/bin/ld: æ‰¾ä¸åˆ° -lmariadbclient</strong><br />collect2: error: ld returned 1 exit status<br />Makefile:80: recipe for target â€˜â€¦/plugins/sqldrivers/libqsqlmysql.soâ€™ failed<br />make: *** [â€¦/plugins/sqldrivers/libqsqlmysql.so] Error 1</p></blockquote><p>å…¶å®é—®é¢˜å¾ˆç®€å•,å°±æ˜¯ä¸€ä¸ªé“¾æ¥åå­—.åœ¨é“¾æ¥åº“æ—¶,é»˜è®¤åŒ¹é…çš„ä¸º <a href="http://libxxx.so">libxxx.so</a> ; è€Œåé¢çš„æ•°å­—,å¦‚: <a href="http://libxxx.so">libxxx.so</a>.<strong>1.1.1</strong> è¡¨ç¤ºåº“çš„ç‰ˆæœ¬.</p><p><code>$ locate libmariadbclient.so</code> çœ‹åˆ°,å°‘äº†ä¸€ä¸ª <a href="http://libmariadbclient.so">libmariadbclient.so</a></p><blockquote><p>/usr/lib/x86_64-linux-gnu/libmariadbclient.so.18<br />/usr/lib/x86_64-linux-gnu/libmariadbclient.so.18.0.0</p></blockquote><p>ç¬é—´é—®é¢˜ç®€å•åŒ–äº†,so,ç›´æ¥æ·»åŠ ä¸€ä¸ªè½¯é“¾æ¥å°±è¡Œäº†</p><blockquote><p>ln -s /usr/lib/x86_64-linux-gnu/libmariadbclient.so.18.0.0 /usr/lib/x86_64-linux-gnu/<strong><a href="http://libmariadbclient.so">libmariadbclient.so</a></strong></p></blockquote><p>å†ä¸€æ¬¡ <code>qmake;make</code>â€¦â€¦</p><blockquote><p>rm -f <a href="http://libqsqlmysql.so">libqsqlmysql.so</a><br />g++ -Wl,â€“no-undefined -Wl,-O1 -Wl,â€“enable-new-dtags -Wl,-z,origin -Wl,-rpath,$ORIGIN/â€¦/â€¦/lib -Wl,-rpath,$ORIGIN/â€¦/â€¦/lib -shared -o <a href="http://libqsqlmysql.so">libqsqlmysql.so</a> .obj/qsql_mysql.o .obj/main.o .obj/moc_qsql_mysql_p.o -L/opt/Qt5.10.0/5.10.0/gcc_64/lib -lQt5Sql -lQt5Core -lmariadbclient -lpthread -lz -lm -ldl<br />mv -f <a href="http://libqsqlmysql.so">libqsqlmysql.so</a> <strong>â€¦/plugins/sqldrivers/</strong></p></blockquote><p>æˆåŠŸç¼–è¯‘!</p><p>ç°åœ¨ <code>$ ../plugins/sqldrivers</code><br /><code>$ ldd libqsqlmysql.so</code></p><blockquote><p><strong>libmariadbclient.so.18</strong> =&gt; /usr/lib/x86_64-linux-gnu/libmariadbclient.so.18 (0x00007f1bf7414000)</p></blockquote><p>ç°åœ¨å¯ä»¥æŠŠè¿™ä¸ªæ–‡ä»¶å¤åˆ¶åˆ° /opt/Qt5.10.0/5.10.0/gcc_64/plugins/sqldrivers ç›®å½•ä¸‹äº†</p><h3 id="ç»“æŸè¯­"><a class="markdownIt-Anchor" href="#ç»“æŸè¯­"></a> ç»“æŸè¯­</h3><p>åŸºæœ¬ä¸Šåˆ°æ­¤ä¸ºæ­¢äº†å§â€¦â€¦é¡ºå¸¦æä¸‹,ç”¨Cå†™çš„ç¨‹åºé“¾æ¥MySQLæ•°æ®åº“æ—¶,ä¼ ç»Ÿçš„åšæ³•å°±æ˜¯</p><blockquote><p>gcc xxx.c -o xxx <strong>-lmysqlclient</strong></p></blockquote><p>æ¢æˆMariaDBåå°±æˆäº†</p><blockquote><p>gcc xxx.c -o xxx <strong>-lmariadb</strong></p></blockquote><p>è¿™ä¸€ç‚¹è¦ç‰¹åˆ«æ³¨æ„å•Š!</p><p>bye</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Qt</tag>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows10 GTK Theme</title>
    <link href="/windows10-gtk-theme/"/>
    <url>/windows10-gtk-theme/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å¶ç„¶çœ‹åˆ°ä¸€ç¯‡æ–‡ç« ,è®²çš„æ˜¯è®²Linuxä¸»é¢˜é…ç½®æˆWindows10,å’‹ä¸€çœ‹,æŒºå¥½å¥‡çš„,æ‰€ä»¥æ‰å‡ºäº†æœ¬æ–‡</p><p><img src="/uploads/images/windows/w10-3.png" alt="img" /></p><span id="more"></span><h3 id="è·å–windows10-gtk-theme"><a class="markdownIt-Anchor" href="#è·å–windows10-gtk-theme"></a> è·å–Windows10 GTK Theme</h3><h4 id="windows-10-light"><a class="markdownIt-Anchor" href="#windows-10-light"></a> Windows 10 Light</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/B00merang-Project/</span>Windows-<span class="hljs-number">10</span>.git<br>sudo mv Windows-<span class="hljs-number">10</span> <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/themes/</span><br></code></pre></div></td></tr></table></figure><h4 id="windows-10-dark"><a class="markdownIt-Anchor" href="#windows-10-dark"></a> Windows 10 Dark</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/B00merang-Project/</span>Windows-<span class="hljs-number">10</span>-Dark.git<br>sudo mv Windows-<span class="hljs-number">10</span>-Dark <span class="hljs-regexp">/usr/</span>share/themes<br></code></pre></div></td></tr></table></figure><h4 id="windows-10-universal"><a class="markdownIt-Anchor" href="#windows-10-universal"></a> Windows 10 Universal</h4><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/B00merang-Project/</span>Windows-<span class="hljs-number">10</span>-Metro.git<br>sudo mv Windows-<span class="hljs-number">10</span>-Metro <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/themes/</span><br></code></pre></div></td></tr></table></figure><h3 id="è®¾ç½®å›¾æ ‡icons"><a class="markdownIt-Anchor" href="#è®¾ç½®å›¾æ ‡icons"></a> è®¾ç½®å›¾æ ‡(Icons)</h3><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">wget</span> https://github.com/Elbullazul/Windows-<span class="hljs-number">10</span>/releases/download/v<span class="hljs-number">0</span>.<span class="hljs-number">9</span>.<span class="hljs-number">6</span>/Windows.<span class="hljs-number">10</span>.Icons.v<span class="hljs-number">0</span>.<span class="hljs-number">4</span>.<span class="hljs-number">1</span>.zip<br><span class="hljs-attribute">unzip</span> Windows.<span class="hljs-number">10</span>.Icons.v<span class="hljs-number">0</span>.<span class="hljs-number">4</span>.<span class="hljs-number">1</span>.zip<br><span class="hljs-attribute">mv</span> &#x27;Windows <span class="hljs-number">10</span> Icons&#x27; /usr/share/icons<br></code></pre></div></td></tr></table></figure><h3 id="è®¾ç½®å¢™çº¸wallpaper"><a class="markdownIt-Anchor" href="#è®¾ç½®å¢™çº¸wallpaper"></a> è®¾ç½®å¢™çº¸(Wallpaper)</h3><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/usr/</span>share<span class="hljs-regexp">/themes/</span>Windows-<span class="hljs-number">10</span><br>ls<br>cp wallpaper.jpg ~/Pictures<br></code></pre></div></td></tr></table></figure><p>ä¹‹åå°±å¯ä»¥é€šè¿‡ <strong>gnome-tweak-tool</strong> è®¾ç½®ä¸»é¢˜äº†â€¦</p><p>å¦å¤–å¯å‚è€ƒ<br /><a href="https://www.addictivetips.com/ubuntu-linux-tips/make-linux-look-like-windows-10/">How To Make Linux Look Like <strong>Windows 10</strong></a><br /><a href="https://www.addictivetips.com/ubuntu-linux-tips/make-linux-look-like-windows-vista/">How To Make Linux Look Like <strong>Windows Vista</strong></a><br /><a href="https://www.addictivetips.com/ubuntu-linux-tips/make-your-linux-desktop-look-like-windows-xp/">How To Make Linux Look Like <strong>Windows XP</strong></a><br /><a href="https://www.addictivetips.com/ubuntu-linux-tips/make-linux-look-like-macos/">How To Make Linux Look Like <strong>macOS</strong></a><br /><a href="https://www.addictivetips.com/ubuntu-linux-tips/make-linux-look-like-chrome-os/">How To Make Linux Look Like <strong>Chrome OS</strong></a></p><p>bye~~</p>]]></content>
    
    
    <categories>
      
      <category>Others</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç”µè„‘æ— çº¿è¿æ¥åˆ°æ ‘è“æ´¾(RaspPi)</title>
    <link href="/connect-reappi/"/>
    <url>/connect-reappi/</url>
    
    <content type="html"><![CDATA[<p>å½“å¾—åˆ°ä¸€å—æ ‘è“æ´¾æ—¶ï¼Œå·²ç»åˆ·å…¥raspbianç³»ç»Ÿï¼Œé™¤äº†ç”¨ç½‘çº¿è¿æ¥æ ‘è“æ´¾å’Œç”µè„‘å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡æ— çº¿WiFiè¿æ¥åˆ°æ ‘è“æ´¾</p><span id="more"></span><h3 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h3><p>æ­£å¸¸æ¥è®²ï¼Œæˆ‘å¾—ç”¨å¦ä¸€ä¸ªæ ¹ç½‘çº¿æŠŠç”µè„‘å’Œæ ‘è“æ´¾è¿åœ¨ä¸€èµ·ã€‚åœ¨ä¸»æœºä¸Šè¿æ¥æ— çº¿WiFiï¼Œå† <strong>fping -asqg 192.168.1.0/24</strong> æˆ– <strong>nmap</strong> æ‰¾åˆ°å±€åŸŸç½‘ä¸‹æ ‘è“æ´¾çš„IPåœ°å€ã€‚è€Œç°åœ¨ï¼Œæˆ‘ä¸è¦è®©ä¸»æœºè¿æ¥WiFi(è¿™æ ·ç½‘ç»œé€Ÿåº¦å¿«å¾ˆå¤š)ï¼Œå³åœ¨æ ‘è“æ´¾å¯åŠ¨æ—¶è‡ªåŠ¨è¿æ¥åˆ°WiFiçƒ­ç‚¹ã€‚</p><p>å› æ­¤ï¼Œå¯ä»¥æŠŠå·²ç»åˆ·å¥½çš„SDå¡é‡Œé¢çš„æœ‰å…³ç½‘ç»œçš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ <strong>/etc/network/interfaces</strong> è¿›è¡Œä¿®æ”¹ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">auto</span> lo<br><span class="hljs-attribute">iface</span> lo inet loopback<br><span class="hljs-attribute">auto</span> eth<span class="hljs-number">0</span><br><span class="hljs-attribute">iface</span> eth<span class="hljs-number">0</span> inet static<br><span class="hljs-attribute">address</span> <span class="hljs-number">192.168.1.105</span><br><span class="hljs-attribute">netmask</span> <span class="hljs-number">255.255.255.0</span><br><span class="hljs-attribute">gateway</span> <span class="hljs-number">192.168.1.1</span><br><span class="hljs-comment">#auto wlan0</span><br><span class="hljs-attribute"><span class="hljs-nomarkup">allow</span></span>-hotplug wlan<span class="hljs-number">0</span><br><span class="hljs-attribute">iface</span> wlan<span class="hljs-number">0</span> inet static <br><span class="hljs-attribute">address</span> <span class="hljs-number">192.168.1.110</span><br><span class="hljs-attribute">netmask</span> <span class="hljs-number">255.255.255.0</span><br><span class="hljs-attribute">gateway</span> <span class="hljs-number">192.168.1.1</span><br><span class="hljs-attribute">wpa</span>-ssid WiFiåç§°<br><span class="hljs-attribute">wpa</span>-psk WiFiå¯†ç <br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œæˆ‘å°†wlan0æ¥å£è®¾ç½®æˆé™æ€åœ°å€ï¼Œè¿™æ ·çš„è¯ä»¥åå°±å¯ä»¥å¾ˆæ–¹ä¾¿é€šè¿‡sshè¿æ¥åˆ°æ ‘è“æ´¾äº†ã€‚</p><p>ç°åœ¨å†æŠŠSDå¡æ’å…¥æ ‘è“æ´¾ï¼Œå¯åŠ¨ï¼Œç¨ç­‰ç‰‡åˆ» <strong>fping -asqg 192.168.1.0/24</strong> æ‰«æå±€åŸŸç½‘ä¸»æœºåï¼Œå°±å¯ä»¥çœ‹åˆ°è®¾ç½®çš„é™æ€IPåœ°å€192.168.1.11</p><p>æˆ–è€…æŒ‡å®šä¸€ä¸ª <strong>wpa_supplicant.conf</strong></p><p>/etc/network/interfaces</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-comment">#auto wlan0</span><br><span class="hljs-attribute"><span class="hljs-nomarkup">allow</span></span>-hotplug wlan<span class="hljs-number">0</span><br><span class="hljs-attribute">iface</span> wlan<span class="hljs-number">0</span> inet manual<br><span class="hljs-attribute">wpa</span>-roam /etc/wpa_supplicant/wpa_supplicant.conf<br><span class="hljs-attribute">iface</span> default inet dhcp<br></code></pre></div></td></tr></table></figure><p>/etc/wpa_supplicant/wpa_supplicant.conf</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros"><span class="hljs-attribute">ctrl_interface</span>=DIR=/var/run/wpa_supplicant <span class="hljs-attribute">GROUP</span>=netdev<br><span class="hljs-attribute">update_config</span>=1<br>network=&#123;<br><span class="hljs-attribute">ssid</span>=<span class="hljs-string">&quot;wifiåç§°&quot;</span><br><span class="hljs-attribute">psk</span>=<span class="hljs-string">&quot;wifiå¯†ç &quot;</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>æœ€åé€šè¿‡ <code>ssh pi@192.168.1.110</code> å³å¯è¿æ¥åˆ°æ ‘è“æ´¾</p><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>RaspberryPi</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>æ ‘è“æ´¾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ©ç”¨winpcapè·å–ç½‘ç»œæ•°æ®ä¼ è¾“</title>
    <link href="/windows-kernel/"/>
    <url>/windows-kernel/</url>
    
    <content type="html"><![CDATA[<blockquote><p>è¯´æ˜ï¼šåœ¨æˆ‘æ²¡è½¬åˆ°linuxä¹‹å‰ï¼Œæˆ‘ç²—ç•¥çš„å­¦è¿‡windowså†…æ ¸ç¼–ç¨‹ï¼Œä»¥ä¸‹æ˜¯åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ç¼–å½•çš„å†…å®¹ï¼Œä»¥ä¾›å‚è€ƒ</p></blockquote><p>å·¥å…·ï¼šWDK 7+VS2015 æµ‹è¯•å¹³å°ï¼šè™šæ‹Ÿæœº WINDOWS XP</p><span id="more"></span><ul><li>åŒ…å«çš„å¤´æ–‡ä»¶</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ntifs.h&gt;</span>#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ntstrsafe.h&gt;</span></span><br></code></pre></div></td></tr></table></figure><ul><li>å£°æ˜çš„APIå‡½æ•°</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">NTKERNELAPI HANDLE <span class="hljs-title">PsGetProcessInheritedFromUniqueProcessId</span><span class="hljs-params">(IN PEPROCESS Process)</span></span>;<br><span class="hljs-function">NTKERNELAPI  PPEB_EX  <span class="hljs-title">PsGetProcessPeb</span><span class="hljs-params">(PEPROCESS Process)</span></span>;<br><span class="hljs-function">NTKERNELAPI NTSTATUS <span class="hljs-title">PsLookupProcessByProcessId</span><span class="hljs-params">(HANDLE Id, PEPROCESS *Process)</span></span>;<br><span class="hljs-function">NTKERNELAPI NTSTATUS <span class="hljs-title">PsLookupThreadByThreadId</span><span class="hljs-params">(HANDLE Id, PETHREAD *Thread)</span></span>;<br><span class="hljs-function">NTKERNELAPI PEPROCESS <span class="hljs-title">IoThreadToProcess</span><span class="hljs-params">(PETHREAD Thread)</span></span>;<br><span class="hljs-comment">//NTKERNELAPI VOID NTAPI KeAttachProcess(PEPROCESS Process);</span><br><span class="hljs-comment">//NTKERNELAPI VOID NTAPI KeDetachProcess();</span><br><span class="hljs-comment">//NTKERNELAPI VOID NTAPI KeStackAttachProcess(PEPROCESS Process, PKAPC_STATE ApcState);</span><br><span class="hljs-comment">//NTKERNELAPI VOID NTAPI KeUnstackDetachProcess(PKAPC_STATE ApcState);</span><br></code></pre></div></td></tr></table></figure><ul><li>å› ä¸ºè¦é€šè¿‡ <code>PEPROCESS</code> æ¥è·å–è¿›ç¨‹å’Œæ¨¡å—ï¼Œæ‰€ä»¥è¿˜è¦ç”¨åˆ°å‡ ä¸ªç»“æ„ä½“ï¼Œåœ¨<strong>WinDbg</strong> å¯çœ‹åˆ°ã€‚<br />è¿™é‡Œæ–°å»ºä¸€ä¸ªå¤´æ–‡ä»¶ï¼ŒåŒ…å«äº†PEBç­‰ä¿¡æ¯</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;peb.h&quot;</span></span><br>å¦‚ä¸‹ï¼š<br><span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> once</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;ntifs.h&gt;</span></span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">PEB_LDR_DATA_EX</span></span><br><span class="hljs-class">&#123;</span><br>ULONG Length; <span class="hljs-comment">// +0x00  </span><br>BOOLEAN Initialized; <span class="hljs-comment">// +0x04  </span><br>PVOID SsHandle; <span class="hljs-comment">// +0x08  </span><br>LIST_ENTRY InLoadOrderModuleList; <span class="hljs-comment">// +0x0c </span><br>LIST_ENTRY InMemoryOrderModuleList; <span class="hljs-comment">// +0x14</span><br>LIST_ENTRY InInitializationOrderModuleList;<span class="hljs-comment">// +0x1c  </span><br>&#125;PEB_LDR_DATA_EX, *PPEB_LDR_DATA_EX;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">LDR_DATA_TABLE_ENTRY_EX</span> &#123;</span><br>LIST_ENTRY InLoadOrderLinks;<br>LIST_ENTRY InMemoryOrderLinks;<br>LIST_ENTRY InInitializationOrderLinks;<br>PVOID DllBase;<br>PVOID EntryPoint;<br>ULONG SizeOfImage;<br>UNICODE_STRING FullDllName;<br>UNICODE_STRING BaseDllName;<br>ULONG Flags;<br>USHORT LoadCount;<br>USHORT TlsIndex;<br><span class="hljs-class"><span class="hljs-keyword">union</span> &#123;</span><br>LIST_ENTRY HashLinks;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span><br>PVOID SectionPointer;<br>ULONG CheckSum;<br>&#125;;<br>&#125;;<br><span class="hljs-class"><span class="hljs-keyword">union</span> &#123;</span><br>ULONG TimeDateStamp;<br>PVOID LoadedImports;<br>&#125;;<br>PVOID EntryPointActivationContext;      <br>PVOID PatchInformation;<br>LIST_ENTRY ForwarderLinks;<br>LIST_ENTRY ServiceTagLinks;<br>LIST_ENTRY StaticLinks;<br>PVOID ContextInformation;<br>PVOID OriginalBase;<br>LARGE_INTEGER LoadTime;<br>&#125; LDR_DATA_TABLE_ENTRY_EX, *PLDR_DATA_TABLE_ENTRY_EX;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">CURDIR</span> &#123;</span><br>UNICODE_STRING DosPath;<br>PVOID Handle;<br>&#125;CURDIR, *PCURDIR;<br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">RTL_DRIVE_LETTER_CURDIR</span> &#123;</span><br>USHORT Flags;<br>USHORT Length;<br>ULONG TimeStamp;<br>STRING DosPath;<br>&#125;RTL_DRIVE_LETTER_CURDIR, *PRTL_DRIVE_LETTER_CURDIR;<br><span class="hljs-comment">//è¿›ç¨‹å‚æ•°</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">RTL_USER_PROCESS_PARAMETERS</span>&#123;</span><br>ULONG MaximumLength;<br>ULONG Length;<br>ULONG Flags;<br>ULONG DebugFlags;<br>PVOID ConsoleHandle;<br>ULONG ConsoleFlags;<br>PVOID StandardInput;<br>PVOID StandardOutput;<br>PVOID StandardError;<br>CURDIR CurrentDirectory;<br>UNICODE_STRING DllPath;<br>UNICODE_STRING ImagePathName;<br>UNICODE_STRING CommandLine;<br>PVOID Environment;<br>ULONG StartingX;<br>ULONG StartingY;<br>ULONG CountX;<br>ULONG CountY;<br>ULONG CountCharsX;<br>ULONG CountCharsY;<br>ULONG FillAttribute;<br>ULONG WindowFlags;<br>ULONG ShowWindowFlags;<br>UNICODE_STRING WindowTitle;<br>UNICODE_STRING DesktopInfo;<br>UNICODE_STRING ShellInfo;<br>UNICODE_STRING RuntimeData;<br>RTL_DRIVE_LETTER_CURDIR CurrentDirectores[<span class="hljs-number">32</span>];<br>&#125;RTL_USER_PROCESS_PARAMETERS,*PRTL_USER_PROCESS_PARAMETERS;<br><span class="hljs-comment">//è¿›ç¨‹ç¯å¢ƒå—ï¼ˆå› ä¸ºWindowså†…æ ¸æœ‰ä¸€ä¸ªæœºæ„PEBï¼Œä¸ºäº†ä¸é‡å®šä¹‰ï¼Œæ‰€ä»¥å°±å¦èµ·ä¸€ä¸ªåå­—ï¼‰</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> _<span class="hljs-title">PEB_EX</span> &#123;</span><br>UCHAR InheritedAddressSpace;<br>UCHAR ReadImageFileExecOptions;<br>UCHAR BeingDebugged;<br>UCHAR SpareBool;<br>PVOID Mutant;<br>PVOID ImageBaseAddress;<br>PPEB_LDR_DATA_EX Ldr;<br>PRTL_USER_PROCESS_PARAMETERS  ProcessParameters;<br>UCHAR Reserved4[<span class="hljs-number">104</span>];<br>PVOID Reserved5[<span class="hljs-number">52</span>];<br>PVOID PostProcessInitRoutine;<br>PVOID Reserved7;<br>UCHAR Reserved6[<span class="hljs-number">128</span>];<br>ULONG SessionId;<br>&#125; PEB_EX, *PPEB_EX;<br></code></pre></div></td></tr></table></figure><ul><li>ç”¨äºéå†è¿›ç¨‹å‡½æ•°</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">EnumProcess</span><span class="hljs-params">(PEPROCESS eprocess)</span></span><br><span class="hljs-function"></span>&#123;<br>KAPC_STATE ks;<br><span class="hljs-keyword">if</span> (!<span class="hljs-built_in">MmIsAddressValid</span>(eprocess))<br><span class="hljs-keyword">return</span>;<br><span class="hljs-comment">//è·å– PEBä¿¡æ¯</span><br>PPEB_EX peb = <span class="hljs-built_in">PsGetProcessPeb</span>(eprocess);<br><span class="hljs-keyword">if</span> (!peb)<br><span class="hljs-keyword">return</span>;<br><span class="hljs-comment">//ä¾é™„è¿›ç¨‹!!!!!!!!!!!!!!</span><br><span class="hljs-built_in">KeStackAttachProcess</span>(eprocess, &amp;ks);<br>__try<br>&#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-built_in">PsGetProcessId</span>(eprocess)!=<span class="hljs-number">0</span>)<br>&#123;<br><span class="hljs-comment">//è·å– è¿›ç¨‹å‚æ•°</span><br>PRTL_USER_PROCESS_PARAMETERS rtl_user_process_param = <br>(PRTL_USER_PROCESS_PARAMETERS)peb-&gt;ProcessParameters;<br><span class="hljs-built_in">DbgPrint</span>(<span class="hljs-string">&quot;CommandLine:%wZ\n&quot;</span>, &amp;rtl_user_process_param-&gt;CommandLine);<br><span class="hljs-built_in">DbgPrint</span>(<span class="hljs-string">&quot;ImagePath=%wZ\n&quot;</span>, &amp;rtl_user_process_param-&gt;ImagePathName);<br><span class="hljs-comment">//DbgPrint(&quot;Window Title=%wZ\n&quot;, &amp;rtl_user_process_param-&gt;WindowTitle);</span><br><span class="hljs-built_in">DbgPrint</span>(<span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span>);<br>&#125;<br>&#125;<br>__except (EXCEPTION_EXECUTE_HANDLER)<br>&#123;<br><span class="hljs-comment">//DbgPrint(&quot;Can not Process...&quot;);</span><br>&#125;<br><span class="hljs-comment">//å–æ¶ˆä¾é™„è¿›ç¨‹</span><br><span class="hljs-built_in">KeUnstackDetachProcess</span>(&amp;ks);<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li>éå†æ¨¡å—ï¼Œå¤§ä½“ä¸Šå’Œéå†è¿›ç¨‹ä¸€æ ·ï¼Œä½†ä¹Ÿè¦æ³¨æ„åŒºåˆ«</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">EnumModules</span><span class="hljs-params">(PEPROCESS eprocess)</span></span><br><span class="hljs-function"></span>&#123;<br>KAPC_STATE ks;<br><span class="hljs-keyword">if</span> (!<span class="hljs-built_in">MmIsAddressValid</span>(eprocess))<br><span class="hljs-keyword">return</span>;<br><span class="hljs-comment">//è·å– PEBä¿¡æ¯</span><br>PPEB_EX peb = <span class="hljs-built_in">PsGetProcessPeb</span>(eprocess);<br><span class="hljs-keyword">if</span> (!peb)<br><span class="hljs-keyword">return</span>;<br><span class="hljs-comment">//ä¾é™„è¿›ç¨‹!!!!!!!!!!!!!!</span><br><span class="hljs-built_in">KeStackAttachProcess</span>(eprocess, &amp;ks);<br>__try<br>&#123;<br>PPEB_LDR_DATA_EX peb_LDR_data = (PPEB_LDR_DATA_EX)peb-&gt;Ldr;<br>PLIST_ENTRY list_entry = &amp;peb_LDR_data-&gt;InLoadOrderModuleList;<br><span class="hljs-comment">//å…ˆè·å–ç¬¬ä¸€ä¸ª</span><br>PLIST_ENTRY currentList = list_entry-&gt;Flink;<br><span class="hljs-keyword">while</span> (currentList!=list_entry)<br>&#123;<br>PLDR_DATA_TABLE_ENTRY_EX ldr_data_table_entry =(PLDR_DATA_TABLE_ENTRY_EX)currentList;<br><span class="hljs-built_in">DbgPrint</span>(<span class="hljs-string">&quot;Module Base=%p DllPath=%wZ\n&quot;</span>,ldr_data_table_entry-&gt;DllBase, &amp;ldr_data_table_entry-&gt;FullDllName);<br><span class="hljs-comment">//æŒ‡å‘ä¸‹ä¸€ä¸ª</span><br>currentList = currentList-&gt;Flink;<br>&#125;<br>&#125;<br>__except (EXCEPTION_EXECUTE_HANDLER)<br>&#123;<br><span class="hljs-comment">//DbgPrint(&quot;Can not Modules...&quot;);</span><br>&#125;<br><span class="hljs-comment">//å–æ¶ˆä¾é™„è¿›ç¨‹</span><br><span class="hljs-built_in">KeUnstackDetachProcess</span>(&amp;ks);<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li>è¿™ä¸ªå‡½æ•°æŠŠä¸Šé¢ä¸¤ä¸ªå‡½æ•°æ•´åˆåœ¨ä¸€èµ·äº†</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">VOID <span class="hljs-title">EnumProcessModuleInformations</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">//ç¬¬ä¸€ä¸ªè¿›ç¨‹ç¯å¢ƒå—</span><br>PEPROCESS eprocess=<span class="hljs-built_in">PsGetCurrentProcess</span>();<br>PEPROCESS eprocess_first = eprocess;<br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>&#123;<br><span class="hljs-comment">//è·å–è¿›ç¨‹</span><br><span class="hljs-built_in">EnumProcess</span>(eprocess);<br><span class="hljs-comment">//ä¸‹ä¸€ä¸ªè¿›ç¨‹ï¼Œæˆ‘è·å–çš„æ˜¯WinXPçš„ EPROCESS !</span><br>eprocess = (PEPROCESS)(*(ULONG*)((ULONG)eprocess + <span class="hljs-number">0x88</span>) - <span class="hljs-number">0x88</span>);<br><span class="hljs-keyword">if</span> (eprocess == eprocess_first)&#123;<span class="hljs-keyword">break</span>;&#125;<br>&#125;<br>eprocess= eprocess_first;<br><span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>&#123;<br><span class="hljs-comment">//è·å–æ¨¡å—</span><br><span class="hljs-built_in">EnumModules</span>(eprocess);<br><span class="hljs-comment">//ä¸‹ä¸€ä¸ªè¿›ç¨‹</span><br>eprocess = (PEPROCESS)(*(ULONG*)((ULONG)eprocess + <span class="hljs-number">0x88</span>) - <span class="hljs-number">0x88</span>);<br><span class="hljs-keyword">if</span> (eprocess == eprocess_first)&#123;<span class="hljs-keyword">break</span>;&#125;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li>å¸è½½å‡½æ•°å¾ˆç®€å•</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">VOID <span class="hljs-title">unload</span><span class="hljs-params">(PDRIVER_OBJECT p)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">DbgPrint</span>(<span class="hljs-string">&quot;UnloadDriver...&quot;</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li>é©±åŠ¨å…¥å£å‡½æ•°</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">NTSTATUS <span class="hljs-title">DriverEntry</span><span class="hljs-params">(PDRIVER_OBJECT pDriver_Obj, PUNICODE_STRING pRegisterPath)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">DbgPrint</span>(<span class="hljs-string">&quot;DriverEntry...&quot;</span>);<br>pDriver_Obj-&gt;DriverUnload = unload;<br><span class="hljs-built_in">DbgPrint</span>(<span class="hljs-string">&quot;DriverName:%wZ RegisterPath:%wZ \n &quot;</span>, &amp;pDriver_Obj-&gt;DriverName,pRegisterPath);<br><span class="hljs-comment">//è¿™é‡Œè°ƒç”¨</span><br><span class="hljs-built_in">EnumProcessModuleInformations</span>();<br><span class="hljs-keyword">return</span> STATUS_SUCCESS;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é˜¿é‡Œäº‘+Github Pageæ”¯æŒHTTPS</title>
    <link href="/github-page-https/"/>
    <url>/github-page-https/</url>
    
    <content type="html"><![CDATA[<p>æ­£å¸¸æ¥è®²åœ¨é˜¿é‡Œäº‘æ³¨å†Œäº†ä¸€ä¸ªåŸŸåï¼Œé»˜è®¤æ—¶æ”¯æŒHTTPï¼Œè¦æƒ³è®©è‡ªå·±çš„åŸŸååœ¨<code>Github Page</code>æ”¯æŒHTTPSï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ <code>Cloudflare</code></p><span id="more"></span><h3 id="cloudflare"><a class="markdownIt-Anchor" href="#cloudflare"></a> Cloudflare</h3><blockquote><p>Cloudflareæ˜¯ä¸€å®¶ç¾å›½çš„è·¨å›½ç§‘æŠ€ä¼ä¸šï¼Œæ€»éƒ¨ä½äºæ—§é‡‘å±±ï¼Œåœ¨è‹±å›½ä¼¦æ•¦äº¦è®¾æœ‰åŠäº‹å¤„ã€‚Cloudflareä»¥å‘å®¢æˆ·æä¾›ç½‘ç«™å®‰å…¨ç®¡ç†ã€æ€§èƒ½ä¼˜åŒ–åŠç›¸å…³çš„æŠ€æœ¯æ”¯æŒä¸ºä¸»è¦ä¸šåŠ¡ã€‚é€šè¿‡åŸºäºåå‘ä»£ç†çš„å†…å®¹ä¼ é€’ç½‘ç»œ(ContentDeliveryNetwork,CDN)åŠåˆ†å¸ƒå¼åŸŸåè§£ææœåŠ¡(DistributedDomainNameServer)ï¼ŒCloudflareå¯ä»¥å¸®åŠ©å—ä¿æŠ¤ç«™ç‚¹æŠµå¾¡åŒ…æ‹¬æ‹’ç»æœåŠ¡æ”»å‡»(DenialofService)åœ¨å†…çš„å¤§å¤šæ•°ç½‘ç»œæ”»å‡»ï¼Œç¡®ä¿è¯¥ç½‘ç«™é•¿æœŸåœ¨çº¿ï¼ŒåŒæ—¶æå‡ç½‘ç«™çš„æ€§èƒ½ã€è®¿é—®é€Ÿåº¦ä»¥æ”¹å–„è®¿å®¢ä½“éªŒ</p></blockquote><h4 id="cloudflareé…ç½®"><a class="markdownIt-Anchor" href="#cloudflareé…ç½®"></a> Cloudflareé…ç½®</h4><p>é¦–å…ˆéœ€è¦ç™»å½• <a href="https://www.cloudflare.com/">å®˜ç½‘</a> æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œæ–°æ³¨å†Œè´¦æˆ·ç™»å½•åå¼¹å‡ºå¯¹è¯æ¡†è¦æ±‚æ·»åŠ ä¸€ä¸ªç«™ç‚¹ã€‚å¯ä»¥æ˜¯ä»é˜¿é‡Œäº‘æ³¨å†Œçš„åŸŸåã€‚<br /><img src="/uploads/images/hexo/file_001.png" alt="img" /></p><p>è¿™é‡Œæ·»åŠ ä¸€æ¡DNSè®°å½•ã€‚æˆ‘åœ¨é˜¿é‡Œäº‘åŸŸåè§£æä¸­æ·»åŠ äº†CNAMEè®°å½•ï¼ŒæŒ‡å‘githubæœåŠ¡å™¨ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä¹Ÿç›´æ¥æ·»åŠ ä¸€æ¡CNAME DNSè®°å½•ã€‚</p><blockquote><p>åœ¨â€œDNSè®°å½•â€ä¸‹æœä¸Šï¼Œä»ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹© <strong>CNAME</strong>ã€‚<br /><strong>Name</strong> è¾“å…¥ <strong>@</strong><br /><strong>Domain name</strong> è¾“å…¥ <strong>åŸŸå</strong>ï¼Œå¦‚ <a href="http://josexy.github.io">josexy.github.io</a><br />å°†å…¶ä¿ç•™ä¸º è‡ªåŠ¨TTL(<strong>Automatic TTL</strong>)ã€‚<br />ç‚¹å‡»<strong>æ©™è‰²äº‘</strong>å°†å…¶å˜æˆ<strong>ç°è‰²</strong>ã€‚<br />ç‚¹å‡»â€œæ·»åŠ è®°å½•â€(<strong>Add Record</strong>)ã€‚</p></blockquote><p>ä¹‹åæˆ‘ä»¬è¿˜éœ€è¦ä¿®æ”¹åŸåŸŸåçš„DNSæœåŠ¡å™¨ä¸ºCloudflareæä¾›çš„DNSæœåŠ¡å™¨ã€‚è¦æ ¹æ®è‡ªå·±çš„æ¥è®¾ç½®ã€‚<br /><img src="/uploads/images/hexo/file_003.png" alt="img" /></p><p>ä¿®æ”¹Cloudflareæä¾›çš„DNSæœåŠ¡å™¨ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°å˜æˆäº†è¿™æ ·å­ã€‚<br /><img src="/uploads/images/hexo/file_004.png" alt="img" /></p><p>æœ€åçœ‹åˆ°è¿™ä¸ªè¡¨ç¤ºä¸€åˆ‡æ­£å¸¸<br /><img src="/uploads/images/hexo/file_009.png" alt="img" /></p><h4 id="ssl"><a class="markdownIt-Anchor" href="#ssl"></a> SSL</h4><p>é€‰æ‹© <code>Crypto</code> ï¼Œä¿®æ”¹ <strong>SSL</strong> ä¸º <strong>Flexible</strong>(è¿™é‡Œæˆ‘å»ºè®®é€‰æ‹© <strong>Full/Full(strict)</strong>ï¼Œä¹Ÿæ˜¯ä¸ºäº†é¿å… <strong>ERR_TOO_MANY_REDIRECTS</strong> )ï¼Œè¡¨ç¤ºæ”¯æŒHTTPS<br /><img src="/uploads/images/hexo/file_005.png" alt="img" /></p><h4 id="é‡å®šå‘"><a class="markdownIt-Anchor" href="#é‡å®šå‘"></a> é‡å®šå‘</h4><p>é€‰æ‹© <code>Page Rules</code> ,æ·»åŠ è§„åˆ™ï¼Œè·³è½¬åˆ°HTTPSã€‚æ¯”å¦‚è®¿é—®æœ‰äººè®¿é—® <code>http://josephxy.com</code> ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å¼ºåˆ¶è·³è½¬ï¼ˆé‡å®šå‘ï¼‰åˆ° <code>https://josephxy.com</code>ã€‚</p><p>è¿™é‡Œæ·»åŠ äº†ä¸¤æ¡è§„åˆ™<br /><img src="/uploads/images/hexo/file_006.png" alt="img" /></p><p><img src="/uploads/images/hexo/file_007.png" alt="img" /></p><p><img src="/uploads/images/hexo/file_008.png" alt="img" /></p><p>æœ€åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å°ç»¿é”ï¼Œè¡¨ç¤ºæ”¯æŒHTTPS ğŸ˜ƒ<br /><img src="/uploads/images/hexo/file_010.png" alt="img" /></p><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><blockquote><p>å‚è€ƒæ–‡ç« ï¼š</p><ol><li><a href="https://blog.cloudflare.com/secure-and-fast-github-pages-with-cloudflare/">https://blog.cloudflare.com/secure-and-fast-github-pages-with-cloudflare/</a></li><li><a href="https://docs.clickfunnels.com/custom-domains/dns-hosts/how-to-add-your-cname-record-to-cloudflare">https://docs.clickfunnels.com/custom-domains/dns-hosts/how-to-add-your-cname-record-to-cloudflare</a></li></ol></blockquote><p><strong><font color=red>æ³¨æ„ï¼š å¯ä»¥åœ¨GitHub Pages [Setting] ä¸­ Enforce HTTPS</font></strong></p>]]></content>
    
    
    <categories>
      
      <category>Github</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Github</tag>
      
      <tag>Hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ ‘è“æ´¾å®‰è£…Metasploitæ¡†æ¶</title>
    <link href="/rasppi-meatsploit/"/>
    <url>/rasppi-meatsploit/</url>
    
    <content type="html"><![CDATA[<p>Metasploitæ¡†æ¶åŒ…å«çš„å¤§é‡çš„æ¨¡å—ã€æ’ä»¶ï¼Œå…¶å¼ºå¤§çš„åŠŸèƒ½ä½¿å¾—æ¸—é€å˜å¾—ä¸åœ¨æ˜¯æƒ³è±¡ä¸­çš„é‚£ä¹ˆéš¾ã€‚Kali Linuxæœ¬èº«å°±è‡ªå¸¦äº†metasploitæ¡†æ¶ï¼Œå½“ç„¶äº†ï¼Œæœ‰å…´è¶£çš„å¯ä»¥åœ¨æ ‘è“æ´¾ä¸Šå®‰è£… <a href="https://www.offensive-security.com/kali-linux-arm-images/">kali Linux</a> ã€‚ä¸è¿‡æœ¬æ–‡çš„é‡ç‚¹æ˜¯åœ¨raspbianä¸Šè¿›è¡Œå®‰è£…</p><span id="more"></span><h3 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h3><p>é¦–å…ˆå‘¢ï¼Œå½“ç„¶æ˜¯è¦è¿æ¥åˆ°æ ‘è“æ´¾äº†ã€‚<br />æ¥ç€æˆ‘ä»¬æŠŠä»¥ä¸‹æ›´æ–°æºè¿½åŠ åˆ° sources.list</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">deb http:<span class="hljs-regexp">//mi</span>rrors.ustc.edu.cn<span class="hljs-regexp">/raspbian/</span>raspbian/ stretch main contrib non-free rpi<br><span class="hljs-comment">#deb-src http://mirrors.ustc.edu.cn/raspbian/raspbian/ stretch main contrib non-free rpi</span><br><span class="hljs-comment">##### æ‰€éœ€çš„æœ‰å…³kali linuxæ›´æ–°æº</span><br>deb http:<span class="hljs-regexp">//</span>http.kali.org/kali kali-rolling main non-free contrib<br>deb-src http:<span class="hljs-regexp">//</span>http.kali.org/kali kali-rolling main non-free contrib<br></code></pre></div></td></tr></table></figure><p>å† <code>sudo apt-get update</code> ï¼Œå¦‚æœåœ¨è¿™æ—¶å‡ºç°äº†ç±»ä¼¼ä¸€ä¸‹çš„é”™è¯¯ï¼Œé‚£ä¹ˆæ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰æˆæƒåœ¨raspbianç³»ç»Ÿä¸Šä½¿ç”¨kaliçš„æ›´æ–°æº</p><blockquote><p>æ­£åœ¨è¯»å–è½¯ä»¶åŒ…åˆ—è¡¨â€¦ å®Œæˆ<br />W: GPG é”™è¯¯ï¼š<a href="http://kali.mirror.garr.it/mirrors/kali">http://kali.mirror.garr.it/mirrors/kali</a> kali-rolling InRelease: ç”±äºæ²¡æœ‰å…¬é’¥ï¼Œæ— æ³•éªŒè¯ä¸‹åˆ—ç­¾åï¼š NO_PUBKEY <strong>ED444FF07D8D0BF6</strong><br />W: ä»“åº“ â€œ<a href="http://http.kali.org/kali">http://http.kali.org/kali</a> kali-rolling InReleaseâ€ æ²¡æœ‰æ•°å­—ç­¾åã€‚<br />N: æ— æ³•è®¤è¯æ¥è‡ªè¯¥æºçš„æ•°æ®ï¼Œæ‰€ä»¥ä½¿ç”¨å®ƒä¼šå¸¦æ¥æ½œåœ¨é£é™©ã€‚<br />N: å‚è§ apt-secure(8) æ‰‹å†Œä»¥äº†è§£ä»“åº“åˆ›å»ºå’Œç”¨æˆ·é…ç½®æ–¹é¢çš„ç»†èŠ‚</p><p><strong>è§£å†³æ–¹æ³•ï¼š</strong><br /><strong>gpg --keyserver <a href="http://pgp.mit.edu">pgp.mit.edu</a> --recv-keys ED444FF07D8D0BF6</strong><br />gpg -a --export <strong>ED444FF07D8D0BF6</strong> | sudo apt-key add -</p></blockquote><p>å…¶ä¸­ --keyserver åé¢çš„ <a href="http://pgp.mit.edu">pgp.mit.edu</a> å¯æ¢æˆï¼š</p><blockquote><p><a href="http://keyserver.ubuntu.com">keyserver.ubuntu.com</a><br /><a href="http://pgp.mit.edu">pgp.mit.edu</a><br /><a href="http://subkeys.pgp.net">subkeys.pgp.net</a><br /><a href="http://www.gpg-keyserver.de">www.gpg-keyserver.de</a></p></blockquote><p>ç„¶ååœ¨æ‰§è¡Œ <code>sudo apt-get update</code></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å®‰è£…metasploitæ¡†æ¶äº†</p><blockquote><p>sudo apt-get install metasploit-framework</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>RaspberryPi</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>æ ‘è“æ´¾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Qt5è°ƒç”¨QFtpå‡½æ•°</title>
    <link href="/linux-qt-qftp/"/>
    <url>/linux-qt-qftp/</url>
    
    <content type="html"><![CDATA[<p>ä¸çŸ¥æ€ä¹ˆ,åœ¨Qt5ä»¥ä¸Šç‰ˆæœ¬æ²¡æœ‰äº†QFtp,ä¸è¿‡å¯ä»¥ç”¨QNetworkAccessManager.æˆ‘åœ¨ç½‘ä¸Šä¹Ÿæ‰¾äº†äº›èµ„æ–™,æœ€åè¿˜æ˜¯å†³å®šå…ˆæš‚æ—¶ç”¨QFtpâ€¦<br />è¿™ç¯‡åšå®¢è®²è§£çš„å¾ˆè¯¦ç»†<br /><a href="http://blog.csdn.net/liang19890820/article/details/53304049">http://blog.csdn.net/liang19890820/article/details/53304049</a></p><span id="more"></span><h4 id="ä¸‹è½½qftpæºç "><a class="markdownIt-Anchor" href="#ä¸‹è½½qftpæºç "></a> ä¸‹è½½QFtpæºç </h4><blockquote><p>git clone <a href="https://github.com/qt/qtftp.git">https://github.com/qt/qtftp.git</a></p></blockquote><h4 id="ä¿®æ”¹é…ç½®"><a class="markdownIt-Anchor" href="#ä¿®æ”¹é…ç½®"></a> ä¿®æ”¹é…ç½®</h4><ul><li><p>è¿›å…¥qtftp/src/qftp,æœ‰ä¸ª</p><p><a href="http://qftp.pro">qftp.pro</a></p><p>,ä¿®æ”¹ä¸º</p><blockquote><p>CONFIG += static #ç”Ÿæˆ .aé™æ€é“¾æ¥åº“<br />CONFIG += shared #ç”Ÿæˆ.soåŠ¨æ€é“¾æ¥åº“</p></blockquote></li></ul><h4 id="ç¼–è¯‘"><a class="markdownIt-Anchor" href="#ç¼–è¯‘"></a> ç¼–è¯‘</h4><p>è¿›å…¥qtftpæ ¹ç›®å½•,ç¼–è¯‘ç”Ÿæˆåº“æ–‡ä»¶</p><blockquote><p>cd qtftp<br />qmake<br />make</p></blockquote><p>ç„¶ååœ¨ qtftp/lib ä¸‹ç”Ÿæˆäº†ä¸€äº›ç›®å½•æ–‡ä»¶,å¤§æ¦‚æ˜¯è¿™æ ·</p><blockquote><p>cmake/ <a href="http://libQt5Ftp.la">libQt5Ftp.la</a> <a href="http://libQt5Ftp.so">libQt5Ftp.so</a> <strong>libQt5Ftp.so.5.0</strong> pkgconfig/<br />libQt5Ftp.a libQt5Ftp.prl libQt5Ftp.so.5 libQt5Ftp.so.5.0.0</p></blockquote><h4 id="æ•´åˆæ–‡ä»¶"><a class="markdownIt-Anchor" href="#æ•´åˆæ–‡ä»¶"></a> æ•´åˆæ–‡ä»¶</h4><p>æŠŠè¿™äº›é›¶æ•£çš„æ–‡ä»¶æ•´åˆæˆä¸€ä¸ªä¾¿äºè°ƒç”¨çš„åº“,è¿˜æ˜¯éå¸¸æœ‰å¿…è¦çš„<br />è¿™é‡Œæˆ‘åˆ›å»ºä¸€ä¸ª <strong>libqtftp</strong> æ–‡ä»¶å¤¹,ç”¨æ¥å­˜æ”¾æ‰€éœ€è¦çš„æ–‡ä»¶</p><p>ç„¶ååœ¨åˆšæ‰åœ¨ <strong>qtftp</strong> ç›®å½•ä¸‹çš„ <code>lib</code> , <code>include</code> , <code>src</code><br />æ–‡ä»¶å¤¹å¤åˆ¶åˆ° libqtftp ç›®å½•</p><ul><li>è¿›å…¥ include/QtFtp æ–‡ä»¶å¤¹,åˆ é™¤ headers.pri,åŒæ—¶æŠŠ src æ–‡ä»¶å¤¹å†…:<br />qftp.cpp<br />qftp.h<br />qurlinfo.cpp<br />qurlinfo.h<br />.mocæ–‡ä»¶å¤¹å†…<strong>3ä¸ªæ–‡ä»¶</strong>å¤åˆ¶åˆ°<strong>ä¸Šä¸€å±‚æ–‡ä»¶å¤¹</strong> (éšè—æ–‡ä»¶å¤¹)<br />.obj + .pch (éšè—æ–‡ä»¶å¤¹)</li></ul><p>ä¸€å¹¶å¤åˆ¶åˆ° <strong>include/QtFtp</strong> æ–‡ä»¶å¤¹,è¿™æ—¶å¯åˆ é™¤ <strong>src</strong> æ–‡ä»¶å¤¹</p><ul><li>ä¿®æ”¹ <strong>moc_qftp.cpp</strong> ä»£ç  <code>#include &quot;../qftp.h&quot;</code> ä¸º <code>#include &quot;qftp.h&quot;</code></li><li>ä¸ºäº†ä¾¿äºç®¡ç†,åœ¨ <strong>libqtftp</strong> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª .priæ–‡ä»¶:</li></ul><p>qtftp.pri:</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-comment">#QT += network</span><br>HEADERS += $<span class="hljs-variable">$PWD</span><span class="hljs-regexp">/include/</span>QtFtp/\<br>$<span class="hljs-variable">$PWD</span><span class="hljs-regexp">/include/</span>QtFtp/QFtp\<br>$<span class="hljs-variable">$PWD</span><span class="hljs-regexp">/include/</span>QtFtp/QUrlInfo\<br>$<span class="hljs-variable">$PWD</span><span class="hljs-regexp">/include/</span>QtFtp/QtFtpVersion<br>SOURCES += $<span class="hljs-variable">$PWD</span><span class="hljs-regexp">/include/</span>QtFtp/qftp.cpp\<br>$<span class="hljs-variable">$PWD</span><span class="hljs-regexp">/include/</span>QtFtp/qurlinfo.cpp<br>INCLUDEPATH += $<span class="hljs-variable">$PWD</span><span class="hljs-regexp">/include/</span><br></code></pre></div></td></tr></table></figure><h4 id="å¼•ç”¨åº“"><a class="markdownIt-Anchor" href="#å¼•ç”¨åº“"></a> å¼•ç”¨åº“</h4><p>é¦–å…ˆ,æ–°å»ºä¸€ä¸ªQté¡¹ç›®,æŠŠ <strong>libqtftp</strong> æ–‡ä»¶å¤¹æ”¾åˆ° Qté¡¹ç›®ä¸‹.<br />ç„¶ååœ¨ä¿®æ”¹ <a href="http://xn--i0yn92e.pro">é¡¹ç›®.pro</a> æ–‡ä»¶</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">QT       += core gui network<br><span class="hljs-function"><span class="hljs-title">greaterThan</span><span class="hljs-params">(QT_MAJOR_VERSION, <span class="hljs-number">4</span>)</span></span>: QT += widgets<br>TARGET = MyFtp<br>TEMPLATE = app<br><span class="hljs-function"><span class="hljs-title">include</span><span class="hljs-params">($<span class="hljs-variable">$PWD</span>/libqtftp/qtftp.pri)</span></span><br>SOURCES += <span class="hljs-selector-tag">main</span>.cpp\<br>        mainwindow<span class="hljs-selector-class">.cpp</span><br>HEADERS  += mainwindow<span class="hljs-selector-class">.h</span><br>FORMS    += mainwindow<span class="hljs-selector-class">.ui</span><br>INCLUDEPATH += $<span class="hljs-variable">$PWD</span>/libqtftp/include/<br>LIBS += -L$<span class="hljs-variable">$PWD</span>/libqtftp/lib/ -lQt5Ftp<br></code></pre></div></td></tr></table></figure><p>è¦æ³¨æ„é‚£ä¸ªé…ç½®:</p><ul><li><code>QT += network</code></li><li><code>include($$PWD/libqtftp/qtftp.pri)</code></li><li><code>INCLUDEPATH += $$PWD/libqtftp/include/</code></li><li><code>LIBS += -L$$PWD/libqtftp/lib/ -lQt5Ftp</code><br />é“¾æ¥<strong><a href="http://libQt5Ftp.so">libQt5Ftp.so</a></strong>åŠ¨æ€é“¾æ¥åº“</li></ul><p>ä¹‹å é‡æ–°æ„å»ºé¡¹ç›®</p><h4 id="ä¾‹å­"><a class="markdownIt-Anchor" href="#ä¾‹å­"></a> ä¾‹å­</h4><p>ä½¿ç”¨å‰éœ€è¦åŒ…å«å¤´æ–‡ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&quot;QtFtp/QFtp&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QtFtp/QUrlInfo&gt;</span></span><br></code></pre></div></td></tr></table></figure><p>å¦‚ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">// do something ...</span><br>QFtp * ftp =<span class="hljs-keyword">new</span> <span class="hljs-built_in">QFtp</span>(<span class="hljs-keyword">this</span>);<br><span class="hljs-built_in">connect</span>(ftp,&amp;QFtp::listInfo,<span class="hljs-keyword">this</span>,[=](<span class="hljs-keyword">const</span> QUrlInfo u)&#123;<br><span class="hljs-comment">// do something ...</span><br>    &#125;);<br>    <span class="hljs-built_in">connect</span>(ftp,&amp;QFtp::dataTransferProgress,[=](qint64 _t1, qint64 _t2)&#123;<br><span class="hljs-comment">// do something ...</span><br>    &#125;);<br>    <span class="hljs-built_in">connect</span>(ftp,&amp;QFtp::readyRead,<span class="hljs-keyword">this</span>,[=]()&#123;<br><span class="hljs-comment">// do something ...</span><br>    &#125;);<br>    <span class="hljs-keyword">int</span> id=ftp-&gt;<span class="hljs-built_in">connectToHost</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    ftp-&gt;<span class="hljs-built_in">login</span>(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>);<br>    ftp-&gt;<span class="hljs-built_in">cd</span>(<span class="hljs-string">&quot;&quot;</span>);<br>    ftp-&gt;<span class="hljs-built_in">list</span>();<br>ftp-&gt;<span class="hljs-built_in">close</span>();<br><span class="hljs-comment">// do something ...</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Qt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Qt&amp;QZXingè¯†åˆ«äºŒç»´ç </title>
    <link href="/linux-qzxing/"/>
    <url>/linux-qzxing/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h3><p>æœ€è¿‘åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€ç¯‡åšå®¢,è®²çš„æ˜¯äºŒç»´ç çš„ç”Ÿæˆå’Œè¯†åˆ«</p><span id="more"></span><p>å€Ÿç”¨ä¸€ä¸‹</p><blockquote><p>ZXing<br />ZXingæ˜¯ä¸€ä¸ªå¼€æ”¾æºç çš„ï¼Œç”¨Javaå®ç°çš„å¤šç§æ ¼å¼çš„1D/2Dæ¡ç å›¾åƒå¤„ç†åº“ï¼ŒåŒ…å«äº†è”ç³»åˆ°å…¶ä»–è¯­è¨€çš„ç«¯å£ã€‚<br />ç½‘å€ï¼š<a href="https://code.google.com/p/zxing">https://code.google.com/p/zxing</a>.</p><p>Libqrencode<br />Libqrencode(QRencode)æ˜¯ä¸€ä¸ªç”¨Cè¯­è¨€ç¼–å†™çš„ç”¨æ¥è§£æäºŒç»´æ¡å½¢ç (QR Code)çš„ç¨‹åºåº“ï¼ŒLibqrencodeé€šè¿‡æ‰‹æœºçš„CCDæ‘„åƒå¤´æ¥æ‰«æäºŒç»´æ¡å½¢ç ã€‚äºŒç»´ç å®¹é‡å¯è¾¾7000ä¸ªæ•°å­—æˆ–4000ä¸ªå­—ç¬¦ï¼Œæ˜¯éå¸¸å¼ºå¤§çš„ã€‚<br />ç½‘å€ï¼š<a href="http://fukuchi.org/works/qrencode/">http://fukuchi.org/works/qrencode/</a>.</p><p>ZBar<br />ZBaræ˜¯æ¬¾æ¡Œé¢ç”µè„‘ç”¨æ¡å½¢ç /äºŒç»´ç æ‰«æå·¥å…·ï¼Œæ”¯æŒæ‘„åƒå¤´åŠå›¾ç‰‡æ‰«æï¼Œæ”¯æŒå¤šå¹³å°åŒ…æ‹¬iPhoneæ‰‹æœºã€‚åŒæ—¶ ZBaræä¾›äº†äºŒç»´ç æ‰«æçš„APIå¼€å‘åŒ…ã€‚<br />ç½‘å€ï¼š<a href="http://zbar.sourceforge.net">http://zbar.sourceforge.net</a>.<br />æ›´å¤šå‚è€ƒï¼š<a href="http://sourceforge.net/apps/mediawiki/zbar/index.php">http://sourceforge.net/apps/mediawiki/zbar/index.php</a>.</p><p>Open Source QR Code Library<br />äºŒç»´ç ç¼–ç /è§£ç çš„Javaåº“ï¼ˆJ2SE, J2ME MIDP2.0/CLDC1.0ï¼‰ã€‚<br />ç½‘å€ï¼š<a href="http://qrcode.sourceforge.jp/index.html.en">http://qrcode.sourceforge.jp/index.html.en</a>.</p><p>QZXing<br />QtåŒ…è£…ZXingçš„è§£ç åº“ã€‚<br />ç½‘å€ï¼š<a href="http://sourceforge.net/projects/qzxing">http://sourceforge.net/projects/qzxing</a>.<br />æ›´å¤šå‚è€ƒï¼š<a href="https://projects.developer.nokia.com/QZXing">https://projects.developer.nokia.com/QZXing</a>.</p></blockquote><p>ç„¶è€Œæœ¬äººèƒ½åŠ›æœ‰é™,è¿™é‡Œåªé€‰å–äº† <strong>QZXing</strong> è§£ç åº“,ä»¥åæœ‰æ—¶é—´åœ¨æ…¢æ…¢ç¢ç£¨â€¦</p><p>example:<br /><img src="/uploads/images/file4_qt/qr.png" alt="img" /></p><h3 id="qzxing"><a class="markdownIt-Anchor" href="#qzxing"></a> QZXing</h3><p>é¦–å…ˆåˆ°githubè·å–åˆ°æºç </p><blockquote><p>git clone <a href="https://github.com/ftylitak/qzxing.git">https://github.com/ftylitak/qzxing.git</a></p></blockquote><p>å½“ç„¶ä¹Ÿå¯ä»¥ä¸‹zipå‹ç¼©åŒ…</p><h3 id="how-to-include"><a class="markdownIt-Anchor" href="#how-to-include"></a> How to include</h3><p>qzxingä¸Šè®²çš„è¿˜æ¯”è¾ƒæ¸…æ¥šâ€¦æ€ä¹ˆä½¿ç”¨<img src="/uploads/images/file4_qt/qt1.png" alt="img" /></p><ul><li><p>æŠŠQZXingç›®å½•ç›´æ¥å¤åˆ¶åˆ°é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹,å¹¶ä¸”åœ¨é¡¹ç›®çš„ .pro ä¸­åŠ å…¥ <code>include(../../src/QZXing.pri)</code></p></li><li><p>æˆ–è€…æŠŠæºç ç¼–è¯‘æˆåŠ¨æ€åº“(dynamic library)</p><blockquote><p>qmake src/QZXing.pro<br />make</p></blockquote></li></ul><h3 id="ä½¿ç”¨"><a class="markdownIt-Anchor" href="#ä½¿ç”¨"></a> ä½¿ç”¨</h3><p><img src="/uploads/images/file4_qt/qt2.png" alt="img" /></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;widget.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;ui_widget.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QZXing.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QPixmap&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QDebug&gt;</span></span><br>Widget::<span class="hljs-built_in">Widget</span>(QWidget *parent) :<br>    <span class="hljs-built_in">QWidget</span>(parent),<br>    <span class="hljs-built_in">ui</span>(<span class="hljs-keyword">new</span> Ui::Widget)&#123;<br>    ui-&gt;<span class="hljs-built_in">setupUi</span>(<span class="hljs-keyword">this</span>);<br>&#125;<br>Widget::~<span class="hljs-built_in">Widget</span>()&#123;<br>    <span class="hljs-keyword">delete</span> ui;<br>&#125;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FILE_PATH <span class="hljs-meta-string">&quot;/root/Desktop/l.png&quot;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::on_pushButton_clicked</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-function">QPixmap <span class="hljs-title">pixmap</span><span class="hljs-params">(FILE_PATH)</span></span>;<br>    ui-&gt;label-&gt;<span class="hljs-built_in">setPixmap</span>(pixmap.<span class="hljs-built_in">scaled</span>(ui-&gt;label-&gt;<span class="hljs-built_in">size</span>()));<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::on_pushButton_2_clicked</span><span class="hljs-params">()</span></span>&#123;<br>    QZXing *decoder=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QZXing</span>(<span class="hljs-keyword">this</span>);<br>    <span class="hljs-comment">//è®¾ç½®è§£ç æ ¼å¼</span><br>    decoder-&gt;<span class="hljs-built_in">setDecoder</span>(QZXing::DecoderFormat_QR_CODE);<br>    <span class="hljs-comment">//start decode</span><br>    QString str= decoder-&gt;<span class="hljs-built_in">decodeImage</span>(ui-&gt;label-&gt;<span class="hljs-built_in">pixmap</span>()-&gt;<span class="hljs-built_in">toImage</span>());<br>    <span class="hljs-keyword">if</span> (!str.<span class="hljs-built_in">isEmpty</span>())&#123;<br>        ui-&gt;textEdit-&gt;<span class="hljs-built_in">setText</span>(str);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        ui-&gt;textEdit-&gt;<span class="hljs-built_in">setText</span>(<span class="hljs-string">&quot;Failed!!&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å°¾"><a class="markdownIt-Anchor" href="#å°¾"></a> å°¾</h3><p>å½“ç„¶,æ„Ÿå…´è¶£çš„å¯ä»¥å»çœ‹æºç æœ‰è§£ç å°±æœ‰ç¼–ç ,ç½‘ä¸Šæœ‰å¾ˆå¤šåº“å¯ä»¥ç”¨,ä¹Ÿå¯ä»¥è‡ªå·±å†™ä¸€ä¸ªå‡ºæ¥â€¦ä¸è¿‡è¿™è¦æŠ€æœ¯åˆ°å®¶â€¦ä¸è¿‡ç›®å‰æˆ‘æ­£åœ¨å­¦ä¹ ä½¿ç”¨ libqrencode ,å¯ä»¥åˆ°å®˜ç½‘ç§ç§https://fukuchi.org/works/qrencode/</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Qt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Qtè¿›ç¨‹é—´é€šä¿¡</title>
    <link href="/linux-qt-process/"/>
    <url>/linux-qt-process/</url>
    
    <content type="html"><![CDATA[<p>Qtä¸­å®ç°<strong>è¿›ç¨‹é—´é€šä¿¡</strong>çš„æ–¹æ³•è¯¸å¤š,è¿™é‡Œè®²è§£æ¯”è¾ƒç®€å•çš„å…±äº«å†…å­˜ç±»<strong>QSharedMemory</strong>åœ¨è¿™ä¹‹å‰,å…ˆæ¥çœ‹çœ‹è¿™ä¸ªç±»,å…¶å®å‡½æ•°ä¸æ˜¯å¾ˆå¤š,è¯¦ç»†èµ„æ–™åˆ°å®˜æ–¹æ–‡æ¡£æŸ¥çœ‹</p><span id="more"></span><p>æ¼”ç¤º<br /><img src="/uploads/images/file4_qt/qt0.gif" alt="img" /></p><p>ä¸‹é¢ä»£ç æ³¨é‡Šå†™çš„æ¯”è¾ƒæ¸…æ¥šäº†</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QDebug&gt;</span></span><br><span class="hljs-comment">//å†…å­˜å…±äº« æ ‡è¯†ç¬¦</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MEM_KEY <span class="hljs-meta-string">&quot;_sharedMemKey_&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QPixmap&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QBuffer&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PIX_MAP <span class="hljs-meta-string">&quot;test.jpg&quot;</span></span><br>Widget::<span class="hljs-built_in">Widget</span>(QWidget *parent) :<br>    <span class="hljs-built_in">QWidget</span>(parent),<br>    <span class="hljs-built_in">ui</span>(<span class="hljs-keyword">new</span> Ui::Widget)<br>&#123;<br>    ui-&gt;<span class="hljs-built_in">setupUi</span>(<span class="hljs-keyword">this</span>);<br>    <span class="hljs-comment">//è®¾ç½®å†…å­˜æ ‡å¿— key</span><br>    sharedMemory=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QSharedMemory</span>(<span class="hljs-keyword">this</span>);<br>    sharedMemory-&gt;<span class="hljs-built_in">setKey</span>(MEM_KEY);<br>&#125;<br>Widget::~<span class="hljs-built_in">Widget</span>()<br>&#123;<br>    <span class="hljs-keyword">delete</span> ui;<br>&#125;<br><span class="hljs-comment">//è½½å…¥å›¾ç‰‡åˆ°å†…å­˜</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::on_pushButton_clicked</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//å¦‚æœå·²ç»ç»‘å®š,åˆ™åˆ†ç¦»</span><br>    <span class="hljs-keyword">if</span>(sharedMemory-&gt;<span class="hljs-built_in">isAttached</span>())&#123;<br>        sharedMemory-&gt;<span class="hljs-built_in">detach</span>();<br>    &#125;<br>    QPixmap pmp;<br>    pmp.<span class="hljs-built_in">load</span>(PIX_MAP);<br>    ui-&gt;label-&gt;<span class="hljs-built_in">setPixmap</span>(pmp.<span class="hljs-built_in">scaled</span>(ui-&gt;label-&gt;<span class="hljs-built_in">size</span>()));<br>    <span class="hljs-comment">//å›¾åƒçš„æ•°æ®(QPixmap)---&gt; ( QDataStream )--&gt;QBuffer</span><br>    QBuffer tmpBuffer;<br>    <span class="hljs-comment">//æ‰“å¼€ ç¼“å­˜åŒºè®¾å¤‡</span><br>    tmpBuffer.<span class="hljs-built_in">open</span>(QIODevice::ReadWrite);<br>    <span class="hljs-comment">//æ•°æ®æµä¸ç¼“å­˜åŒºå…³è”</span><br>    <span class="hljs-function">QDataStream <span class="hljs-title">dataOutstream</span><span class="hljs-params">(&amp;tmpBuffer)</span></span>;<br>    <span class="hljs-comment">//å›¾åƒæ•°æ®è¾“å…¥åˆ°æ•°æ®æµ</span><br>    dataOutstream&lt;&lt;pmp;<br>    <span class="hljs-comment">//è·å–ç¼“å­˜åŒº(å›¾åƒ)å­—èŠ‚å¤§å°</span><br>    <span class="hljs-keyword">int</span> bufferSize=tmpBuffer.<span class="hljs-built_in">size</span>();<br>    <span class="hljs-comment">//åˆ›å»ºå…±äº«å†…å­˜</span><br>    <span class="hljs-keyword">if</span>(sharedMemory-&gt;<span class="hljs-built_in">create</span>(bufferSize))&#123;<br>        <span class="hljs-comment">//lock</span><br>        sharedMemory-&gt;<span class="hljs-built_in">lock</span>();<br>        <span class="hljs-comment">//memset(sharedMemory-&gt;data(),0,bufferSize);</span><br>        <span class="hljs-comment">//è·å–å›¾åƒæ•°æ®</span><br>        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *datasharedBuffer= tmpBuffer.<span class="hljs-built_in">data</span>().<span class="hljs-built_in">data</span>();<br>        <span class="hljs-comment">//è·å–å…±äº«å†…å­˜åœ°å€</span><br>        <span class="hljs-keyword">char</span> *datasharedMemory=(<span class="hljs-keyword">char</span> *)sharedMemory-&gt;<span class="hljs-built_in">data</span>();<br>        <span class="hljs-comment">//å›¾åƒæ•°æ® æ‹·è´åˆ° å…±äº«å†…å­˜ä¸­</span><br>        <span class="hljs-built_in">memcpy</span>(datasharedMemory,datasharedBuffer,bufferSize);<br>        <span class="hljs-comment">//unlock</span><br>        sharedMemory-&gt;<span class="hljs-built_in">unlock</span>();<br>    &#125;<br>    tmpBuffer.<span class="hljs-built_in">close</span>();<br>&#125;<br><span class="hljs-comment">//ä»å…±äº«å†…å­˜è·å–å›¾åƒæ•°æ®</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::on_pushButton_2_clicked</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">//è¿›ç¨‹ä¸å…±äº«å†…å­˜ç»‘å®š!,,æ³¨æ„è¦è®¾ç½®å¥½æ ‡è¯†ç¬¦ key</span><br>    <span class="hljs-keyword">if</span>(sharedMemory-&gt;<span class="hljs-built_in">attach</span>())&#123;<br>        <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;ok!&quot;</span>;<br>        sharedMemory-&gt;<span class="hljs-built_in">lock</span>();<br>        <span class="hljs-comment">// å›¾åƒçš„æ•°æ®(QPixmap) &lt;--- ( QDataStream ) &lt;--- QBuffer</span><br>        QBuffer buffer;<br>        <span class="hljs-keyword">char</span> *dataSharedMem=(<span class="hljs-keyword">char</span>*)sharedMemory-&gt;<span class="hljs-built_in">data</span>();<br>        <span class="hljs-keyword">int</span> dataSize =sharedMemory-&gt;<span class="hljs-built_in">size</span>();<br>        <span class="hljs-comment">//è®¾ç½®å…±äº«å†…å­˜çš„æ•°æ®åˆ°ç¼“å­˜åŒº</span><br>        buffer.<span class="hljs-built_in">setData</span>(<span class="hljs-built_in">QByteArray</span>(dataSharedMem,dataSize));<br>        QPixmap pmp;<br>        buffer.<span class="hljs-built_in">open</span>(QIODevice::ReadOnly);<br>        <span class="hljs-comment">//å…³è”ç¼“å­˜åŒºæ•°æ®åˆ°æ•°æ®æµ</span><br>        <span class="hljs-function">QDataStream <span class="hljs-title">dataInStream</span><span class="hljs-params">(&amp;buffer)</span></span>;<br>        dataInStream&gt;&gt;pmp;<br>        ui-&gt;label-&gt;<span class="hljs-built_in">setPixmap</span>(pmp.<span class="hljs-built_in">scaled</span>(ui-&gt;label-&gt;<span class="hljs-built_in">size</span>()));<br>        <span class="hljs-comment">//è¿›ç¨‹ä¸å…±äº«å†…å­˜åˆ†ç¦»</span><br>        sharedMemory-&gt;<span class="hljs-built_in">unlock</span>();<br>        <span class="hljs-keyword">if</span>(sharedMemory-&gt;<span class="hljs-built_in">isAttached</span>())&#123;<br>            sharedMemory-&gt;<span class="hljs-built_in">detach</span>();<br>        &#125;<br>        buffer.<span class="hljs-built_in">close</span>();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Qt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ›å»ºQt5åº”ç”¨ç¨‹åºæ’ä»¶</title>
    <link href="/linux-qt-plugin/"/>
    <url>/linux-qt-plugin/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h3><p>æœ€è¿‘ä¹Ÿæ²¡æ—¶é—´æ¥å†™åšå®¢äº† (âŠ™oâŠ™)â€¦ï¼Œäºæ˜¯ç°åœ¨èµ¶ç´§æŠ½ç©ºå†™ä¸€å†™ï½ï½è¿™æ¬¡è®²çš„æ˜¯åœ¨åˆ›å»ºQtæ’ä»¶ï¼Œ<strong>åœ¨Windowsä¸Šä¸º.dllåŠ¨æ€åº“ï¼ŒLinuxä¸Šä¸º.soåŠ¨æ€åº“</strong></p><span id="more"></span><p><a href="http://doc.qt.io/qt-5/plugins-howto.html">å®˜ç½‘&gt;&gt; How to Create Qt Plugins</a></p><p>å¤§æ¦‚å°±æ˜¯è¿™ä¹ˆå‡ æ­¥</p><p><strong>Making an application extensible through plugins involves the following steps:</strong></p><ul><li>Define a set of interfaces (classes with only pure virtual functions) used to talk to the plugins.</li><li>Use the <code>Q_DECLARE_INTERFACE</code>() macro to tell Qtâ€™s meta-object system about the interface.</li><li>Use <code>QPluginLoader</code> in the application to load the plugins.</li><li>Use qobject_cast() to test whether a plugin implements a given interface.</li></ul><p><strong>Writing a plugin involves these steps:</strong></p><ul><li>Declare a plugin class that inherits from QObject and from the interfaces that the plugin wants to provide.</li><li>Use the <code>Q_INTERFACES</code>() macro to tell Qtâ€™s meta-object system about the interfaces.</li><li>Export the plugin using the Q_PLUGIN_METADATA() macro.</li><li>Build the plugin using a suitable .pro file.</li></ul><hr /><p>**<font color=red>æ³¨æ„ï¼š</font>**Q_EXPORT_PLUGINï¼ŒQ_EXPORT_PLUGIN2 å®åœ¨Qt5ä¸èƒ½ç”¨äº†ï¼Œç”¨æ–°çš„å® <strong>Q_PLUGIN_METADATA</strong>ã€‚</p><h3 id="ç”Ÿæˆæ’ä»¶"><a class="markdownIt-Anchor" href="#ç”Ÿæˆæ’ä»¶"></a> ç”Ÿæˆæ’ä»¶</h3><p>åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºæ’ä»¶ï¼Œè¦å…ˆåˆ›å»ºä¸€ä¸ªæ’ä»¶æ¥å£ç±»ï¼ˆinterfaceï¼‰ï¼Œå®ƒåªèƒ½åŒ…å«ï¼Œå†åˆ›å»ºä¸€ä¸ªæ’ä»¶ç±»ï¼Œå¹¶ç»§æ‰¿è‡ªè¿™ä¸ªæ¥å£ç±»ã€‚ä¸‹é¢ä»¥ä¸€ä¸ªç®€å•çš„ä¾‹å­è¯´æ˜ï¼š)</p><p>ï¼ˆæ–°å»ºä¸€ä¸ªç©ºçš„Qté¡¹ç›®ï¼‰</p><p>mytestplugininterface.h <strong>æ¥å£ç±»</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> MYTESTPLUGININTERFACE_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MYTESTPLUGININTERFACE_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QString&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QObject&gt;</span></span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTestPluginInterface</span></span><br><span class="hljs-class">&#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">MyTestPluginInterface</span>()&#123;&#125;<br>    <span class="hljs-comment">//çº¯è™šå‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">helloworld</span><span class="hljs-params">(QString string)</span></span>=<span class="hljs-number">0</span>;<br>&#125;;<br><span class="hljs-comment">//ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®š å”¯ä¸€IIDæ ‡è¯†ç¬¦ï¼Œå…¶å®å°±æ˜¯ä¸ªå­—ç¬¦ä¸²</span><br><span class="hljs-built_in">Q_DECLARE_INTERFACE</span>(MyTestPluginInterface,<span class="hljs-string">&quot;myplugin.example.my.com&quot;</span>)<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">// MYTESTPLUGININTERFACE_H</span></span><br></code></pre></div></td></tr></table></figure><p>mytestplugin.h <strong>æ’ä»¶ç±»å¤´æ–‡ä»¶</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> MYTESTPLUGIN_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MYTESTPLUGIN_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&quot;mytestplugininterface.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QObject&gt;</span></span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTestPlugin</span>:</span><span class="hljs-keyword">public</span> QObject,MyTestPluginInterface<br>&#123;<br>    Q_OBJECT<br>     <span class="hljs-comment">//å¯¼å‡ºè¯¥æ’ä»¶</span><br>    <span class="hljs-built_in">Q_PLUGIN_METADATA</span>(IID <span class="hljs-string">&quot;myplugin.example.my.com&quot;</span>)<br>     <span class="hljs-comment">//å°†è¯¥æ¥å£æ³¨å†Œåˆ°Qtçš„å…ƒå¯¹è±¡ç³»ç»Ÿ</span><br>    <span class="hljs-built_in">Q_INTERFACES</span>(MyTestPluginInterface)<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">MyTestPlugin</span>();<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">helloworld</span><span class="hljs-params">(QString string)</span></span>;<br>    ~<span class="hljs-built_in">MyTestPlugin</span>()&#123;&#125;<br>&#125;;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">// MYTESTPLUGIN_H</span></span><br></code></pre></div></td></tr></table></figure><p>mytestplugin.cpp <strong>æ’ä»¶ç±»cppæºæ–‡ä»¶</strong></p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&quot;mytestplugin.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QtPlugin&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QDebug&gt;</span></span><br>MyTestPlugin::<span class="hljs-built_in">MyTestPlugin</span>()&#123;&#125;<br><span class="hljs-comment">//é‡å†™è¯¥æ¥å£ç±»çš„è™šå‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">MyTestPlugin::helloworld</span><span class="hljs-params">(QString string)</span></span>&#123;<br>    <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;Hello---&gt; &quot;</span>&lt;&lt;string;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æœ€åå°±æ˜¯ç¼–è¾‘.proæ–‡ä»¶å¹¶æ„å»ºè¯¥æ’ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">TEMPLATE = lib<br>CONFIG += plugin<br>TARGET = mytestPlugin<br>DESTDIR = ../outputDir<br>HEADERS += \<br>    mytestplugin.h \<br>    mytestplugininterface.h<br>SOURCES += \<br>    mytestplugin.cpp<br></code></pre></div></td></tr></table></figure><blockquote><p>CONFIG è¡¨æ˜è¦æ„å»ºä¸€ä¸ªæ’ä»¶<br />TARGET æŒ‡å®šç”Ÿæˆçš„.dll æˆ– .so æ–‡ä»¶å<br />DESTDIR æŒ‡å®šç”Ÿæˆçš„.dll æˆ– .so æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•</p></blockquote><p>æœ€åè¿˜è¦æŠŠæœ¬åœ°éƒ¨ç½²æ”¹ä¸º<strong>Release</strong>ï¼Œç„¶ååœ¨æ„å»ºè¯¥é¡¹ç›®å³å¯ç”ŸæˆæŒ‡å®šçš„åº“æ–‡ä»¶ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ <strong><a href="http://libmytestPlugin.so">libmytestPlugin.so</a></strong></p><h3 id="æµ‹è¯•æ’ä»¶"><a class="markdownIt-Anchor" href="#æµ‹è¯•æ’ä»¶"></a> æµ‹è¯•æ’ä»¶</h3><p>ä¸ºäº†åšä¸€ä¸ªç®€å•çš„æµ‹è¯•ï¼Œæˆ‘å¦å¤–åˆ›å»ºäº†ä¸€ä¸ªé¡¹ç›®ï¼Œè°ƒç”¨æ’ä»¶ä¹Ÿå¾ˆç®€å•ï¼Œè¿™é‡Œç»™å‡ºæ ¸å¿ƒä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//ç”¨QPluginLoaderåŠ è½½åŠ¨æ€é“¾æ¥åº“ï¼Œæ³¨æ„QLibraryç±»ä¸QPluginLoaderç±»çš„åŒºåˆ«</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QPluginLoader&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&quot;mytestplugininterface.h&quot;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dialog::loadmyPlugin</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    QPluginLoader *loader=<span class="hljs-keyword">new</span> <span class="hljs-built_in">QPluginLoader</span>(<span class="hljs-keyword">this</span>);<br>    <span class="hljs-comment">//æŠŠæ’ä»¶æ–‡ä»¶å’ŒåŒ…å«æ’ä»¶å£°æ˜çš„æ–‡ä»¶æ”¾åˆ°é¡¹ç›®ä¸‹</span><br>    loader-&gt;<span class="hljs-built_in">setFileName</span>(<span class="hljs-string">&quot;libmytestPlugin.so&quot;</span>);<br>    <span class="hljs-comment">//åˆ¤æ–­åŠ è½½æ’ä»¶æ˜¯å¦æˆåŠŸ</span><br>    <span class="hljs-keyword">if</span>(!loader-&gt;<span class="hljs-built_in">load</span>())&#123;<br>        <span class="hljs-built_in">qDebug</span>()&lt;&lt;<span class="hljs-string">&quot;Error:&quot;</span>&lt;&lt;loader-&gt;<span class="hljs-built_in">errorString</span>();<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-comment">//éå†æ’ä»¶çš„å…ƒæ•°æ®ä¿¡æ¯</span><br>    foreach (QString key,loader-&gt;<span class="hljs-built_in">metaData</span>().<span class="hljs-built_in">keys</span>()) &#123;<br>        <span class="hljs-built_in">qDebug</span>()&lt;&lt;key&lt;&lt;<span class="hljs-string">&quot;\t&quot;</span>&lt;&lt;loader-&gt;<span class="hljs-built_in">metaData</span>().<span class="hljs-built_in">value</span>(key);<br>    &#125;<br>    QObject*plugin= loader-&gt;<span class="hljs-built_in">instance</span>();<br>    <span class="hljs-comment">//è½¬æ¢è·å–æ’ä»¶ç±»å¯¹è±¡</span><br>    MyTestPluginInterface *mytestpliugin=qobject_cast&lt;MyTestPluginInterface*&gt;(plugin);<br>    mytestpliugin-&gt;<span class="hljs-built_in">helloworld</span>(<span class="hljs-string">&quot;Google...&quot;</span>);<br>    <span class="hljs-comment">//å¸è½½æ’ä»¶</span><br>    loader-&gt;<span class="hljs-built_in">unload</span>();<br>&#125;<br></code></pre></div></td></tr></table></figure><p>okï¼Œåˆ°æ­¤åŸºæœ¬ä¸Šå®Œæˆäº†ä¸€ä¸ªç®€å•çš„æ’ä»¶ä½¿ç”¨äº† ï¼š)</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Qt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mysql error 1524-unix_socket</title>
    <link href="/mysql-error-unix-socket/"/>
    <url>/mysql-error-unix-socket/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ç™»å½•MySQLæ—¶æ˜¾ç¤ºé”™è¯¯ <code>mysql &quot;ERROR 1524 (HY000): Plugin 'unix_socket' is not loaded&quot;</code></p><span id="more"></span><p>å‚è€ƒåŸæ–‡: <a href="https://askubuntu.com/questions/705458/ubuntu-15-10-mysql-error-1524-unix-socket">https://askubuntu.com/questions/705458/ubuntu-15-10-mysql-error-1524-unix-socket</a></p><p>è§£å†³åŠæ³•</p><blockquote><p>/etc/init.d/mysql stop<br />sudo killall mysqld_safe<br />sudo killall mysqld<br />sudo mysqld_safe â€“skip-grant-tables &amp;<br />mysql -u root<br />use mysql;<br />update user set password=<strong>PASSWORD(â€œMySQLå¯†ç â€)</strong> where User=â€™rootâ€™;<br />update user set plugin=â€<strong>mysql_native_password</strong>â€œ;<br />quit;<br />/etc/init.d/mysql stop<br />sudo kill -9 $(pgrep mysql)<br />/etc/init.d/mysql start</p></blockquote><p>è¿™æ˜¯åŸæ–‡ï¼ŒæŒºè¯¦ç»†çš„â€¦</p><p>The â€œ<strong>unix_socket</strong>â€ has been called by mysql authentication process (maybe related to a partial migration of database to mariadb, now removed). To get all stuff back working go su:</p><blockquote><p>sudo su</p></blockquote><p>then follow:</p><blockquote><p>/etc/init.d/mysql stop<br />mysqld_safe â€“skip-grant-tables &amp;<br />mysql -uroot</p></blockquote><p>This will completely stop mysql, bypass user authentication (no password needed) and connect to mysql with user â€œrootâ€.</p><p>Now, in mysql console, go using mysql administrative db:</p><blockquote><p>use mysql;</p></blockquote><p>To reset root password to mynewpassword (change it at your wish), just to be sure of it:</p><blockquote><p>update user set password=PASSWORD(â€œmynewpasswordâ€) where User=â€™rootâ€™;</p></blockquote><p>And this one will overwrite authentication method, remove the unix_socket request (and everything else), restoring a normal and working password method:</p><blockquote><p>update user set plugin=â€mysql_native_passwordâ€;</p></blockquote><p>Exit mysql console:</p><blockquote><p>quit;</p></blockquote><p>Stop and start everything related to mysql:</p><blockquote><p>/etc/init.d/mysql stop<br />kill -9 $(pgrep mysql)<br />/etc/init.d/mysql start<br />Donâ€™t forget to exit the su mode.</p></blockquote><p>Now mySQL server is up and running. You can login it with root:</p><blockquote><p>mysql -u root -p</p></blockquote><p>or whatever you wish. Password usage is operative.</p><p>Thatâ€™s it.</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python requestsæ¨¡å—</title>
    <link href="/python-requests/"/>
    <url>/python-requests/</url>
    
    <content type="html"><![CDATA[<p>Pythoné‡Œæœ‰è‡ªå¸¦çš„ <strong>urllib</strong> åº“,æä¾›äº†è®¸å¤šå¼ºå¤§çš„åŠŸèƒ½æ¥è·å–URLä¿¡æ¯,è€Œ <strong>urllib2</strong> åˆ™æä¾›äº†ä¸€ç»„åŸºäºè¯·æ±‚(request)çš„åŠŸèƒ½.ä¸¤è€…å¯ä»¥ç›¸é“ºç›¸æˆ.è€Œä»Šå¤©çš„ä¸»è§’æ˜¯ç¬¬ä¸‰æ–¹åº“ <strong>requests</strong> ,å…¶ä»¥ç®€å•çš„æ–¹å¼å»è·å–URL,å¤æ‚æ€§æ²¡æœ‰urllibé«˜</p><span id="more"></span><h3 id="è·å–requests"><a class="markdownIt-Anchor" href="#è·å–requests"></a> è·å–requests</h3><p>æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ <code>pip install requests</code> ,ç„¶åå°±å¯ä»¥ä½¿ç”¨äº†</p><h3 id="å‘é€è¯·æ±‚"><a class="markdownIt-Anchor" href="#å‘é€è¯·æ±‚"></a> å‘é€è¯·æ±‚</h3><p>é¦–å…ˆ,éœ€è¦å¯¼å…¥ Requests æ¨¡å—,è¿™é‡Œå°±ä»‹ç» <strong>get</strong> å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span>(<span class="hljs-params">url, params=<span class="hljs-literal">None</span>, **kwargs</span>):</span><br>    <span class="hljs-string">r&quot;&quot;&quot;Sends a GET request.</span><br><span class="hljs-string">    :param url: URL for the new :class:`Request` object.</span><br><span class="hljs-string">    :param params: (optional) Dictionary or bytes to be sent in the query string for the :class:`Request`.</span><br><span class="hljs-string">    :param \*\*kwargs: Optional arguments that ``request`` takes.</span><br><span class="hljs-string">    :return: :class:`Response &lt;Response&gt;` object</span><br><span class="hljs-string">    :rtype: requests.Response</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    kwargs.setdefault(<span class="hljs-string">&#x27;allow_redirects&#x27;</span>, <span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">return</span> request(<span class="hljs-string">&#x27;get&#x27;</span>, url, params=params, **kwargs)<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° requests.get å‡½æ•° å®é™…æ˜¯è°ƒç”¨äº† <strong>requests.Request</strong> æ„é€ è¯·æ±‚å‚æ•°,å¹¶è¿”å›ä¸€ä¸ª <strong>requests.Response</strong> å“åº”å¯¹è±¡</p><p>ç±»ä¼¼çš„,è¿˜æœ‰ put,delete,head,post,option è¯·æ±‚å‡½æ•°</p><h4 id="ä¾‹1"><a class="markdownIt-Anchor" href="#ä¾‹1"></a> ä¾‹1</h4><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">    query=&#123;<span class="hljs-string">&#x27;test1&#x27;</span>:<span class="hljs-string">&#x27;123456789&#x27;</span>,<span class="hljs-string">&#x27;test2&#x27;</span>:<span class="hljs-string">&#x27;123456789&#x27;</span>&#125;<br>    r=requests.get(url=<span class="hljs-string">&#x27;https://www.baidu.com&#x27;</span>,params=query)<br>    <span class="hljs-built_in">print</span> r.url  <span class="hljs-comment">#è¿”å›URLåœ°å€</span><br>    <span class="hljs-built_in">print</span> r.status_code  <span class="hljs-comment">#è¿”å›çŠ¶æ€ç </span><br>    <span class="hljs-built_in">print</span> r.encoding<span class="hljs-comment">#ç¼–ç æ ¼å¼</span><br>    <span class="hljs-built_in">print</span> r.headers[<span class="hljs-string">&#x27;Content-Type&#x27;</span>]<span class="hljs-comment">#è·å–ç½‘é¡µheader </span><br>    <span class="hljs-built_in">print</span> r.cookies  <span class="hljs-comment">#è·å–cookies</span><br>    <span class="hljs-built_in">print</span> r.text     <span class="hljs-comment">#Requestsè‡ªåŠ¨è§£ç åæ•°æ®</span><br>    <span class="hljs-built_in">print</span> r.content <span class="hljs-comment">#è·å–äºŒè¿›åˆ¶å“åº”å†…å®¹</span><br>    <span class="hljs-built_in">print</span> r.json()  <span class="hljs-comment">#JSON å“åº”å†…å®¹ å¯ä»¥å’Œ json æ¨¡å—ä½¿ç”¨</span><br>è¾“å‡º:<br>https://www.baidu.com/?test1=<span class="hljs-number">123456789</span>&amp;test2=<span class="hljs-number">123456789</span><br><span class="hljs-number">200</span><br>ISO-<span class="hljs-number">8859</span>-<span class="hljs-number">1</span><br>text/html<br>&lt;RequestsCookieJar[&lt;Cookie BDORZ=<span class="hljs-number">27315</span> <span class="hljs-keyword">for</span> .baidu.com/&gt;]&gt; <br>è¿”å›æ•°æ®å¤ªå¤š,è¿™é‡Œä¸æ˜¾ç¤ºäº†<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„,getå‡½æ•°çš„paramsä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²</p><h4 id="ä¾‹2"><a class="markdownIt-Anchor" href="#ä¾‹2"></a> ä¾‹2</h4><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">   user_agent = <span class="hljs-string">&#x27;Mozilla/5.0(X11; Linux x86_64) AppleWebKit/537.36(KHTML, like Gecko)Chrome/59.0.3071.115 Safari/537.36&#x27;</span><br>    headers = &#123;<span class="hljs-string">&#x27;User-Agent&#x27;</span>: user_agent&#125;<br>    data=&#123;<span class="hljs-string">&#x27;key1&#x27;</span>:<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-string">&#x27;key2&#x27;</span>:<span class="hljs-string">&#x27;world&#x27;</span>&#125;<br>    r=requests.post(url=<span class="hljs-string">&#x27;http://httpbin.org/post&#x27;</span>,headers=headers,data=data)<br>    <span class="hljs-built_in">print</span> r.text<br>    <br>    <br>è¾“å‡º:<br>&#123;<br>  <span class="hljs-string">&quot;args&quot;</span>: &#123;&#125;, <br>  <span class="hljs-string">&quot;data&quot;</span>: <span class="hljs-string">&quot;&quot;</span>, <br>  <span class="hljs-string">&quot;files&quot;</span>: &#123;&#125;, <br>  <span class="hljs-string">&quot;form&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;key1&quot;</span>: <span class="hljs-string">&quot;hello&quot;</span>, <br>    <span class="hljs-string">&quot;key2&quot;</span>: <span class="hljs-string">&quot;world&quot;</span><br>  &#125;, <br>  <span class="hljs-string">&quot;headers&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;*/*&quot;</span>, <br>    <span class="hljs-string">&quot;Accept-Encoding&quot;</span>: <span class="hljs-string">&quot;gzip, deflate&quot;</span>, <br>    <span class="hljs-string">&quot;Connection&quot;</span>: <span class="hljs-string">&quot;close&quot;</span>, <br>    <span class="hljs-string">&quot;Content-Length&quot;</span>: <span class="hljs-string">&quot;21&quot;</span>, <br>    <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>, <br>    <span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;httpbin.org&quot;</span>, <br>    <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0(X11; Linux x86_64) AppleWebKit/537.36(KHTML, like Gecko)Chrome/59.0.3071.115 Safari/537.36&quot;</span><br>  &#125;<br>  ...<br></code></pre></div></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ª POST è¯·æ±‚ ,å…¶ä¸­ <strong>data</strong> å‚æ•°è¡¨ç¤ºè¦æäº¤ç»™æœåŠ¡å™¨çš„æ•°æ® ,<strong>headers</strong> æ˜¯ä¸€ä¸ªå­—å…¸ç±»å‹çš„è¯·æ±‚å¤´,æ­¤å¤„æˆ‘åªæŒ‡å®šäº† <strong>User-Agent</strong> .</p><h3 id="ä»£ç†è®¿é—®"><a class="markdownIt-Anchor" href="#ä»£ç†è®¿é—®"></a> ä»£ç†è®¿é—®</h3><p>ä¸ºäº†è®¿é—®ä¸€äº›è¢«Qçš„ç½‘ç«™,å¾€å¾€éœ€è¦è®¾ç½®ä»£ç†,å¹¸è¿çš„æ˜¯,requestsåŒæ ·ä¹Ÿæä¾›çš„ä»£ç†è¿™ä¸€åŠŸèƒ½,ä¸ä¹‹æœ‰å…³çš„å‚æ•°ä¸º <strong>proxies</strong></p><h4 id="ä¾‹3"><a class="markdownIt-Anchor" href="#ä¾‹3"></a> ä¾‹3</h4><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">proxy=&#123;<span class="hljs-string">&#x27;http&#x27;</span>:<span class="hljs-string">&#x27;http://127.0.0.1:8087&#x27;</span>,<br><span class="hljs-string">&#x27;https&#x27;</span>:<span class="hljs-string">&#x27;http://127.0.0.1:8087&#x27;</span>&#125;<br>r=requests.get(url=<span class="hljs-string">&#x27;https://www.google.com&#x27;</span>,proxies=proxy,verify=<span class="hljs-literal">False</span>)<br><span class="hljs-built_in">print</span> r.text<br><span class="hljs-built_in">print</span> r.status_code<br></code></pre></div></td></tr></table></figure><p>å¦‚æœä»£ç†éœ€è¦è´¦æˆ·å’Œå¯†ç , åˆ™</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">proxies=&#123;<br><span class="hljs-string">&quot;http&quot;</span>: <span class="hljs-string">&quot;http://username:password@127.0.0.1:8087&quot;</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>æˆ‘æŠŠ <strong>verify</strong> è®¾ç½®ä¸º False,æ˜¯ä¸ºäº†SSLè¯ä¹¦éªŒè¯.</p><p>ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ <strong>HTTP_PROXY</strong> å’Œ <strong>HTTPS_PROXY</strong> æ¥é…ç½®ä»£ç†</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">$ export HTTP_PROXY=<span class="hljs-string">&quot;http://10.10.1.10:3128&quot;</span><br>$ export HTTPS_PROXY=<span class="hljs-string">&quot;http://10.10.1.10:1080&quot;</span><br>$ python<br><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> requests<br><span class="hljs-meta">&gt;&gt;&gt; </span>requests.get(<span class="hljs-string">&quot;http://example.org&quot;</span>)<br></code></pre></div></td></tr></table></figure><h3 id="ä¼šè¯session"><a class="markdownIt-Anchor" href="#ä¼šè¯session"></a> ä¼šè¯(Session)</h3><p>ä¼šè¯å¯¹è±¡è®©ä½ èƒ½å¤Ÿè·¨è¯·æ±‚ä¿æŒæŸäº›å‚æ•°ã€‚å®ƒä¹Ÿä¼šåœ¨åŒä¸€ä¸ª Session å®ä¾‹å‘å‡ºçš„æ‰€æœ‰è¯·æ±‚ä¹‹é—´ä¿æŒ cookieï¼Œ æœŸé—´ä½¿ç”¨ <code>urllib3</code> çš„ <a href="http://urllib3.readthedocs.io/en/latest/reference/index.html#module-urllib3.connectionpool">connection pooling</a> åŠŸèƒ½ã€‚æ‰€ä»¥å¦‚æœä½ å‘åŒä¸€ä¸»æœºå‘é€å¤šä¸ªè¯·æ±‚ï¼Œåº•å±‚çš„ TCP è¿æ¥å°†ä¼šè¢«é‡ç”¨ï¼Œä»è€Œå¸¦æ¥æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚ (å‚è§ <a href="https://en.wikipedia.org/wiki/HTTP_persistent_connection">HTTP persistent connection</a> ).</p><p>ä½¿ç”¨ä¹‹å‰éœ€å¯¼å…¥ç±»: <code>from requests import Session</code></p><h3 id="å‡†å¤‡çš„è¯·æ±‚prepared-request"><a class="markdownIt-Anchor" href="#å‡†å¤‡çš„è¯·æ±‚prepared-request"></a> å‡†å¤‡çš„è¯·æ±‚(Prepared Request)</h3><p>å½“ä½ ä» API æˆ–è€…ä¼šè¯è°ƒç”¨ä¸­æ”¶åˆ°ä¸€ä¸ª Response å¯¹è±¡æ—¶ï¼Œrequest å±æ€§å…¶å®æ˜¯ä½¿ç”¨äº† PreparedRequestã€‚æœ‰æ—¶åœ¨å‘é€è¯·æ±‚ä¹‹å‰ï¼Œä½ éœ€è¦å¯¹ body æˆ–è€… header ï¼ˆæˆ–è€…åˆ«çš„ä»€ä¹ˆä¸œè¥¿ï¼‰åšä¸€äº›é¢å¤–å¤„ç†</p><h4 id="ä¾‹4"><a class="markdownIt-Anchor" href="#ä¾‹4"></a> ä¾‹4</h4><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">user_agent = <span class="hljs-string">&#x27;Mozilla/5.0(X11; Linux x86_64) AppleWebKit/537.36(KHTML, like Gecko)Chrome/59.0.3071.115 Safari/537.36&#x27;</span><br>    headers=&#123;<span class="hljs-string">&#x27;User-Agent&#x27;</span>:user_agent&#125;<br>    <span class="hljs-comment"># å¼€å¯å›è¯</span><br>    s= requests.Session()<br>    req=requests.Request(<span class="hljs-string">&#x27;GET&#x27;</span>,url=<span class="hljs-string">&#x27;http://baidu.com&#x27;</span>)<br>    <span class="hljs-comment"># å¼€å§‹å‡†å¤‡ä¸€ä¸ªè¯·æ±‚</span><br>    prepped= s.prepare_request(req)<br>    <br>    <span class="hljs-comment"># do something with prepped.body</span><br>    <span class="hljs-comment"># do something with prepped.headers</span><br>    prepped.prepare_headers(headers)<br>    <span class="hljs-comment"># å‘é€ä»¥å‡†å¤‡å¥½çš„è¯·æ±‚</span><br>    resp= s.send(prepped,timeout=<span class="hljs-number">5</span>)<br>    <span class="hljs-built_in">print</span> resp.status_code<br>    s.close()<br></code></pre></div></td></tr></table></figure><h3 id="äº‹ä»¶æŒ‚é’©"><a class="markdownIt-Anchor" href="#äº‹ä»¶æŒ‚é’©"></a> äº‹ä»¶æŒ‚é’©</h3><p>Requestsæœ‰ä¸€ä¸ªé’©å­ç³»ç»Ÿï¼Œä½ å¯ä»¥ç”¨æ¥æ“æ§éƒ¨åˆ†è¯·æ±‚è¿‡ç¨‹ï¼Œæˆ–ä¿¡å·äº‹ä»¶å¤„ç†</p><blockquote><p>å¯ç”¨çš„é’©å­:<br /><strong>response</strong> :<br />ä»ä¸€ä¸ªè¯·æ±‚äº§ç”Ÿçš„å“åº”</p></blockquote><p>å¯ä»¥é€šè¿‡ä¼ é€’ä¸€ä¸ª {hook_name: callback_function} å­—å…¸ç»™ <strong>hooks</strong> è¯·æ±‚å‚æ•°ä¸ºæ¯ä¸ªè¯·æ±‚åˆ†é…ä¸€ä¸ªé’©å­å‡½æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python">hooks=<span class="hljs-built_in">dict</span>(response=print_url)<br></code></pre></div></td></tr></table></figure><p><strong>callback_function</strong> ä¼šæ¥å—ä¸€ä¸ªæ•°æ®å—ä½œä¸ºå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°</p><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">print_url</span>(<span class="hljs-params">r, *args, **kwargs</span>):</span><br>    <span class="hljs-built_in">print</span>(r.url)<br></code></pre></div></td></tr></table></figure><h4 id="ä¾‹5"><a class="markdownIt-Anchor" href="#ä¾‹5"></a> ä¾‹5</h4><figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">print_urls</span>(<span class="hljs-params">r,*args,**kwargs</span>):</span><br>    <span class="hljs-built_in">print</span> r.url<br>    <span class="hljs-keyword">pass</span><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    s=requests.Session()<br>    <span class="hljs-comment"># é’©å­</span><br>    s.hooks=<span class="hljs-built_in">dict</span>(response=print_urls)<br>    req= requests.Request(<span class="hljs-string">&#x27;GET&#x27;</span>,url=<span class="hljs-string">&#x27;https://www.github.com&#x27;</span>,headers=header)<br>   <br>    pre=s.prepare_request(req)<br>    pre.prepare_headers(header)<br>    resp=s.send(pre)<br>    <span class="hljs-built_in">print</span> resp.headers<br>    <span class="hljs-keyword">pass</span><br></code></pre></div></td></tr></table></figure><p>å‚è€ƒ</p><p><a href="http://docs.python-requests.org/zh_CN/latest/user/quickstart.html">http://docs.python-requests.org/zh_CN/latest/user/quickstart.html</a></p><p>good~</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxä¸‹Qtå‘ç”Ÿé”™è¯¯qt.network.ssl:QSslSocket:cannotresolve...</title>
    <link href="/linux-qt-network-ssl/"/>
    <url>/linux-qt-network-ssl/</url>
    
    <content type="html"><![CDATA[<p>åœ¨Linuxä¸ŠQtä½¿ç”¨networkæ—¶å‡ºç°é”™è¯¯:</p><blockquote><p>qt.network.ssl: QSslSocket: cannot resolve TLSv1_1_client_method<br />qt.network.ssl: QSslSocket: cannot resolve TLSv1_2_client_method<br />qt.network.ssl: QSslSocket: cannot resolve TLSv1_1_server_method<br />qt.network.ssl: QSslSocket: cannot resolve TLSv1_2_server_method<br />qt.network.ssl: QSslSocket: cannot resolve SSL_select_next_proto<br />qt.network.ssl: QSslSocket: cannot resolve SSL_CTX_set_next_proto_select_cb<br />qt.network.ssl: QSslSocket: cannot resolve SSL_get0_next_proto_negotiated<br />qt.network.ssl: QSslSocket: cannot call unresolved function SSL_get0_next_proto_negotiated</p></blockquote><span id="more"></span><p>ç»ç½‘ä¸ŠæŸ¥é˜…,å¤§æ¦‚çŸ¥é“äº†åŸå› ,å°±æ˜¯è¦è‡ªå·±é‡æ–°ç¼–è¯‘openssl.ç¬¬ä¸€æ¬¡ç”¨çš„æ˜¯1.1ç‰ˆæœ¬çš„,å‘ç°è¿˜æ˜¯è§£å†³ä¸äº†,äºæ˜¯ä¸‹äº†1.0.1çš„.<br /><a href="https://www.openssl.org/source/old/1.0.1/">&gt;&gt;é“¾æ¥</a></p><blockquote><p>wget <a href="https://www.openssl.org/source/old/1.0.1/openssl-1.0.1.tar.gz">https://www.openssl.org/source/old/1.0.1/openssl-1.0.1.tar.gz</a><br />tar zxvf openssl-1.0.1.tar.gz<br />cd openssl-1.0.1/<br />./config enable-shared<br />make</p></blockquote><p>åœ¨ openssl-1.0.1 ç›®å½•ä¸‹ç”Ÿæˆäº†soæ–‡ä»¶,å¤åˆ¶åˆ°Qtå®‰è£…ç›®å½•libä¸‹</p><blockquote><p>cp <a href="http://libcrypto.so">libcrypto.so</a> libcrypto.so.1.0.0 <a href="http://libssl.so">libssl.so</a> libssl.so.1.0.0 /opt/Qt5.6.2/5.6/gcc_64/lib</p></blockquote><p>ç„¶åok</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Qt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è§£å†³Qt5 qDebug()ä¸æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯</title>
    <link href="/qt-qdebug/"/>
    <url>/qt-qdebug/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰ä¸çŸ¥æ€ä¹ˆ,Qt <strong>qDebug()</strong> æ— æ³•è¾“å‡ºè°ƒè¯•ä¿¡æ¯,ä¸è¿‡è¯¸å¦‚<br /><code>qWarning()</code> <code>qCritical()</code> å¯ä»¥æ­£å¸¸è¾“å‡º</p><span id="more"></span><h4 id="æ–¹æ³•"><a class="markdownIt-Anchor" href="#æ–¹æ³•"></a> æ–¹æ³•</h4><p>ä¹‹å‰æˆ‘æ˜¯ç”¨ <strong>qInstallMessageHandler(QtMessageHandler)</strong> æ•è·ä¿¡æ¯,åŒæ ·ä¹Ÿæ˜¯æ— æ³•è¾“å‡º qDebug() çš„ä¿¡æ¯.</p><p>æœ€åè¿˜æ˜¯åœ¨Qtå®˜ç½‘è®ºå›å‘å‡ºå¸–å­å¯»æ±‚å¸®åŠ©<br /><a href="https://forum.qt.io/topic/86358/qdebug-can-t-output-text">https://forum.qt.io/topic/86358/qdebug-can-t-output-text</a></p><p>ä»è¿™ä¸ªç½‘ç«™æ‰¾åˆ°è§£å†³æ–¹æ³• <a href="https://brendanwhitfield.wordpress.com/2016/06/08/enabling-qdebug-on-fedora/">https://brendanwhitfield.wordpress.com/2016/06/08/enabling-qdebug-on-fedora/</a></p><blockquote><p>When writing Qt applications, itâ€™s helpful to use a qDebug() statement once in a while. However, Iâ€™ve recently found that qDebug() on stock Fedora no longer prints, while qWarning() does. The first thing that the internet tells you is to add CONFIG += console to your .pro file, but alas, this is not the solution. It turns out, because of the way Qt is setup on Fedora, debug output is no longer emitted on stderr (by design). Thanks to this bug report, the solution is to create the following file in either of these locations:</p><ul><li><strong>~/.config/QtProject/qtlogging.ini (for your user only)</strong></li><li><strong>/etc/xdg/QtProject/qtlogging.ini (system-wide)</strong></li></ul><p><strong>[Rules].debug=trueqtâ€¦debug=false</strong></p><p>The first rule enables all debug output, while the second disables Qtâ€™s internal debug statements. This prevents a deluge of output from Qt when debugging your application.</p></blockquote><p>æˆ‘ä¿®æ”¹ <code>/etc/xdg/QtProject/qtlogging.ini</code> æ–‡ä»¶<br />ä¸º</p><blockquote><p>*<em>[Rules]</em> .debug=true<br />qt.*.debug=false</p></blockquote><p>bye~</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Qt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SDL2æ˜¾ç¤ºPNGå›¾ç‰‡+æ’­æ”¾MP3</title>
    <link href="/sdl2-png-mp3/"/>
    <url>/sdl2-png-mp3/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ä½¿ç”¨SDLæ—¶ï¼Œå‘ç°å°±ç®—ç¼–è¯‘å®‰è£…äº†SDL2_imageå’ŒSDL_mixerä¹Ÿæ— æ³•æ˜¾ç¤ºpngæ ¼å¼å›¾ç‰‡å’Œæ’­æ”¾MP3éŸ³é¢‘æ–‡ä»¶ã€‚åœ¨ç½‘ä¸Šæœç´¢è®¸ä¹…ï¼Œè¿™é‡Œæ€»ç»“ä¸€ä¸‹ç¼–è¯‘è¿‡ç¨‹ã€‚ã€‚ã€‚</p><span id="more"></span><h3 id="sdl2_image"><a class="markdownIt-Anchor" href="#sdl2_image"></a> SDL2_image</h3><p>é¦–å…ˆï¼Œæˆ‘æ˜¯ç”¨ä¸€ä¸‹å‡½æ•°è·å–é”™è¯¯çš„ä¿¡æ¯çš„</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs C++">_texture=<span class="hljs-built_in">IMG_LoadTexture</span>(_renderer,filename.<span class="hljs-built_in">c_str</span>());<br>cout&lt;&lt; <span class="hljs-built_in">SDL_GetError</span>()&lt;&lt;endl;<br></code></pre></div></td></tr></table></figure><p>é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š<br />Failed loading <strong>png_set_longjmp_fn</strong>: /lib/x86_64-linux-gnu/libpng12.so.0: <strong>undefined symbol</strong>: <strong>_png_set_longjmp_fn</strong></p><p>å¯çœ‹åˆ°ï¼Œ<a href="http://libpng12.so">libpng12.so</a> è¿™ä¸ªåº“æ–‡ä»¶ä½å®šä¹‰å‡½æ•°ç¬¦å· <strong>png_set_longjmp_fn</strong></p><p>æ¥ç€æˆ‘æŸ¥æ‰¾ <strong><a href="http://libpng12.so">libpng12.so</a></strong> è¿™ä¸ªåº“æ–‡ä»¶</p><figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">$ locate libpng|<span class="hljs-keyword">grep</span> <span class="hljs-string">&quot;so&quot;</span><br><span class="hljs-regexp">/lib/</span>x86_64-linux-gnu/libpng12.so.<span class="hljs-number">0</span><br><span class="hljs-regexp">/lib/</span>x86_64-linux-gnu/libpng12.so.<span class="hljs-number">0.49</span>.<span class="hljs-number">0</span><br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/x86_64-linux-gnu/</span>libpng.so<br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/x86_64-linux-gnu/</span>libpng16.so<br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/x86_64-linux-gnu/</span>libpng16.so.<span class="hljs-number">16</span><br><span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/x86_64-linux-gnu/</span>libpng16.so.<span class="hljs-number">16.34</span>.<span class="hljs-number">0</span><br><br></code></pre></div></td></tr></table></figure><p>å¯çœ‹åˆ°ç³»ç»Ÿå­˜åœ¨ä¸¤ä¸ªç‰ˆæœ¬çš„ <strong>libpng</strong> åº“ ã€‚å¦‚æœåªå­˜åœ¨ä¸€ä¸ªï¼Œé‚£ä¹ˆå¯ä»¥è‡ªè¡Œä¸‹è½½libpngæœ€æ–°ç‰ˆæœ¬ç¼–è¯‘å®‰è£…ï¼Œå¹¶ç»§ç»­ä»¥ä¸‹æ“ä½œã€‚<br />å…¶ä¸­ <strong>libpng12.so.0.49.0</strong> æ˜¯ä¸€ä¸ªæ¯”è¾ƒè€çš„ç‰ˆæœ¬äº†ã€‚æ‰€ä»¥ä¸æœ€æ–°çš„SDL2å¯èƒ½ä¸å…¼å®¹ï¼Œæ‰ä¼šå‡ºç°ä¸Šé¢çš„é‚£ä¸ªé”™è¯¯ã€‚çŸ¥é“çš„é—®é¢˜åï¼Œè§£å†³èµ·æ¥ä¼¼ä¹ä¹Ÿå˜å¾—ç®€å•äº†ã€‚ã€‚ã€‚</p><ul><li><p>æ˜¾ç¤º12ç‰ˆæœ¬ dynamic symbols</p><blockquote><p>$ nm -D /lib/x86_64-linux-gnu/libpng12.so.0|grep png_set_longjmp_fn</p></blockquote></li><li><p>æ˜¾ç¤º16ç‰ˆæœ¬ dynamic symbols</p><blockquote><p>$ nm -D /usr/lib/x86_64-linux-gnu/libpng.so|grep png_set_longjmp_fn<br />ç»“æœï¼š000000000000a840 T <strong>png_set_longjmp_fn</strong></p></blockquote></li></ul><p>æ‰€ä»¥ï¼Œè§£å†³æ–¹æ³•å¾ˆç®€å•ï¼Œåˆ é™¤æ—§çš„åº“æ–‡ä»¶ï¼Œæ›¿æ¢æˆæ–°çš„ã€‚ä¸è¿‡æœ€åæˆ‘å‘ç°äº†ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜ï¼Œé‚£å°±æ˜¯åœ¨ä» /lib/x86_64-linux-gnu è·¯å¾„å»é™¤libpng12.so.0è¿™ä¸ªæ—§ç‰ˆæœ¬çš„åº“æ—¶ï¼Œvirtualboxè™šæ‹Ÿæœºå¯åŠ¨æ˜¾ç¤º <strong>åˆ›å»ºCOMå¯¹è±¡å¤±è´¥</strong> ã€‚æœ€åé‡æ–°ç¼–è¯‘å®‰è£…äº†libpng12.so.0å¹¶å¤åˆ¶åˆ° /lib/x86_64-linux-gnu ç›®å½•ä¸‹æ‰å¯ä»¥ï¼</p><blockquote><p>cp /usr/lib/x86_64-linux-gnu/<strong>libpng16.so.16.34.0</strong> /lib/x86_64-linux-gnu/<br />ln -s /lib/x86_64-linux-gnu/<strong>libpng16.so.16.34.0</strong> /lib/x86_64-linux-gnu/<strong><a href="http://libpng16.so">libpng16.so</a></strong> #æ·»åŠ è½¯é“¾æ¥</p></blockquote><p>ä¹‹åé‡æ–°ç¼–è¯‘ SDL2_image</p><blockquote><p>./configure<br />make<br />make install</p></blockquote><h3 id="sdl_mixer"><a class="markdownIt-Anchor" href="#sdl_mixer"></a> SDL_mixer</h3><p>é€šè¿‡ ./configure --help æŸ¥çœ‹é…ç½®é€‰é¡¹ã€‚è¦æƒ³æ”¯æŒæ’­æ”¾MP3æ ¼å¼ï¼Œåªéœ€æ·»åŠ ä»¥ä¸‹é…ç½®å‚æ•°</p><blockquote><p>./configure â€“<strong>enable-music-mp3</strong> â€“<strong>enable-music-mp3-mad-gpl</strong><br />make<br />make insatll</p></blockquote><p>ldd build/.libs/libSDL2_mixer.so</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">linux-vdso.so.<span class="hljs-number">1</span> (<span class="hljs-number">0</span>x00007ffc71f8d000)<br>libSDL2-<span class="hljs-number">2.0</span>.so.<span class="hljs-number">0</span> =&gt; <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/lib/</span>libSDL2-<span class="hljs-number">2.0</span>.so.<span class="hljs-number">0</span> (<span class="hljs-number">0</span>x00007f07ed821000)<br>libdl.so.<span class="hljs-number">2</span> =&gt; <span class="hljs-regexp">/lib/</span>x86_64-linux-gnu/libdl.so.<span class="hljs-number">2</span> (<span class="hljs-number">0</span>x00007f07ed5f2000)<br>libpthread.so.<span class="hljs-number">0</span> =&gt; <span class="hljs-regexp">/lib/</span>x86_64-linux-gnu/libpthread.so.<span class="hljs-number">0</span> (<span class="hljs-number">0</span>x00007f07ed3d4000)<br>librt.so.<span class="hljs-number">1</span> =&gt; <span class="hljs-regexp">/lib/</span>x86_64-linux-gnu/librt.so.<span class="hljs-number">1</span> (<span class="hljs-number">0</span>x00007f07ed1cc000)<br>libmad.so.<span class="hljs-number">0</span> =&gt; <span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/x86_64-linux-gnu/</span>libmad.so.<span class="hljs-number">0</span> (<span class="hljs-number">0</span>x00007f07ecfac000)<br>libm.so.<span class="hljs-number">6</span> =&gt; <span class="hljs-regexp">/lib/</span>x86_64-linux-gnu/libm.so.<span class="hljs-number">6</span> (<span class="hljs-number">0</span>x00007f07ecc99000)<br>libc.so.<span class="hljs-number">6</span> =&gt; <span class="hljs-regexp">/lib/</span>x86_64-linux-gnu/libc.so.<span class="hljs-number">6</span> (<span class="hljs-number">0</span>x00007f07ec8f4000)<br><span class="hljs-regexp">/lib64/</span>ld-linux-x86-<span class="hljs-number">64</span>.so.<span class="hljs-number">2</span> (<span class="hljs-number">0</span>x0000557697c43000)<br></code></pre></div></td></tr></table></figure><p>è¿™æ ·å°±OKäº† ğŸ˜ƒ</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C++</tag>
      
      <tag>C</tag>
      
      <tag>SDL2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XX-NETæ­å»ºFQç¯å¢ƒ</title>
    <link href="/linux-xxnet/"/>
    <url>/linux-xxnet/</url>
    
    <content type="html"><![CDATA[<p>æˆ‘æ˜¯åœ¨Linuxä¸‹æ­å»ºçš„,ä¸è¿‡å…¶ä»–ç³»ç»Ÿä¹Ÿæ˜¯ä¸€æ ·çš„.<br />ç”±äºæ­å»ºFQè¿‡ç¨‹æ¯”è¾ƒå¤æ‚çš„,æ‰€ä»¥è¿™é‡Œåˆ—ä¸¾å‡ ä¸ªå·¥å…·:<br /><a href="#googlechrome">ä¸‹è½½Google chrome</a><br /><a href="#lantern">ä½¿ç”¨lanternè“ç¯</a><br /><a href="#gae">åˆ›å»ºGAEå¹¶ç”³è¯·appid</a><br /><a href="#xx_net">XX-NETé…ç½®</a></p><span id="more"></span><p><font color=green>PSï¼š ä»¥ä¸‹æ–¹æ³•å¯èƒ½æ¯”è¾ƒæ—§ï¼Œç›®å‰æˆ‘ä½¿ç”¨çš„æ˜¯X-Tunnel</font></p><h3 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h3><table><thead><tr><th>éœ€è¦</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>Chromeæµè§ˆå™¨</td><td>â€“</td></tr><tr><td>lantern</td><td>è®¿é—®Google</td></tr><tr><td>XX-NET</td><td>ä¸»è¦å·¥å…·</td></tr><tr><td>GAE</td><td>ä»£ç†æœåŠ¡å™¨</td></tr><tr><td>SwitchOmega</td><td>ç®¡ç†å’Œåˆ‡æ¢å¤šä¸ªä»£ç†è®¾ç½®</td></tr></tbody></table><h4 id="ä¸‹è½½google-chrome"><a class="markdownIt-Anchor" href="#ä¸‹è½½google-chrome"></a> ä¸‹è½½Google chrome</h4><p>å»ºè®®å»å®˜ç½‘ä¸‹è½½,æ‰€ä»¥è¿™é‡Œå°±è¦ç”¨åˆ°lanternäº†<br /><img src="/uploads/images/vpn/file_003.png" alt="img" /><br />å®‰è£…ç•¥ ğŸ˜ƒ</p><h4 id="ä½¿ç”¨lanternè“ç¯"><a class="markdownIt-Anchor" href="#ä½¿ç”¨lanternè“ç¯"></a> ä½¿ç”¨lanternè“ç¯</h4><p>ä½¿ç”¨lanternè“ç¯</p><p>åˆ°githubè·å– <a href="https://github.com/getlantern/forum">https://github.com/getlantern/forum</a></p><p><img src="/uploads/images/vpn/file_001.png" alt="img" /><br />æˆ‘çš„æ˜¯Linuxç³»ç»Ÿ<br /><img src="/uploads/images/vpn/file_002.png" alt="img" /><br />ä¸‹è½½ä¹‹åå°±å¯ä»¥ <code>dpkg -i</code>æ¥å®‰è£…äº†,ç„¶åå¯ä»¥ç›´æ¥ lantern è¿è¡Œ,å¹¶æ˜¾ç¤ºä¸€ä¸ªæ‰˜ç›˜å›¾æ ‡.<br />å¯ä»¥ <code>netstat -ntlp |grep lantern</code> æ¥æŸ¥çœ‹lanternè¿›åœºç›‘å¬çš„ç«¯å£.</p><blockquote><p>åˆ«è¯´è¿™è®¿é—®é€Ÿåº¦è¿˜æŒºå¿«çš„.ä¸è¿‡,ä½“éªŒç‰ˆlanternç”¨æˆ·æ¯ä¸ªæœˆåªèƒ½ç”¨å‡ ç™¾MBçš„æµé‡,è¶…è¿‡åå°±ä¸èƒ½ç”¨äº†(çœç‚¹ç”¨å•Š),æ‰€ä»¥,ç‰¹ä¹ˆçš„çœ‹ä¸ªè§†é¢‘å°±æ²¡äº†â€¦åŸºäºæ­¤,æˆ‘å†³å®šæŠ˜è…¾ä¸€ç•ªâ€¦</p></blockquote><h4 id="åˆ›å»ºgaeå¹¶ç”³è¯·appid"><a class="markdownIt-Anchor" href="#åˆ›å»ºgaeå¹¶ç”³è¯·appid"></a> åˆ›å»ºGAEå¹¶ç”³è¯·appid</h4><p>å…¶å®,åˆ°äº†è¿™é‡Œå°±æ˜¯æ³¨æ„äº†,è¿™æ‰æ˜¯æœ€ä¸»è¦çš„.<br />GAE(Google APP Engine)æ˜¯ä»€ä¹ˆ?<br />ä»¥ä¸‹æ‘˜è‡ªç™¾åº¦</p><blockquote><p>Google App Engine æ˜¯ä¸€ç§è®©æ‚¨å¯ä»¥åœ¨ Google çš„åŸºç¡€æ¶æ„ä¸Šè¿è¡Œæ‚¨çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚Google App Engine åº”ç”¨ç¨‹åºæ˜“äºæ„å»ºå’Œç»´æŠ¤ï¼Œå¹¶å¯æ ¹æ®æ‚¨çš„è®¿é—®é‡å’Œæ•°æ®å­˜å‚¨éœ€è¦çš„å¢é•¿è½»æ¾æ‰©å±•ã€‚ä½¿ç”¨ Google App Engineï¼Œå°†ä¸å†éœ€è¦ç»´æŠ¤æœåŠ¡å™¨ï¼šæ‚¨åªéœ€ä¸Šä¼ æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œå®ƒä¾¿å¯ç«‹å³ä¸ºæ‚¨çš„ç”¨æˆ·æä¾›æœåŠ¡ã€‚</p></blockquote><p><strong>PS:å¿…é¡»å»åˆ›å»ºä¸€ä¸ªGoogleè´¦å·,æ­¤å¤„ä¸åœ¨èµ˜è¿°</strong><br />gaeå®˜ç½‘: <a href="https://appengine.google.com">https://appengine.google.com</a><br />è¾“å…¥Googleè´¦å·å¯†ç ä¹‹åå°±å¯ä»¥è¿›å»gaeç®¡ç†ç•Œé¢äº†<br /><img src="/uploads/images/vpn/file_004.png" alt="img" /></p><p>ä¹‹åå¯ä»¥ç›´æ¥åˆ›å»ºé¡¹ç›®äº†,æ³¨æ„é‚£ä¸ª<code>appid</code>å°±æ˜¯<strong>é¡¹ç›®å</strong><br /><img src="/uploads/images/vpn/file_005.png" alt="img" /></p><p>ç­‰å¾…åˆ›å»ºå®Œæˆ<br /><img src="/uploads/images/vpn/file_006.png" alt="img" /></p><p>å®Œæˆä¹‹ååªéœ€å§é‚£ä¸ª<code>appid</code>è®°ä½.<br /><img src="/uploads/images/vpn/file_007.png" alt="img" /></p><p><strong>PS:å¯ä»¥åˆ›å»ºå¤šä¸ªé¡¹ç›®.åœ¨é…ç½®xx-netæ—¶ä¹Ÿå¯ä»¥æŒ‡å®šå¤šä¸ªappid,ä¸€ä¸ªappidå¯¹åº”1Gçš„ä½¿ç”¨æµé‡</strong></p><h4 id="xx-neté…ç½®"><a class="markdownIt-Anchor" href="#xx-neté…ç½®"></a> XX-NETé…ç½®</h4><p>å¯ä»¥åœ¨ <a href="https://github.com/XX-net/XX-Net">https://github.com/XX-net/XX-Net</a> ä¸‹è½½ <strong>XX-NET</strong><br />ç›´æ¥ <code>git clone https://github.com/XX-net/XX-Net.git</code><br /><img src="/uploads/images/vpn/file_008.png" alt="img" /></p><p>æˆ–è€…åœ¨è¿™é‡Œä¸‹è½½: <a href="https://github.com/XX-net/XX-Net/blob/master/code/default/download.md">https://github.com/XX-net/XX-Net/blob/master/code/default/download.md</a><br /><img src="/uploads/images/vpn/file_009.png" alt="img" /><br />ä¸­æ–‡å¸®åŠ©æ–‡æ¡£: <a href="https://github.com/XX-net/XX-Net/wiki/%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3">https://github.com/XX-net/XX-Net/wiki/%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3</a></p><p>ä¸‹è½½ä¹‹å</p><figure class="highlight dos"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dos">unzip XX-<span class="hljs-built_in">Net</span>-<span class="hljs-number">3</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>.zip<br><span class="hljs-built_in">cd</span> XX-<span class="hljs-built_in">Net</span>-<span class="hljs-number">3</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span><br>./<span class="hljs-built_in">start</span> #åå°è¿è¡Œ<br></code></pre></div></td></tr></table></figure><p><strong>PS:å»ºè®®åœ¨é…ç½®XX-NETä¹‹å‰,åå°è¿è¡Œlantern,å› ä¸ºç­‰ä¸‹éƒ¨ç½²æ—¶è¦ç™»å½•Googleè´¦å·</strong></p><p>æˆ‘åœ¨Linuxä¸‹é…ç½®æ—¶è¿˜è¦å¼€å¯<strong>ipv6</strong>é€šé“ .æ–¹æ³•å¦‚ä¸‹</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">apt</span>-get install miredo<br><span class="hljs-attribute">miredo</span> #è¿è¡Œ<br><span class="hljs-attribute">ifconfig</span>å¯ä»¥çœ‹åˆ°å¤šå‡ºä¸€ä¸ª`teredo`æ¥å£<br><br><span class="hljs-attribute">teredo</span>: flags=<span class="hljs-number">4305</span> mtu <span class="hljs-number">1280</span><br><span class="hljs-attribute">inet6</span> <span class="hljs-number">2001</span>:<span class="hljs-number">0</span>:<span class="hljs-number">53</span>aa:<span class="hljs-number">64</span>c:<span class="hljs-number">2</span>c<span class="hljs-number">46</span>:bf<span class="hljs-number">0</span>:e<span class="hljs-number">4</span>db:<span class="hljs-number">1</span>ac<span class="hljs-number">5</span> prefixlen <span class="hljs-number">32</span> scopeid <span class="hljs-number">0</span>x<span class="hljs-number">0</span><br><span class="hljs-attribute">inet6</span> fe<span class="hljs-number">80</span>::<span class="hljs-number">707</span>:<span class="hljs-number">2</span>c<span class="hljs-number">4</span>a:<span class="hljs-number">7</span>df<span class="hljs-number">6</span>:<span class="hljs-number">4104</span> prefixlen <span class="hljs-number">64</span> scopeid <span class="hljs-number">0</span>x<span class="hljs-number">20</span><br><span class="hljs-attribute">inet6</span> fe<span class="hljs-number">80</span>::ffff:ffff:ffff prefixlen <span class="hljs-number">64</span> scopeid <span class="hljs-number">0</span>x<span class="hljs-number">20</span><br><span class="hljs-attribute">unspec</span> <span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span>-<span class="hljs-number">00</span> txqueuelen <span class="hljs-number">500</span> (UNSPEC)<br><span class="hljs-attribute">RX</span> packets <span class="hljs-number">2828</span> bytes <span class="hljs-number">1820077</span> (<span class="hljs-number">1</span>.<span class="hljs-number">7</span> MiB)<br><span class="hljs-attribute">RX</span> errors <span class="hljs-number">0</span> dropped <span class="hljs-number">0</span> overruns <span class="hljs-number">0</span> frame <span class="hljs-number">0</span><br><span class="hljs-attribute">TX</span> packets <span class="hljs-number">3687</span> bytes <span class="hljs-number">397036</span> (<span class="hljs-number">387</span>.<span class="hljs-number">7</span> KiB)<br><span class="hljs-attribute">TX</span> errors <span class="hljs-number">0</span> dropped <span class="hljs-number">0</span> overruns <span class="hljs-number">0</span> carrier <span class="hljs-number">0</span> collisions <span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p>XX-NETä¸»ç•Œé¢<br /><img src="/uploads/images/vpn/file_010.png" alt="img" /></p><p>éƒ¨ç½²æœåŠ¡ç«¯â€“&gt;é…ç½®â€“&gt;æŸ¥çœ‹çŠ¶æ€</p><ul><li>éƒ¨ç½²æœåŠ¡ç«¯<br />å¤šä¸ªappidç”¨ â€œ|â€ åˆ†å‰²,ä¹‹åå¯ä»¥[å¼€å§‹éƒ¨ç½²],å†æ¬¡å¼ºè°ƒä¸€ä¸‹,é‚£ä¸ª<code>appid</code>å°±æ˜¯<strong>é¡¹ç›®å</strong><br /><img src="/uploads/images/vpn/file_011.png" alt="img" /></li></ul><p>ä¹‹åä¼šè·³è½¬åˆ°ç™»å½•Googleè´¦å·çš„çª—å£.ç™»å½•okå<strong>ç­‰å¾…éƒ¨ç½²å®Œæˆ</strong></p><ul><li>é…ç½®<br />ä¹‹ååœ¨<code>GAE AppID</code>è¾“å…¥è‡ªå·±çš„appid<br /><img src="/uploads/images/vpn/file_012.png" alt="img" /></li><li>çŠ¶æ€<br />ç¡®ä¿æ¯æ¬¡é…ç½®æ—¶æŸ¥çœ‹æ˜¯å¦é…ç½®æˆåŠŸ!<br /><img src="/uploads/images/vpn/file_013.png" alt="img" /><br />å¦‚æœå‡ºç° <code>è¯·æ£€æŸ¥æµè§ˆå™¨ä»£ç†è®¾ç½®ã€‚</code>è¡¨ç¤ºé…ç½®æˆåŠŸäº†,åªæ˜¯è¿˜éœ€è¦ <strong>â€œè®¾ç½®ä»£ç†ï¼Œæ˜¯ä¸ºäº†è®©ä½ çš„æµè§ˆå™¨æˆ–è€…å…¶ä»–åº”ç”¨ç¨‹åºçŸ¥é“XX-Netçš„å­˜åœ¨ï¼Œè¿™æ ·ä»–ä»¬æ‰ä¼šé€šè¿‡XX-Netç§‘å­¦ä¸Šç½‘ã€‚â€</strong></li><li>è§£å†³æ–¹æ³•<br />å…·ä½“æ–¹æ³•å¯ä»¥æŸ¥çœ‹ <a href="https://github.com/XX-net/XX-Net/wiki/%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86">https://github.com/XX-net/XX-Net/wiki/%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86</a></li></ul><p>ç”±äºæˆ‘ç›®å‰æ˜¯Linuxç³»ç»Ÿ,æ‰€ä»¥ æˆ‘ç”¨ <strong>Chrome+SwitchOmega(ç®¡ç†å’Œåˆ‡æ¢å¤šä¸ªä»£ç†è®¾ç½®)</strong></p><p>å¯ä»¥åœ¨chromeæµè§ˆå™¨åº”ç”¨å•†åº—å®‰è£…SwitchOmegaæ‹“å±•ç¨‹åº<br /><img src="/uploads/images/vpn/file_014.png" alt="img" /></p><p>ç„¶åæ‰“å¼€<strong>SwitchOmegaé€‰é¡¹</strong>â€“&gt;å¯¼å…¥/å¯¼å‡ºâ€“&gt;ä»å¤‡ä»½æ–‡ä»¶æ¢å¤<br />å¯¼å…¥<strong>OmegaOptions.bak</strong>æ–‡ä»¶,æ­¤æ–‡ä»¶ä½ç½®åœ¨ â€¦/XX-Net-3.8.0/SwitchyOmega/ ç›®å½•ä¸‹<br /><img src="/uploads/images/vpn/file_015.png" alt="img" /></p><p>ä¹‹åå¯ä»¥çœ‹åˆ°ä¸€ä¸‹å‡ ä¸ªé€‰é¡¹<br /><img src="/uploads/images/vpn/file_016.png" alt="img" /></p><p>ç„¶åé€‰æ‹©gaeæœåŠ¡å™¨ä»£ç†.æ¢å¤æ­£å¸¸å¯ä»¥åˆ‡æ¢å› <strong>[ç³»ç»Ÿä»£ç†]</strong><br /><img src="/uploads/images/vpn/file_017.png" alt="img" /></p><p>ç„¶åå†çœ‹çœ‹XX-NETé…ç½®çŠ¶æ€,æˆåŠŸ!<br /><img src="/uploads/images/vpn/file_018.png" alt="img" /><br />ç°åœ¨å¯ä»¥å…³é—­lanternäº†,ç„¶åå†å»è¯•è¯•çœ‹èƒ½ä¸èƒ½æ‰“å¼€ <a href="https://www.google.com">https://www.google.com</a> å§!<br /><img src="/uploads/images/vpn/file_019.png" alt="img" /><br /><img src="/uploads/images/vpn/file_020.png" alt="img" /></p><p>å»æµªå§~ :&gt;</p>]]></content>
    
    
    <categories>
      
      <category>Others</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Google</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows XX-NETä½¿ç”¨</title>
    <link href="/windows-xxnet/"/>
    <url>/windows-xxnet/</url>
    
    <content type="html"><![CDATA[<p>æœ¬ç« è®²è¿°Windowsä¸‹æ€ä¹ˆå¿«é€Ÿçš„æ­å»ºFQç¯å¢ƒ,åŒæ ·æ˜¯ç”¨XX-NET<br />åŒæ ·çš„,è¿˜æ˜¯åˆ°githubè·å–xx-net.<br />æœ¬æ–‡çš„é‡ç‚¹æ˜¯åœ¨Windowsä¸Šå¼€å§‹ <strong>IPv6</strong> .<br />åœ¨æœªå¼€å¯ipv6é¦–æ¬¡æ‰“å¼€xx-netæ—¶,ä¼šæ˜¾ç¤º <strong>å°šæœªå»ºç«‹è¿æ¥</strong>.</p><span id="more"></span><p><font color=green>PSï¼š ä»¥ä¸‹æ–¹æ³•å¯èƒ½æ¯”è¾ƒæ—§ï¼Œç›®å‰æˆ‘ä½¿ç”¨çš„æ˜¯X-Tunnel</font></p><h4 id="å¼€å¯ipv6"><a class="markdownIt-Anchor" href="#å¼€å¯ipv6"></a> å¼€å¯ipv6</h4><p>ç›´æ¥åœ¨ <strong>cmdå‘½ä»¤æç¤ºç¬¦</strong> ä¸‹è¾“å…¥ä¸€ä¸‹å‘½ä»¤</p><figure class="highlight pf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs pf">//teredoæœåŠ¡å™¨ï¼šteredo-debian.remlab.net<br>netsh interface teredo <span class="hljs-built_in">set</span> <span class="hljs-keyword">state</span> server=teredo-debian.remlab.net<br>netsh int ter <span class="hljs-built_in">set</span> <span class="hljs-keyword">state</span> enterpriseclient<br>netsh int ipv6 show teredo//æŸ¥çœ‹çŠ¶æ€<br></code></pre></div></td></tr></table></figure><blockquote><p>Teredo å‚æ•°<br />-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“<br />ç±»å‹ : enterpriseclient<br />æœåŠ¡å™¨åç§° : <a href="http://teredo-debian.remlab.net">teredo-debian.remlab.net</a><br />å®¢æˆ·ç«¯åˆ·æ–°é—´éš” : 30 ç§’<br />å®¢æˆ·ç«¯ç«¯å£ : unspecified<br />çŠ¶æ€ : qualified<br />å®¢æˆ·ç«¯ç±»å‹ : teredo client<br />ç½‘ç»œ : unmanaged<br />NAT : restricted<br />NAT ç‰¹æ®Šè¡Œä¸º : UPNP: æ˜¯ï¼ŒPortPreserving: å¦<br />æœ¬åœ°æ˜ å°„ : 192.168.1.103:64530<br />å¤–éƒ¨ NAT æ˜ å°„ : <a href="http://xxx.xxx.xxx.xxx:23441">xxx.xxx.xxx.xxx:23441</a></p></blockquote><p><img src="/uploads/images/win_vpn/file_013.png" alt="img" /></p><h4 id="æ¢å¤teredo"><a class="markdownIt-Anchor" href="#æ¢å¤teredo"></a> æ¢å¤teredo</h4><p>æ–­å¼€è¿æ¥çš„è¯,å¯ä»¥ç›´æ¥ <strong>é€€å‡º</strong> xx-net,è¿˜éœ€åœ¨cmdä¸‹è¾“å…¥ä¸€ä¸‹å‘½ä»¤å³å¯</p><figure class="highlight angelscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs angelscript"><span class="hljs-comment">//æ¢å¤teredo</span><br>netsh <span class="hljs-keyword">interface</span> <span class="hljs-symbol">teredo</span> <span class="hljs-symbol">set</span> <span class="hljs-symbol">state</span> <span class="hljs-symbol">default</span> <span class="hljs-symbol">server</span>=<span class="hljs-symbol">default</span><br><span class="hljs-symbol">netsh</span> <span class="hljs-symbol">int</span> <span class="hljs-symbol">ipv6</span> <span class="hljs-symbol">show</span> <span class="hljs-symbol">teredo</span> //æŸ¥çœ‹çŠ¶æ€<br></code></pre></div></td></tr></table></figure><blockquote><p>Teredo å‚æ•°<br />-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“<br />ç±»å‹ : client<br />æœåŠ¡å™¨åç§° : teredo.ipv6.micr<br />å®¢æˆ·ç«¯åˆ·æ–°é—´éš” : 30 ç§’<br />å®¢æˆ·ç«¯ç«¯å£ : unspecified<br />çŠ¶æ€ : offline<br />é”™è¯¯ : æœªèƒ½è§£ææœåŠ¡å™¨å</p></blockquote><h4 id="ieæµè§ˆå™¨ä»£ç†è®¾ç½®"><a class="markdownIt-Anchor" href="#ieæµè§ˆå™¨ä»£ç†è®¾ç½®"></a> IEæµè§ˆå™¨ä»£ç†è®¾ç½®</h4><p><img src="/uploads/images/win_vpn/file_017.png" alt="img" /></p><p>é»˜è®¤æƒ…å†µä¸‹,IEæµè§ˆå™¨æ—¶æ²¡æœ‰è®¾ç½®ä»£ç†,æ‰€ä»¥ä¹Ÿå°±æ— æ³•è®¿é—®ä¸€äº›ç½‘ç«™.è¿™é‡Œä»‹ç»ä¸¤ç§æ–¹æ³•</p><h5 id="interneté€‰é¡¹lanè®¾ç½®"><a class="markdownIt-Anchor" href="#interneté€‰é¡¹lanè®¾ç½®"></a> Interneté€‰é¡¹(LAN)è®¾ç½®</h5><p>æ‰“å¼€IEæµè§ˆå™¨&gt;&gt;Interneté€‰é¡¹&gt;&gt;è¿æ¥&gt;&gt;<strong>å±€åŸŸç½‘(LAN)è®¾ç½®</strong>,ä¹‹å å‹¾é€‰ ä»£ç†æœåŠ¡å™¨ä¹‹ä¸€,å¹¶å¡«å…¥ <strong>åœ°å€</strong> å’Œ <strong>ç«¯å£</strong> ,å…¶ä¸­åœ°å€é»˜è®¤ <code>127.0.0.1</code> ,ç«¯å£å¯ä»¥ä» GAEProxyçŠ¶æ€ä¿¡æ¯ &gt;&gt; é…ç½® å±æ€§é‡Œçš„ <strong>ç›‘å¬ä»£ç†</strong> ä¸º <code>8087</code></p><p><img src="/uploads/images/win_vpn/file_015.png" alt="img" /><br /><img src="/uploads/images/win_vpn/file_016.png" alt="img" /></p><h5 id="èŠ±åˆºä»£ç†proxythorn"><a class="markdownIt-Anchor" href="#èŠ±åˆºä»£ç†proxythorn"></a> èŠ±åˆºä»£ç†(ProxyThorn)</h5><p>æ·»åŠ ä»£ç†<br /><img src="/uploads/images/win_vpn/file_018.png" alt="img" /></p><p>å¡«å…¥gaeçš„æœåŠ¡å™¨åœ°å€ä»¥åŠç«¯å£<br /><img src="/uploads/images/win_vpn/file_019.png" alt="img" /></p><p>å…ˆéªŒè¯å†è®¾ä¸ºIEä»£ç†<br /><img src="/uploads/images/win_vpn/file_020.png" alt="img" /></p><p>ç„¶ååœ¨æ¬¡åˆ·æ–°IEæµè§ˆå™¨å³å¯å†æ¬¡çœ‹åˆ°Googleä¸»é¡µ!</p><p>bye</p>]]></content>
    
    
    <categories>
      
      <category>Others</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Google</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gnome gedité…ç½®</title>
    <link href="/linux-gnome-setting/"/>
    <url>/linux-gnome-setting/</url>
    
    <content type="html"><![CDATA[<p>ä¸çŸ¥ä»€ä¹ˆåŸå› ,geditæ‰¾ä¸åˆ°é¦–é€‰é¡¹,æ‰€ä»¥ä¹Ÿæ— æ³•ç›´æ¥ä¿®æ”¹é…ç½®,ç»ä¸€ç•ªç¢ç£¨,è®°å½•ä¸‹è¿‡ç¨‹â€¦</p><span id="more"></span><h4 id="gsettings"><a class="markdownIt-Anchor" href="#gsettings"></a> gsettings</h4><p>æœ¬æ–‡ç”¨åˆ°æ­¤å·¥å…·,ç”¨å®ƒæ¥æŸ¥è¯¢,ä¿®æ”¹ <strong>Gnomeæ¡Œé¢ç¯å¢ƒé…ç½®</strong> ,å…³äºå®ƒçš„ç”¨æ³•å¯ä»¥ç›´æ¥æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£<br />æ¯”å¦‚ <code>gsettings list-recursively</code> å°±ä¼šè¾“å‡ºå¾ˆå¤šä¿¡æ¯</p><blockquote><p>â€¦â€¦<br />org.gnome.gnome-system-monitor.proctree col-20-visible false<br />org.gnome.gnome-system-monitor.proctree col-10-visible false<br />org.gnome.gnome-system-monitor.proctree col-6-width 90<br />org.gnome.gnome-system-monitor.proctree col-22-visible true<br />org.gnome.gnome-system-monitor.proctree col-14-visible false<br />org.gnome.gnome-system-monitor.proctree col-13-visible false<br />org.gnome.gnome-system-monitor.proctree col-11-visible false<br />org.gnome.gnome-system-monitor.proctree col-7-width 90<br />org.gnome.gnome-system-monitor.proctree col-16-visible false<br />org.gnome.gnome-system-monitor.proctree col-15-visible true<br />org.gnome.gnome-system-monitor.proctree col-10-width 70<br />org.gnome.gnome-system-monitor.proctree col-8-width 71<br />org.gnome.gnome-system-monitor.proctree col-18-visible false<br />org.gnome.GWeather distance-unit â€˜kmâ€™<br />â€¦â€¦</p></blockquote><p>è·å–å…³äº <strong>gedit</strong> çš„é…ç½®ä¿¡æ¯ <code>gsettings list-recursively |grep org.gnome.gedit.preferences.editor</code> å°±ä¼šè¾“å‡ºå¾ˆå¤š é”®å€¼å¯¹ .</p><h5 id="æ˜¾ç¤ºè¡Œå·"><a class="markdownIt-Anchor" href="#æ˜¾ç¤ºè¡Œå·"></a> æ˜¾ç¤ºè¡Œå·</h5><blockquote><p>gsettings set org.gnome.gedit.preferences.editor display-line-numbers true</p></blockquote><h5 id="é«˜äº®å½“å‰è¡Œ"><a class="markdownIt-Anchor" href="#é«˜äº®å½“å‰è¡Œ"></a> é«˜äº®å½“å‰è¡Œ</h5><blockquote><p>gsettings set org.gnome.gedit.preferences.editor highlight-current-line true</p></blockquote><h5 id="å³ä¾§é¢„è§ˆ"><a class="markdownIt-Anchor" href="#å³ä¾§é¢„è§ˆ"></a> å³ä¾§é¢„è§ˆ</h5><blockquote><p>gsettings set org.gnome.gedit.preferences.editor display-overview-map true</p></blockquote><h5 id="ä¿®æ”¹ä¸»é¢˜"><a class="markdownIt-Anchor" href="#ä¿®æ”¹ä¸»é¢˜"></a> ä¿®æ”¹ä¸»é¢˜</h5><p>å…¶ä¸­ä¸»é¢˜æ–‡ä»¶ä¸ºxmlæ ¼å¼,ä½äº <strong>/usr/share/gtksourceview-3.0/styles</strong> ,å¯ä»¥åœ¨ <a href="https://github.com/mig/gedit-themes">https://github.com/mig/gedit-themes</a> è·å–é¢å¤–çš„ä¸»é¢˜æ–‡ä»¶.</p><blockquote><p>gsettings set org.gnome.gedit.preferences.editor scheme <strong>oblivion</strong></p></blockquote><p>å…¶ä¸­ <strong>oblivion</strong> ä¸ºä¸»é¢˜æ–‡ä»¶å(é™¤å»åç¼€.xml)</p><h5 id="ä¿®æ”¹å­—ä½“"><a class="markdownIt-Anchor" href="#ä¿®æ”¹å­—ä½“"></a> ä¿®æ”¹å­—ä½“</h5><p>åœ¨ä¿®æ”¹å­—ä½“ä¹‹å‰ä¸€å®šè¦æŠŠä½¿ç”¨é»˜è®¤å­—ä½“çš„è®¾ä¸º<code>false</code> ! ä¸ç„¶ä¸ä¼šç”Ÿæ•ˆ</p><blockquote><p>gsettings set org.gnome.gedit.preferences.editor <strong>use-default-font</strong> <strong>false</strong><br />gsettings set org.gnome.gedit.preferences.editor editor-font <strong>â€œMonospace 11â€</strong></p></blockquote><p><code>Monospace</code>ä¸ºå­—ä½“åç§° , <code>11</code> ä¸ºå­—ä½“å¤§å°,ä¹‹å‰è¦æœ‰ç©ºæ ¼</p><h4 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h4><p>æœ€å,byeâ€¦â€¦</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>GNOME</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WindowsAPIè·å–æ“ä½œç³»ç»Ÿä¸»æ¬¡ç‰ˆæœ¬å·</title>
    <link href="/windows-getosversion/"/>
    <url>/windows-getosversion/</url>
    
    <content type="html"><![CDATA[<p>åˆ—ä¸¾äº†ä¸€äº›ç›®å‰æ‰€çŸ¥é“çš„æ–¹æ³•æ¥è·å–Windowsæ“ä½œç³»ç»Ÿç‰ˆæœ¬å·</p><span id="more"></span><ul><li>æ–¹æ³•1 <strong>RtlGetNtVersionNumbers</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//å®šä¹‰å‡½æ•°æŒ‡é’ˆ</span><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">void</span><span class="hljs-params">(__stdcall*NTPROC)</span><span class="hljs-params">(DWORD*, DWORD*, DWORD*)</span></span>;<br><span class="hljs-comment">//è½½å…¥æ¨¡å—</span><br>HMODULE hmod= <span class="hljs-built_in">LoadLibraryA</span>(<span class="hljs-string">&quot;ntdll.dll&quot;</span>);<br><span class="hljs-comment">//è·å–å‡½æ•°åœ°å€</span><br>NTPROC RtlGetNtVersionNumbers = (NTPROC)<span class="hljs-built_in">GetProcAddress</span>(hmod, <span class="hljs-string">&quot;RtlGetNtVersionNumbers&quot;</span>);<br>DWORD dwMajor, dwMin, dwOpt;<br><span class="hljs-built_in">RtlGetNtVersionNumbers</span>(&amp;dwMajor, &amp;dwMin, &amp;dwOpt);<br><span class="hljs-comment">//å¸è½½æ¨¡å—</span><br><span class="hljs-built_in">FreeLibrary</span>(hmod);<br></code></pre></div></td></tr></table></figure><ul><li>æ–¹æ³•2 <strong>GetVersion</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">DWORD dwVersion= <span class="hljs-built_in">GetVersion</span>();<br><span class="hljs-comment">//ä½16ä½</span><br>WORD lwo = <span class="hljs-built_in">LOWORD</span>(dwVersion);<br>BYTE minor = <span class="hljs-built_in">HIBYTE</span>(lwo);<span class="hljs-comment">//æ¬¡ç‰ˆæœ¬å·</span><br>BYTE major = <span class="hljs-built_in">LOBYTE</span>(lwo);   <span class="hljs-comment">//ä¸»ç‰ˆæœ¬å·</span><br><span class="hljs-keyword">if</span> (major ==<span class="hljs-number">10</span>)  <span class="hljs-built_in">SetWindowText</span>(<span class="hljs-string">L&quot;Windows 10&quot;</span>);<br><span class="hljs-keyword">if</span> (major ==<span class="hljs-number">6</span>)  <span class="hljs-built_in">SetWindowText</span>(<span class="hljs-string">L&quot;Windows 7&quot;</span>);<br><br></code></pre></div></td></tr></table></figure><ul><li>æ–¹æ³•3 <strong>GetVersionEx</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">BOOL <span class="hljs-title">GetVersionEx</span><span class="hljs-params">(POSVERSIONINFO pVersionInformation)</span></span>;<br> <br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span> <br>DWORD dwOSVersionInfoSize;       <span class="hljs-comment">//åœ¨ä½¿ç”¨GetVersionExä¹‹å‰è¦å°†æ­¤åˆå§‹åŒ–ä¸ºç»“æ„çš„å¤§å° </span><br>DWORD dwMajorVersion;               <span class="hljs-comment">//ç³»ç»Ÿä¸»ç‰ˆæœ¬å· </span><br>DWORD dwMinorVersion;               <span class="hljs-comment">//ç³»ç»Ÿæ¬¡ç‰ˆæœ¬å· </span><br>DWORD dwBuildNumber;               <span class="hljs-comment">//ç³»ç»Ÿæ„å»ºå· </span><br>DWORD dwPlatformId;                  <span class="hljs-comment">//ç³»ç»Ÿæ”¯æŒçš„å¹³å° </span><br>TCHAR szCSDVersion[<span class="hljs-number">128</span>];          <span class="hljs-comment">//ç³»ç»Ÿè¡¥ä¸åŒ…çš„åç§° </span><br>WORD wServicePackMajor;            <span class="hljs-comment">//ç³»ç»Ÿè¡¥ä¸åŒ…çš„ä¸»ç‰ˆæœ¬ </span><br>WORD wServicePackMinor;            <span class="hljs-comment">//ç³»ç»Ÿè¡¥ä¸åŒ…çš„æ¬¡ç‰ˆæœ¬ </span><br>WORD wSuiteMask;                      <span class="hljs-comment">//æ ‡è¯†ç³»ç»Ÿä¸Šçš„ç¨‹åºç»„ </span><br>BYTE wProductType;                    <span class="hljs-comment">//æ ‡è¯†ç³»ç»Ÿç±»å‹ </span><br>BYTE wReserved;                         <span class="hljs-comment">//ä¿ç•™,æœªä½¿ç”¨ </span><br>&#125;OSVERSIONINFOEX, *POSVERSIONINFOEX;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„,ä½¿ç”¨è¯¥å‡½æ•°åœ¨Windows8å’ŒWindows10ä¹‹é—´è·å–çš„æ˜¯åŒä¸€ä¸ªä¸»æ¬¡ç‰ˆæœ¬å·,æ‰€ä»¥,è¦åœ¨é¡¹ç›®æ·»åŠ ä¸€ä¸ªæ¸…å•æ–‡ä»¶(manifest)<br /><strong>é…ç½®å±æ€§-&gt;æ¸…å•å·¥å…·-&gt;è¾“å…¥å’Œè¾“å‡º-é™„åŠ æ¸…å•æ–‡ä»¶,å¡«å†™manifest.xml</strong></p><p><strong>manifest.xmlæ–‡ä»¶å†…å®¹</strong></p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span> <br><span class="hljs-tag">&lt;<span class="hljs-name">assembly</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;urn:schemas-microsoft-com:asm.v1&quot;</span> <span class="hljs-attr">manifestVersion</span>=<span class="hljs-string">&quot;1.0&quot;</span>&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">compatibility</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;urn:schemas-microsoft-com:compatibility.v1&quot;</span>&gt;</span> <br>        <span class="hljs-tag">&lt;<span class="hljs-name">application</span>&gt;</span>   <br>            <span class="hljs-comment">&lt;!-- Windows 10 --&gt;</span>   <br>            <span class="hljs-tag">&lt;<span class="hljs-name">supportedOS</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;&#123;8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a&#125;&quot;</span>/&gt;</span>  <br>            <span class="hljs-comment">&lt;!-- Windows 8.1 --&gt;</span>  <br>            <span class="hljs-tag">&lt;<span class="hljs-name">supportedOS</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;&#123;1f676c76-80e1-4239-95bb-83d0f6d0da78&#125;&quot;</span>/&gt;</span>  <br>            <span class="hljs-comment">&lt;!-- Windows Vista --&gt;</span>  <br>            <span class="hljs-tag">&lt;<span class="hljs-name">supportedOS</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;&#123;e2011457-1546-43c5-a5fe-008deee3d3f0&#125;&quot;</span>/&gt;</span>   <br>            <span class="hljs-comment">&lt;!-- Windows 7 --&gt;</span>  <br>            <span class="hljs-tag">&lt;<span class="hljs-name">supportedOS</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;&#123;35138b9a-5d96-4fbd-8e2d-a2440225f93a&#125;&quot;</span>/&gt;</span>  <br>            <span class="hljs-comment">&lt;!-- Windows 8 --&gt;</span>  <br>            <span class="hljs-tag">&lt;<span class="hljs-name">supportedOS</span> <span class="hljs-attr">Id</span>=<span class="hljs-string">&quot;&#123;4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38&#125;&quot;</span>/&gt;</span>  <br>        <span class="hljs-tag">&lt;/<span class="hljs-name">application</span>&gt;</span>   <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">compatibility</span>&gt;</span> <br><span class="hljs-tag">&lt;/<span class="hljs-name">assembly</span>&gt;</span><br></code></pre></div></td></tr></table></figure><ul><li>æ³•4 <strong>PsGetVersion,åœ¨å†…æ ¸é©±åŠ¨ç¨‹åºä¸­è°ƒç”¨è¯¥å‡½æ•°</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">BOOLEAN <span class="hljs-title">PsGetVersion</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">PULONG MajorVersion OPTIONAL,</span></span><br><span class="hljs-params"><span class="hljs-function">PULONG MinorVersion OPTIONAL,</span></span><br><span class="hljs-params"><span class="hljs-function">PULONG BuildNumber OPTIONAL,</span></span><br><span class="hljs-params"><span class="hljs-function">PUNICODE_STRING CSDVersion OPTIONAL</span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>;<br>MajorVersion æ˜¯ä¸»ç‰ˆæœ¬å·<br>MinorVersion æ˜¯å‰¯ç‰ˆæœ¬å·<br>BuildNumber æ˜¯buildç‰ˆæœ¬å·ï¼Œå¦‚<span class="hljs-number">7600</span>ç­‰<br>CSDVersion å­˜æ”¾ç€SP1ã€SP2ç­‰ä¿¡æ¯<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++ç¼–å†™åŠ¨æ€é“¾æ¥åº“Dll+è°ƒç”¨Dll</title>
    <link href="/cpp-call-dll/"/>
    <url>/cpp-call-dll/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h3><blockquote><p>åŠ¨æ€é“¾æ¥æä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œä½¿è¿›ç¨‹å¯ä»¥è°ƒç”¨ä¸å±äºå…¶å¯æ‰§è¡Œä»£ç çš„å‡½æ•°ã€‚å‡½æ•°çš„å¯æ‰§è¡Œä»£ç ä½äºä¸€ä¸ª DLL æ–‡ä»¶ä¸­ï¼Œè¯¥ DLL åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå·²è¢«ç¼–è¯‘ã€é“¾æ¥å¹¶ä¸ä½¿ç”¨å®ƒä»¬çš„è¿›ç¨‹åˆ†å¼€å­˜å‚¨çš„å‡½æ•°ã€‚DLL è¿˜æœ‰åŠ©äºå…±äº«æ•°æ®å’Œèµ„æºã€‚å¤šä¸ªåº”ç”¨ç¨‹åºå¯åŒæ—¶è®¿é—®å†…å­˜ä¸­å•ä¸ª DLL å‰¯æœ¬çš„å†…å®¹ã€‚<br />ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“å¯ä»¥æ›´ä¸ºå®¹æ˜“åœ°å°†æ›´æ–°åº”ç”¨äºå„ä¸ªæ¨¡å—ï¼Œè€Œä¸ä¼šå½±å“è¯¥ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œæ‚¨æœ‰ä¸€ä¸ªå¤§å‹ç½‘ç»œæ¸¸æˆï¼Œå¦‚æœæŠŠæ•´ä¸ªæ•°ç™¾MBç”šè‡³æ•°GBçš„æ¸¸æˆçš„ä»£ç éƒ½æ”¾åœ¨ä¸€ä¸ªåº”ç”¨ç¨‹åºé‡Œï¼Œæ—¥åçš„ä¿®æ”¹å·¥ä½œå°†ä¼šååˆ†è´¹æ—¶ï¼Œè€Œå¦‚æœæŠŠä¸åŒåŠŸèƒ½çš„ä»£ç åˆ†åˆ«æ”¾åœ¨æ•°ä¸ªåŠ¨æ€é“¾æ¥åº“ä¸­ï¼Œæ‚¨æ— éœ€é‡æ–°ç”Ÿæˆæˆ–å®‰è£…æ•´ä¸ªç¨‹åºå°±å¯ä»¥åº”ç”¨æ›´æ–°</p></blockquote><span id="more"></span><h3 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h3><p>æœ¬æ–‡å°±Windowsä¸‹åˆ›å»ºä¸€ä¸ªdllåŠ¨æ€åº“å¹¶è°ƒç”¨</p><ul><li>æ‰“å¼€VS2013ï¼Œæ–°å»ºä¸€ä¸ªC++å·¥ç¨‹ï¼ˆä¸æ˜¯MFCï¼ï¼‰ï¼Œå‘½åä¸º â€œmydllâ€ï¼Œæ¥ç€é€‰ä¸­ â€œDLLâ€ï¼Œâ€å¯¼å‡ºç¬¦å·â€ï¼Œç›´æ¥å®Œæˆ</li><li>è¿™æ—¶ï¼Œçœ‹åˆ°çš„æ˜¯é»˜è®¤åˆå§‹åŒ–å¥½äº†çš„ä»£ç ï¼Œæˆ‘ä»¬æŠŠä¸€äº›ä¸å¿…è¦çš„åˆ æ‰ï¼ˆå…¶å®é‚£äº›æ˜¯ç”¨æ¥å‚è€ƒçš„ï¼Œå®é™…ç¼–å†™æ—¶åˆ æ‰ä¹Ÿæ— å¤§ç¢ï¼‰ã€‚<br />ç„¶ååœ¨â€œmydll.hâ€å¤´æ–‡ä»¶é‡Œæ·»åŠ  ä¸‹åˆ—ä»£ç ï¼š</li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function">MYDLL_API  <span class="hljs-keyword">int</span>  _stdcall <span class="hljs-title">GetMaxNumber</span><span class="hljs-params">(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>)</span></span>;<br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function">MYDLL_API <span class="hljs-keyword">void</span>  _stdcall <span class="hljs-title">ShowMsg</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *, <span class="hljs-keyword">char</span>*)</span></span>;<br></code></pre></div></td></tr></table></figure><p>åœ¨â€œmydll.cppâ€æºæ–‡ä»¶æ·»åŠ  å¦‚ä¸‹å›¾æ‰€ç¤ºçš„åŠŸèƒ½å®ç°ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function">MYDLL_API  <span class="hljs-keyword">int</span>  _stdcall <span class="hljs-title">GetMaxNumber</span><span class="hljs-params">(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">return</span> a&gt;b?a*<span class="hljs-number">100</span>:b;<br>&#125;<br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> <span class="hljs-function">MYDLL_API <span class="hljs-keyword">void</span>  _stdcall <span class="hljs-title">ShowMsg</span><span class="hljs-params">(<span class="hljs-keyword">char</span> * text, <span class="hljs-keyword">char</span>* title)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">MessageBoxA</span>(<span class="hljs-literal">NULL</span>,text,title,MB_OK);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>OK!ç°åœ¨ä»£ç ç®€ç®€å•å•çš„å†™å®Œäº†ï¼Œé‚£å¦‚ä½•ç¼–è¯‘æˆ .dll æ–‡ä»¶å‘¢ï¼Ÿ<br />å•å‡»èœå•æ  &gt;â€ç”Ÿæˆâ€&gt;â€ç”Ÿæˆ mydllâ€ï¼Œç¼–è¯‘æˆåŠŸã€‚ï¼ˆæ³¨æ„ï¼Œä¸æ˜¯ è°ƒè¯•ä¸‹çš„å¼€å§‹æ‰§è¡Œâ€¦ï¼‰<br />ç„¶åæ‰¾åˆ°å·¥ç¨‹çš„ç›®å½•æ‰€åœ¨è·¯å¾„ï¼ŒDeBugç›®å½•ä¸‹æ‰¾åˆ° é‚£ä¸ªç”Ÿæˆçš„ â€œmydll.dllâ€ï¼ˆç°åœ¨æ˜¯ä¸æ˜¯å¾ˆæ¿€åŠ¨å‘¢ ğŸ˜ƒ</p><h3 id="æµ‹è¯•"><a class="markdownIt-Anchor" href="#æµ‹è¯•"></a> æµ‹è¯•</h3><ul><li>åœ¨é‡æ–°åˆ›å»ºä¸€ä¸ªå·¥ç¨‹ï¼Œè¿™æ¬¡æ˜¯ä¸€ä¸ªC++ä¸‹çš„æ§åˆ¶å°åº”ç”¨ç¨‹åºæ¥æµ‹è¯•ç¼–å†™çš„dllæ˜¯å¦æˆåŠŸè¿è¡Œï¼ï¼<br />å·¥ç¨‹åä¸ºâ€œtest_mydllâ€</li><li>æ·»åŠ ä¸€ä¸ª.cppæºæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br /><strong>ï¼ˆæ³¨æ„ï¼Œè¦æŠŠ mydll.dll æ”¾åˆ° ç”Ÿæˆçš„.exe åŒä¸€ç›®å½•ä¸‹ï¼‰</strong></li></ul><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><br><span class="hljs-comment">//å…¨å±€...</span><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span><span class="hljs-params">(_stdcall *pGetMaxN)</span><span class="hljs-params">(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>)</span></span>;<span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆç±»å‹</span><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">void</span><span class="hljs-params">(_stdcall *pShowMsg)</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *, <span class="hljs-keyword">char</span> *)</span></span>;<br><span class="hljs-built_in">main</span>()...<br><span class="hljs-comment">//åŠ¨æ€åŠ è½½ dll</span><br>HMODULE hModule = <span class="hljs-built_in">LoadLibrary</span>(<span class="hljs-string">L&quot;mydll.dll&quot;</span>);<br><span class="hljs-keyword">if</span> (!hModule)<br>&#123;<br>cout &lt;&lt; <span class="hljs-string">&quot;Error!&quot;</span> &lt;&lt; endl;<br>&#125;<br><span class="hljs-comment">//è·å–å‡½æ•° GetMaxNumber çš„åœ°å€</span><br>pGetMaxN pgetm = (pGetMaxN)<span class="hljs-built_in">GetProcAddress</span>(hModule, <span class="hljs-string">&quot;GetMaxNumber&quot;</span>);<br>cout &lt;&lt; <span class="hljs-built_in">pgetm</span>(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>) &lt;&lt; endl;<br><span class="hljs-comment">//è·å–å‡½æ•° ShowMsg çš„åœ°å€</span><br>pShowMsg pshowm = (pShowMsg)<span class="hljs-built_in">GetProcAddress</span>(hModule, <span class="hljs-string">&quot;ShowMsg&quot;</span>);<br><span class="hljs-built_in">pshowm</span>(<span class="hljs-string">&quot;å†…å®¹&quot;</span>, <span class="hljs-string">&quot;æ ‡é¢˜&quot;</span>);<br><span class="hljs-comment">//é‡Šæ”¾</span><br><span class="hljs-built_in">FreeLibrary</span>(hModule);<br><br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œè¦æé†’ä¸€ä¸‹å“¦ï¼Œä¸Šé¢çš„æ˜¯åŠ¨æ€åŠ è½½dllçš„ï¼Œæ‰€ä»¥ï¼Œå°±ä¹Ÿæ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸€ç›´éƒ½æ²¡æœ‰ä½¿ç”¨åŸæ¥çš„dllå·¥ç¨‹ç”Ÿæˆäº†é‚£ä¸ªâ€œmydll.libâ€çš„æ–‡ä»¶ï¼<br />é‚£ä¹ˆç°åœ¨ä»¥é™æ€è°ƒç”¨dll ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œä½† è¦æŠŠé‚£ä¸ª.libæ–‡ä»¶å’Œ .hå¤´æ–‡ä»¶æ”¾åˆ° ä¸.cpp åŒä¸€ä¸ªç›®å½•ä¸‹ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªä¸æ˜¯.dllæ–‡ä»¶ï¼Œæ‰€ä»¥å¯ä»¥æ”¾åœ¨ ä¸.cppåŒä¸€ä¸ªç›®å½•ä¸‹ï¼ï¼ï¼ï¼ï¼‰</p><p><img src="/uploads/images/cpp/0.png" alt="img" /></p><p>ç„¶åï¼Œå¯ä»¥æ”¾å¿ƒçš„å§ä»¥å‰åŠ¨æ€è°ƒç”¨çš„ä»£ç æ³¨é‡Šæ‰å•¦ï¼Œæ·»åŠ æ–°ä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//åŠ¨æ€</span><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span><span class="hljs-params">( _stdcall *pGetMaxN)</span><span class="hljs-params">(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>)</span></span>; <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆç±»å‹</span><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">void</span><span class="hljs-params">( _stdcall *pShowMsg)</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *, <span class="hljs-keyword">char</span> *)</span></span>;<br><span class="hljs-comment">//é™æ€</span><br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> __declspec(dllimport) <span class="hljs-function"><span class="hljs-keyword">int</span> _stdcall <span class="hljs-title">GetMaxNumber</span><span class="hljs-params">(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>)</span></span>;<br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> __declspec(dllimport) <span class="hljs-function"><span class="hljs-keyword">void</span> _stdcall <span class="hljs-title">ShowMsg</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *, <span class="hljs-keyword">char</span>*)</span></span>;<br><br></code></pre></div></td></tr></table></figure><p>Bye~</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Qtæ³¨å†Œçƒ­é”®QHotkey</title>
    <link href="/qt-reg-hotkey/"/>
    <url>/qt-reg-hotkey/</url>
    
    <content type="html"><![CDATA[<p>è¦æƒ³åœ¨Qtæ”¯æŒå…¨å±€æ³¨å†Œçƒ­é”®ï¼ŒWindowsä¸‹æ–¹æ³•å¾ˆç®€å•RegisterHotKeyå‡½æ•°å¯ä»¥æ»¡è¶³ã€‚å½“ç„¶ï¼Œè¿™åªèƒ½åœ¨Windowsä¸‹æ“ä½œï¼Œé‚£ä¹ˆï¼Œæ˜¯å¦æœ‰ä¸€ä¸ªè·¨å¹³å°çš„å…¨å±€æ³¨å†Œçƒ­é”®åº“æ–¹ä¾¿ä½¿ç”¨å‘¢ï¼Ÿ</p><span id="more"></span><h3 id="qhotkey"><a class="markdownIt-Anchor" href="#qhotkey"></a> QHotkey</h3><p><a href="https://www.qpm.io/packages/de.skycoder42.qhotkey/index.html">å®˜ç½‘</a></p><p><a href="https://github.com/Skycoder42/QHotkey">Github</a></p><p><a href="https://skycoder42.github.io/QHotkey/class_q_hotkey.html">QHotkeyç±»å‚è€ƒ</a></p><p><strong>PS: QHotkeyé€‚ç”¨äº Windows, Mac ï¼Œ X11</strong></p><p>ä»githubä¸Šè·å–æºæ–‡ä»¶ï¼Œè‡ªè¡Œç¼–è¯‘(æ— éœ€å®‰è£…)</p><blockquote><p>git clone <a href="https://github.com/Skycoder42/QHotkey.git">https://github.com/Skycoder42/QHotkey.git</a><br />cd QHotkey<br />qmake<br />make</p></blockquote><p>ä¹‹åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹<br />åˆ›å»ºä¸€ä¸ªQté¡¹ç›®ï¼Œåœ¨ .pro ä¸­æ·»åŠ </p><p>include(QHotkey/qhotkey.pri)<br />LIBS += -L$$PWD/QHotkey/QHotkey -lQHotkey<br />INCLUDEPATH += $$PWD/QHotkey/QHotkey</p><p>æ³¨æ„ï¼Œæˆ‘æŠŠ QHotkey æ–‡ä»¶å¤¹å¤åˆ¶åˆ°é¡¹ç›®ç›®å½•ä¸‹ï¼Œå¹¶ä¸”è¦include <strong>qhotkey.pri</strong><br />LIBS å’Œ INCLUDEPATHä¸èƒ½ç›´æ¥å†™æˆï¼Œå¦åˆ™å‡ºç° <strong>No such file or directory</strong>ï¼š<br />LIBS += -LQHotkey/QHotkey -lQHotkey<br />INCLUDEPATH += QHotkey/QHotkey</p><p>ä¸»è¦ä»£ç å®ä¾‹</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;QHotkey&quot;</span></span><br><span class="hljs-keyword">bool</span> ispressed=<span class="hljs-literal">false</span>;<br>Widget::<span class="hljs-built_in">Widget</span>(QWidget *parent) :<br>    <span class="hljs-built_in">QWidget</span>(parent),<br>    <span class="hljs-built_in">ui</span>(<span class="hljs-keyword">new</span> Ui::Widget)<br>&#123;<br>    ui-&gt;<span class="hljs-built_in">setupUi</span>(<span class="hljs-keyword">this</span>);<br>    <span class="hljs-comment">// è¿‡æ»¤è­¦å‘Š</span><br>    QLoggingCategory::<span class="hljs-built_in">setFilterRules</span>(<span class="hljs-built_in">QStringLiteral</span>(<span class="hljs-string">&quot;QHotkey.warning=false&quot;</span>));<br><span class="hljs-comment">// Ctrl+P ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼</span><br>    QHotkey *hotkey = <span class="hljs-keyword">new</span> QHotkey&#123;<span class="hljs-built_in">QKeySequence</span>(<span class="hljs-string">&quot;Ctrl+P&quot;</span>),<span class="hljs-literal">true</span>&#125;; <br>    <span class="hljs-built_in">connect</span>(hotkey, &amp;QHotkey::activated, [<span class="hljs-keyword">this</span>]()&#123;<br>        <span class="hljs-comment">//è¿™é‡Œè¿›è¡Œåˆ¤æ–­,åªå…è®¸æŒ‰ä¸‹ä¸€æ¬¡</span><br>        <span class="hljs-keyword">if</span>(ispressed==<span class="hljs-literal">false</span>)&#123;<br>            ispressed=<span class="hljs-literal">true</span>;<br>            QMessageBox::<span class="hljs-built_in">information</span>(<span class="hljs-keyword">this</span>,<span class="hljs-string">&quot;Hello&quot;</span>,<span class="hljs-string">&quot;Hello&quot;</span>);<br>            ispressed=<span class="hljs-literal">false</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            ispressed=<span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>     &#125;);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>é»˜è®¤çš„ï¼ŒQHotkeyä¼šæ‰“å°ä¸€äº›è­¦å‘Šä¿¡æ¯ï¼Œä¸è¿‡å¯ä»¥ç”¨ <strong>QLoggingCategory::setFilterRules</strong> è¿‡æ»¤æ‰è¿™äº›ä¿¡æ¯ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-built_in">QHotkey</span> (QObject *parent=Q_NULLPTR)<br><span class="hljs-built_in">QHotkey</span> (<span class="hljs-keyword">const</span> QKeySequence &amp;shortcut, <span class="hljs-keyword">bool</span> autoRegister=<span class="hljs-literal">false</span>, QObject *parent=Q_NULLPTR)<br><span class="hljs-built_in">QHotkey</span> (Qt::Key key, Qt::KeyboardModifiers modifiers, <span class="hljs-keyword">bool</span> autoRegister=<span class="hljs-literal">false</span>, QObject *parent=Q_NULLPTR)<br><span class="hljs-built_in">QHotkey</span> (<span class="hljs-keyword">const</span> NativeShortcut &amp;shortcut, <span class="hljs-keyword">bool</span> autoRegister=<span class="hljs-literal">false</span>, QObject *parent=Q_NULLPTR)<br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">setRegistered</span> <span class="hljs-params">(<span class="hljs-keyword">bool</span> registered)</span></span><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">setShortcut</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> QKeySequence &amp;shortcut, <span class="hljs-keyword">bool</span> autoRegister=<span class="hljs-literal">false</span>)</span></span><br><span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">setShortcut</span> <span class="hljs-params">(Qt::Key key, Qt::KeyboardModifiers modifiers, <span class="hljs-keyword">bool</span> autoRegister=<span class="hljs-literal">false</span>)</span></span><br></code></pre></div></td></tr></table></figure><p>æœ‰ä¸¤ç§æ–¹æ³•æ„é€ ä¸€ä¸ª QHotkey å¯¹è±¡ï¼š</p><p>1.æä¾›ä¸€ä¸ª <strong>QKeySequence</strong> å¯¹è±¡ï¼Œå¦‚æœ QHotkey æ„é€ å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ä¸º <strong>false</strong>ï¼Œåˆ™å¿…é¡»è°ƒç”¨ <strong>bool setRegistered (bool registered)</strong> æ³¨å†Œçƒ­é”®</p><figure class="highlight haxe"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs haxe">QHotkey *hotkey = <span class="hljs-keyword">new</span> <span class="hljs-type">QHotkey</span>&#123;QKeySequence(<span class="hljs-string">&quot;Ctrl+P&quot;</span>),<span class="hljs-literal">true</span>&#125;;<br></code></pre></div></td></tr></table></figure><p>2.æä¾›<strong>Qt::Keyå’ŒQt::KeyboardModifiers</strong>ï¼Œä¸è¿‡æ˜¯é€šè¿‡<strong>setShortcut</strong>è®¾ç½®ã€‚å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php">QHotkey *hotkey =<span class="hljs-keyword">new</span> QHotkey(this);hotkey-&gt;setShortcut(Qt::Key_A,Qt::ControlModifier,<span class="hljs-literal">true</span>);<br></code></pre></div></td></tr></table></figure><p>æ³¨å†Œçƒ­é”®æˆåŠŸåå°±å¯ä»¥åœ¨æ§½å‡½æ•°<strong>QHotkey::activated</strong>ä¸­è¿›è¡Œå¤„ç†äº†</p><h3 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h3><p>æ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ï¼Ÿ</p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>Qt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxä¸‹C++è¿æ¥Mysql</title>
    <link href="/linux-cpp-connect-mysql/"/>
    <url>/linux-cpp-connect-mysql/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h3><p>åœ¨è¿æ¥MySQLä¹‹å‰ï¼Œç¡®ä¿ç³»ç»Ÿå®‰è£…äº†MySQLï¼Œå¹¶ä¸”å®‰è£…äº†å¯¹åº”çš„åº“æ–‡ä»¶ã€‚å¯ä»¥åˆ°å®˜ç½‘ä¸‹è½½ä¸åŒç‰ˆæœ¬çš„MySQLï¼ˆè‡ªè¡Œç¼–è¯‘å®‰è£…ï¼‰<a href="https://dev.mysql.com/downloads/mysql/">ä¼ é€é—¨&gt;&gt;</a>å…·ä½“å®‰è£…æ–¹æ³•ä¸å†å¤šè¯´</p><span id="more"></span><h3 id="ä»£ç "><a class="markdownIt-Anchor" href="#ä»£ç "></a> ä»£ç </h3><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;mysql/mysql.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">connMYSQL</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-comment">//mysql_server_init(NULL,NULL,NULL);</span><br>    MYSQL mysql;<br>    <span class="hljs-built_in">mysql_init</span>(&amp;mysql);<br>    <span class="hljs-comment">//è®¾ç½®å­—ç¬¦é›† æ–¹æ³•1</span><br>    <span class="hljs-keyword">int</span> r=<span class="hljs-built_in">mysql_options</span>(&amp;mysql,MYSQL_SET_CHARSET_NAME,<span class="hljs-string">&quot;utf8&quot;</span>);<br>    <span class="hljs-keyword">if</span>(r==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;è®¾ç½®å­—ç¬¦é›† utf8 ok\n&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//è¿æ¥mysql</span><br>    MYSQL *m= <span class="hljs-built_in">mysql_real_connect</span>(&amp;mysql, <span class="hljs-string">&quot;127.0.0.1&quot;</span>,<span class="hljs-string">&quot;root&quot;</span>,<span class="hljs-string">&quot;123456&quot;</span>,<span class="hljs-string">&quot;db_0&quot;</span>, <span class="hljs-number">3306</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span>(!m)&#123;<br>        <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> errorCode=<span class="hljs-built_in">mysql_errno</span>(&amp;mysql);<br>        <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *errorString=<span class="hljs-built_in">mysql_error</span>(&amp;mysql);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;è¿æ¥æ•°æ®åº“å¤±è´¥ : %s\n&quot;</span>,errorString);<br>    &#125;<br>    <span class="hljs-comment">//è®¾ç½®å­—ç¬¦é›† æ–¹æ³•2</span><br>    <span class="hljs-built_in">mysql_query</span>(&amp;mysql,<span class="hljs-string">&quot;set names &#x27;utf8&#x27;;&quot;</span>);<br>    <span class="hljs-built_in">mysql_query</span>(&amp;mysql,<span class="hljs-string">&quot;select *from tb_0;&quot;</span>);<br>    <span class="hljs-comment">//è·å–èµ„æºç»“æœé›†</span><br>    MYSQL_RES *result=<span class="hljs-built_in">mysql_store_result</span>(&amp;mysql);<br>    <span class="hljs-comment">//è¿”å›æŸ¥è¯¢å—å½±å“çš„è¡Œ</span><br>    <span class="hljs-keyword">int</span> affectedRows=<span class="hljs-built_in">mysql_affected_rows</span>(&amp;mysql);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;affected rows: %d \n&quot;</span>,affectedRows);<br>    <span class="hljs-comment">//è·å–è®°å½•æ•°</span><br>    <span class="hljs-keyword">int</span> rowcount=<span class="hljs-built_in">mysql_num_rows</span>(result);<br>    <span class="hljs-comment">//è·å–å­—æ®µæ•°</span><br>    <span class="hljs-keyword">int</span> fieldcount=<span class="hljs-built_in">mysql_num_fields</span>(result);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;rowCount:%d fieldCount:%d \n&quot;</span>,rowcount,fieldcount);<br>    MYSQL_FIELD *field=<span class="hljs-literal">NULL</span>;<br>     <span class="hljs-comment">//éå†å­—æ®µ</span><br>    <span class="hljs-keyword">while</span> (field=<span class="hljs-built_in">mysql_fetch_field</span>(result))&#123;<br>        std::cout&lt;&lt;<span class="hljs-string">&quot;--&gt;&quot;</span>&lt;&lt;field-&gt;name&lt;&lt;std::endl;<br>    &#125;<br>    <span class="hljs-comment">//field= mysql_fetch_field_direct(result,0);</span><br>    <span class="hljs-comment">//field= mysql_fetch_field_direct(result,1);</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n&quot;</span>);<br>    <span class="hljs-comment">//char ** = MYSQL_ROW</span><br>    MYSQL_ROW row=<span class="hljs-literal">NULL</span>;<br>     <span class="hljs-comment">//éå†è¡Œ</span><br>    <span class="hljs-keyword">while</span>(row=<span class="hljs-built_in">mysql_fetch_row</span>(result))&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\t%s\t%s\t%s\t%s\n&quot;</span>,row[<span class="hljs-number">0</span>],row[<span class="hljs-number">1</span>],row[<span class="hljs-number">2</span>],row[<span class="hljs-number">3</span>],row[<span class="hljs-number">4</span>]);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n&quot;</span>);<br>    <span class="hljs-comment">//é‡Šæ”¾ç»“æœé›†</span><br>    <span class="hljs-built_in">mysql_free_result</span>(result);<br>    <span class="hljs-comment">//å…³é—­è¿æ¥</span><br>    <span class="hljs-built_in">mysql_close</span>(&amp;mysql);<br>    <span class="hljs-comment">//mysql_server_end();</span><br>    <span class="hljs-comment">//mysql_library_end();</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>      <span class="hljs-built_in">connMYSQL</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç”±äºæˆ‘ä½¿ç”¨çš„æ˜¯CLionï¼Œæ‰€ä»¥å½“æˆ‘å†™å‡ºæ¥çš„æºæ–‡ä»¶æ˜¯æ— æ³•ç›´æ¥ç¼–è¯‘çš„ï¼Œè¿™æ—¶å€™å¯ä»¥åœ¨<br />**<font color=red>CMakeLists.txt</font> **å†…æ·»åŠ  <strong>target_link_libraries(mysqlconn /usr/lib/libmysqlclient.so)</strong><br />å…¶ä¸­ mysqlconn ä¸ºé¡¹ç›®åï¼Œ/usr/lib/libmysqlclient.so ä¸ºåº“æ–‡ä»¶è·¯å¾„<br />å¦‚ /usr/lib/ ä¸å­˜åœ¨ <a href="http://libmysqlclient.so">libmysqlclient.so</a> æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨</p><blockquote><p>locate libmysqlclient</p></blockquote><p>æ‰¾åˆ°ç³»ç»Ÿå†…å­˜åœ¨çš„ libmysqlclientåº“æ–‡ä»¶ã€‚<br />æ¯”å¦‚æˆ‘çš„æœ¬æ¥æ˜¯ /usr/lib/x86_64-linux-gnu/libmysqlclient.so ï¼Œé‚£ä¹ˆæˆ‘å°±å¯ä»¥è®¾ç½®ä¸ªè½¯é“¾æ¥</p><blockquote><p>ln -s /usr/lib/x86_64-linux-gnu/libmysqlclient.so /usr/lib/libmysqlclient.so</p></blockquote><p>æˆ–è€…ç®€å•ç‚¹ä¹Ÿå¯ä»¥ç›´æ¥</p><blockquote><p>g++ main.cpp -o test -lmysqlclient<br />./test</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C++</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Partition X does not start on physical sector boundary</title>
    <link href="/linux-partition-x/"/>
    <url>/linux-partition-x/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h3><p>ä»Šå¤©å¥½å¥½çš„ï¼Œçªç„¶æ¥äº†è¿™ä¸ªï¼Œè¿˜ä»¥ä¸ºæˆ‘åŸæ¥åˆ†çš„æ‰©å±•åˆ†åŒºä¸èƒ½ç”¨äº†ã€‚æ‰€ä»¥èµ¶ç´§ç™¾åº¦ï¼Œç™¾åº¦ä¸è¡ŒGoogleï¼Œæœç„¶ï¼Œè¿˜æ˜¯Googlç‰›ï¼ç„¶è€Œè‹±æ–‡ï¼Œåªå¥½ç¡¬ç€å¤´çš®å»çœ‹ã€‚ã€‚ã€‚</p><blockquote><p>åŸæ–‡: <a href="https://askubuntu.com/questions/156994/partition-does-not-start-on-physical-sector-boundary">https://askubuntu.com/questions/156994/partition-does-not-start-on-physical-sector-boundary</a></p></blockquote><span id="more"></span><h3 id="è§£å†³æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ¡ˆ"></a> è§£å†³æ–¹æ¡ˆ</h3><p>é”™è¯¯æƒ…å†µå›¾<img src="/uploads/images/files/0.png" alt="img" /></p><p>çº¢è‰²é‚£ä¸ªé”™è¯¯æç¤ºï¼š<code>Partition 3 does not start on physical sector boundary.</code><br />æˆ‘ç¬¬ä¸€æ¬¡æ˜¯æŠŠé‚£ä¸ª /dev/sda5 åˆ é™¤åœ¨æ–°å»ºæ ¼å¼åŒ–ï¼Œç»“æœè¿˜æ˜¯ä¸è¡Œï¼Œæœ€åæˆ‘çœ‹åˆ°è€å¤–ç”¨ <strong>gparted</strong></p><ul><li><p>æˆ‘æŠŠä»¥å‰çš„æ‹“å±•åˆ†åŒºå…¨éƒ¨åˆ é™¤ï¼Œç»“æœå¦‚å›¾ã€æœªåˆ†é…ã€‘<br /><img src="/uploads/images/files/1.png" alt="img" /></p></li><li><p>æ–°å»º<code>æ‰©å±•åˆ†åŒº</code>ï¼Œ<code>ä¹‹å‰çš„ç©ºä½™ç©ºé—´</code>ä¸º <code>1MB</code><br /><img src="/uploads/images/files/2.png" alt="img" /></p></li><li><p>ç„¶ååœ¨æ–°å»ºçš„æ‰©å±•åˆ†åŒºé‚£æ–°å»ºä¸€ä¸ª<code>é€»è¾‘åˆ†åŒº</code>ï¼ŒåŒæ ·ä¹Ÿæ˜¯<code>1MB</code><br /><img src="/uploads/images/files/3.png" alt="img" /></p></li><li><p>å…¨éƒ¨åº”ç”¨ï¼Œå®Œæˆ<br /><img src="/uploads/images/files/4.png" alt="img" /></p></li><li><p>è¿™æ—¶åœ¨ç»ˆç«¯ä¸‹è¾“å…¥ <code>fdisk -l</code>åº”è¯¥å¯ä»¥çœ‹åˆ° æ²¡æœ‰é”™è¯¯äº†</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç”¨Qtå®ç°ç±»ä¼¼QQè¡¨æƒ…çª—å£</title>
    <link href="/linux-qt-qqwindow/"/>
    <url>/linux-qt-qqwindow/</url>
    
    <content type="html"><![CDATA[<p>æ¼”ç¤º</p><p><img src="/uploads/images/files/demo1.gif" alt="" /></p><span id="more"></span><p>å®ç°èµ·æ¥æ¯”è¾ƒç®€å•,å°±æ˜¯åœ¨æ¯ä¸ª<strong>TableWidget</strong>çš„å•å…ƒæ ¼è®¾ç½®ä¸€ä¸ªWidget,å¦‚Label.é‡å†™QLabelç±»ä¸­çš„ä¸¤ä¸ªå‡½æ•°,è¾¾åˆ°é¼ æ ‡è¿›å…¥ç¦»å¼€å•å…ƒæ ¼æ—¶æ˜¾ç¤ºçš„æ•ˆæœ</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//æ·»åŠ gifåˆ°TabWidget</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Widget::addGIFtoTableWidget</span><span class="hljs-params">(<span class="hljs-keyword">int</span> row,<span class="hljs-keyword">int</span> column,QString file)</span></span>&#123;<br>     <span class="hljs-comment">//è‡ªå®šä¹‰ç±»,ç”¨æ¥é‡æ–°å®ç°äº†ä¸€äº›å‡½æ•°</span><br>    MyLabel *label=<span class="hljs-keyword">new</span> MyLabel;<br>    <span class="hljs-comment">//è®¾ç½®è¾¹è·</span><br>    label-&gt;<span class="hljs-built_in">setMargin</span>(<span class="hljs-number">3</span>);<br>    <span class="hljs-comment">//gifåŠ¨ç”»</span><br>    QMovie *movie=<span class="hljs-keyword">new</span> QMovie;<br><br>    movie-&gt;<span class="hljs-built_in">setFileName</span>(file);<br>    movie-&gt;<span class="hljs-built_in">setScaledSize</span>(<span class="hljs-built_in">QSize</span>(<span class="hljs-number">24</span>,<span class="hljs-number">24</span>));<br>    movie-&gt;<span class="hljs-built_in">start</span>();<br>    movie-&gt;<span class="hljs-built_in">stop</span>();<br>    label-&gt;<span class="hljs-built_in">setMovie</span>(movie);<br>     <span class="hljs-comment">//æ·»åŠ éƒ¨ä»¶åˆ°tableWidget</span><br>    ui-&gt;tableWidget-&gt;<span class="hljs-built_in">setCellWidget</span>(row,column,label);<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> QQ_GIF_DIR <span class="hljs-meta-string">&quot;../expression/qq/&quot;</span></span><br>Widget::<span class="hljs-built_in">Widget</span>(QWidget *parent) :<br>    <span class="hljs-built_in">QWidget</span>(parent),<br>    <span class="hljs-built_in">ui</span>(<span class="hljs-keyword">new</span> Ui::Widget)<br>&#123;<br>    ui-&gt;<span class="hljs-built_in">setupUi</span>(<span class="hljs-keyword">this</span>);<br>    <span class="hljs-comment">//ä¸å¯é€‰</span><br>    ui-&gt;tableWidget-&gt;<span class="hljs-built_in">setSelectionMode</span>(QTableWidget::NoSelection);<br>    ui-&gt;tableWidget-&gt;<span class="hljs-built_in">setRowCount</span>(<span class="hljs-number">10</span>);<br>    <span class="hljs-comment">//åˆå§‹åŒ– gifè¡¨æ ¼</span><br>    <span class="hljs-keyword">int</span> num_index=<span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">int</span> rowCount= ui-&gt;tableWidget-&gt;<span class="hljs-built_in">rowCount</span>();<br>    <span class="hljs-keyword">int</span> columnCount = ui-&gt;tableWidget-&gt;<span class="hljs-built_in">columnCount</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> row = <span class="hljs-number">0</span>; row &lt;rowCount; ++row)<br>     &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> column = <span class="hljs-number">0</span>;column&lt;columnCount; ++column)<br>         &#123;<br>            QString strFileName=<span class="hljs-built_in">QString</span>(<span class="hljs-string">&quot;%1%2.gif&quot;</span>).<span class="hljs-built_in">arg</span>(QQ_GIF_DIR).<span class="hljs-built_in">arg</span>(num_index);<br>              <span class="hljs-comment">//gifæ–‡ä»¶æ˜¯å¦å­˜åœ¨</span><br>            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">QFileInfo</span>(strFileName).<span class="hljs-built_in">exists</span>())<br>                <span class="hljs-built_in">addGIFtoTableWidget</span>(row,column,strFileName);<br>            num_index++;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç„¶åå†çœ‹çœ‹ MyLabel ç±»</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">mylabel.h<br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> MYLABEL_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> MYLABEL_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QLabel&gt;</span></span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyLabel</span> :</span> <span class="hljs-keyword">public</span> QLabel<br>&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">MyLabel</span>(QWidget *parent=<span class="hljs-number">0</span>);<br><span class="hljs-keyword">protected</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">enterEvent</span><span class="hljs-params">(QEvent *event)</span></span>;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">leaveEvent</span><span class="hljs-params">(QEvent *event)</span></span>;<br>&#125;;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">// MYLABEL_H</span></span><br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">mylabel.cpp<br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;mylabel.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;QMovie&gt;</span></span><br>MyLabel::<span class="hljs-built_in">MyLabel</span>(QWidget *parent):<span class="hljs-built_in">QLabel</span>(parent)<br>&#123;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">MyLabel::enterEvent</span><span class="hljs-params">(QEvent *event)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">setStyleSheet</span>(<span class="hljs-string">&quot;border: 1px solid rgb(111, 156, 207);background-color:rgba(150,150,150,50)&quot;</span>);<br>    <span class="hljs-built_in">setCursor</span>(Qt::PointingHandCursor);<br>    QMovie *movie=<span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">movie</span>();<br>    <span class="hljs-comment">//å¼€å§‹æ’­æ”¾</span><br>    movie-&gt;<span class="hljs-built_in">start</span>();<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">MyLabel::leaveEvent</span><span class="hljs-params">(QEvent *event)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">setStyleSheet</span>(<span class="hljs-string">&quot;border:none&quot;</span>);<br>    <span class="hljs-built_in">setCursor</span>(Qt::ArrowCursor);<br>    QMovie *movie=<span class="hljs-keyword">this</span>-&gt;<span class="hljs-built_in">movie</span>();<br>    <span class="hljs-comment">//è·³è½¬åˆ°åŠ¨æ€å›¾çš„åˆå§‹å¸§</span><br>    movie-&gt;<span class="hljs-built_in">jumpToFrame</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-comment">//åœæ­¢</span><br>    movie-&gt;<span class="hljs-built_in">stop</span>();<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æˆ‘åœ¨Uiçª—å£æ·»åŠ äº†äº†ä¸€ä¸ªtable widgetéƒ¨ä»¶,æ‰€ä»¥è¿˜è¦å…ˆè®¾ç½®ç›¸åº”çš„å‚æ•°<br /><img src="/uploads/images/files/demo2.png" alt="img" /></p><p>OK,çš„ç¡®æŒºç®€å•çš„â€¦å½“ç„¶è¿˜æœ‰å¾ˆå¤šé—®é¢˜ä¹Ÿè¦è€ƒè™‘â€¦</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Qt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linux popen()å‡½æ•°å†…éƒ¨å®ç°åŸç†</title>
    <link href="/linux-popen/"/>
    <url>/linux-popen/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å‘ç°äº†ä¸€ä¸ªå‡½æ•° <strong>popen()/pclose()</strong> ,æ‰€ä»¥ç°åœ¨æ‰“ç®—ç†æ¸…ä¸‹æ€è·¯â€¦</p><span id="more"></span><h4 id="æ­£æ–‡"><a class="markdownIt-Anchor" href="#æ­£æ–‡"></a> æ­£æ–‡</h4><p>linuxä¸‹çš„ <strong>popen</strong> å‡½æ•°,å¤§æ¦‚å°±æ˜¯é€šè¿‡ <strong>fork</strong> ä¸€ä¸ªå­è¿›ç¨‹æ¥æ‰§è¡Œå‘½ä»¤å¹¶è¿”å›æ‰§è¡Œçš„ç»“æœç»™çˆ¶è¿›ç¨‹.</p><blockquote><p>The popen() function shall <strong>execute the command</strong> specified by the string command. It shall <strong>create a pipe</strong> between the calling program and the executed command, and shall return a pointer to a stream that can be used to either read from or write to the pipe.</p><p><a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/popen.html">http://pubs.opengroup.org/onlinepubs/009695399/functions/popen.html</a></p></blockquote><p>å‡½æ•°å£°æ˜å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-comment">/* Create a new stream connected to a pipe running the given command.</span><br><span class="hljs-comment">   This function is a possible cancellation point and therefore not</span><br><span class="hljs-comment">   marked with __THROW.  */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> FILE *<span class="hljs-title">popen</span> <span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *__command, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *__modes)</span> __wur</span>;<br><span class="hljs-comment">/* Close a stream opened by popen and return the status of its child.</span><br><span class="hljs-comment">   This function is a possible cancellation point and therefore not</span><br><span class="hljs-comment">   marked with __THROW.  */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">int</span> <span class="hljs-title">pclose</span> <span class="hljs-params">(FILE *__stream)</span></span>;<br></code></pre></div></td></tr></table></figure><p>å½“ç„¶äº†,æ›´é‡è¦çš„æ˜¯è¦çŸ¥é“è¯¥å‡½æ•°å†…éƒ¨æ˜¯æ€ä¹ˆå®ç°çš„,å¤§æ¦‚æ­¥éª¤å¦‚ä¸‹:<strong>(æ­¤å¤„ä»…è®¨è®ºå­è¿›ç¨‹è¿”å›ç»“æœç»™çˆ¶è¿›ç¨‹!)</strong></p><ol><li>çˆ¶è¿›ç¨‹é€šè¿‡ <strong>pipe()</strong> åˆ›å»º <strong>è¯»/å†™åŒ¿åç®¡é“</strong> ,å¹¶å…³é—­å†™ç®¡é“pfd[1]</li><li>ç„¶å <strong>fork()</strong> åˆ›å»ºå­è¿›ç¨‹</li><li>å­è¿›ç¨‹ <strong>close()</strong> è¯»ç®¡é“pfd[0]å’Œæ ‡å‡†è¾“å‡º(STDOUT_FILENO=1) ,å¹¶ <strong>dup()</strong> å†™ç®¡é“pfd[1]</li><li>å­è¿›ç¨‹é€šè¿‡ <strong>execl()</strong> æ‰§è¡Œå‘½ä»¤,æ‰§è¡Œçš„ç»“æœä¸ºæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°äº†å†™ç®¡é“pfd[1]</li><li>çˆ¶è¿›ç¨‹ <strong>wait()</strong> å­è¿›ç¨‹é€€å‡º,æ¥ç€ <strong>fdopen()</strong> é€šè¿‡æ–‡ä»¶æè¿°ç¬¦è¿”å›ä¸€ä¸ª <strong>FILE*</strong> . æ³¨æ„è¿”å›æ–‡ä»¶æŒ‡é’ˆæ—¶,ä¸èƒ½å…³é—­è¯»ç®¡é“pfd[0],å¯ä»¥é€šè¿‡åç»­ fclose() å…³é—­è¯¥æè¿°ç¬¦</li><li><strong>fclose()</strong> å…³é—­è¯¥è¯»ç®¡é“pfd[0]</li></ol><p>ç®€å•å®ç°ä»£ç å¦‚ä¸‹:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">FILE* <span class="hljs-title">mypopen</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*cmd)</span></span>&#123;<br>    <span class="hljs-comment">//ç®¡é“æ–‡ä»¶æè¿°ç¬¦</span><br>    <span class="hljs-keyword">int</span> pfd[<span class="hljs-number">2</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">pipe</span>(pfd)!=<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;error: %s\n&quot;</span>,<span class="hljs-built_in">strerror</span>(errno));<br>        <span class="hljs-built_in">exit</span>(EXIT_FAILURE);<br>    &#125;<br>    <span class="hljs-comment">//åˆ›å»ºå­è¿›ç¨‹</span><br>    <span class="hljs-keyword">pid_t</span>  pid=fork();<br>    <span class="hljs-keyword">if</span>(pid==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-built_in">close</span>(pfd[<span class="hljs-number">0</span>]);<br>        <br>         <span class="hljs-comment">//é‡å®šå‘ æ ‡å‡†è¾“å‡º åˆ° å†™ç®¡é“</span><br>        <span class="hljs-built_in">close</span>(STDOUT_FILENO);<br>        <span class="hljs-built_in">dup</span>(pfd[<span class="hljs-number">1</span>]);<br>        <span class="hljs-keyword">char</span> _cmd[<span class="hljs-number">50</span>]&#123;<span class="hljs-number">0</span>&#125;;<br>        <span class="hljs-built_in">sprintf</span>(_cmd,<span class="hljs-string">&quot;%s&quot;</span>,cmd);<br>        <span class="hljs-built_in">execl</span>(<span class="hljs-string">&quot;/bin/sh&quot;</span>,<span class="hljs-string">&quot;sh&quot;</span>,<span class="hljs-string">&quot;-c&quot;</span>,_cmd,<span class="hljs-literal">NULL</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-comment">//å…³é—­å†™ç®¡é“</span><br>    <span class="hljs-built_in">close</span>(pfd[<span class="hljs-number">1</span>]);<br>    <span class="hljs-comment">//ç­‰å¾…å­è¿›ç¨‹é€€å‡º</span><br>    <span class="hljs-keyword">int</span> p= <span class="hljs-built_in">wait</span>(<span class="hljs-number">0</span>);<br>   <span class="hljs-comment">//printf(&quot;%d terminal\n&quot;,p);</span><br>    <span class="hljs-comment">//ç›´æ¥è¯»å–æ•°æ®</span><br>    <span class="hljs-comment">//char buffer[1024*2]=&#123;0&#125;;</span><br>    <span class="hljs-comment">//read(pfd[0],buffer,1024*2);</span><br>    FILE* pfile =<span class="hljs-built_in">fdopen</span>(pfd[<span class="hljs-number">0</span>],<span class="hljs-string">&quot;r&quot;</span>);<br>    <span class="hljs-keyword">if</span>(!pfile) <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-keyword">return</span> pfile;<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    FILE *file= <span class="hljs-built_in">mypopen</span>(<span class="hljs-string">&quot;ls -lSah&quot;</span>);<br>    <span class="hljs-keyword">char</span> buffer[<span class="hljs-number">1024</span>];<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">fgets</span>(buffer,<span class="hljs-number">1024</span>,file))&#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>,buffer);<br>    &#125;<br>    <span class="hljs-comment">//close pfd[0]!</span><br>    <span class="hljs-built_in">fclose</span>(file);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­,è¾ƒé‡è¦çš„æ˜¯åœ¨å­è¿›ç¨‹ä¸­é‡å®šå‘æ ‡å‡†è¾“å‡º,è¿™é‡Œç»™å‡ºå…¶ä»–æ–¹æ³•é‡å®šå‘æ ‡å‡†è¾“å‡ºåˆ°ç®¡é“æè¿°ç¬¦</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//æ–¹æ³•1</span><br><span class="hljs-comment">//é‡å®šå‘ æ ‡å‡†è¾“å‡º åˆ° å†™ç®¡é“</span><br><span class="hljs-built_in">close</span>(STDOUT_FILENO);<br><span class="hljs-built_in">dup</span>(pfd[<span class="hljs-number">1</span>]);<br><span class="hljs-comment">//æ–¹æ³•2,ç›¸å½“äºå…ˆclose(STDOUT_FILENO) ,å†dup(pfd[1])</span><br><span class="hljs-built_in">dup2</span>(pfd[<span class="hljs-number">1</span>],STDOUT_FILENO);<br><span class="hljs-comment">//æ–¹æ³•3</span><br><span class="hljs-built_in">close</span>(STDOUT_FILENO);<br><span class="hljs-keyword">int</span> fd=<span class="hljs-built_in">fcntl</span>(pfd[<span class="hljs-number">1</span>],F_DUPFD);<br></code></pre></div></td></tr></table></figure><h4 id="ç»“å°¾"><a class="markdownIt-Anchor" href="#ç»“å°¾"></a> ç»“å°¾</h4><p>å‚è€ƒæ–‡ç« : <a href="http://blog.csdn.net/litingli/article/details/5891726">http://blog.csdn.net/litingli/article/details/5891726</a></p>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>C++</tag>
      
      <tag>C</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows API HOOKé’©å­</title>
    <link href="/windows-hook/"/>
    <url>/windows-hook/</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡è®²ä¸‹Windows API HOOK(é’©å­),ä¸»è¦å’ŒDLLæ³¨å…¥è”ç³»åœ¨ä¸€èµ·.<br />Windowsç³»ç»ŸæŠŠæ¯ä¸ªWindowsAPIå‡½æ•°åŠŸèƒ½å°è£…åˆ°äº†æ¯ä¸€ä¸ªDLLåº“æ–‡ä»¶ä¸­,ä»è€Œæé«˜ç¨‹åºçš„ç¼–è¯‘è¿è¡Œæ•ˆç‡,è€Œåœ¨åº”ç”¨ç¨‹åºè¿è¡ŒæœŸé—´åŠ¨æ€åº“æ—¶,å¿…ç„¶å­˜åœ¨ç¨‹åºè·å–DLLä¸­çš„å‡½æ•°åœ°å€.äºæ˜¯é€šè¿‡æ³¨å…¥DLLæ¥æˆªå–ä¿¡æ¯.</p><span id="more"></span><h3 id="æ¶ˆæ¯hook"><a class="markdownIt-Anchor" href="#æ¶ˆæ¯hook"></a> æ¶ˆæ¯HOOK</h3><p>HOOK(æŒ‚é’©)æŠ€æœ¯,å¯åˆ†ä¸º <strong>å†…æ ¸å±‚(R0)HOOK</strong> , <strong>åº”ç”¨å±‚(R3)HOOK</strong> ,è¿™ä¸¤ç§æŠ€æœ¯å®ç°èµ·æ¥è™½ç„¶ç•¥ç›¸ä¼¼,ä½†æ˜¯ <strong>å†…æ ¸å±‚HOOK</strong> æ¯”èµ· <strong>åº”ç”¨å±‚HOOK</strong> éš¾åº¦è¦é«˜å¾—å¤š,è€Œä¸”ç¼–å†™çš„ä»£ç ä¹Ÿè¦ä¿è¯æ­£ç¡®(å¼‚å¸¸æœºåˆ¶),ä¸ç„¶ä¸‡ä¸€æ¥ä¸ªèµ‹å€¼ç»™ä¸€ä¸ªç©ºæŒ‡é’ˆçš„ä»£ç ,è“å±å°±å‘µå‘µäº†â€¦æœ¬æ–‡ä¸»è¦è®²è§£ åº”ç”¨å±‚hook</p><p>ä¸»è¦ç”¨åˆ°çš„WindowsAPI</p><blockquote><p>å¤´æ–‡ä»¶Winuser.h (include Windows.h)<br />åº“æ–‡ä»¶User32.lib<br />DLLæ–‡ä»¶User32.dll</p></blockquote><h5 id="setwindowshookex"><a class="markdownIt-Anchor" href="#setwindowshookex"></a> SetWindowsHookEx</h5><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">HHOOK WINAPI <span class="hljs-title">SetWindowsHookEx</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ <span class="hljs-keyword">int</span>       idHook,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ HOOKPROC  lpfn,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ HINSTANCE hMod,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ DWORD     dwThreadId</span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>;<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­ <strong>idHook</strong> å¯é€‰çš„å€¼æœ‰å¾ˆå¤šç§, æ›´å¤šé€‰é¡¹å¯ä»¥åˆ° MSDN <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms644990(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/ms644990(v=vs.85).aspx</a> æŸ¥çœ‹<br />æœ¬æ–‡ç”¨åˆ°å…¶ä¸­çš„ <strong>WH_GETMESSAGE</strong> ç›‘è§†å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—çš„æ¶ˆæ¯</p><h5 id="getmsgproc"><a class="markdownIt-Anchor" href="#getmsgproc"></a> GetMsgProc</h5><p>å…¶ <code>_In_ HOOKPROC lpfn,</code> å¯¹åº”çš„å›è°ƒå‡½æ•°å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">LRESULT CALLBACK <span class="hljs-title">GetMsgProc</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ <span class="hljs-keyword">int</span>    code,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ WPARAM wParam,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ LPARAM lParam</span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>;<br></code></pre></div></td></tr></table></figure><p><strong>lParam</strong> å‚æ•°å¯ä»¥è½¬æ¢ä¸º **MSG***ç»“æ„ä½“<br /><code>MSG* pMsg = (MSG*)lParam;</code></p><h5 id="callnexthookex"><a class="markdownIt-Anchor" href="#callnexthookex"></a> CallNextHookEx</h5><p>è¿™ä¸ªå‡½æ•°èµ·åˆ°ä¼ é€’ä¸‹ä¸€ä¸ªé’©å­å‡½æ•°çš„ä½œç”¨,è¿™æ ·çš„è¯,å…¶ä»–é’©å­æ‰å¯ä»¥ç»§ç»­æ‰§è¡Œ</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">LRESULT WINAPI <span class="hljs-title">CallNextHookEx</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_opt_ HHOOK  hhk,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_     <span class="hljs-keyword">int</span>    nCode,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_     WPARAM wParam,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_     LPARAM lParam</span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>;<br></code></pre></div></td></tr></table></figure><p><strong>nCode,wParam,lParam</strong> ä¸€èˆ¬éƒ½æ˜¯ <strong>GetMsgProc</strong> ä¸­çš„å‚æ•°<br />,è€Œ <strong>hhk</strong> åˆ™ä¸º <strong>SetWindowsHookEx</strong> è¿”å›çš„é’©å­å¥æŸ„.</p><h5 id="unhookwindowshookex"><a class="markdownIt-Anchor" href="#unhookwindowshookex"></a> UnhookWindowsHookEx</h5><p>å¸è½½é’©å­,ä¸ <code>SetWindowsHookEx</code> æˆå¯¹ä½¿ç”¨</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">BOOL WINAPI <span class="hljs-title">UnhookWindowsHookEx</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ HHOOK hhk</span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>;<br></code></pre></div></td></tr></table></figure><p>ä¸‹é¢ä»¥ä¸€ä¸ªç®€å•ä¾‹å­è¯´æ˜(<strong>MFC</strong>)</p><p>Source.defæ–‡ä»¶ï¼Œç”¨äºå¯¼å‡ºDLLå‡½æ•°</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">LIBRARY hookFun.dll;dllå<br>EXPORTS;å¯¼å‡ºå‡½æ•°<br>SetHook@<span class="hljs-number">1</span><br>UnsetHook@<span class="hljs-number">2</span><br></code></pre></div></td></tr></table></figure><p>DLLæ¨¡å—æ–‡ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DLL_EXPORT extern <span class="hljs-meta-string">&quot;C&quot;</span> __declspec(dllexport)</span><br><span class="hljs-comment">//å¼€å§‹HOOK</span><br><span class="hljs-function">DLL_EXPORT <span class="hljs-keyword">void</span> _stdcall <span class="hljs-title">SetHook</span><span class="hljs-params">(DWORD pid)</span></span>;<br><span class="hljs-comment">//å–æ¶ˆHOOK</span><br><span class="hljs-function">DLL_EXPORT <span class="hljs-keyword">void</span> _stdcall <span class="hljs-title">UnsetHook</span><span class="hljs-params">()</span></span>;<br><span class="hljs-comment">//å…¨å±€ é’©å­å¥æŸ„</span><br>HHOOK hHook_g = <span class="hljs-literal">NULL</span>;<br><span class="hljs-comment">//å…¨å±€ DLLæ¨¡å—å¥æŸ„</span><br>HINSTANCE hInstance_g = <span class="hljs-literal">NULL</span>;<br><span class="hljs-comment">//DLL å…¥å£å‡½æ•°</span><br><span class="hljs-function">BOOL APIENTRY <span class="hljs-title">DllMain</span><span class="hljs-params">(_In_ <span class="hljs-keyword">void</span>* _DllHandle, _In_ <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> _Reason, _In_opt_ <span class="hljs-keyword">void</span>* _Reserved)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span> (_Reason==DLL_PROCESS_ATTACH)<br>&#123;<br><span class="hljs-comment">//ä¿å­˜å½“å‰ DLLæ¨¡å—çš„å¥æŸ„åˆ°å…¨å±€ï¼Œä»¥åè¦ç”¨ï¼</span><br>hInstance_g = (HINSTANCE)_DllHandle;<br>&#125;<br><span class="hljs-keyword">return</span> TRUE;<br>&#125;<br><span class="hljs-comment">//è‡ªå®šä¹‰æ¶ˆæ¯ï¼Œå¤„ç†é’©å­æ¶ˆæ¯å‡½æ•°</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WM_HOOKMSG WM_USER+100 </span><br><span class="hljs-comment">//è¿‡ç¨‹æ¶ˆæ¯å¤„ç†å‡½æ•°</span><br><span class="hljs-function">LRESULT CALLBACK <span class="hljs-title">GetMsgProc</span><span class="hljs-params">(_In_ <span class="hljs-keyword">int</span>    code,_In_ WPARAM wParam,_In_ LPARAM lParam)</span> </span><br><span class="hljs-function"></span>&#123; <br><span class="hljs-comment">//æŠŠ å‚æ•° lParam è½¬æ¢ä¸º MSG ç»“æ„ä½“ï¼Œè·å– æ¶ˆæ¯ç±»å‹</span><br>MSG* pMsg = (MSG*)lParam;<br><span class="hljs-keyword">if</span> (pMsg-&gt;message== WM_HOOKMSG)<br>&#123;<br><span class="hljs-built_in">MessageBoxA</span>(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;HOOK MSG&quot;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-number">0</span>);<br>&#125;<br><span class="hljs-comment">//ç»§ç»­ä¼ é€’ä¸‹ä¸€ä¸ªé’©å­</span><br><span class="hljs-keyword">return</span> <span class="hljs-built_in">CallNextHookEx</span>(hHook_g, code, wParam, lParam);<br>&#125;<br><span class="hljs-comment">//å¼€å§‹HOOKï¼Œè¿™é‡Œè¿‡äºç®€å•ï¼Œæ²¡æœ‰è¿›è¡Œå…¶ä»–å¤„ç†...(-ï½¡-;)</span><br><span class="hljs-comment">//å‚æ•°--&gt; çº¿ç¨‹ID </span><br><span class="hljs-function">DLL_EXPORT <span class="hljs-keyword">void</span> _stdcall <span class="hljs-title">SetHook</span><span class="hljs-params">(DWORD tid)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">//å®‰è£…é’©å­</span><br><span class="hljs-comment">//hInstance_gï¼šæ ‡è¯† GetMsgProc åœ¨ è¯¥æ¨¡å—å†…</span><br><span class="hljs-comment">//tidï¼šæ ‡è¯†æ˜¯ å…¨å±€é’©å­( tid=0 ) è¿˜æ˜¯æŒ‡å®š çº¿ç¨‹é’©å­</span><br>hHook_g = <span class="hljs-built_in">SetWindowsHookExW</span>(WH_GETMESSAGE, GetMsgProc, hInstance_g, tid);<br>&#125;<br><span class="hljs-comment">//å–æ¶ˆHOOK</span><br><span class="hljs-function">DLL_EXPORT <span class="hljs-keyword">void</span> _stdcall <span class="hljs-title">UnsetHook</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">//å¸è½½é’©å­</span><br><span class="hljs-built_in">UnhookWindowsHookEx</span>(hHook_g);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è°ƒç”¨è¿›ç¨‹ä¸»è¦ä»£ç å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//è‡ªå®šä¹‰æ¶ˆæ¯</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>  WM_HOOKMSG WM_USER+100</span><br><span class="hljs-comment">//è·¯å¾„</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span>  DLL_PATH <span class="hljs-meta-string">L&quot;C:\\hookFun.dll&quot;</span></span><br><span class="hljs-comment">//SetHook å‡½æ•°åœ°å€</span><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">void</span><span class="hljs-params">(_stdcall* LPFNSETHOOK)</span><span class="hljs-params">(DWORD)</span></span>;<br><span class="hljs-comment">//UnsetHook å‡½æ•°åœ°å€</span><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">void</span><span class="hljs-params">(_stdcall* LPFNUNSETHOOK)</span><span class="hljs-params">()</span></span>;<br>HMODULE hMo = <span class="hljs-literal">NULL</span>;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ChookMfcDlg::OnBnClickedButton1</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">//è·å–æŒ‡å®šä¸»çª—å£çš„å¥æŸ„</span><br>HWND hwndMain = ::<span class="hljs-built_in">FindWindow</span>(<span class="hljs-literal">NULL</span>, <span class="hljs-string">L&quot;å‰ªè´´ç°¿æŸ¥çœ‹å™¨ - [å‰ªè´´æ¿]&quot;</span>);<br><span class="hljs-comment">//ä¿å­˜ è¿›ç¨‹ID</span><br>DWORD PID;<br><br><span class="hljs-keyword">char</span> szMsg[<span class="hljs-number">50</span>]=&#123; <span class="hljs-number">0</span> &#125;;<br><span class="hljs-comment">//è¿”å› çº¿ç¨‹ID</span><br> DWORD TID= <span class="hljs-built_in">GetWindowThreadProcessId</span>(hwndMain, &amp;PID);<br> <span class="hljs-built_in">sprintf</span>(szMsg, <span class="hljs-string">&quot;Thread ID:%08X&quot;</span>, TID);<br> <span class="hljs-built_in">MessageBoxA</span>(<span class="hljs-literal">NULL</span>, szMsg, szMsg, MB_ICONINFORMATION);<br> <span class="hljs-comment">//å…ˆåŠ¨æ€è½½å…¥ è¦æ³¨å…¥çš„DLLï¼Œç„¶åå†æŠŠå®ƒå¸è½½ï¼ï¼ï¼</span><br> hMo= <span class="hljs-built_in">LoadLibrary</span>(DLL_PATH);<br><span class="hljs-comment">//è·å–æ¨¡å—å†… SetHook å‡½æ•°åœ°å€</span><br>LPFNSETHOOK lpSethook = (LPFNSETHOOK)<span class="hljs-built_in">GetProcAddress</span>(hMo, <span class="hljs-string">&quot;SetHook&quot;</span>);<br><span class="hljs-comment">//è°ƒç”¨SetHookå‡½æ•°</span><br><span class="hljs-built_in">lpSethook</span>(TID);<br><span class="hljs-comment">//å‘ è¦æ³¨å…¥çš„ è¿›ç¨‹çš„çº¿ç¨‹ID æŠ•é€’ æˆ‘è‡ªå·±æ¶ˆæ¯</span><br><span class="hljs-built_in">PostThreadMessageW</span>(TID, WM_HOOKMSG, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br><span class="hljs-comment">//è·å–æ¨¡å—å†… UnsetHook å‡½æ•°åœ°å€</span><br>LPFNUNSETHOOK lpUnSethook = (LPFNUNSETHOOK)<span class="hljs-built_in">GetProcAddress</span>(hMo, <span class="hljs-string">&quot;UnsetHook&quot;</span>);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ChookMfcDlg::OnBnClickedButton2</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">//è·å–æ¨¡å—å†… UnsetHook å‡½æ•°åœ°å€</span><br>LPFNUNSETHOOK lpUnSethook = (LPFNUNSETHOOK)<span class="hljs-built_in">GetProcAddress</span>(hMo, <span class="hljs-string">&quot;UnsetHook&quot;</span>);<br><span class="hljs-comment">// å–æ¶ˆHOOKï¼</span><br><span class="hljs-built_in">lpUnSethook</span>();<br><span class="hljs-comment">//æŠŠ ä¸»è°ƒç”¨è¿›ç¨‹  çš„ DLL å¸è½½ï¼Œä¸ç„¶ä¼šä¸€ç›´å­˜åœ¨ä¸»è°ƒç”¨è¿›ç¨‹ä¸­ï¼ï¼</span><br><span class="hljs-built_in">FreeLibrary</span>(hMo);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸€èˆ¬æ¥è¯´,æ³¨å…¥DLLè¿™é¡¹æŠ€æœ¯ç¡®å®å¾ˆè€äº†,<a href="http://xn--6oqs9cz1c48h6qs0zjkn9anlu.so">æ³¨å…¥æ—¶å¯èƒ½ä¼šå¤±è´¥.so</a> â€¦</p><h4 id="é”®ç›˜hook"><a class="markdownIt-Anchor" href="#é”®ç›˜hook"></a> é”®ç›˜HOOK</h4><p>è¿™ä¸ªä¾‹å­æ²¡æœ‰ç”¨åˆ°DLL,ç›´æ¥å‹¾ä½å½“å‰ç¨‹åº</p><ul><li>KeyboardProc â€”- <strong>WH_KEYBOARD(2)</strong></li><li>LowLevelKeyboardProc â€”- <strong>WH_KEYBOARD_LL(13)</strong></li></ul><p>æ³¨æ„ ä¸Šé¢çš„ <strong>KeyboardProc</strong> å’Œ <strong>LowLevelKeyboardProc</strong> å‡½æ•°ï¼Œå‰è€…æ˜¯<strong>æ™®é€š</strong>çš„é’©å­å‡½æ•°ï¼Œè€Œåè€…æ˜¯ä¸€ä¸ª<strong>ä½çº§</strong>çš„é’©å­å‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°çš„å‚æ•°ä¸åŒï¼Œæ‰€ä»¥è¦è·å–çš„å€¼ä¹Ÿä¸åŒï¼ï¼</p><blockquote><p><strong>wParam</strong> [in]<br />Type: <strong>WPARAM</strong><br /><strong>The virtual-key code of the key</strong> thatgenerated the keystroke message.<br /><strong>lParam</strong> [in]<br />Type: <strong>LPARAM</strong><br />The repeat count, scan code, extended-key flag, contextcode, previous key-state flag, and transition-state flag. For more informationabout thelParam parameter, seeKeystroke Message Flags. The following table describes the bits of this value.<br /><strong>ç”±æ­¤å¯çœ‹å‡º ï¼Œwparamä¸»è¦æ˜¯é”®ç›˜çš„è™šæ‹Ÿé”®ä»£ç ï¼Œlparamä¸»è¦æ˜¯ï¼š</strong><br />The lParam parameter of a keystroke message containsadditional information about the keystroke that generated the message. Thisinformation includes therepeat count, the scan code, the extended-key flag, thecontext code, the previous key-state flag, and the transition-state flag.The following illustration shows the locations of these flags and values in thelParam parameter.</p></blockquote><p>å½“ <strong>SetWindowsHookEx()</strong> å‚æ•° <strong>idHOOK</strong> ä¸º <strong>WH_KEYBORAD_LL</strong> æ—¶ï¼Œè¿™ä¸ªå‡½æ•°çš„å‚æ•°ä¸­çš„ <strong>wparam</strong> ä¸º <strong>é”®ç›˜æ¶ˆæ¯</strong> ï¼Œå¦‚WM_KEYDOMNâ€¦ é‚£ä¹ˆ <strong>lparam</strong> å°±æ˜¯ä¸€ä¸ª <strong>LPKBDLLHOOKSTRUCTç»“æ„ä½“</strong> äº†ï¼çœ‹è¿™ä¸ªç»“æ„ä½“çš„åå­—å°±çŸ¥é“è¿™æ˜¯ä¸€ä¸ªç”¨äº ä½çº§é”®ç›˜é’©å­çš„ï¼Œâ€œLLâ€-&gt;â€LowLevelâ€œï¼Œå‘µå‘µ~è¿™ä¸ªç»“æ„ä½“ä¸­ åŒ…æ‹¬äº† <strong>è™šæ‹Ÿé”®ä»£ç  å’Œ æ‰«æç </strong>!</p><p>åˆ«å¿˜äº†è¿˜æœ‰é‚£ä¸ª SetWindowsHookEx() å‡½æ•°ï¼Œç°åœ¨åœ¨å›å¿†ä¸€ä¸‹é‚£ä¸ªå‡½æ•°åŸå‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-function">HHOOK WINAPI <span class="hljs-title">SetWindowsHookEx</span><span class="hljs-params">(</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ <span class="hljs-keyword">int</span>       idHook,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ HOOKPROC  lpfn,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ HINSTANCE hMod,</span></span><br><span class="hljs-params"><span class="hljs-function">  _In_ DWORD    dwThreadId</span></span><br><span class="hljs-params"><span class="hljs-function">)</span></span>;<br></code></pre></div></td></tr></table></figure><ul><li><p>å½“<strong>IdHookä¸ºWH_KEYBOARD</strong>æ—¶ï¼Œlpfnä¸ºKeyboardProc(åå­—è‡ªå®šä¹‰)ï¼Œ<strong>hModä¸ºå½“å‰ç¨‹åºå®ä¾‹å¥æŸ„</strong>ï¼ŒMFC æœ‰å¤šç§æ–¹æ³•è·å–ï¼Œå¦‚: <code>AfxGetInstanceHandle()</code><br />æœ€åä¸€ä¸ª <strong>dwThreadIdä¸º0</strong></p></li><li><p>å½“idHookä¸ºWH_KEYBOARD_LLæ—¶ï¼ŒdwThreadidå¿…é¡»ä¸ºå½“å‰æ¨¡å—çš„çº¿ç¨‹IDï¼<br />å¦‚ä¸‹è¡¨:</p><table><thead><tr><th>idHook</th><th>lpfn</th><th>hMod</th><th>dwThreadId</th></tr></thead><tbody><tr><td>WH_KEYBOARD</td><td>KeyboardProc</td><td>å½“å‰ç¨‹åºå®ä¾‹å¥æŸ„</td><td>0</td></tr><tr><td>WH_KEYBOARD_LL</td><td>LowLevelKeyboardProc</td><td>å½“å‰ç¨‹åºå®ä¾‹å¥æŸ„</td><td>å½“å‰ç¨‹åºçº¿ç¨‹ID</td></tr></tbody></table></li></ul><p>ä»£ç å¦‚ä¸‹:</p><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++">HHOOK hHook2;<br><span class="hljs-function">LRESULT CALLBACK <span class="hljs-title">KeyBoradProc</span><span class="hljs-params">(intcode,WPARAMwp,LPARAMlp)</span></span><br><span class="hljs-function"></span>&#123;<br>         <span class="hljs-keyword">if</span> (code&lt;<span class="hljs-number">0</span>)<br>         &#123;<br>                   <span class="hljs-keyword">return</span> <span class="hljs-built_in">CallNextHookEx</span>(hHook2,code,wp, lp);<br>         &#125;<br>         WCHAR szkeyValue[<span class="hljs-number">20</span>]=&#123; <span class="hljs-number">0</span> &#125;;<br>         <span class="hljs-comment">//wsprintf(szkeyValue, L&quot;%c&quot;, wp);  //è™šæ‹Ÿé”®ä»£ç </span><br>            <span class="hljs-comment">//è·å–æŒ‰é”®çš„åç§°          </span><br>         <span class="hljs-built_in">GetKeyNameText</span>(lp,szkeyValue, <span class="hljs-number">50</span>);<br>         <span class="hljs-built_in">AfxGetMainWnd</span>()-&gt;<span class="hljs-built_in">SetDlgItemText</span>(IDC_EDIT1,szkeyValue);<br>         <span class="hljs-keyword">return</span> <span class="hljs-built_in">CallNextHookEx</span>(hHook2,code,wp, lp);<br>&#125;<br>       <span class="hljs-comment">//å®‰è£…é”®ç›˜é’©å­</span><br>         hHook2 = <span class="hljs-built_in">SetWindowsHookEx</span>(WH_KEYBOARD,KeyBoradProc,<span class="hljs-built_in">AfxGetInstanceHandle</span>(),<span class="hljs-built_in">GetCurrentThreadId</span>());      <span class="hljs-comment">//æ³¨æ„è¿™é‡Œçš„çº¿ç¨‹IDä¸ºå½“å‰ç¨‹åºçš„çº¿ç¨‹IDï¼</span><br>      <br>         <span class="hljs-comment">//å¸è½½é’©å­</span><br><span class="hljs-built_in">UnhookWindowsHookEx</span>(hHook2);<br>ä¸‹é¢æ˜¯å…³äºä½çº§é”®ç›˜é’©å­çš„ä»£ç ï¼›<br>         <span class="hljs-comment">//ä½çº§çš„é”®ç›˜é’©å­</span><br>         hHook= ::<span class="hljs-built_in">SetWindowsHookEx</span>(WH_KEYBOARD_LL,myLowLevelKeyboardProc,<span class="hljs-built_in">AfxGetInstanceHandle</span>(),<span class="hljs-number">0</span>);<span class="hljs-comment">//æ³¨æ„è¿™é‡ŒTIDä¸º 0</span><br> <br>         <span class="hljs-comment">//å¸è½½ä½çº§é’©å­</span><br><span class="hljs-built_in">UnhookWindowsHookEx</span>(hHook)<br></code></pre></div></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs c++"><span class="hljs-comment">//ä½çº§é’©å­å‡½æ•°å¤„ç†è¿‡ç¨‹</span><br><span class="hljs-function">LRESULT CALLBACK <span class="hljs-title">LowLevelKeyboardProc</span><span class="hljs-params">(_In_int   code,_In_WPARAMwParam,_In_LPARAMlParam)</span></span><br><span class="hljs-function"></span>&#123;<br>                   <span class="hljs-keyword">if</span> (code &lt; <span class="hljs-number">0</span>)<br>                   &#123;<br>                            <span class="hljs-built_in">returnCallNextHookEx</span>(hHook,code,wParam, lParam);<br>                   &#125;<br> <br>                  <span class="hljs-comment">// ä½çº§é”®ç›˜é’©å­æ—¶ï¼Œwparamå‚æ•°ä¸º WMé”®ç›˜æ¶ˆæ¯ï¼ï¼ï¼</span><br> <br>                   <span class="hljs-comment">//æŒ‰ä¸‹çš„</span><br>                   <span class="hljs-keyword">if</span> (code ==HC_ACTION&amp;&amp;wParam==WM_KEYDOWN)<br>                   &#123;<br>                            LPKBDLLHOOKSTRUCTpKbs = (LPKBDLLHOOKSTRUCT)lParam;<br>                            WCHARszlMsg[<span class="hljs-number">100</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>                            <span class="hljs-built_in">wsprintf</span>(szMsg,<span class="hljs-string">L&quot;vkCode:%c-scanCode:%02X&quot;</span>,pKbs-&gt;vkCode,pKbs-&gt;scanCode);<br> <br><span class="hljs-comment">//ESCé”®æ‰«æç </span><br>                            <span class="hljs-keyword">if</span> (pKbs-&gt;scanCode==<span class="hljs-number">0x01</span>)<br>                            &#123;                         <br>                                     returnTRUE;<br>                            &#125;<br>                   &#125;<br>                   <span class="hljs-keyword">return</span> <span class="hljs-built_in">CallNextHookEx</span>(hHook,code,wParam, lParam);<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Programming</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>C</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
